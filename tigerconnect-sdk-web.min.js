var TigerConnect=function(n){function r(e){if(o[e])return o[e].exports;var t=o[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,r),t.loaded=!0,t.exports}var o={};return r.m=n,r.c=o,r.p="",r(0)}([function(e,n,r){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),r(e._babelPolyfill||!1===e._tcShouldPolyfill?526:529);r(981)("./web");var t=r(405).TigerConnectClient;n.Client=t}).call(n,function(){return this}())},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(177),a=(r=o)&&r.__esModule?r:{default:r};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,a.default)(e,r.key,r)}}t.default=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(n(12)),a=r(n(94)),i="function"==typeof a.default&&"symbol"==typeof o.default?function(e){return typeof e}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":typeof e};t.default="function"==typeof a.default&&"symbol"===i(o.default)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":void 0===e?"undefined":i(e)}},function(e,t,n){e.exports={default:n(545),__esModule:!0}},function(e,t,n){e.exports={default:n(556),__esModule:!0}},function(e,t,n){e.exports={default:n(554),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(n(539)),a=r(n(176)),i=r(n(3));t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,i.default)(t)));e.prototype=(0,a.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(3),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,a.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(19),u=(r=o)&&r.__esModule?r:{default:r};t.default=function(e){return function(){var s=e.apply(this,arguments);return new u.default(function(a,i){return function t(e,n){try{var r=s[e](n),o=r.value}catch(e){return void i(e)}return r.done?void a(o):u.default.resolve(o).then(function(e){t("next",e)},function(e){t("throw",e)})}("next")})}}},function(e,t,n){e.exports=n(612)},function(e,t,n){e.exports={default:n(552),__esModule:!0}},function(e,t,n){e.exports={default:n(563),__esModule:!0}},function(e,t,n){e.exports={default:n(543),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.VERSIONS=t.ROUTES=void 0;var u=r(n(10)),o=r(n(9)),a=r(n(38)),i=r(n(1)),s=r(n(2));t.recoverFromNotFound=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.fallbackValue,i=void 0===t?null:t,n=e.httpStatusCodes,s=void 0===n?f:n;return function(e,t,n){var r,a=n.value;return n.value=(r=(0,o.default)(u.default.mark(function e(){var t,n,r,o=arguments;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,t=o.length,n=Array(t),r=0;r<t;r++)n[r]=o[r];return e.next=4,a.call.apply(a,[this].concat(n));case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(0),e.t0.response&&s.includes(e.t0.response.status))return e.abrupt("return",i);e.next=13;break;case 13:if(e.t0.code===l.PermissionDeniedError.CODE&&s.includes(403))return e.abrupt("return",i);e.next=17;break;case 17:if(e.t0.code===l.WrongCredentialsError.CODE&&s.includes(401))return e.abrupt("return",i);e.next=21;break;case 21:throw e.t0;case 22:case"end":return e.stop()}},e,this,[[0,7]])})),function(){return r.apply(this,arguments)}),n}};var c=r(n(41)),l=n(18),f=[403,404],d=(t.ROUTES={CONVERSATION_FIND_ALL:"conversations.findAll",DISTRIBUTION_LIST_FIND:"distributionLists.find",ENTITIES_FIND_ALL:"entities.findAll",ESCALATION:"escalation",EVENTS_ACK:"events.ack",EVENTS_CLOSE_ALL_CONNECTIONS:"events.closeAllConnections",GROUP_ADD_MEMBERS:"group.addMembers",GROUP_CREATE:"group.create",GROUP_DESTROY:"group.destroy",GROUP_FIND:"group.find",GROUP_FIND_ALL_MEMBER_IDS:"group.findAllMemberIds",GROUP_UPDATE:"group.update",MESSAGE_FIND:"messages.find",MESSAGE_FIND_RECIPIENT_STATUS:"messages.findRecipientStatus",MESSAGE_FIND_RECIPIENT_STATUS_MULTI:"messages.findRecipientStatusMulti",MESSAGE_FORWARD:"message.forward",MESSAGE_SEND:"message.send",MESSAGE_UPDATE_RECIPIENT_STATUS_MULTI:"messages.updateRecipientStatusMulti",METADATA_FIND:"metadata.find",MUTE_FIND_ALL:"mute.findAll",ORGANIZATION_FIND:"organization.find",ORGANIZATION_FIND_ALL_OF_USER:"organization.findAllOfUser",ROLES_CREATE_P2P_GROUP:"roles.createP2PGroup",SEARCH_QUERY:"search.query",TEAMS_CREATE:"teams.create",TEAMS_FIND:"teams.find",TEAMS_LEAVE:"teams.leave",TEAMS_UPDATE:"teams.update",USER_FIND:"user.find",USER_FIND_ME:"user.findMe"},t.VERSIONS={VERSION_TWO:"v2",VERSION_FIVE:"v5"}),p=((0,s.default)(h,[{key:"getVersion",value:function(e){var t=d.VERSION_TWO,n=d.VERSION_FIVE;return{version:this.config.condensedReplays?n:t}}}]),h);function h(e,t){(0,i.default)(this,h),(0,a.default)(this,t),this.config=e.config,this.host=e,this.httpClient=e.httpClient}t.default=p,(0,a.default)(p.prototype,c.default.prototype)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function c(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=c(t[0],n);return t.every(function(e){return c(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return c(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+c(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function l(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=l(t[0],n);return t.every(function(e){return l(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return l(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+l(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(4)),s=r(n(5)),f=r(n(13)),d=r(n(12)),p=r(n(3)),o=r(n(38)),a=r(n(1)),u=r(n(2)),h=r(n(41)),y=n(29),v=((0,u.default)(g,[{key:"_resolveModelIdWithTypes",value:function(e,t){if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+l(e));if(!("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "allowedEntityTypes" violates contract.\n\nExpected:\nstring | string[]\n\nGot:\n'+l(t));if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+c(e));if(!("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "allowedEntityTypes" violates contract.\n\nExpected:\nstring | string[]\n\nGot:\n'+c(t));if(!e)return null;if("string"==typeof e){var n=this._resolveEntity(e);if(!n)return e;e=n}return y.Validator.oneOf("thing",e.$entityType,(0,y.arrayWrap)(t)),e.serverId||e.id||null}},{key:"_resolveEntity",value:function(e,t){if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+l(e));if(!(null==t||"string"==typeof t||null==t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "types" violates contract.\n\nExpected:\n?string | ?string[]\n\nGot:\n'+l(t));if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+c(e));if(!(null==t||"string"==typeof t||null==t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})))throw new TypeError('Value of argument "types" violates contract.\n\nExpected:\n?string | ?string[]\n\nGot:\n'+c(t));if(t=t?(0,y.arrayWrap)(t):this.host.allModelEntityTypes,"object"===(void 0===e?"undefined":(0,p.default)(e))&&(e.$entityType&&(y.Validator.oneOf("thing",e.$entityType,t),t=[e.$entityType]),e=e.id),!t||"function"!=typeof t[d.default]&&!Array.isArray(t))throw new TypeError("Expected types to be iterable, got "+c(t));if(!t||"function"!=typeof t[d.default]&&!Array.isArray(t))throw new TypeError("Expected types to be iterable, got "+l(t));var n=!0,r=!1,o=void 0;try{for(var a,i=(0,f.default)(t);!(n=(a=i.next()).done);n=!0){var s=a.value,u=this.host.modelsByEntityType[s].get(e);if(u)return u}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return null}},{key:"mounted",value:function(){}},{key:"dispose",value:function(){}}]),g);function g(e,t){(0,a.default)(this,g),this._resolveModelId=function(e){if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+l(e));if(!(null==e||"string"==typeof e||null==e||e instanceof Object))throw new TypeError('Value of argument "thing" violates contract.\n\nExpected:\n?string | ?Object\n\nGot:\n'+c(e));return"string"==typeof e?e:e&&(e.serverId||e.id)||null},(0,o.default)(this,t),this.host=e,this.config=e.config,this.httpClient=e.httpClient}t.default=v,(0,o.default)(v.prototype,h.default.prototype),e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(38),a=(r=o)&&r.__esModule?r:{default:r};t.default=a.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},function(e,t){var n=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.WrongCredentialsError=t.ValidationError=t.TargetNotSupportedError=t.RequiresBasicAuthError=t.PermissionDeniedError=t.NotSupportedError=t.NotSignedInError=t.NotFoundError=t.ConnectionUnavailableError=void 0;var o=r(n(435)),a=r(n(436)),i=r(n(437)),s=r(n(438)),u=r(n(439)),c=r(n(440)),l=r(n(441)),f=r(n(258)),d=r(n(442));t.ConnectionUnavailableError=o.default,t.NotFoundError=a.default,t.NotSignedInError=i.default,t.NotSupportedError=s.default,t.PermissionDeniedError=u.default,t.RequiresBasicAuthError=c.default,t.TargetNotSupportedError=l.default,t.ValidationError=f.default,t.WrongCredentialsError=d.default},function(e,t,n){e.exports={default:n(559),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(n(536)),u=r(n(13));t.default=function(e,t){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=(0,u.default)(e);!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return(0,l.default)(e)}function a(s){var u=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];u=(0,d.default)({memoize:!1,serializeArguments:o},u);function e(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=u.serializeArguments(t),o=c[r];if(o)return o;if(u.memoize&&r in l)return f.default.resolve(l[r]);function a(){return delete c[r]}var i=s.apply(this,t).then(function(e){return u.memoize&&(l[r]=e),a(),e},function(e){throw a(),e});return c[r]=i}var c={},l={};return e.__reusePromise__origFn=s,e.__reusePromise__clear=function(){a.clear(e)},e.__reusePromise__promiseMapsByArgs=c,e.__reusePromise__memoizedValuesByArgs=l,p.push(c),h.push(l),e}function i(t){(0,c.default)(t).forEach(function(e){return delete t[e]})}function s(){var e=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];void 0===e?(p.forEach(i),h.forEach(i)):(i(e.__reusePromise__promiseMapsByArgs),i(e.__reusePromise__memoizedValuesByArgs))}function u(){var r=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(e,t,n){return n.value=a(n.value,r),n}}Object.defineProperty(t,"__esModule",{value:!0});var c=r(n(915)),f=r(n(916)),d=r(n(917)),l=r(n(913));t.default=a,t.clear=s,t.decorator=u;var p=[],h=[];a.clear=u.clear=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ServerValueEnum=t.default=void 0;var o,a=r(n(6)),i=r(n(8)),s=r(n(7)),u=r(n(275)),c=r(n(16)),l=r(n(1)),f=r(n(2)),d=r(n(881)),p=r(n(238)),h=((0,f.default)(y,[{key:"resolve",value:function(e){return e||this.defaultValue}},{key:"isValid",value:function(e){return!!this.entriesByKey[e]}}]),y);function y(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(var n in(0,l.default)(this,y),Array.isArray(e)&&(e=e.reduce(function(e,t){return e[t]={},e},{})),this.keys=[],this.entries=[],this.entriesByKey={},this.defaultValue=t.defaultValue||null,e){this[n]=t.valueFn?t.valueFn(n):n;var r=(0,c.default)({key:n},e[n]);this.entriesByKey[n]=r,this.entries.push(r),this.keys.push(n)}(0,u.default)(this.keys),(0,u.default)(this.entries),(0,u.default)(this.entriesByKey)}function v(){return(0,l.default)(this,v),(0,i.default)(this,(v.__proto__||(0,a.default)(v)).apply(this,arguments))}t.default=h,t.ServerValueEnum=(o=h,(0,s.default)(v,o),(0,f.default)(v,[{key:"mapEnumKeyToServerValue",value:function(){return this._mapEnumKeyToServerValue||(this._mapEnumKeyToServerValue=(0,p.default)(this.entries,function(e,t){return e[t.key]=t.serverValue},{}))}},{key:"mapServerValueToEnumKey",value:function(){return this._mapServerValueToEnumKey||(this._mapServerValueToEnumKey=(0,d.default)(this.mapEnumKeyToServerValue()))}},{key:"fromServer",value:function(e){return this.mapServerValueToEnumKey()[e]}},{key:"toServer",value:function(e){return this.mapEnumKeyToServerValue()[this.resolve(e)]}},{key:"resolve",value:function(e){return(this.isValid(e)?e:this.fromServer(e))||this.defaultValue}}]),v)},function(e,t,n){var r=n(71),o=n(40),a=n(313),i=n(62).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});o(t,e)||i(t,e,{value:a.f(e)})}},function(e,t,n){e.exports={default:n(550),__esModule:!0}},function(e,t,n){var y=n(31),v=n(17),g=n(55),m=n(59),b="prototype",_=function(e,t,n){var r,o,a,i=e&_.F,s=e&_.G,u=e&_.S,c=e&_.P,l=e&_.B,f=e&_.W,d=s?v:v[t]||(v[t]={}),p=d[b],h=s?y:u?y[t]:(y[t]||{})[b];for(r in s&&(n=t),n)(o=!i&&h&&void 0!==h[r])&&r in d||(a=o?h[r]:n[r],d[r]=s&&"function"!=typeof h[r]?n[r]:l&&o?g(a,y):f&&h[r]==a?function(r){function e(e,t,n){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(e);case 2:return new r(e,t)}return new r(e,t,n)}return r.apply(this,arguments)}return e[b]=r[b],e}(a):c&&"function"==typeof a?g(Function.call,a):a,c&&((d.virtual||(d.virtual={}))[r]=a,e&_.R&&p&&!p[r]&&m(p,r,a)))};_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128,e.exports=_},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r=n(190)("wks"),o=n(130),a=n(31).Symbol,i="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=i&&a[e]||(i?a:o)("Symbol."+e))}).store=r},function(e,t,n){var r=n(32),o=n(105),a=n(210),i=n(309),s=r.Symbol,u=o("wks");e.exports=function(e){return u[e]||(u[e]=i&&s[e]||(i?s:a)("Symbol."+e))}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return Array.isArray(e)?e:null!=e?[e]:[]}Object.defineProperty(t,"__esModule",{value:!0}),t.Validator=t.urlEncodedTaggedString=t.SortedArray=t.replaceKeys=t.replaceKey=t.phone=t.jsonCloneDeep=t.isConfigurableProperty=t.generateComparator=t.email=t.date=t.attachments=t.Camelizer=void 0,t.arrayWrapBound=function(){return a(this)},t.arrayWrap=a;var i=o(n(45)),s=r(n(272)),u=r(n(124)),c=r(n(67)),l=o(n(528)),f=o(n(273)),d=o(n(274)),p=r(n(46)),h=o(n(530)),y=o(n(531)),v=o(n(524)),g=o(n(533)),m=o(n(525));t.Camelizer=i.default,t.attachments=s,t.date=u,t.email=c,t.generateComparator=l.default,t.isConfigurableProperty=f.default,t.jsonCloneDeep=d.default,t.phone=p,t.replaceKey=h.default,t.replaceKeys=y.default,t.SortedArray=v.default,t.urlEncodedTaggedString=g.default,t.Validator=m.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=r(n(6)),u=r(n(11));t.default=function e(t,n,r){null===t&&(t=Function.prototype);var o=(0,u.default)(t,n);if(void 0===o){var a=(0,s.default)(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(r):void 0}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(r,e){(function(e){function t(e){return e&&e.Math==Math&&e}var n="object";r.exports=t(typeof globalThis==n&&globalThis)||t(typeof window==n&&window)||t(typeof self==n&&self)||t(typeof e==n&&e)||Function("return this")()}).call(e,function(){return this}())},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var l=n(32),f=n(205).f,d=n(61),p=n(138),h=n(208),y=n(302),v=n(649);e.exports=function(e,t){var n,r,o,a,i,s=e.target,u=e.global,c=e.stat;if(n=u?l:c?l[s]||h(s,{}):(l[s]||{}).prototype)for(r in t){if(a=t[r],o=e.noTargetGet?(i=f(n,r))&&i.value:n[r],!v(u?r:s+(c?".":"#")+r,e.forced)&&void 0!==o){if(typeof a==typeof o)continue;y(a,o)}(e.sham||o&&o.sham)&&d(a,"sham",!0),p(n,r,a,e)}}},function(e,t,n){var r=n(58),f=n(157),d=n(154),p=n(161),h=Object.prototype,y=h.hasOwnProperty,o=r(function(e,t){e=Object(e);var n=-1,r=t.length,o=2<r?t[2]:void 0;for(o&&d(t[0],t[1],o)&&(r=1);++n<r;)for(var a=t[n],i=p(a),s=-1,u=i.length;++s<u;){var c=i[s],l=e[c];(void 0===l||f(l,h[c])&&!y.call(e,c))&&(e[c]=a[c])}return e});e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.VisibilityType=t.TypingContext=t.SearchType=t.ProcessingActionTypes=t.PresenceStatus=t.PatientCareCardUIType=t.PatientCareCardType=t.PatientCareCardActionType=t.Networks=t.MessageType=t.MessageSubType=t.MessageSenderStatus=t.MessageRecipientStatus=t.MessagePriority=t.GroupType=t.EscalationStatus=t.EscalationChangeAction=t.ConversationAnchorPoints=t.AllowedSendersReason=void 0;var o=r(n(468)),a=r(n(469)),i=r(n(470)),s=r(n(260)),u=r(n(171)),c=r(n(471)),l=r(n(121)),f=r(n(472)),d=r(n(473)),p=r(n(474)),h=r(n(261)),y=r(n(475)),v=r(n(476)),g=r(n(477)),m=r(n(262)),b=r(n(172)),_=r(n(478)),w=r(n(263)),x=r(n(264));t.AllowedSendersReason=o.default,t.ConversationAnchorPoints=a.default,t.EscalationChangeAction=i.default,t.EscalationStatus=s.default,t.GroupType=u.default,t.MessagePriority=c.default,t.MessageRecipientStatus=l.default,t.MessageSenderStatus=f.default,t.MessageSubType=d.default,t.MessageType=p.default,t.Networks=h.default,t.PatientCareCardActionType=y.default,t.PatientCareCardType=v.default,t.PatientCareCardUIType=g.default,t.PresenceStatus=m.default,t.ProcessingActionTypes=b.default,t.SearchType=_.default,t.TypingContext=w.default,t.VisibilityType=x.default},function(e,t,n){var r=n(48),o=n(278),a=n(192),i=Object.defineProperty;t.f=n(39)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),o)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports={default:n(546),__esModule:!0}},function(e,t,n){e.exports=!n(68)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){"use strict";function n(){n.init.call(this)}function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function r(e,t,n,r){var o,a,i;if(u(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),i=a[t]),void 0===i)i=a[t]=n,++e._eventsCount;else if("function"==typeof i?i=a[t]=r?[n,i]:[i,n]:r?i.unshift(n):i.push(n),0<(o=c(e))&&i.length>o&&!i.warned){i.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=i.length,function(e){console&&console.warn&&console.warn(e)}(s)}return e}function o(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(r);return o.listener=n,r.wrapFn=o}function a(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):l(o,o.length)}function i(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function l(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}var s,f="object"==typeof Reflect?Reflect:null,d=f&&"function"==typeof f.apply?f.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};s=f&&"function"==typeof f.ownKeys?f.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var p=Number.isNaN||function(e){return e!=e};((e.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var h=10;Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(e){if("number"!=typeof e||e<0||p(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");h=e}}),n.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||p(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return c(this)},n.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(0<t.length&&(a=t[0]),a instanceof Error)throw a;var i=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw i.context=a,i}var s=o[e];if(void 0===s)return!1;if("function"==typeof s)d(s,this,t);else{var u=s.length,c=l(s,u);for(n=0;n<u;++n)d(c[n],this,t)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){return r(this,e,t,!1)},n.prototype.prependListener=function(e,t){return r(this,e,t,!0)},n.prototype.once=function(e,t){return u(t),this.on(e,o(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,o(this,e,t)),this},n.prototype.off=n.prototype.removeListener=function(e,t){var n,r,o,a,i;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,a=n.length-1;0<=a;a--)if(n[a]===t||n[a].listener===t){i=n[a].listener,o=a;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,i||t)}return this},n.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(o=a[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},n.prototype.listeners=function(e){return a(this,e,!0)},n.prototype.rawListeners=function(e){return a(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):i.call(e,t)},n.prototype.listenerCount=i,n.prototype.eventNames=function(){return 0<this._eventsCount?s(this._events):[]}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(390)("wks"),o=n(394),a=n(43).Symbol,i="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=i&&a[e]||(i?a:o)("Symbol."+e))}).store=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,r){return(0,s.default)(e)?e.map(function(e){return o(e,r)}):(0,i.default)(e)?(0,a.default)(e,function(e,t,n){e[r(n)]=o(t,r)},{}):e}Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(238)),i=r(n(52)),s=r(n(26)),u=r(n(893)),c=r(n(866)),l=r(n(376)),f={camelizeKey:(0,l.default)(c.default),underscoreKey:(0,l.default)(u.default),camelizeObject:function(e){return o(e,f.camelizeKey)},underscoreObject:function(e){return o(e,f.underscoreKey)}};t.default=f,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPhone=function(e){return e&&/^\+?([0-9]{7,15})$/.test(e.replace(/[-.â— ()]/g,""))},t.formatPhone=function(e){var t=e.replace(/\D/g,"");return/^\+?1/.test(e)?t.replace(/^(1)(\d{3})(\d{3})(\d{4})/,"+$1 $2 $3 $4"):("1"===t[0]&&(t=t.slice(1)),t.replace(/^(\d{3})(\d{3})(\d{4})/,"$1 $2 $3"))},t.formatPhoneWithDash=function(e){var t=e.replace(/\D/g,"");return"1"===t[0]&&(t=t.slice(1)),t.replace(/^(\d{3})(\d{3})(\d{4})/,"$1-$2-$3")},t.normalizePhone=function(e){return e.replace(/\D/g,"")},t.normalizePhoneUS=function(e){var t=e.replace(/\D/g,"");return"1"!==t[0]&&(t="1"+t),"+"+t}},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(535),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,a.default)(e)}},function(e,t,n){var r=n(33);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,z,V){(function(e){"use strict";function n(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=f.prototype:(null===e&&(e=new f(t)),e.length=t),e}function f(e,t,n){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(e,t,n);if("number"!=typeof e)return r(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return i(this,e)}function r(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),f.TYPED_ARRAY_SUPPORT?(e=t).__proto__=f.prototype:e=s(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!f.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|c(t,n),o=(e=a(e,r)).write(t,n);return o!==r&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(f.isBuffer(t)){var n=0|u(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):s(e,t);if("Buffer"===t.type&&C(t.data))return s(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function i(e,t){if(o(t),e=a(e,t<0?0:0|u(t)),!f.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function s(e,t){var n=t.length<0?0:0|u(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function u(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function c(e,t){if(f.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return O(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(e).length;default:if(r)return O(e).length;t=(""+t).toLowerCase(),r=!0}}function l(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function d(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=f.from(t,r)),f.isBuffer(t))return 0===t.length?-1:p(e,t,n,r,o);if("number"==typeof t)return t&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):p(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function p(e,t,n,r,o){function a(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var i,s=1,u=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;u/=s=2,c/=2,n/=2}if(o){var l=-1;for(i=n;i<u;i++)if(a(e,i)===a(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(u<n+c&&(n=u-c),i=n;0<=i;i--){for(var f=!0,d=0;d<c;d++)if(a(e,i+d)!==a(t,d)){f=!1;break}if(f)return i}return-1}function y(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?o<(r=Number(r))&&(r=o):r=o;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");a/2<r&&(r=a/2);for(var i=0;i<r;++i){var s=parseInt(t.substr(2*i,2),16);if(isNaN(s))return i;e[n+i]=s}return i}function v(e,t,n,r){return S(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function h(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var a,i,s,u,c=e[o],l=null,f=239<c?4:223<c?3:191<c?2:1;if(o+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(a=e[o+1]))&&(127<(u=(31&c)<<6|63&a)&&(l=u));break;case 3:a=e[o+1],i=e[o+2],128==(192&a)&&128==(192&i)&&(2047<(u=(15&c)<<12|(63&a)<<6|63&i)&&(u<55296||57343<u)&&(l=u));break;case 4:a=e[o+1],i=e[o+2],s=e[o+3],128==(192&a)&&128==(192&i)&&128==(192&s)&&(65535<(u=(15&c)<<18|(63&a)<<12|(63&i)<<6|63&s)&&u<1114112&&(l=u))}null===l?(l=65533,f=1):65535<l&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=f}return function(e){var t=e.length;if(t<=P)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=P));return n}(r)}function g(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function m(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function b(e,t,n){var r,o=e.length;(!t||t<0)&&(t=0),(!n||n<0||o<n)&&(n=o);for(var a="",i=t;i<n;++i)a+=(r=e[i])<16?"0"+r.toString(16):r.toString(16);return a}function _(e,t,n){for(var r=e.slice(t,n),o="",a=0;a<r.length;a+=2)o+=String.fromCharCode(r[a]+256*r[a+1]);return o}function w(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,o,a){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function E(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,a=Math.min(e.length-n,2);o<a;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function k(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,a=Math.min(e.length-n,4);o<a;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function T(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function A(e,t,n,r,o){return o||T(e,0,n,4),R.write(e,t,n,r,23,4),n+4}function I(e,t,n,r,o){return o||T(e,0,n,8),R.write(e,t,n,r,52,8),n+8}function O(e,t){t=t||1/0;for(var n,r=e.length,o=null,a=[],i=0;i<r;++i){if(55295<(n=e.charCodeAt(i))&&n<57344){if(!o){if(56319<n){-1<(t-=3)&&a.push(239,191,189);continue}if(i+1===r){-1<(t-=3)&&a.push(239,191,189);continue}o=n;continue}if(n<56320){-1<(t-=3)&&a.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(t-=3)&&a.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function j(e){return M.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(t,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function S(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}var M=V(614),R=V(696),C=V(314);z.Buffer=f,z.SlowBuffer=function(e){return+e!=e&&(e=0),f.alloc(+e)},z.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),z.kMaxLength=n(),f.poolSize=8192,f._augment=function(e){return e.__proto__=f.prototype,e},f.from=function(e,t,n){return r(null,e,t,n)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(e,t,n){return function(e,t,n,r){return o(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},f.allocUnsafe=function(e){return i(null,e)},f.allocUnsafeSlow=function(e){return i(null,e)},f.isBuffer=function(e){return!(null==e||!e._isBuffer)},f.compare=function(e,t){if(!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,a=Math.min(n,r);o<a;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(e,t){if(!C(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);var n;if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;var r=f.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!f.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},f.byteLength=c,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)l(this,t,t+1);return this},f.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)l(this,t,t+3),l(this,t+1,t+2);return this},f.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)l(this,t,t+7),l(this,t+1,t+6),l(this,t+2,t+5),l(this,t+3,t+4);return this},f.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?h(this,0,e):function(e,t,n){var r,o,a,i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return b(this,t,n);case"utf8":case"utf-8":return h(this,t,n);case"ascii":return g(this,t,n);case"latin1":case"binary":return m(this,t,n);case"base64":return r=this,a=n,0===(o=t)&&a===r.length?M.fromByteArray(r):M.fromByteArray(r.slice(o,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){var e="",t=z.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},f.prototype.compare=function(e,t,n,r,o){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(o<=r&&n<=t)return 0;if(o<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var a=(o>>>=0)-(r>>>=0),i=(n>>>=0)-(t>>>=0),s=Math.min(a,i),u=this.slice(r,o),c=e.slice(t,n),l=0;l<s;++l)if(u[l]!==c[l]){a=u[l],i=c[l];break}return a<i?-1:i<a?1:0},f.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},f.prototype.indexOf=function(e,t,n){return d(this,e,t,n,!0)},f.prototype.lastIndexOf=function(e,t,n){return d(this,e,t,n,!1)},f.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o,a,i,s,u,c,l,f,d,p=this.length-t;if((void 0===n||p<n)&&(n=p),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var h=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return f=t,d=n,S(O(e,(l=this).length-f),l,f,d);case"ascii":return v(this,e,t,n);case"latin1":case"binary":return v(this,e,t,n);case"base64":return s=this,u=t,c=n,S(j(e),s,u,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a=t,i=n,S(function(e,t){for(var n,r,o,a=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,o=n%256,a.push(o),a.push(r);return a}(e,(o=this).length-a),o,a,i);default:if(h)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),h=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;f.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),f.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=f.prototype;else{var o=t-e;n=new f(o,void 0);for(var a=0;a<o;++a)n[a]=this[a+e]}return n},f.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=this[e],o=1,a=0;++a<t&&(o*=256);)r+=this[e+a]*o;return r},f.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=this[e+--t],o=1;0<t&&(o*=256);)r+=this[e+--t]*o;return r},f.prototype.readUInt8=function(e,t){return t||w(e,1,this.length),this[e]},f.prototype.readUInt16LE=function(e,t){return t||w(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUInt16BE=function(e,t){return t||w(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUInt32LE=function(e,t){return t||w(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUInt32BE=function(e,t){return t||w(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=this[e],o=1,a=0;++a<t&&(o*=256);)r+=this[e+a]*o;return(o*=128)<=r&&(r-=Math.pow(2,8*t)),r},f.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||w(e,t,this.length);for(var r=t,o=1,a=this[e+--r];0<r&&(o*=256);)a+=this[e+--r]*o;return(o*=128)<=a&&(a-=Math.pow(2,8*t)),a},f.prototype.readInt8=function(e,t){return t||w(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){t||w(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt16BE=function(e,t){t||w(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt32LE=function(e,t){return t||w(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return t||w(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,t){return t||w(e,4,this.length),R.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return t||w(e,4,this.length),R.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return t||w(e,8,this.length),R.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return t||w(e,8,this.length),R.read(this,e,!1,52,8)},f.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||x(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},f.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||x(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,a=1;for(this[t+o]=255&e;0<=--o&&(a*=256);)this[t+o]=e/a&255;return t+n},f.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,255,0),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},f.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):E(this,e,t,!0),t+2},f.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):E(this,e,t,!1),t+2},f.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):k(this,e,t,!0),t+4},f.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},f.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);x(this,e,t,n,o-1,-o)}var a=0,i=1,s=0;for(this[t]=255&e;++a<n&&(i*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/i>>0)-s&255;return t+n},f.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);x(this,e,t,n,o-1,-o)}var a=n-1,i=1,s=0;for(this[t+a]=255&e;0<=--a&&(i*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/i>>0)-s&255;return t+n},f.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,127,-128),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},f.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):E(this,e,t,!0),t+2},f.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):E(this,e,t,!1),t+2},f.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):k(this,e,t,!0),t+4},f.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},f.prototype.writeFloatLE=function(e,t,n){return A(this,e,t,!0,n)},f.prototype.writeFloatBE=function(e,t,n){return A(this,e,t,!1,n)},f.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},f.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},f.prototype.copy=function(e,t,n,r){if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,a=r-n;if(this===e&&n<t&&t<r)for(o=a-1;0<=o;--o)e[o+t]=this[o+n];else if(a<1e3||!f.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},f.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!f.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(a=t;a<n;++a)this[a]=e;else{var i=f.isBuffer(e)?e:O(new f(e,r).toString()),s=i.length;for(a=0;a<n-t;++a)this[a+t]=i[a%s]}return this};var t=/[^+\/0-9A-Za-z-_]/g}).call(z,function(){return this}())},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var n=e.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(177),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e,t,n){return t in e?(0,a.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){var a=n(95);e.exports=function(r,o,e){if(a(r),void 0===o)return r;switch(e){case 1:return function(e){return r.call(o,e)};case 2:return function(e,t){return r.call(o,e,t)};case 3:return function(e,t,n){return r.call(o,e,t,n)}}return function(){return r.apply(o,arguments)}}},function(e,t,n){var r=n(50);e.exports=!r(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(815),o=n(816),a=n(112),i=n(26),s=n(890);e.exports=function(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?i(e)?o(e[0],e[1]):r(e):s(e)}},function(e,t,n){var r=n(112),o=n(365),a=n(367);e.exports=function(e,t){return a(o(e,t,r),e+"")}},function(e,t,n){var r=n(37),o=n(99);e.exports=n(39)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(182),o=n(179);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(56),o=n(62),a=n(102);e.exports=r?function(e,t,n){return o.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(56),o=n(307),a=n(70),i=n(140),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(a(e),t=i(t,!0),a(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(155)(Object.keys,Object);e.exports=r},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function a(){h&&d&&(h=!1,d.length?p=d.concat(p):y=-1,p.length&&i())}function i(){if(!h){var e=o(a);h=!0;for(var t=p.length;t;){for(d=p,p=[];++y<t;)d&&d[y].run();y=-1,t=p.length}d=null,h=!1,function(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var c,l,f=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var d,p=[],h=!1,y=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new s(e,t)),1!==p.length||h||o(i)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmail=void 0;var r,o=n(698),a=(r=o)&&r.__esModule?r:{default:r};t.isEmail=a.default},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(51);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){e.exports=n(32)},function(e,t,n){var c=n(146),l=n(148);e.exports=function(e,t,n,r){var o=!n;n=n||{};for(var a=-1,i=t.length;++a<i;){var s=t[a],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),o?l(n,s,u):c(n,s,u)}return n}},function(e,t,n){var o=n(150);e.exports=function(e,t,n){var r=null==e?void 0:o(e,t);return void 0===r?n:r}},function(e,t,n){var r=n(236),o=n(372);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){"use strict";function r(e){return this instanceof r?(c.call(this,e),l.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),void this.once("end",o)):new r(e)}function o(){this.allowHalfOpen||this._writableState.ended||s(a,this)}function a(e){e.end()}var i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=r;var s=n(241),u=n(106);u.inherits=n(63);var c=n(380),l=n(243);u.inherits(r,c);for(var f=i(l.prototype),d=0;d<f.length;d++){var p=f[d];r.prototype[p]||(r.prototype[p]=l.prototype[p])}},function(e,t,n){var r=n(119);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){var n={};for(var r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}},function(e,t){e.exports={}},function(e,t,n){var r=n(287),o=n(181);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var o=n(25),a=n(17),i=n(68);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],r={};r[e]=t(n),o(o.S+o.F*i(function(){n(1)}),"Object",r)}},function(e,t,n){var r=n(179);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(582)(!0);n(183)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){var r=n(200),o=n(83);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(209),o=Math.min;e.exports=function(e){return 0<e?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(83);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(783);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){var r=n(26),o=n(231),a=n(862),i=n(117);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:a(i(e))}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var y=n(43),v=n(53),g=n(166),m=n(91),b="prototype",_=function(e,t,n){var r,o,a,i=e&_.F,s=e&_.G,u=e&_.S,c=e&_.P,l=e&_.B,f=e&_.W,d=s?v:v[t]||(v[t]={}),p=d[b],h=s?y:u?y[t]:(y[t]||{})[b];for(r in s&&(n=t),n)(o=!i&&h&&void 0!==h[r])&&r in d||(a=o?h[r]:n[r],d[r]=s&&"function"!=typeof h[r]?n[r]:l&&o?g(a,y):f&&h[r]==a?function(r){function e(e,t,n){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(e);case 2:return new r(e,t)}return new r(e,t,n)}return r.apply(this,arguments)}return e[b]=r[b],e}(a):c&&"function"==typeof a?g(Function.call,a):a,c&&((d.virtual||(d.virtual={}))[r]=a,e&_.R&&p&&!p[r]&&m(p,r,a)))};_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128,e.exports=_},function(e,t,n){var r=n(169),o=n(389);e.exports=n(118)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){var r=I(t);if(!A[r]){var o;if(!n.placeholderEntityDelayBeforeRefreshing)return x(e,t,n).catch((o=console).error.bind(o));Object.defineProperty(t,"$$loadingScheduled",{value:!0,configurable:!0}),A[r]=setTimeout(function(){return E(e,t,n)},n.placeholderEntityDelayBeforeRefreshing)}}function h(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=h(t[0],n);return t.every(function(e){return h(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return h(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+h(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function y(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=y(t[0],n);return t.every(function(e){return y(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return y(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+y(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0});var o,a,i=r(n(4)),s=r(n(5)),u=r(n(3)),l=r(n(19)),v=r(n(10)),g=r(n(20)),m=r(n(13)),b=r(n(12)),_=r(n(24)),f=r(n(9)),d=r(n(54)),p=r(n(16)),w=r(n(163)),x=(a=(0,f.default)(v.default.mark(function e(t,n,r){var o,a,i,s,u,c,l,f,d,p;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.placeholderEntityAllowLoading){e.next=2;break}return e.abrupt("return");case 2:return Object.defineProperty(n,"$$loading",{value:!0,configurable:!0}),o=void 0,e.prev=4,e.next=7,r.finder(n.id);case 7:e.next=18;break;case 9:if(e.prev=9,e.t0=e.catch(4),e.t0.code!==k.NotFoundError.CODE&&e.t0.code!==k.PermissionDeniedError.CODE){e.next=15;break}o=!0,e.next=18;break;case 15:e.next=18;break;case 18:if(delete n.$$loading,!o){e.next=51;break}if(!(l=(0,_.default)(r.notFoundAttributes))||"function"!=typeof l[b.default]&&!Array.isArray(l))throw new TypeError("Expected _Object$entries to be iterable, got "+h(l));e.next=23;break;case 23:if(!l||"function"!=typeof l[b.default]&&!Array.isArray(l))throw new TypeError("Expected _Object$entries to be iterable, got "+y(l));e.next=25;break;case 25:for(i=!(a=!0),s=void 0,e.prev=28,u=(0,m.default)(l);!(a=(c=u.next()).done);a=!0)f=(0,g.default)(c.value,2),d=f[0],p=f[1],(0,T.default)(n,d)&&(n[d]=p);e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),i=!0,s=e.t1;case 36:e.prev=36,e.prev=37,!a&&u.return&&u.return();case 39:if(e.prev=39,i)throw s;e.next=42;break;case 42:return e.finish(39);case 43:return e.finish(36);case 44:Object.defineProperty(n,"$notFound",{value:!0,configurable:!0}),t.inject(n),r.onNotFound&&r.onNotFound(),r.onLoad&&r.onLoad(null),r.onFinish&&r.onFinish(null),e.next=57;break;case 51:delete n.$placeholder,delete n.$notFound,t.inject(n),r.onSuccess&&r.onSuccess(n),r.onLoad&&r.onLoad(n),r.onFinish&&r.onFinish(n);case 57:case"end":return e.stop()}},e,this,[[4,9],[28,32,36,44],[37,,39,43]])})),function(e,t,n){return a.apply(this,arguments)}),E=(o=(0,f.default)(v.default.mark(function e(t,n,r){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,delete n.$$loadingScheduled,delete A[I(n)],n.$placeholder){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",x(t,n,r));case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),function(e,t,n){return o.apply(this,arguments)});t.default=function(o,e){var n=e.finder,r=e.defaultPlaceholderAttrs,a=e.defaultNotFoundAttrs,i=e.placeholderEntityDelayBeforeRefreshing,s=e.placeholderEntityAllowLoading,u=e.shouldEnsure;if(null==e||void 0!==e.finder&&null!=e.finder&&"function"!=typeof e.finder||!(void 0===e.defaultPlaceholderAttrs||null==e.defaultPlaceholderAttrs||e.defaultPlaceholderAttrs instanceof Object)||!(void 0===e.defaultNotFoundAttrs||null==e.defaultNotFoundAttrs||e.defaultNotFoundAttrs instanceof Object)||void 0!==e.placeholderEntityDelayBeforeRefreshing&&null!=e.placeholderEntityDelayBeforeRefreshing&&"function"!=typeof e.placeholderEntityDelayBeforeRefreshing&&null!=e.placeholderEntityDelayBeforeRefreshing&&"number"!=typeof e.placeholderEntityDelayBeforeRefreshing||void 0!==e.placeholderEntityAllowLoading&&null!=e.placeholderEntityAllowLoading&&"function"!=typeof e.placeholderEntityAllowLoading&&null!=e.placeholderEntityAllowLoading&&"boolean"!=typeof e.placeholderEntityAllowLoading||void 0!==e.shouldEnsure&&null!=e.shouldEnsure&&"function"!=typeof e.shouldEnsure)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  finder?: ?Function;\n  defaultPlaceholderAttrs?: ?Object;\n  defaultNotFoundAttrs?: ?Object;\n  placeholderEntityDelayBeforeRefreshing?: ?Function | ?number;\n  placeholderEntityAllowLoading?: ?Function | ?boolean;\n  shouldEnsure?: ?Function;\n}\n\nGot:\n"+y(e));if(null==e||void 0!==e.finder&&null!=e.finder&&"function"!=typeof e.finder||!(void 0===e.defaultPlaceholderAttrs||null==e.defaultPlaceholderAttrs||e.defaultPlaceholderAttrs instanceof Object)||!(void 0===e.defaultNotFoundAttrs||null==e.defaultNotFoundAttrs||e.defaultNotFoundAttrs instanceof Object)||void 0!==e.placeholderEntityDelayBeforeRefreshing&&null!=e.placeholderEntityDelayBeforeRefreshing&&"function"!=typeof e.placeholderEntityDelayBeforeRefreshing&&null!=e.placeholderEntityDelayBeforeRefreshing&&"number"!=typeof e.placeholderEntityDelayBeforeRefreshing||void 0!==e.placeholderEntityAllowLoading&&null!=e.placeholderEntityAllowLoading&&"function"!=typeof e.placeholderEntityAllowLoading&&null!=e.placeholderEntityAllowLoading&&"boolean"!=typeof e.placeholderEntityAllowLoading||void 0!==e.shouldEnsure&&null!=e.shouldEnsure&&"function"!=typeof e.shouldEnsure)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  finder?: ?Function;\n  defaultPlaceholderAttrs?: ?Object;\n  defaultNotFoundAttrs?: ?Object;\n  placeholderEntityDelayBeforeRefreshing?: ?Function | ?number;\n  placeholderEntityAllowLoading?: ?Function | ?boolean;\n  shouldEnsure?: ?Function;\n}\n\nGot:\n"+h(e));o.ensureEntity=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"function"==typeof i&&(i=i()),"function"==typeof s&&(s=s()),function(e,t,n,r){var o=3<arguments.length&&void 0!==r?r:{},a=e.get(t);if(a)a.$placeholder?a.$$loading||a.$notFound||o.onlyPlaceholder||c(e,a,o):(o.onExists&&o.onExists(a),o.onFinish&&o.onFinish(a));else{if(n=(0,p.default)((0,d.default)({},e.idAttribute,t),n),o.onMissing&&o.onMissing(),a=e.createInstance(n),Object.defineProperty(a,"$placeholder",{value:!0,configurable:!0}),e.inject(a),o.onlyPlaceholder)return a;c(e,a,o)}}(o,e,(0,p.default)({},r,t.attrs),(0,p.default)({finder:n,notFoundAttributes:a,placeholderEntityDelayBeforeRefreshing:i,placeholderEntityAllowLoading:s},t))},o.waitForEnsuredEntity=function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new l.default(function(e,t){o.ensureEntity(n,(0,p.default)({},r,{onFinish:e}))})},o.shouldEnsure=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return"string"==typeof e&&(e=o.get(e)),!e||!(!u||!u(e,t,n))||!(!e.$placeholder||e.$$loading||t)}},t.dispose=function(){(0,w.default)(A).map(function(e){return clearTimeout(e)}),A={}};var k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),T=r(n(273)),A={},I=function(e){return e.$entityType+":"+e.id}},function(e,t,n){e.exports={default:n(558),__esModule:!0}},function(e,t,n){e.exports={default:n(562),__esModule:!0}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var d=n(55),p=n(281),h=n(279),y=n(48),v=n(129),g=n(194),m={},b={};(t=e.exports=function(e,t,n,r,o){var a,i,s,u,c=o?function(){return e}:g(e),l=d(n,r,t?2:1),f=0;if("function"!=typeof c)throw TypeError(e+" is not iterable!");if(h(c)){for(a=v(e.length);f<a;f++)if((u=t?l(y(i=e[f])[0],i[1]):l(e[f]))===m||u===b)return u}else for(s=c.call(e);!(i=s.next()).done;)if((u=p(s,l,i.value,t))===m||u===b)return u}).BREAK=m,t.RETURN=b},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(37).f,o=n(69),a=n(27)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){n(587);for(var r=n(31),o=n(59),a=n(78),i=n(27)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],l=r[c],f=l&&l.prototype;f&&!f[i]&&o(f,i,c),a[c]=a.Array}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(32),o=n(197),a=Function.call;e.exports=function(e,t,n){return o(a,r[e].prototype[t],n)}},function(e,t,n){var r=n(62).f,o=n(40),a=n(28)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(32),o=n(208),a=n(134),i="__core-js_shared__",s=r[i]||o(i,{});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.2.1",mode:a?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,n,t){(function(e){function t(e){return Object.prototype.toString.call(e)}n.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},n.isBoolean=function(e){return"boolean"==typeof e},n.isNull=function(e){return null===e},n.isNullOrUndefined=function(e){return null==e},n.isNumber=function(e){return"number"==typeof e},n.isString=function(e){return"string"==typeof e},n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=function(e){return void 0===e},n.isRegExp=function(e){return"[object RegExp]"===t(e)},n.isObject=function(e){return"object"==typeof e&&null!==e},n.isDate=function(e){return"[object Date]"===t(e)},n.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},n.isFunction=function(e){return"function"==typeof e},n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e.isBuffer}).call(n,t(49).Buffer)},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(725),o=n(726),a=n(333),i=n(42),s=n(780);e.exports=function(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?i(e)?o(e[0],e[1]):r(e):s(e)}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(331)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(345),o=n(65);e.exports=function(e,t){return e&&r(e,t,o)}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(74),o=n(159);e.exports=function(e){return o(e)&&r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(813),o=n(230),a=n(158),i=n(26),s=n(74),u=n(114),c=n(232),l=n(160),f=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||u(e)||l(e)||a(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(f.call(e,n))return!1;return!0}},function(e,t,n){var a=n(64),i=n(802),s=n(825),u=n(88),c=n(72),l=n(843),r=n(352),f=n(228),o=r(function(t,e){var n={};if(null==t)return n;var r=!1;e=a(e,function(e){return e=u(e,t),r=r||1<e.length,e}),c(t,f(t),n),r&&(n=i(n,7,l));for(var o=e.length;o--;)s(n,e[o]);return n});e.exports=o},function(e,t){e.exports=function(e){return e}},function(e,t,n){e.exports=!n(167)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGE_STATUS_ORDER=t.MessageRecipientStatus=void 0;var r,o,a=n(54),i=(o=a)&&o.__esModule?o:{default:o},s=new(n(22).ServerValueEnum)({NA:{key:"NA"},NEW:{serverValue:"New"},DELIVERED:{serverValue:"Delivered"},READ:{serverValue:"Read"},ACKNOWLEDGED:{serverValue:"Confirmed"}},{defaultValue:"NA"}),u=(r={},(0,i.default)(r,s.NA,0),(0,i.default)(r,s.NEW,1),(0,i.default)(r,s.DELIVERED,2),(0,i.default)(r,s.READ,3),(0,i.default)(r,s.ACKNOWLEDGED,4),r);t.MessageRecipientStatus=s,t.MESSAGE_STATUS_ORDER=u,t.default=s},function(e,t){"use strict";function n(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||57344<=r?t.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&e.charCodeAt(n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t}function r(e){for(var t=new Uint8Array(e),n="",r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.getUtf8Bytes=n,t.doubleEncodeUtf8=function(e){return r(n(e))},t.arrayBufferToBinaryString=r,t.base64ToArrayBuffer=function(e){for(var t=window.atob(e),n=t.length,r=new Uint8Array(n),o=0;o<n;o++){var a=t.charCodeAt(o);r[o]=a}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["ONLINE","OFFLINE","CONNECTING","UNREACHABLE"]);t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(20),l=(r=o)&&r.__esModule?r:{default:r};t.formatDob=function(e){if(!e)return e;var t=e.split("T"),n=(0,l.default)(t,1)[0];if(n.includes("-")){var r=n.split("-"),o=(0,l.default)(r,3),a=o[0];return[o[1],o[2],a].join("/")}if(n.includes("/")){var i=n.split("/"),s=(0,l.default)(i,3);return[s[0],s[1],s[2]].join("/")}return e},t.secondsToDurationFormat=function(e){if(!e||!parseInt(e))return"";var t=parseInt(e),n=Math.floor(t/f),r=t%f,o=new Date(0);o.setSeconds(r);var a=o.toISOString().substr(11,8).split(":").map(function(e){return parseInt(e)}),i=(0,l.default)(a,3),s=i[0],u=i[1],c=i[2]+" sec";return(u||s||n)&&(c=u+" min "+c),(s||n)&&(c=s+24*n+" hr "+c),c};var f=86400},function(e,t,n){var o=n(96),a=n(27)("toStringTag"),i="Arguments"==o(function(){return arguments}());e.exports=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:i?o(t):"Object"==(r=o(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t){e.exports=!0},function(e,t,n){function r(e){s(e,o,{value:{i:"O"+ ++u,w:{}}})}var o=n(130)("meta"),a=n(33),i=n(69),s=n(37).f,u=0,c=Object.isExtensible||function(){return!0},l=!n(68)(function(){return c(Object.preventExtensions({}))}),f=e.exports={KEY:o,NEED:!1,fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,o)){if(!c(e))return"F";if(!t)return"E";r(e)}return e[o].i},getWeak:function(e,t){if(!i(e,o)){if(!c(e))return!0;if(!t)return!1;r(e)}return e[o].w},onFreeze:function(e){return l&&f.NEED&&c(e)&&!i(e,o)&&r(e),e}}},function(e,t,r){function o(){}var a=r(48),i=r(284),s=r(181),u=r(189)("IE_PROTO"),c="prototype",l=function(){var e,t=r(180)("iframe"),n=s.length;for(t.style.display="none",r(277).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l[c][s[n]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(o[c]=a(e),n=new o,o[c]=null,n[u]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(191),o=Math.min;e.exports=function(e){return 0<e?o(r(e),9007199254740991):0}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){t.f=n(27)},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports={}},function(e,t){e.exports=!1},function(e,t){e.exports={}},function(e,t,n){var r=n(311),o=n(199);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},function(e,t,n){var s=n(32),r=n(105),u=n(61),c=n(40),l=n(208),o=n(305),a=n(201),i=a.get,f=a.enforce,d=String(o).split("toString");r("inspectSource",function(e){return o.call(e)}),(e.exports=function(e,t,n,r){var o=!!r&&!!r.unsafe,a=!!r&&!!r.enumerable,i=!!r&&!!r.noTargetGet;return"function"==typeof n&&("string"!=typeof t||c(n,"name")||u(n,"name",t),f(n).source=d.join("string"==typeof t?t:"")),e===s?void(a?e[t]=n:l(t,n)):(o?!i&&e[t]&&(a=!0):delete e[t],void(a?e[t]=n:u(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&i(this).source||o.call(this)})},function(e,t,n){var r=n(105),o=n(210),a=r("keys");e.exports=function(e){return a[e]||(a[e]=o(e))}},function(e,t,n){var o=n(51);e.exports=function(e,t){if(!o(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!o(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(332);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(719),o=n(739)(r);e.exports=o},function(e,t,n){var r=n(42),o=n(216),a=n(761),i=n(782);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:a(i(e))}},function(e,t,n){var r=n(26);e.exports=function(){if(!arguments.length)return[];var e=arguments[0];return r(e)?e:[e]}},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(359),a=n(360),i=n(361),s=n(362),u=n(363);r.prototype.clear=o,r.prototype.delete=a,r.prototype.get=i,r.prototype.has=s,r.prototype.set=u,e.exports=r},function(e,t,n){var o=n(148),a=n(157),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var r=e[t];i.call(e,t)&&a(r,n)&&(void 0!==n||t in e)||o(e,t,n)}},function(e,t,n){var r=n(157);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(845);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var c=n(795),l=n(857);e.exports=function e(t,n,r,o,a){var i=-1,s=t.length;for(r=r||l,a=a||[];++i<s;){var u=t[i];0<n&&r(u)?1<n?e(u,n-1,r,o,a):c(a,u):o||(a[a.length]=u)}return a}},function(e,t,n){var o=n(88),a=n(89);e.exports=function(e,t){for(var n=0,r=(t=o(t,e)).length;null!=e&&n<r;)e=e[a(t[n++])];return n&&n==r?e:void 0}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},function(e,t){e.exports=function(t){return function(e){return t(e)}}},function(e,t,n){var r=n(151);e.exports=function(e,t){return!!(null==e?0:e.length)&&-1<r(e,t,0)}},function(e,t){e.exports=function(){return!1}},function(e,t){e.exports=function(t,n){return function(e){return t(n(e))}}},function(e,t,n){var r=n(344),o=n(149),a=n(58),i=n(113),s=a(function(e,t){return i(e)?r(e,o(t,1,i,!0)):[]});e.exports=s},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){e.exports=function(){return!1}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){e.exports=function(){return!1}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){var r=n(818),o=n(352)(function(e,t){return null==e?{}:r(e,t)});e.exports=o},function(e,t,n){var r=n(826),o=n(65);e.exports=function(e){return null==e?[]:r(e,o(e))}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var a=n(164);e.exports=function(r,o,e){if(a(r),void 0===o)return r;switch(e){case 1:return function(e){return r.call(o,e)};case 2:return function(e,t){return r.call(o,e,t)};case 3:return function(e,t,n){return r.call(o,e,t,n)}}return function(){return r.apply(o,arguments)}}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(76),o=n(926),a=n(947),i=Object.defineProperty;t.f=n(118)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),o)try{return i(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function b(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=b(t[0],n);return t.every(function(e){return b(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return b(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+b(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function _(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=_(t[0],n);return t.every(function(e){return _(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return _(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+_(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.PROFILE_ATTRIBUTES_PER_ORG=void 0;var i=r(n(4)),s=r(n(5)),u=r(n(3)),l=r(n(93)),w=r(n(38)),x=r(n(20)),E=r(n(13)),k=r(n(12)),T=r(n(24)),f=r(n(16)),A=r(n(377)),d=r(n(162));t.default=function(e,t){var c=t.host,n=e.defineModel("user",{replaceKeys:{avatar:"avatarUrl",blockedPersonal:"contactsMessagingBlockedByOrganizationIds",organizationKey:"organizationId",organizationToken:"organizationId",timeToLive:"messagesTTL"},defaultValues:{botRole:null,contactsMessagingBlockedByOrganizationIds:[],isPatient:!1,isPatientContact:!1,organizationIds:[],presence:o.default.UNKNOWN,profileByOrganizationId:{},removedFromOrg:!1,roles:[]},skipCamelizationForKeys:["metadata"],parseAttrs:function(e){var t=e.organizationId;if(e.dndAutoForwardReceivers?e.autoForwardReceiverIds=e.dndAutoForwardReceivers.map(function(e){return e.token}):""===e.dndAutoForwardReceiver||"undefined"===e.dndAutoForwardReceiver?e.autoForwardReceiverIds=[]:void 0!==e.dndAutoForwardReceiver&&(e.autoForwardReceiverIds=[e.dndAutoForwardReceiver]),delete e.dndAutoForwardReceiver,delete e.dndAutoForwardReceivers,t){delete e.organizationId,e.organizationIds||(e.organizationIds=[]),e.organizationIds.includes(t)||e.organizationIds.push(t);var n=(0,f.default)({},(0,d.default)(e,y),{userId:e.id,organizationId:t});delete e.autoForwardReceiverIds,delete e.conversationId,e.profileByOrganizationId||(e.profileByOrganizationId={}),e.profileByOrganizationId[t]=n}if("patientId"in e&&!e.patientId.startsWith("patient:")){var r="patient:"+e.patientId,o=e.patientId;e.isPatient=!e.isPatientContact,e.patientId=r,e.patientBroadcastListDetails={addedByDisplayName:e.addedByDisplayName,addedOn:e.addedOn};var a={id:r,dob:e.patientDob,gender:e.patientGender,mrn:e.patientMrn};if(e.isPatient)a.userId=e.id;else if(e.isPatientContact){var i="patientContact:"+e.id;e.patientContactId=i,c.models.User.injectPlaceholder({id:o,displayName:e.patientDisplayName,patientId:r}),c.models.PatientContact.injectPlaceholder({id:i,relation:e.relationName,userId:e.id,patientId:r}),a.userId=o}c.models.Patient.injectPlaceholder(a),delete e.addedByDisplayName,delete e.addedOn,delete e.patientDisplayName,delete e.patientDob,delete e.patientGender,delete e.patientMrn,delete e.relationName}if("metadata"in e){if("feature_service"in e.metadata&&"patient_messaging"===e.metadata.feature_service){var s=e.metadata,u=s.is_patient_contact;"string"==typeof u&&"true"===u||"boolean"==typeof u&&u?(e.patientContactId="patientContact:"+e.id,e.isPatientContact=!0,c.users._injectPatientContactEntity(e,t)):(e.patientId="patient:"+e.id,e.isPatient=!0,c.users._injectPatientEntity(s,e.id,t))}"feature_service"in e.metadata&&"role"===e.metadata.feature_service&&t&&c.roles.__injectRoleFromMetadata({metadata:(0,f.default)({},e.metadata,{display_name:e.display_name,token:e.id}),organizationId:t}),delete e.metadata}return e.avatarUrl&&(e.avatarUrl=(0,h.cloudFrontUrlTransform)(e.avatarUrl,c.config)),!e.displayName&&e.name&&(e.displayName=e.name),e.displayName&&(0,p.isPhone)(e.displayName)&&(e.displayName=(0,p.formatPhone)(e.displayName)),e},beforeInject:function(e,t){if(t&&(e.organizationIds&&(e.organizationIds=(0,A.default)(t.organizationIds,e.organizationIds)),e.profileByOrganizationId)){var n={};if(t.profileByOrganizationId){if(!(u=(0,T.default)(t.profileByOrganizationId))||"function"!=typeof u[k.default]&&!Array.isArray(u))throw new TypeError("Expected _Object$entries to be iterable, got "+b(u));if(!u||"function"!=typeof u[k.default]&&!Array.isArray(u))throw new TypeError("Expected _Object$entries to be iterable, got "+_(u));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,E.default)(u);!(r=(i=s.next()).done);r=!0){var u,c=(0,x.default)(i.value,2),l=c[0],f=c[1];n[l]={},(0,w.default)(n[l],f)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}}if(!(g=(0,T.default)(e.profileByOrganizationId))||"function"!=typeof g[k.default]&&!Array.isArray(g))throw new TypeError("Expected _Object$entries2 to be iterable, got "+b(g));if(!g||"function"!=typeof g[k.default]&&!Array.isArray(g))throw new TypeError("Expected _Object$entries2 to be iterable, got "+_(g));var d=!0,p=!1,h=void 0;try{for(var y,v=(0,E.default)(g);!(d=(y=v.next()).done);d=!0){var g,m=(0,x.default)(y.value,2);l=m[0],f=m[1];n[l]||(n[l]={}),(0,w.default)(n[l],f)}}catch(e){p=!0,h=e}finally{try{!d&&v.return&&v.return()}finally{if(p)throw h}}e.profileByOrganizationId=n}},afterAssignment:function(e){var t=e.profileByOrganizationId;if(e.contactsMessagingBlocked=0<e.contactsMessagingBlockedByOrganizationIds.length,e.isRoleBot=e.metadata.some(function(e){return"role"===e.data.feature_service}),e.shouldDisplay=!e.metadata.some(function(e){return"true"===e.data.invisible}),!(s=(0,l.default)(t))||"function"!=typeof s[k.default]&&!Array.isArray(s))throw new TypeError("Expected _Object$values to be iterable, got "+b(s));if(!s||"function"!=typeof s[k.default]&&!Array.isArray(s))throw new TypeError("Expected _Object$values to be iterable, got "+_(s));var n=!0,r=!1,o=void 0;try{for(var a,i=(0,E.default)(s);!(n=(a=i.next()).done);n=!0){var s,u=a.value;e.dnd||(u.autoForwardReceiverIds=[]),c.users._setMembersOnEntity(u,"autoForwardReceiverIds","autoForwardReceivers")}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}e.removedFromOrg&&(!e.displayName||e.$$loading||e.$$loadingScheduled||e.$notFound)&&(e.displayName="Removed User")},relations:{belongsTo:{patient:{type:"patient",foreignKey:"patientId"},patientContact:{type:"patientContact",foreignKey:"patientContactId"}},hasMany:{metadata:{type:"metadata",foreignKey:"entityId"}}}});return(0,a.default)(n,{finder:function(){var e;return(e=c.users).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return c.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return c.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading..."},defaultNotFoundAttrs:{displayName:"<User Not Found>"}}),n};var p=n(46),o=r(n(262)),h=n(265),a=r(n(92)),y=t.PROFILE_ATTRIBUTES_PER_ORG=["autoForwardReceiverIds","conversationId","department","title"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["ACTIVATED_TEAM","ESCALATION","FORUM","GROUP","INTRA_TEAM","PATIENT_CARE","PATIENT_MESSAGING","ROLE_ASSIGNMENT","ROLE_P2P"]);t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({CONVERSATION_MESSAGE_STATUS:{serverValue:"conversation_message_status"},GROUP_REPLAY:{serverValue:"group_replay"},MESSAGE_REPLAY:{serverValue:"message_replay"},OFFLINE:{serverValue:"offline"},ORGANIZATION_MESSAGE_STATUS:{serverValue:"organization_message_status"},ORGANIZATION_REPLAY:{serverValue:"organization_replay"},ROLE_OPT_IN:{serverValue:"optin"},ROLE_OPT_OUT:{serverValue:"optout"}});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=n(1),a=(r=o)&&r.__esModule?r:{default:r};t.default=function e(t){(0,a.default)(this,e),this.type=t,this.target=void 0},e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=e.provideDefault,n=void 0!==t&&t;return function(e){var t=e.mime,n=(0,s.getMimeEntryByContentType)(t);if(n){var r=n[0];return{ext:r="."+r,mime:t}}}((0,i.default)(e,["provideDefault"]))||(n?{ext:c,mime:u}:void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_MIME_EXTENSION=t.DEFAULT_MIME_CONTENT_TYPE=void 0;var o,a=n(77),i=(o=a)&&o.__esModule?o:{default:o};t.getMimeType=r;var s=n(272),u=t.DEFAULT_MIME_CONTENT_TYPE="application/octet-stream",c=t.DEFAULT_MIME_EXTENSION=".bin";t.default=r},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function f(r){return new o.default(function(e,t){var n=new FileReader;n.addEventListener("load",function(){e(n.result)},!1),n.addEventListener("error",function(e){t(e)},!1),n.readAsDataURL(r)})}function d(e,t,n){var r=new FileReader,o=new Blob([t],{type:n});r.fileName=e,r.onload=function(e){window.open(r.result,"_blank")},r.readAsDataURL(o)}Object.defineProperty(t,"__esModule",{value:!0}),t.downloadFile=void 0;var r,o=n(l(19)),p=n(l(10)),a=n(l(9));t.downloadFile=(r=(0,a.default)(p.default.mark(function e(t){var n,r,o,a,i,s=t.attachmentContentType,u=t.blob,c=t.fileName;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((n=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&navigator.userAgent.match("chrome"))return e.next=5,f(u);e.next=10;break;case 5:r=e.sent,o=(0,h.base64ToArrayBuffer)(r),d(c,o,s),e.next=11;break;case 10:n?(a=window.URL.createObjectURL(u),window.open(a,"_blank")):(i=l(695),(0,i.saveAs)(u,c));case 11:e.next=14;break;case 13:y.TargetNotSupportedError.raise();case 14:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)}),t.loadLocalFilePathWithFileReader=f,t.saveByteArray=d;var h=l(122),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l(18))},function(e,t,n){e.exports={default:n(547),__esModule:!0}},function(e,t,n){e.exports={default:n(549),__esModule:!0}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(33),o=n(31).document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(96);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";function b(){return this}var _=n(126),w=n(25),x=n(291),E=n(59),k=n(69),T=n(78),A=n(576),I=n(100),O=n(187),j=n(27)("iterator"),S=!([].keys&&"next"in[].keys()),M="values";e.exports=function(e,t,n,r,o,a,i){A(n,t,r);function s(e){if(!S&&e in h)return h[e];switch(e){case"keys":case M:return function(){return new n(this,e)}}return function(){return new n(this,e)}}var u,c,l,f=t+" Iterator",d=o==M,p=!1,h=e.prototype,y=h[j]||h["@@iterator"]||o&&h[o],v=y||s(o),g=o?d?s("entries"):v:void 0,m="Array"==t&&h.entries||y;if(m&&((l=O(m.call(new e)))!==Object.prototype&&l.next&&(I(l,f,!0),_||k(l,j)||E(l,j,b))),d&&y&&y.name!==M&&(p=!0,v=function(){return y.call(this)}),_&&!i||!S&&!p&&h[j]||E(h,j,v),T[t]=v,T[f]=b,o)if(u={values:d?v:s(M),keys:a?v:s("keys"),entries:g},i)for(c in u)c in h||x(h,c,u[c]);else w(w.P+w.F*(S||p),t,u);return u}},function(e,t,n){"use strict";function r(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=o(n),this.reject=o(r)}var o=n(95);e.exports.f=function(e){return new r(e)}},function(e,t,n){var r=n(98),o=n(99),a=n(60),i=n(192),s=n(69),u=n(278),c=Object.getOwnPropertyDescriptor;t.f=n(39)?c:function(e,t){if(e=a(e),t=i(t,!0),u)try{return c(e,t)}catch(e){}if(s(e,t))return o(!r.f.call(e,t),e[t])}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(69),o=n(81),a=n(189)("IE_PROTO"),i=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?i:null}},function(e,t,n){var o=n(59);e.exports=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:o(e,r,t[r]);return e}},function(e,t,n){var r=n(190)("keys"),o=n(130);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(31),o="__core-js_shared__",a=r[o]||(r[o]={});e.exports=function(e){return a[e]||(a[e]={})}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){var o=n(33);e.exports=function(e,t){if(!o(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!o(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(31),o=n(17),a=n(126),i=n(131),s=n(37).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:i.f(e)})}},function(e,t,n){var r=n(125),o=n(27)("iterator"),a=n(78);e.exports=n(17).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||a[r(e)]}},function(e,t){},function(e,n,r){(function(i){"use strict";var e=r(49),c=e.Buffer,t=e.SlowBuffer,l=e.kMaxLength||2147483647;n.alloc=function(e,t,n){if("function"==typeof c.alloc)return c.alloc(e,t,n);if("number"==typeof n)throw new TypeError("encoding must not be number");if("number"!=typeof e)throw new TypeError("size must be a number");if(l<e)throw new RangeError("size is too large");var r=n,o=t;void 0===o&&(r=void 0,o=0);var a=new c(e);if("string"==typeof o)for(var i=new c(o,r),s=i.length,u=-1;++u<e;)a[u]=i[u%s];else a.fill(o);return a},n.allocUnsafe=function(e){if("function"==typeof c.allocUnsafe)return c.allocUnsafe(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(l<e)throw new RangeError("size is too large");return new c(e)},n.from=function(e,t,n){if("function"==typeof c.from&&(!i.Uint8Array||Uint8Array.from!==c.from))return c.from(e,t,n);if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("string"==typeof e)return new c(e,t);if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){var r=t;if(1===arguments.length)return new c(e);void 0===r&&(r=0);var o=n;if(void 0===o&&(o=e.byteLength-r),r>=e.byteLength)throw new RangeError("'offset' is out of bounds");if(o>e.byteLength-r)throw new RangeError("'length' is out of bounds");return new c(e.slice(r,r+o))}if(c.isBuffer(e)){var a=new c(e.length);return e.copy(a,0,0,e.length),a}if(e){if(Array.isArray(e)||"undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return new c(e);if("Buffer"===e.type&&Array.isArray(e.data))return new c(e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},n.allocUnsafeSlow=function(e){if("function"==typeof c.allocUnsafeSlow)return c.allocUnsafeSlow(e);if("number"!=typeof e)throw new TypeError("size must be a number");if(l<=e)throw new RangeError("size is too large");return new t(e)}}).call(n,function(){return this}())},function(e,t,n){var a=n(637);e.exports=function(r,o,e){if(a(r),void 0===o)return r;switch(e){case 0:return function(){return r.call(o)};case 1:return function(e){return r.call(o,e)};case 2:return function(e,t){return r.call(o,e,t)};case 3:return function(e,t,n){return r.call(o,e,t,n)}}return function(){return r.apply(o,arguments)}}},function(e,t,n){var r=n(28)("match");e.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[r]=!1,"/./"[t](n)}catch(t){}}return!1}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,n){var r=n(50),o=n(132),a="".split;e.exports=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==o(e)?a.call(e,""):Object(e)}:Object},function(e,t,n){var r,o,a,i=n(651),s=n(32),u=n(51),c=n(61),l=n(40),f=n(139),d=n(133),p=s.WeakMap;if(i){var h=new p,y=h.get,v=h.has,g=h.set;r=function(e,t){return g.call(h,e,t),t},o=function(e){return y.call(h,e)||{}},a=function(e){return v.call(h,e)}}else{var m=f("state");d[m]=!0,r=function(e,t){return c(e,m,t),t},o=function(e){return l(e,m)?e[m]:{}},a=function(e){return l(e,m)}}e.exports={set:r,get:o,has:a,enforce:function(e){return a(e)?o(e):r(e,{})},getterFor:function(n){return function(e){var t;if(!u(e)||(t=o(e)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return t}}}},function(e,t,n){var r=n(132);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(650);e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,n){function r(){}var o=n(70),a=n(653),i=n(199),s=n(133),u=n(647),c=n(304),l=n(139)("IE_PROTO"),f="prototype",d=function(){var e,t=c("iframe"),n=i.length,r="script";for(t.style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object</"+r+">"),e.close(),d=e.F;n--;)delete d[f][i[n]];return d()};e.exports=Object.create||function(e,t){var n;return null!==e?(r[f]=o(e),n=new r,r[f]=null,n[l]=e):n=d(),void 0===t?n:a(n,t)},s[l]=!0},function(e,t,n){var r=n(56),o=n(137),a=n(102),i=n(84),s=n(140),u=n(40),c=n(307),l=Object.getOwnPropertyDescriptor;t.f=r?l:function(e,t){if(e=i(e),t=s(t,!0),c)try{return l(e,t)}catch(e){}if(u(e,t))return a(!o.f.call(e,t),e[t])}},function(e,t,n){var r=n(311),o=n(199).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(32),o=n(61);e.exports=function(t,n){try{o(r,t,n)}catch(e){r[t]=n}return n}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t,n){"use strict";var r=n(764);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){"use strict";var r=n(775);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){var r=n(42);e.exports=function(){if(!arguments.length)return[];var e=arguments[0];return r(e)?e:[e]}},function(e,t,n){var o=n(143),a=n(109);e.exports=function(e,t){for(var n=0,r=(t=o(t,e)).length;null!=e&&n<r;)e=e[a(t[n++])];return n&&n==r?e:void 0}},function(e,t,n){var r=n(320);e.exports=function(e,t){return!!(null==e?0:e.length)&&-1<r(e,t,0)}},function(e,t,n){var r=n(42),o=n(772),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||i.test(e)||!a.test(e)||null!=t&&e in Object(t)}},function(e,t,n){var r=n(771),o=n(335);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){var r=n(151);e.exports=function(e,t){return!!(null==e?0:e.length)&&-1<r(e,t,0)}},function(e,t){e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},function(e,t,n){var r=n(111),o=n(836)(r);e.exports=o},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var i=n(811),s=n(159);e.exports=function e(t,n,r,o,a){return t===n||(null==t||null==n||!s(t)&&!s(n)?t!=t&&n!=n:i(t,n,r,o,e,a))}},function(e,t){e.exports=function(e,t,n){var r=-1,o=e.length;t<0&&(t=o<-t?0:o+t),(n=o<n?o:n)<0&&(n+=o),o=n<t?0:n-t>>>0,t>>>=0;for(var a=Array(o);++r<o;)a[r]=e[r+t];return a}},function(e,t,n){var p=n(144),h=n(220),y=n(221),v=n(153),g=n(841),m=n(860);e.exports=function(e,t,n){var r=-1,o=h,a=e.length,i=!0,s=[],u=s;if(n)i=!1,o=y;else if(200<=a){var c=t?null:g(e);if(c)return m(c);i=!1,o=v,u=new p}else u=t?[]:s;e:for(;++r<a;){var l=e[r],f=t?t(l):l;if(l=n||0!==l?l:0,i&&f==f){for(var d=u.length;d--;)if(u[d]===f)continue e;t&&u.push(f),s.push(l)}else o(u,f,n)||(u!==s&&u.push(f),s.push(l))}return s}},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t=t||Array(r);++n<r;)t[n]=e[n];return t}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){var r=n(155)(Object.getPrototypeOf,Object);e.exports=r},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r=n(26),o=n(374),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||i.test(e)||!a.test(e)||null!=t&&e in Object(t)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(849),o="object"==typeof self&&self&&self.Object===Object&&self,a=r||o||Function("return this")();e.exports=a},function(e,t,n){var s=n(225),u=n(154),c=n(237),l=Math.ceil,f=Math.max;e.exports=function(e,t,n){t=(n?u(e,t,n):void 0===t)?1:f(c(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var o=0,a=0,i=Array(l(r/t));o<r;)i[a++]=s(e,o,o+=t);return i}},function(e,t,n){var r=n(341),o=n(58),a=n(842),i=n(887),s=o(function(e){return e.push(void 0,a),r(i,void 0,e)});e.exports=s},function(e,t,n){var r=n(223),o=n(52);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var i=n(219),s=n(343),u=n(111),c=n(57),l=n(229),f=n(26),d=n(114),p=n(236),h=n(52),y=n(160);e.exports=function(e,r,o){var t=f(e),n=t||d(e)||y(e);if(r=c(r,4),null==o){var a=e&&e.constructor;o=n?t?new a:[]:h(e)&&p(a)?s(l(e)):{}}return(n?i:u)(e,function(e,t,n){return r(o,e,t,n)}),o}},function(e,t,n){var r=n(226);e.exports=function(e){return e&&e.length?r(e):[]}},function(e,t,n){(function(Jn){Jn.exports=function(){"use strict";function d(){return rt.apply(null,arguments)}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e){return void 0===e}function u(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function o(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function r(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){for(var n in t)p(t,n)&&(e[n]=t[n]);return p(t,"toString")&&(e.toString=t.toString),p(t,"valueOf")&&(e.valueOf=t.valueOf),e}function l(e,t,n,r){return be(e,t,n,r,!0).utc()}function h(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function f(e){if(null==e._isValid){var t=h(e),n=ot.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function y(e){var t=l(NaN);return null!=e?c(h(t),e):h(t).userInvalidated=!0,t}function v(e,t){var n,r,o;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=h(t)),a(t._locale)||(e._locale=t._locale),0<it.length)for(n=0;n<it.length;n++)r=it[n],a(o=t[r])||(e[r]=o);return e}function g(e){v(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===st&&(st=!0,d.updateOffset(this),st=!1)}function m(e){return e instanceof g||null!=e&&null!=e._isAMomentObject}function b(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function _(e){var t=+e,n=0;return 0!=t&&isFinite(t)&&(n=b(t)),n}function w(e,t,n){var r,o=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),i=0;for(r=0;r<o;r++)(n&&e[r]!==t[r]||!n&&_(e[r])!==_(t[r]))&&i++;return i+a}function x(e){!1===d.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function e(o,a){var i=!0;return c(function(){if(null!=d.deprecationHandler&&d.deprecationHandler(null,o),i){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==typeof arguments[n]){for(var r in e+="\n["+n+"] ",arguments[0])e+=r+": "+arguments[0][r]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}x(o+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),i=!1}return a.apply(this,arguments)},a)}function E(e,t){null!=d.deprecationHandler&&d.deprecationHandler(e,t),ut[e]||(x(t),ut[e]=!0)}function k(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function T(e,t){var n,r=c({},e);for(n in t)p(t,n)&&(s(e[n])&&s(t[n])?(r[n]={},c(r[n],e[n]),c(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)p(e,n)&&!p(t,n)&&s(e[n])&&(r[n]=c({},r[n]));return r}function A(e){null!=e&&this.set(e)}function t(e,t){var n=e.toLowerCase();ct[n]=ct[n+"s"]=ct[t]=e}function I(e){return"string"==typeof e?ct[e]||ct[e.toLowerCase()]:void 0}function O(e){var t,n,r={};for(n in e)p(e,n)&&((t=I(n))&&(r[t]=e[n]));return r}function n(e,t){lt[e]=t}function j(e){var t=[];for(var n in e)t.push({unit:n,priority:lt[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function S(e,t,n){var r=""+Math.abs(e),o=t-r.length,a=0<=e;return(a?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}function M(e,t,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),e&&(ht[e]=o),t&&(ht[t[0]]=function(){return S(o.apply(this,arguments),t[1],t[2])}),n&&(ht[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function R(e,t){return e.isValid()?(t=C(t,e.localeData()),pt[t]=pt[t]||function(r){var e,o,a=r.match(ft);for(e=0,o=a.length;e<o;e++)ht[a[e]]?a[e]=ht[a[e]]:a[e]=(t=a[e],t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,""));var t;return function(e){var t,n="";for(t=0;t<o;t++)n+=k(a[t])?a[t].call(e,r):a[t];return n}}(t),pt[t](e)):e.localeData().invalidDate()}function C(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(dt.lastIndex=0;0<=r&&dt.test(e);)e=e.replace(dt,n),dt.lastIndex=0,r-=1;return e}function P(e,n,r){Mt[e]=k(n)?n:function(e,t){return e&&r?r:n}}function z(e,t){return p(Mt,e)?Mt[e](t._strict,t._locale):new RegExp(function(e){return V(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,o){return t||n||r||o}))}(e))}function V(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function G(e,n){var t,r=n;for("string"==typeof e&&(e=[e]),u(n)&&(r=function(e,t){t[n]=_(e)}),t=0;t<e.length;t++)Rt[e[t]]=r}function N(e,o){G(e,function(e,t,n,r){n._w=n._w||{},o(e,n._w,n,r)})}function D(e){return U(e)?366:365}function U(e){return e%4==0&&e%100!=0||e%400==0}function F(t,n){return function(e){return null!=e?(B(this,t,e),d.updateOffset(this,n),this):L(this,t)}}function L(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function B(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&U(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),$(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function $(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=function(e,t){return(e%t+t)%t}(t,12);return e+=(t-n)/12,1===n?U(e)?29:28:31-n%7%2}function q(e,t,n){var r,o,a,i=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)a=l([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(a,"").toLocaleLowerCase();return n?-1!==(o="MMM"===t?Lt.call(this._shortMonthsParse,i):Lt.call(this._longMonthsParse,i))?o:null:"MMM"===t?-1!==(o=Lt.call(this._shortMonthsParse,i))?o:-1!==(o=Lt.call(this._longMonthsParse,i))?o:null:-1!==(o=Lt.call(this._longMonthsParse,i))?o:-1!==(o=Lt.call(this._shortMonthsParse,i))?o:null}function H(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=_(t);else if(!u(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),$(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Y(e){return null!=e?(H(this,e),d.updateOffset(this,!0),this):L(this,"Month")}function Z(){function e(e,t){return t.length-e.length}var t,n,r=[],o=[],a=[];for(t=0;t<12;t++)n=l([2e3,t]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),a.push(this.months(n,"")),a.push(this.monthsShort(n,""));for(r.sort(e),o.sort(e),a.sort(e),t=0;t<12;t++)r[t]=V(r[t]),o[t]=V(o[t]);for(t=0;t<24;t++)a[t]=V(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function W(e){var t;if(e<100&&0<=e){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function K(e,t,n){var r=7+t-n,o=(7+W(e,0,r).getUTCDay()-t)%7;return r-o-1}function X(e,t,n,r,o){var a,i,s=(7+n-r)%7,u=K(e,r,o),c=1+7*(t-1)+s+u;return i=c<=0?D(a=e-1)+c:c>D(e)?(a=e+1,c-D(e)):(a=e,c),{year:a,dayOfYear:i}}function Q(e,t,n){var r,o,a=K(e.year(),t,n),i=Math.floor((e.dayOfYear()-a-1)/7)+1;return i<1?(o=e.year()-1,r=i+J(o,t,n)):i>J(e.year(),t,n)?(r=i-J(e.year(),t,n),o=e.year()+1):(o=e.year(),r=i),{week:r,year:o}}function J(e,t,n){var r=K(e,t,n),o=K(e+1,t,n);return(D(e)-r+o)/7}function ee(e,t){return e.slice(t,7).concat(e.slice(0,t))}function te(e,t,n){var r,o,a,i=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)a=l([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(a,"").toLocaleLowerCase();return n?-1!==(o="dddd"===t?Lt.call(this._weekdaysParse,i):"ddd"===t?Lt.call(this._shortWeekdaysParse,i):Lt.call(this._minWeekdaysParse,i))?o:null:"dddd"===t?-1!==(o=Lt.call(this._weekdaysParse,i))?o:-1!==(o=Lt.call(this._shortWeekdaysParse,i))?o:-1!==(o=Lt.call(this._minWeekdaysParse,i))?o:null:"ddd"===t?-1!==(o=Lt.call(this._shortWeekdaysParse,i))?o:-1!==(o=Lt.call(this._weekdaysParse,i))?o:-1!==(o=Lt.call(this._minWeekdaysParse,i))?o:null:-1!==(o=Lt.call(this._minWeekdaysParse,i))?o:-1!==(o=Lt.call(this._weekdaysParse,i))?o:-1!==(o=Lt.call(this._shortWeekdaysParse,i))?o:null}function ne(){function e(e,t){return t.length-e.length}var t,n,r,o,a,i=[],s=[],u=[],c=[];for(t=0;t<7;t++)n=l([2e3,1]).day(t),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),a=this.weekdays(n,""),i.push(r),s.push(o),u.push(a),c.push(r),c.push(o),c.push(a);for(i.sort(e),s.sort(e),u.sort(e),c.sort(e),t=0;t<7;t++)s[t]=V(s[t]),u[t]=V(u[t]),c[t]=V(c[t]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function re(){return this.hours()%12||12}function oe(e,t){M(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function ae(e,t){return t._meridiemParse}function ie(e){return e?e.toLowerCase().replace("_","-"):e}function se(e){var t=null;if(!on[e]&&void 0!==Jn&&Jn&&Jn.exports)try{t=tn._abbr,function(){var e=new Error('Cannot find module "./locale"');throw e.code="MODULE_NOT_FOUND",e}(),ue(t)}catch(e){}return on[e]}function ue(e,t){var n;return e&&((n=a(t)?le(e):ce(e,t))?tn=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),tn._abbr}function ce(e,t){if(null===t)return delete on[e],null;var n,r=rn;if(t.abbr=e,null!=on[e])E("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=on[e]._config;else if(null!=t.parentLocale)if(null!=on[t.parentLocale])r=on[t.parentLocale]._config;else{if(null==(n=se(t.parentLocale)))return an[t.parentLocale]||(an[t.parentLocale]=[]),an[t.parentLocale].push({name:e,config:t}),null;r=n._config}return on[e]=new A(T(r,t)),an[e]&&an[e].forEach(function(e){ce(e.name,e.config)}),ue(e),on[e]}function le(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return tn;if(!i(e)){if(t=se(e))return t;e=[e]}return function(e){for(var t,n,r,o,a=0;a<e.length;){for(o=ie(e[a]).split("-"),t=o.length,n=(n=ie(e[a+1]))?n.split("-"):null;0<t;){if(r=se(o.slice(0,t).join("-")))return r;if(n&&n.length>=t&&w(o,n,!0)>=t-1)break;t--}a++}return tn}(e)}function fe(e){var t,n=e._a;return n&&-2===h(e).overflow&&(t=n[Pt]<0||11<n[Pt]?Pt:n[zt]<1||n[zt]>$(n[Ct],n[Pt])?zt:n[Vt]<0||24<n[Vt]||24===n[Vt]&&(0!==n[Gt]||0!==n[Nt]||0!==n[Dt])?Vt:n[Gt]<0||59<n[Gt]?Gt:n[Nt]<0||59<n[Nt]?Nt:n[Dt]<0||999<n[Dt]?Dt:-1,h(e)._overflowDayOfYear&&(t<Ct||zt<t)&&(t=zt),h(e)._overflowWeeks&&-1===t&&(t=Ut),h(e)._overflowWeekday&&-1===t&&(t=Ft),h(e).overflow=t),e}function de(e,t,n){return null!=e?e:null!=t?t:n}function pe(e){var t,n,r,o,a,i=[];if(!e._d){for(r=function(e){var t=new Date(d.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[zt]&&null==e._a[Pt]&&function(e){var t,n,r,o,a,i,s,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)a=1,i=4,n=de(t.GG,e._a[Ct],Q(_e(),1,4).year),r=de(t.W,1),((o=de(t.E,1))<1||7<o)&&(u=!0);else{a=e._locale._week.dow,i=e._locale._week.doy;var c=Q(_e(),a,i);n=de(t.gg,e._a[Ct],c.year),r=de(t.w,c.week),null!=t.d?((o=t.d)<0||6<o)&&(u=!0):null!=t.e?(o=t.e+a,(t.e<0||6<t.e)&&(u=!0)):o=a}r<1||r>J(n,a,i)?h(e)._overflowWeeks=!0:null!=u?h(e)._overflowWeekday=!0:(s=X(n,r,o,a,i),e._a[Ct]=s.year,e._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(a=de(e._a[Ct],r[Ct]),(e._dayOfYear>D(a)||0===e._dayOfYear)&&(h(e)._overflowDayOfYear=!0),n=W(a,0,e._dayOfYear),e._a[Pt]=n.getUTCMonth(),e._a[zt]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=i[t]=r[t];for(;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Vt]&&0===e._a[Gt]&&0===e._a[Nt]&&0===e._a[Dt]&&(e._nextDay=!0,e._a[Vt]=0),e._d=(e._useUTC?W:function(e,t,n,r,o,a,i){var s;return e<100&&0<=e?(s=new Date(e+400,t,n,r,o,a,i),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,n,r,o,a,i),s}).apply(null,i),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Vt]=24),e._w&&void 0!==e._w.d&&e._w.d!==o&&(h(e).weekdayMismatch=!0)}}function he(e){var t,n,r,o,a,i,s=e._i,u=sn.exec(s)||un.exec(s);if(u){for(h(e).iso=!0,t=0,n=ln.length;t<n;t++)if(ln[t][1].exec(u[1])){o=ln[t][0],r=!1!==ln[t][2];break}if(null==o)return void(e._isValid=!1);if(u[3]){for(t=0,n=fn.length;t<n;t++)if(fn[t][1].exec(u[3])){a=(u[2]||" ")+fn[t][0];break}if(null==a)return void(e._isValid=!1)}if(!r&&null!=a)return void(e._isValid=!1);if(u[4]){if(!cn.exec(u[4]))return void(e._isValid=!1);i="Z"}e._f=o+(a||"")+(i||""),ge(e)}else e._isValid=!1}function ye(e,t,n,r,o,a){var i=[function(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}(e),Ht.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(o,10)];return a&&i.push(parseInt(a,10)),i}function ve(e){var t=pn.exec(function(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}(e._i));if(t){var n=ye(t[4],t[3],t[2],t[5],t[6],t[7]);if(!function(e,t,n){if(e){var r=Kt.indexOf(e),o=new Date(t[0],t[1],t[2]).getDay();if(r!==o)return h(n).weekdayMismatch=!0,n._isValid=!1}return!0}(t[1],n,e))return;e._a=n,e._tzm=function(e,t,n){if(e)return hn[e];if(t)return 0;var r=parseInt(n,10),o=r%100;return(r-o)/100*60+o}(t[8],t[9],t[10]),e._d=W.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),h(e).rfc2822=!0}else e._isValid=!1}function ge(e){if(e._f!==d.ISO_8601)if(e._f!==d.RFC_2822){e._a=[],h(e).empty=!0;var t,n,r,o,a,i,s,u,c=""+e._i,l=c.length,f=0;for(r=C(e._f,e._locale).match(ft)||[],t=0;t<r.length;t++)o=r[t],(n=(c.match(z(o,e))||[])[0])&&(0<(a=c.substr(0,c.indexOf(n))).length&&h(e).unusedInput.push(a),c=c.slice(c.indexOf(n)+n.length),f+=n.length),ht[o]?(n?h(e).empty=!1:h(e).unusedTokens.push(o),i=o,u=e,null!=(s=n)&&p(Rt,i)&&Rt[i](s,u._a,u,i)):e._strict&&!n&&h(e).unusedTokens.push(o);h(e).charsLeftOver=l-f,0<c.length&&h(e).unusedInput.push(c),e._a[Vt]<=12&&!0===h(e).bigHour&&0<e._a[Vt]&&(h(e).bigHour=void 0),h(e).parsedDateParts=e._a.slice(0),h(e).meridiem=e._meridiem,e._a[Vt]=function(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):(null!=e.isPM&&((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0)),t)}(e._locale,e._a[Vt],e._meridiem),pe(e),fe(e)}else ve(e);else he(e)}function me(e){var t=e._i,n=e._f;return e._locale=e._locale||le(e._l),null===t||void 0===n&&""===t?y({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),m(t)?new g(fe(t)):(o(t)?e._d=t:i(n)?function(e){var t,n,r,o,a;if(0===e._f.length)return h(e).invalidFormat=!0,e._d=new Date(NaN);for(o=0;o<e._f.length;o++)a=0,t=v({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],ge(t),f(t)&&(a+=h(t).charsLeftOver,a+=10*h(t).unusedTokens.length,h(t).score=a,(null==r||a<r)&&(r=a,n=t));c(e,n||t)}(e):n?ge(e):function(e){var t=e._i;a(t)?e._d=new Date(d.now()):o(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=dn.exec(e._i);null!==t?e._d=new Date(+t[1]):(he(e),!1===e._isValid&&(delete e._isValid,ve(e),!1===e._isValid&&(delete e._isValid,d.createFromInputFallback(e))))}(e):i(t)?(e._a=r(t.slice(0),function(e){return parseInt(e,10)}),pe(e)):s(t)?function(e){if(!e._d){var t=O(e._i);e._a=r([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),pe(e)}}(e):u(t)?e._d=new Date(t):d.createFromInputFallback(e)}(e),f(e)||(e._d=null),e))}function be(e,t,n,r,o){var a={};return!0!==n&&!1!==n||(r=n,n=void 0),(s(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||i(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=o,a._l=n,a._i=e,a._f=t,a._strict=r,function(e){var t=new g(fe(me(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}(a)}function _e(e,t,n,r){return be(e,t,n,r,!1)}function we(e,t){var n,r;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return _e();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function xe(e){var t=O(e),n=t.year||0,r=t.quarter||0,o=t.month||0,a=t.week||t.isoWeek||0,i=t.day||0,s=t.hour||0,u=t.minute||0,c=t.second||0,l=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Lt.call(gn,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,r=0;r<gn.length;++r)if(e[gn[r]]){if(n)return!1;parseFloat(e[gn[r]])!==_(e[gn[r]])&&(n=!0)}return!0}(t),this._milliseconds=+l+1e3*c+6e4*u+1e3*s*60*60,this._days=+i+7*a,this._months=+o+3*r+12*n,this._data={},this._locale=le(),this._bubble()}function Ee(e){return e instanceof xe}function ke(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Te(e,n){M(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+S(~~(e/60),2)+n+S(~~e%60,2)})}function Ae(e,t){var n=(t||"").match(e);if(null===n)return null;var r=n[n.length-1]||[],o=(r+"").match(mn)||["-",0,0],a=60*o[1]+_(o[2]);return 0===a?0:"+"===o[0]?a:-a}function Ie(e,t){var n,r;return t._isUTC?(n=t.clone(),r=(m(e)||o(e)?e.valueOf():_e(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),d.updateOffset(n,!1),n):_e(e).local()}function Oe(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function je(){return!!this.isValid()&&this._isUTC&&0===this._offset}function Se(e,t){var n,r,o,a=e,i=null;return Ee(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:u(e)?(a={},t?a[t]=e:a.milliseconds=e):(i=bn.exec(e))?(n="-"===i[1]?-1:1,a={y:0,d:_(i[zt])*n,h:_(i[Vt])*n,m:_(i[Gt])*n,s:_(i[Nt])*n,ms:_(ke(1e3*i[Dt]))*n}):(i=_n.exec(e))?(n="-"===i[1]?-1:1,a={y:Me(i[2],n),M:Me(i[3],n),w:Me(i[4],n),d:Me(i[5],n),h:Me(i[6],n),m:Me(i[7],n),s:Me(i[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(o=function(e,t){var n;return e.isValid()&&t.isValid()?(t=Ie(t,e),e.isBefore(t)?n=Re(e,t):((n=Re(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}(_e(a.from),_e(a.to)),(a={}).ms=o.milliseconds,a.M=o.months),r=new xe(a),Ee(e)&&p(e,"_locale")&&(r._locale=e._locale),r}function Me(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Re(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Ce(r,o){return function(e,t){var n;return null===t||isNaN(+t)||(E(o,"moment()."+o+"(period, number) is deprecated. Please use moment()."+o+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),Pe(this,Se(e="string"==typeof e?+e:e,t),r),this}}function Pe(e,t,n,r){var o=t._milliseconds,a=ke(t._days),i=ke(t._months);e.isValid()&&(r=null==r||r,i&&H(e,L(e,"Month")+i*n),a&&B(e,"Date",L(e,"Date")+a*n),o&&e._d.setTime(e._d.valueOf()+o*n),r&&d.updateOffset(e,a||i))}function ze(e,t){var n,r,o=12*(t.year()-e.year())+(t.month()-e.month()),a=e.clone().add(o,"months");return r=t-a<0?(n=e.clone().add(o-1,"months"),(t-a)/(a-n)):(n=e.clone().add(1+o,"months"),(t-a)/(n-a)),-(o+r)||0}function Ve(e){var t;return void 0===e?this._locale._abbr:(null!=(t=le(e))&&(this._locale=t),this)}function Ge(){return this._locale}function Ne(e,t){return(e%t+t)%t}function De(e,t,n){return e<100&&0<=e?new Date(e+400,t,n)-kn:new Date(e,t,n).valueOf()}function Ue(e,t,n){return e<100&&0<=e?Date.UTC(e+400,t,n)-kn:Date.UTC(e,t,n)}function Fe(e,t){M(0,[e,e.length],0,t)}function Le(e,t,n,r,o){var a;return null==e?Q(this,r,o).year:((a=J(e,r,o))<t&&(t=a),function(e,t,n,r,o){var a=X(e,t,n,r,o),i=W(a.year,0,a.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}.call(this,e,t,n,r,o))}function Be(e,t){t[Dt]=_(1e3*("0."+e))}function $e(e){return e}function qe(e,t,n,r){var o=le(),a=l().set(r,t);return o[n](a,e)}function He(e,t,n){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return qe(e,t,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=qe(e,r,n,"month");return o}function Ye(e,t,n,r){t=("boolean"==typeof e||(n=t=e,e=!1),u(t)&&(n=t,t=void 0),t||"");var o=le(),a=e?o._week.dow:0;if(null!=n)return qe(t,(n+a)%7,r,"day");var i,s=[];for(i=0;i<7;i++)s[i]=qe(t,(i+a)%7,r,"day");return s}function Ze(e,t,n,r){var o=Se(t,n);return e._milliseconds+=r*o._milliseconds,e._days+=r*o._days,e._months+=r*o._months,e._bubble()}function We(e){return e<0?Math.floor(e):Math.ceil(e)}function Ke(e){return 4800*e/146097}function Xe(e){return 146097*e/4800}function Qe(e){return function(){return this.as(e)}}function Je(e){return function(){return this.isValid()?this._data[e]:NaN}}function et(e,t,n,r,o){return o.relativeTime(t||1,!!n,e,r)}function tt(e){return(0<e)-(e<0)||+e}function nt(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Xn(this._milliseconds)/1e3,r=Xn(this._days),o=Xn(this._months);e=b(n/60),t=b(e/60),n%=60,e%=60;var a=b(o/12),i=o%=12,s=r,u=t,c=e,l=n?n.toFixed(3).replace(/\.?0+$/,""):"",f=this.asSeconds();if(!f)return"P0D";var d=f<0?"-":"",p=tt(this._months)!==tt(f)?"-":"",h=tt(this._days)!==tt(f)?"-":"",y=tt(this._milliseconds)!==tt(f)?"-":"";return d+"P"+(a?p+a+"Y":"")+(i?p+i+"M":"")+(s?h+s+"D":"")+(u||c||l?"T":"")+(u?y+u+"H":"")+(c?y+c+"M":"")+(l?y+l+"S":"")}var rt,ot;ot=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var at,it=d.momentProperties=[],st=!1,ut={};d.suppressDeprecationWarnings=!1,d.deprecationHandler=null,at=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)p(e,t)&&n.push(t);return n};var ct={},lt={},ft=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,dt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,pt={},ht={},yt=/\d/,vt=/\d\d/,gt=/\d{3}/,mt=/\d{4}/,bt=/[+-]?\d{6}/,_t=/\d\d?/,wt=/\d\d\d\d?/,xt=/\d\d\d\d\d\d?/,Et=/\d{1,3}/,kt=/\d{1,4}/,Tt=/[+-]?\d{1,6}/,At=/\d+/,It=/[+-]?\d+/,Ot=/Z|[+-]\d\d:?\d\d/gi,jt=/Z|[+-]\d\d(?::?\d\d)?/gi,St=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Mt={},Rt={},Ct=0,Pt=1,zt=2,Vt=3,Gt=4,Nt=5,Dt=6,Ut=7,Ft=8;M("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),M(0,["YY",2],0,function(){return this.year()%100}),M(0,["YYYY",4],0,"year"),M(0,["YYYYY",5],0,"year"),M(0,["YYYYYY",6,!0],0,"year"),t("year","y"),n("year",1),P("Y",It),P("YY",_t,vt),P("YYYY",kt,mt),P("YYYYY",Tt,bt),P("YYYYYY",Tt,bt),G(["YYYYY","YYYYYY"],Ct),G("YYYY",function(e,t){t[Ct]=2===e.length?d.parseTwoDigitYear(e):_(e)}),G("YY",function(e,t){t[Ct]=d.parseTwoDigitYear(e)}),G("Y",function(e,t){t[Ct]=parseInt(e,10)}),d.parseTwoDigitYear=function(e){return _(e)+(68<_(e)?1900:2e3)};var Lt,Bt=F("FullYear",!0);Lt=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},M("M",["MM",2],"Mo",function(){return this.month()+1}),M("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),M("MMMM",0,0,function(e){return this.localeData().months(this,e)}),t("month","M"),n("month",8),P("M",_t),P("MM",_t,vt),P("MMM",function(e,t){return t.monthsShortRegex(e)}),P("MMMM",function(e,t){return t.monthsRegex(e)}),G(["M","MM"],function(e,t){t[Pt]=_(e)-1}),G(["MMM","MMMM"],function(e,t,n,r){var o=n._locale.monthsParse(e,r,n._strict);null!=o?t[Pt]=o:h(n).invalidMonth=e});var $t=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,qt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Ht="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Yt=St,Zt=St;M("w",["ww",2],"wo","week"),M("W",["WW",2],"Wo","isoWeek"),t("week","w"),t("isoWeek","W"),n("week",5),n("isoWeek",5),P("w",_t),P("ww",_t,vt),P("W",_t),P("WW",_t,vt),N(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=_(e)});M("d",0,"do","day"),M("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),M("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),M("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),M("e",0,0,"weekday"),M("E",0,0,"isoWeekday"),t("day","d"),t("weekday","e"),t("isoWeekday","E"),n("day",11),n("weekday",11),n("isoWeekday",11),P("d",_t),P("e",_t),P("E",_t),P("dd",function(e,t){return t.weekdaysMinRegex(e)}),P("ddd",function(e,t){return t.weekdaysShortRegex(e)}),P("dddd",function(e,t){return t.weekdaysRegex(e)}),N(["dd","ddd","dddd"],function(e,t,n,r){var o=n._locale.weekdaysParse(e,r,n._strict);null!=o?t.d=o:h(n).invalidWeekday=e}),N(["d","e","E"],function(e,t,n,r){t[r]=_(e)});var Wt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Kt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Xt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Qt=St,Jt=St,en=St;M("H",["HH",2],0,"hour"),M("h",["hh",2],0,re),M("k",["kk",2],0,function(){return this.hours()||24}),M("hmm",0,0,function(){return""+re.apply(this)+S(this.minutes(),2)}),M("hmmss",0,0,function(){return""+re.apply(this)+S(this.minutes(),2)+S(this.seconds(),2)}),M("Hmm",0,0,function(){return""+this.hours()+S(this.minutes(),2)}),M("Hmmss",0,0,function(){return""+this.hours()+S(this.minutes(),2)+S(this.seconds(),2)}),oe("a",!0),oe("A",!1),t("hour","h"),n("hour",13),P("a",ae),P("A",ae),P("H",_t),P("h",_t),P("k",_t),P("HH",_t,vt),P("hh",_t,vt),P("kk",_t,vt),P("hmm",wt),P("hmmss",xt),P("Hmm",wt),P("Hmmss",xt),G(["H","HH"],Vt),G(["k","kk"],function(e,t,n){var r=_(e);t[Vt]=24===r?0:r}),G(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),G(["h","hh"],function(e,t,n){t[Vt]=_(e),h(n).bigHour=!0}),G("hmm",function(e,t,n){var r=e.length-2;t[Vt]=_(e.substr(0,r)),t[Gt]=_(e.substr(r)),h(n).bigHour=!0}),G("hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[Vt]=_(e.substr(0,r)),t[Gt]=_(e.substr(r,2)),t[Nt]=_(e.substr(o)),h(n).bigHour=!0}),G("Hmm",function(e,t,n){var r=e.length-2;t[Vt]=_(e.substr(0,r)),t[Gt]=_(e.substr(r))}),G("Hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[Vt]=_(e.substr(0,r)),t[Gt]=_(e.substr(r,2)),t[Nt]=_(e.substr(o))});var tn,nn=F("Hours",!0),rn={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:qt,monthsShort:Ht,week:{dow:0,doy:6},weekdays:Wt,weekdaysMin:Xt,weekdaysShort:Kt,meridiemParse:/[ap]\.?m?\.?/i},on={},an={},sn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,un=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,cn=/Z|[+-]\d\d(?::?\d\d)?/,ln=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],fn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],dn=/^\/?Date\((\-?\d+)/i,pn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,hn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};d.createFromInputFallback=e("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),d.ISO_8601=function(){},d.RFC_2822=function(){};var yn=e("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_e.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()}),vn=e("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=_e.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:y()}),gn=["year","quarter","month","week","day","hour","minute","second","millisecond"];Te("Z",":"),Te("ZZ",""),P("Z",jt),P("ZZ",jt),G(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ae(jt,e)});var mn=/([\+\-]|\d\d)/gi;d.updateOffset=function(){};var bn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,_n=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;Se.fn=xe.prototype,Se.invalid=function(){return Se(NaN)};var wn=Ce(1,"add"),xn=Ce(-1,"subtract");d.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",d.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var En=e("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)}),kn=126227808e5;M(0,["gg",2],0,function(){return this.weekYear()%100}),M(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Fe("gggg","weekYear"),Fe("ggggg","weekYear"),Fe("GGGG","isoWeekYear"),Fe("GGGGG","isoWeekYear"),t("weekYear","gg"),t("isoWeekYear","GG"),n("weekYear",1),n("isoWeekYear",1),P("G",It),P("g",It),P("GG",_t,vt),P("gg",_t,vt),P("GGGG",kt,mt),P("gggg",kt,mt),P("GGGGG",Tt,bt),P("ggggg",Tt,bt),N(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=_(e)}),N(["gg","GG"],function(e,t,n,r){t[r]=d.parseTwoDigitYear(e)}),M("Q",0,"Qo","quarter"),t("quarter","Q"),n("quarter",7),P("Q",yt),G("Q",function(e,t){t[Pt]=3*(_(e)-1)}),M("D",["DD",2],"Do","date"),t("date","D"),n("date",9),P("D",_t),P("DD",_t,vt),P("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),G(["D","DD"],zt),G("Do",function(e,t){t[zt]=_(e.match(_t)[0])});var Tn=F("Date",!0);M("DDD",["DDDD",3],"DDDo","dayOfYear"),t("dayOfYear","DDD"),n("dayOfYear",4),P("DDD",Et),P("DDDD",gt),G(["DDD","DDDD"],function(e,t,n){n._dayOfYear=_(e)}),M("m",["mm",2],0,"minute"),t("minute","m"),n("minute",14),P("m",_t),P("mm",_t,vt),G(["m","mm"],Gt);var An=F("Minutes",!1);M("s",["ss",2],0,"second"),t("second","s"),n("second",15),P("s",_t),P("ss",_t,vt),G(["s","ss"],Nt);var In,On=F("Seconds",!1);for(M("S",0,0,function(){return~~(this.millisecond()/100)}),M(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),M(0,["SSS",3],0,"millisecond"),M(0,["SSSS",4],0,function(){return 10*this.millisecond()}),M(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),M(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),M(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),M(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),M(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),t("millisecond","ms"),n("millisecond",16),P("S",Et,yt),P("SS",Et,vt),P("SSS",Et,gt),In="SSSS";In.length<=9;In+="S")P(In,At);for(In="S";In.length<=9;In+="S")G(In,Be);var jn=F("Milliseconds",!1);M("z",0,0,"zoneAbbr"),M("zz",0,0,"zoneName");var Sn=g.prototype;Sn.add=wn,Sn.calendar=function(e,t){var n=e||_e(),r=Ie(n,this).startOf("day"),o=d.calendarFormat(this,r)||"sameElse",a=t&&(k(t[o])?t[o].call(this,n):t[o]);return this.format(a||this.localeData().calendar(o,this,_e(n)))},Sn.clone=function(){return new g(this)},Sn.diff=function(e,t,n){var r,o,a;if(!this.isValid())return NaN;if(!(r=Ie(e,this)).isValid())return NaN;switch(o=6e4*(r.utcOffset()-this.utcOffset()),t=I(t)){case"year":a=ze(this,r)/12;break;case"month":a=ze(this,r);break;case"quarter":a=ze(this,r)/3;break;case"second":a=(this-r)/1e3;break;case"minute":a=(this-r)/6e4;break;case"hour":a=(this-r)/36e5;break;case"day":a=(this-r-o)/864e5;break;case"week":a=(this-r-o)/6048e5;break;default:a=this-r}return n?a:b(a)},Sn.endOf=function(e){var t;if(void 0===(e=I(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?Ue:De;switch(e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-Ne(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-Ne(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-Ne(t,1e3)-1}return this._d.setTime(t),d.updateOffset(this,!0),this},Sn.format=function(e){e=e||(this.isUtc()?d.defaultFormatUtc:d.defaultFormat);var t=R(this,e);return this.localeData().postformat(t)},Sn.from=function(e,t){return this.isValid()&&(m(e)&&e.isValid()||_e(e).isValid())?Se({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Sn.fromNow=function(e){return this.from(_e(),e)},Sn.to=function(e,t){return this.isValid()&&(m(e)&&e.isValid()||_e(e).isValid())?Se({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Sn.toNow=function(e){return this.to(_e(),e)},Sn.get=function(e){return k(this[e=I(e)])?this[e]():this},Sn.invalidAt=function(){return h(this).overflow},Sn.isAfter=function(e,t){var n=m(e)?e:_e(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=I(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},Sn.isBefore=function(e,t){var n=m(e)?e:_e(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=I(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},Sn.isBetween=function(e,t,n,r){var o=m(e)?e:_e(e),a=m(t)?t:_e(t);return!!(this.isValid()&&o.isValid()&&a.isValid())&&("("===(r=r||"()")[0]?this.isAfter(o,n):!this.isBefore(o,n))&&(")"===r[1]?this.isBefore(a,n):!this.isAfter(a,n))},Sn.isSame=function(e,t){var n,r=m(e)?e:_e(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=I(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},Sn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},Sn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},Sn.isValid=function(){return f(this)},Sn.lang=En,Sn.locale=Ve,Sn.localeData=Ge,Sn.max=vn,Sn.min=yn,Sn.parsingFlags=function(){return c({},h(this))},Sn.set=function(e,t){if("object"==typeof e)for(var n=j(e=O(e)),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit]);else if(k(this[e=I(e)]))return this[e](t);return this},Sn.startOf=function(e){var t;if(void 0===(e=I(e))||"millisecond"===e||!this.isValid())return this;var n=this._isUTC?Ue:De;switch(e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Ne(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=Ne(t,6e4);break;case"second":t=this._d.valueOf(),t-=Ne(t,1e3)}return this._d.setTime(t),d.updateOffset(this,!0),this},Sn.subtract=xn,Sn.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},Sn.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},Sn.toDate=function(){return new Date(this.valueOf())},Sn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||9999<n.year()?R(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):k(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",R(n,"Z")):R(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},Sn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=t+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+o)},Sn.toJSON=function(){return this.isValid()?this.toISOString():null},Sn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Sn.unix=function(){return Math.floor(this.valueOf()/1e3)},Sn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},Sn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},Sn.year=Bt,Sn.isLeapYear=function(){return U(this.year())},Sn.weekYear=function(e){return Le.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},Sn.isoWeekYear=function(e){return Le.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},Sn.quarter=Sn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},Sn.month=Y,Sn.daysInMonth=function(){return $(this.year(),this.month())},Sn.week=Sn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},Sn.isoWeek=Sn.isoWeeks=function(e){var t=Q(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},Sn.weeksInYear=function(){var e=this.localeData()._week;return J(this.year(),e.dow,e.doy)},Sn.isoWeeksInYear=function(){return J(this.year(),1,4)},Sn.date=Tn,Sn.day=Sn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(n=e,r=this.localeData(),e="string"!=typeof n?n:isNaN(n)?"number"==typeof(n=r.weekdaysParse(n))?n:null:parseInt(n,10),this.add(e-t,"d")):t;var n,r},Sn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},Sn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null==e)return this.day()||7;var t=(n=e,r=this.localeData(),"string"==typeof n?r.weekdaysParse(n)%7||7:isNaN(n)?null:n);var n,r;return this.day(this.day()%7?t:t-7)},Sn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},Sn.hour=Sn.hours=nn,Sn.minute=Sn.minutes=An,Sn.second=Sn.seconds=On,Sn.millisecond=Sn.milliseconds=jn,Sn.utcOffset=function(e,t,n){var r,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?o:Oe(this);if("string"==typeof e){if(null===(e=Ae(jt,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(r=Oe(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),o!==e&&(!t||this._changeInProgress?Pe(this,Se(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,d.updateOffset(this,!0),this._changeInProgress=null)),this},Sn.utc=function(e){return this.utcOffset(0,e)},Sn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Oe(this),"m")),this},Sn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ae(Ot,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},Sn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?_e(e).utcOffset():0,(this.utcOffset()-e)%60==0)},Sn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Sn.isLocal=function(){return!!this.isValid()&&!this._isUTC},Sn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},Sn.isUtc=je,Sn.isUTC=je,Sn.zoneAbbr=function(){return this._isUTC?"UTC":""},Sn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Sn.dates=e("dates accessor is deprecated. Use date instead.",Tn),Sn.months=e("months accessor is deprecated. Use month instead",Y),Sn.years=e("years accessor is deprecated. Use year instead",Bt),Sn.zone=e("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),Sn.isDSTShifted=e("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(v(e,this),(e=me(e))._a){var t=e._isUTC?l(e._a):_e(e._a);this._isDSTShifted=this.isValid()&&0<w(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var Mn=A.prototype;Mn.calendar=function(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return k(r)?r.call(t,n):r},Mn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},Mn.invalidDate=function(){return this._invalidDate},Mn.ordinal=function(e){return this._ordinal.replace("%d",e)},Mn.preparse=$e,Mn.postformat=$e,Mn.relativeTime=function(e,t,n,r){var o=this._relativeTime[n];return k(o)?o(e,t,n,r):o.replace(/%d/i,e)},Mn.pastFuture=function(e,t){var n=this._relativeTime[0<e?"future":"past"];return k(n)?n(t):n.replace(/%s/i,t)},Mn.set=function(e){var t,n;for(n in e)k(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Mn.months=function(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||$t).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone},Mn.monthsShort=function(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[$t.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Mn.monthsParse=function(e,t,n){var r,o,a;if(this._monthsParseExact)return q.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=l([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(a="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(a.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}},Mn.monthsRegex=function(e){return this._monthsParseExact?(p(this,"_monthsRegex")||Z.call(this),e?this._monthsStrictRegex:this._monthsRegex):(p(this,"_monthsRegex")||(this._monthsRegex=Zt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},Mn.monthsShortRegex=function(e){return this._monthsParseExact?(p(this,"_monthsRegex")||Z.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(p(this,"_monthsShortRegex")||(this._monthsShortRegex=Yt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},Mn.week=function(e){return Q(e,this._week.dow,this._week.doy).week},Mn.firstDayOfYear=function(){return this._week.doy},Mn.firstDayOfWeek=function(){return this._week.dow},Mn.weekdays=function(e,t){var n=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?ee(n,this._week.dow):e?n[e.day()]:n},Mn.weekdaysMin=function(e){return!0===e?ee(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},Mn.weekdaysShort=function(e){return!0===e?ee(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},Mn.weekdaysParse=function(e,t,n){var r,o,a;if(this._weekdaysParseExact)return te.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=l([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(a="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(a.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}},Mn.weekdaysRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||ne.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(p(this,"_weekdaysRegex")||(this._weekdaysRegex=Qt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},Mn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||ne.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(p(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Jt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Mn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||ne.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(p(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=en),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Mn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Mn.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},ue("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===_(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th";return e+n}}),d.lang=e("moment.lang is deprecated. Use moment.locale instead.",ue),d.langData=e("moment.langData is deprecated. Use moment.localeData instead.",le);var Rn=Math.abs,Cn=Qe("ms"),Pn=Qe("s"),zn=Qe("m"),Vn=Qe("h"),Gn=Qe("d"),Nn=Qe("w"),Dn=Qe("M"),Un=Qe("Q"),Fn=Qe("y"),Ln=Je("milliseconds"),Bn=Je("seconds"),$n=Je("minutes"),qn=Je("hours"),Hn=Je("days"),Yn=Je("months"),Zn=Je("years"),Wn=Math.round,Kn={ss:44,s:45,m:45,h:22,d:26,M:11},Xn=Math.abs,Qn=xe.prototype;return Qn.isValid=function(){return this._isValid},Qn.abs=function(){var e=this._data;return this._milliseconds=Rn(this._milliseconds),this._days=Rn(this._days),this._months=Rn(this._months),e.milliseconds=Rn(e.milliseconds),e.seconds=Rn(e.seconds),e.minutes=Rn(e.minutes),e.hours=Rn(e.hours),e.months=Rn(e.months),e.years=Rn(e.years),this},Qn.add=function(e,t){return Ze(this,e,t,1)},Qn.subtract=function(e,t){return Ze(this,e,t,-1)},Qn.as=function(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=I(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+Ke(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(Xe(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},Qn.asMilliseconds=Cn,Qn.asSeconds=Pn,Qn.asMinutes=zn,Qn.asHours=Vn,Qn.asDays=Gn,Qn.asWeeks=Nn,Qn.asMonths=Dn,Qn.asQuarters=Un,Qn.asYears=Fn,Qn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*_(this._months/12):NaN},Qn._bubble=function(){var e,t,n,r,o,a=this._milliseconds,i=this._days,s=this._months,u=this._data;return 0<=a&&0<=i&&0<=s||a<=0&&i<=0&&s<=0||(a+=864e5*We(Xe(s)+i),s=i=0),u.milliseconds=a%1e3,e=b(a/1e3),u.seconds=e%60,t=b(e/60),u.minutes=t%60,n=b(t/60),u.hours=n%24,i+=b(n/24),o=b(Ke(i)),s+=o,i-=We(Xe(o)),r=b(s/12),s%=12,u.days=i,u.months=s,u.years=r,this},Qn.clone=function(){return Se(this)},Qn.get=function(e){return e=I(e),this.isValid()?this[e+"s"]():NaN},Qn.milliseconds=Ln,Qn.seconds=Bn,Qn.minutes=$n,Qn.hours=qn,Qn.days=Hn,Qn.weeks=function(){return b(this.days()/7)},Qn.months=Yn,Qn.years=Zn,Qn.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=(r=this,o=!e,a=t,i=Se(r).abs(),s=Wn(i.as("s")),u=Wn(i.as("m")),c=Wn(i.as("h")),l=Wn(i.as("d")),f=Wn(i.as("M")),d=Wn(i.as("y")),p=s<=Kn.ss&&["s",s]||s<Kn.s&&["ss",s]||u<=1&&["m"]||u<Kn.m&&["mm",u]||c<=1&&["h"]||c<Kn.h&&["hh",c]||l<=1&&["d"]||l<Kn.d&&["dd",l]||f<=1&&["M"]||f<Kn.M&&["MM",f]||d<=1&&["y"]||["yy",d],p[2]=o,p[3]=0<+r,p[4]=a,et.apply(null,p));var r,o,a,i,s,u,c,l,f,d,p;return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Qn.toISOString=nt,Qn.toString=nt,Qn.toJSON=nt,Qn.locale=Ve,Qn.localeData=Ge,Qn.toIsoString=e("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",nt),Qn.lang=En,M("X",0,0,"unix"),M("x",0,0,"valueOf"),P("x",It),P("X",/[+-]?\d+(\.\d{1,3})?/),G("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),G("x",function(e,t,n){n._d=new Date(_(e))}),d.version="2.24.0",function(e){rt=e}(_e),d.fn=Sn,d.min=function(){return we("isBefore",[].slice.call(arguments,0))},d.max=function(){return we("isAfter",[].slice.call(arguments,0))},d.now=function(){return Date.now?Date.now():+new Date},d.utc=l,d.unix=function(e){return _e(1e3*e)},d.months=function(e,t){return He(e,t,"months")},d.isDate=o,d.locale=ue,d.invalid=y,d.duration=Se,d.isMoment=m,d.weekdays=function(e,t,n){return Ye(e,t,n,"weekdays")},d.parseZone=function(){return _e.apply(null,arguments).parseZone()},d.localeData=le,d.isDuration=Ee,d.monthsShort=function(e,t){return He(e,t,"monthsShort")},d.weekdaysMin=function(e,t,n){return Ye(e,t,n,"weekdaysMin")},d.defineLocale=ce,d.updateLocale=function(e,t){if(null!=t){var n,r,o=rn;null!=(r=se(e))&&(o=r._config),t=T(o,t),(n=new A(t)).parentLocale=on[e],on[e]=n,ue(e)}else null!=on[e]&&(null!=on[e].parentLocale?on[e]=on[e].parentLocale:null!=on[e]&&delete on[e]);return on[e]},d.locales=function(){return at(on)},d.weekdaysShort=function(e,t,n){return Ye(e,t,n,"weekdaysShort")},d.normalizeUnits=I,d.relativeTimeRounding=function(e){return void 0===e?Wn:"function"==typeof e&&(Wn=e,!0)},d.relativeTimeThreshold=function(e,t){return void 0!==Kn[e]&&(void 0===t?Kn[e]:(Kn[e]=t,"s"===e&&(Kn.ss=t-1),!0))},d.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},d.prototype=Sn,d.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},d}()}).call(t,n(256)(e))},function(e,t,n){(function(s){"use strict";!s.version||0===s.version.indexOf("v0.")||0===s.version.indexOf("v1.")&&0!==s.version.indexOf("v1.8.")?e.exports=function(e,t,n,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,i=arguments.length;switch(i){case 0:case 1:return s.nextTick(e);case 2:return s.nextTick(function(){e.call(null,t)});case 3:return s.nextTick(function(){e.call(null,t,n)});case 4:return s.nextTick(function(){e.call(null,t,n,r)});default:for(o=new Array(i-1),a=0;a<o.length;)o[a++]=arguments[a];return s.nextTick(function(){e.apply(null,o)})}}:e.exports=s.nextTick}).call(t,n(66))},function(e,t,n){"use strict";function r(n){this.afterTransform=function(e,t){return function(e,t,n){var r=e._transformState;r.transforming=!1;var o=r.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,(r.writecb=null)!==n&&void 0!==n&&e.push(n),o(t);var a=e._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&e._read(a.highWaterMark)}(n,e,t)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function o(e){if(!(this instanceof o))return new o(e);i.call(this,e),this._transformState=new r(this);var n=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,t){a(n,e,t)}):a(n)})}function a(e,t,n){if(t)return e.emit("error",t);null!=n&&e.push(n);var r=e._writableState,o=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(o.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}e.exports=o;var i=n(75),s=n(106);s.inherits=n(63),s.inherits(o,i),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(E,e,k){(function(e,t){"use strict";function a(){}function u(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function n(e,t){h=h||k(75),e=e||{},this.objectMode=!!e.objectMode,t instanceof h&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1;var o=(this.finished=!1)===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?y(o,r):o(r),e._writableState.errorEmitted=!0,e.emit("error",r)}(e,n,r,t,o);else{var a=f(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||c(e,n),r?v(s,e,n,a,o):s(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new p(this)}function r(e){return h=h||k(75),_.call(r,this)||this instanceof h?(this._writableState=new n(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),void m.call(this)):new r(e)}function i(e,t,n,r,o){n=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=x.from(t,n)),t}(t,n,r),w.isBuffer(n)&&(r="buffer");var a=t.objectMode?1:n.length;t.length+=a;var i=t.length<t.highWaterMark;if(i||(t.needDrain=!0),t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new u(n,r,o),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else l(e,t,!1,a,n,r,o);return i}function l(e,t,n,r,o,a,i){t.writelen=r,t.writecb=i,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,a,t.onwrite),t.sync=!1}function s(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),d(e,t)}function c(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var i=0;n;)n=(o[i]=n).next,i+=1;l(e,t,!0,t.length,o,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new p(t)}else{for(;n;){var s=n.chunk,u=n.encoding,c=n.callback;if(l(e,t,!1,t.objectMode?1:s.length,s,u,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function f(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function o(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function d(e,t){var n=f(t);return n&&(0===t.pendingcb?(o(e,t),t.finished=!0,e.emit("finish")):o(e,t)),n}function p(r){var o=this;this.next=null,this.entry=null,this.finish=function(e){var t=o.entry;for(o.entry=null;t;){var n=t.callback;r.pendingcb--,n(e),t=t.next}r.corkedRequestsFree?r.corkedRequestsFree.next=o:r.corkedRequestsFree=o}}E.exports=r;var h,y=k(241),v=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?t:y;r.WritableState=n;var g=k(106);g.inherits=k(63);var m,b={deprecate:k(974)};!function(){try{m=k(254)}catch(e){}finally{m=m||k(41).EventEmitter}}();var _,w=k(49).Buffer,x=k(196);g.inherits(r,m),n.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(n.prototype,"buffer",{get:b.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(_=Function.prototype[Symbol.hasInstance],Object.defineProperty(r,Symbol.hasInstance,{value:function(e){return!!_.call(this,e)||e&&e._writableState instanceof n}})):_=function(e){return e instanceof this},r.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},r.prototype.write=function(e,t,n){var r=this._writableState,o=!1;return"function"==typeof t&&(n=t,t=null),t=w.isBuffer(e)?"buffer":t||r.defaultEncoding,"function"!=typeof n&&(n=a),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),y(t,n)}(this,n):function(e,t,n,r){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):w.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),y(r,a),o=!1),o}(this,r,e,n)&&(r.pendingcb++,o=i(this,r,e,t,n)),o},r.prototype.cork=function(){this._writableState.corked++},r.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||c(this,e))},r.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},r.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},r.prototype._writev=null,r.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,t=e=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,d(e,t),n&&(t.finished?y(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n)}}).call(e,k(66),k(969).setImmediate)},function(n,r,o){(function(e){var t=function(){try{return o(254)}catch(e){}}();(r=n.exports=o(380)).Stream=t||r,(r.Readable=r).Writable=o(243),r.Duplex=o(75),r.Transform=o(242),r.PassThrough=o(379),!e.browser&&"disable"==={NODE_ENV:"production",NODE_TARGET:"web"}.READABLE_STREAM&&t&&(n.exports=t)}).call(r,o(66))},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(119),o=n(43).document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){"use strict";function r(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=o(n),this.reject=o(r)}var o=n(164);e.exports.f=function(e){return new r(e)}},function(e,t,n){var r=n(939),o=n(382);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(169).f,o=n(168),a=n(44)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(390)("keys"),o=n(394);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){var r=n(384),o=n(245);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(245);e.exports=function(e){return Object(r(e))}},function(e,t,n){function r(){l.call(this)}e.exports=r;var l=n(41).EventEmitter;n(63)(r,l),r.Readable=n(244),r.Writable=n(912),r.Duplex=n(908),r.Transform=n(911),r.PassThrough=n(910),(r.Stream=r).prototype.pipe=function(t,e){function n(e){t.writable&&!1===t.write(e)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function o(){c||(c=!0,t.end())}function a(){c||(c=!0,"function"==typeof t.destroy&&t.destroy())}function i(e){if(s(),0===l.listenerCount(this,"error"))throw e}function s(){u.removeListener("data",n),t.removeListener("drain",r),u.removeListener("end",o),u.removeListener("close",a),u.removeListener("error",i),t.removeListener("error",i),u.removeListener("end",s),u.removeListener("close",s),t.removeListener("close",s)}var u=this;u.on("data",n),t.on("drain",r),t._isStdio||e&&!1===e.end||(u.on("end",o),u.on("close",a));var c=!1;return u.on("error",i),t.on("error",i),u.on("end",s),u.on("close",s),t.on("close",s),t.emit("pipe",u),t}},function(e,t,n){var r=n(975),o=n(976),a=o;a.v1=r,a.v4=o,e.exports=a},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="UpM28mnfW65vJkbqEATtKvxm",r={CONSUMER_ORGANIZATION_ID:n,BASE_URLS:{local:"http://localhost:8888",productionOauth:"http://52.41.133.15:8000/tigertextapi"},ADMIN_URLS:{},CN_URLS:{},FORGOT_PASSWORD_URLS:{},ROLES_URLS:{},CLOUDFRONT:{development:{d1n6bomzxlt9xn:"tigertext/production/avatar",d18oyzjkq5093g:"tigertext/production/avatar-group"},production:{d1n6bomzxlt9xn:"tigertext/production/avatar",d18oyzjkq5093g:"tigertext/production/avatar-group"},tt:{d1n6bomzxlt9xn:"tigertext/production/avatar",d18oyzjkq5093g:"tigertext/production/avatar-group"},ihis:{avatar:"",groupAvatar:""}},CONFIG_DEFAULT:{adminFeatureBranch:null,apiEnv:"production",assetDomain:"assets.tigerconnect.com",autoAckSuccessfullyHandledEvents:!0,autoSignOutOnBrowserUnload:!0,baseUrl:null,botUsers:[],clearTypingStatusThrottleDelay:2e3,clearTypingStatusTimeout:8e3,cloudfrontDomain:"cloudfront.net",cloudfront:{},condensedReplays:!1,consumerOrganizationId:n,detectBangReplayTimeout:1e3,events:{autoAck:!1,autoDeliver:!1,canConfirm:!0,closeAfterMessages:!1,heartbeat:!0,hidden:!1,includeDistributionListEvents:!0,isTyping:!0,keepAlive:!1,msgDeliveryDelay:0,multiOrg:!0,noOfflineMessages:!1,renderMetadata:!0},eventCollectionInterval:50,eventDrainTimeout:4e3,eventsAutoReconnect:!0,eventsAutoReconnectDelay:2e3,eventsAutoReconnectMaxDelay:16e3,eventsClearRetryHistoryInterval:6e4,eventsDebugging:!1,eventsHeartbeatIntervalVisible:12e3,eventsHeartbeatIntervalInvisible:3e4,eventsOpenTimeout:6e3,flushAckInterval:1e3,flushAckMaxConnections:2,flushAckMaxEvents:50,flushFindRecipientStatusInterval:150,flushFindRecipientStatusMaxCount:20,flushSetMessageStatusInterval:1e3,flushSetMessageStatusMaxCount:500,keepConversationsForAllForums:!1,localAdminUrl:null,localCnUrl:null,localRolesUrl:null,logLevel:"error",manuallyRequestEventQueueBatch:!1,maxEventBatch:50,maxMetadataKeyCount:11,organizationRostersChangeThrottleDelay:500,placeholderEntityAllowLoading:!0,placeholderEntityDelayBeforeRefreshing:100,processingEvents:!1,productKey:"bc1oOf3DZXbnaNZ2LCWZGvSg",pushAgent:"consumer",serviceLogLevels:{},signUpHashKey:"21d2ff3ffbf",signUpHashSalt:"%(xx*&x$&*%&",ttRoute:null,version:"1.0",wantCondensedReplays:!0}};["stag","uat"].forEach(function(e){r.BASE_URLS[e]="https://"+e+"-devapi.tigertext.me",r.FORGOT_PASSWORD_URLS[e]="https://"+e+"-forget.tigertext.com",r.CN_URLS[e]="https://"+e+"-console.tigertext.me",r.ADMIN_URLS[e]="https://"+e+"-console.tigertext.me/app/admin",r.ROLES_URLS[e]="/"+e+"/app/roles/index.html"}),["ihis","prod","prod-a","prod-c","production","tt"].forEach(function(e){r.BASE_URLS[e]="https://api.tigertext.me",r.FORGOT_PASSWORD_URLS[e]="https://forget.tigertext.com",r.CN_URLS[e]="https://home.tigertext.com",r.ADMIN_URLS[e]="https://home.tigertext.com/app/admin",r.ROLES_URLS[e]="/app/roles/index.html"}),["prod-a","prod-c"].forEach(function(e){var t=e.replace("prod-","");r.BASE_URLS[e]="https://"+t+"-api.tigertext.me"}),["ihis"].forEach(function(e){r.CN_URLS[e]="https://"+e+".tigertext.com",r.ADMIN_URLS[e]="https://"+e+".tigertext.com/app/admin"}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="validation",a);function d(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"invalid",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e+" is "+t;(0,u.default)(this,d);var r=(0,c.default)(this,(d.__proto__||(0,s.default)(d)).call(this,n));return r.code=d.CODE,r.name=e,r.reason=t,r}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function T(e,t){return t in e?e[t].value:null}Object.defineProperty(t,"__esModule",{value:!0}),t.CONTACTS_ORG_ID=void 0,t.default=function(e,t){var k=t.host,n=e.defineModel("organization",{instanceEvents:!0,replaceKeys:{allowMsgForward:"__isForwardAllowed",allowPublicGroups:"forumsEnabled",allowRoleScheduleUpload:"__isRolesScheduleUploadEnabled",desktopPriorityMessaging:"__desktopPriorityMessagingSounds",eula:"eulaEnabled",eulaContent:"eulaUrl",featurePatientCare:"__canShowPatientCare",featurePatientNetwork:"__canShowPatientNetwork",featureRoleScheduleUpload:"__canUploadRolesSchedule",featureRoleService:"rolesEnabled",featureRolesEscalation:"__canEscalateMessages",featureTeams:"__canShowTeams",featureTransactions:"canShowTransactions",latestIncomingMessageSortNumber:"lastIncomingMessageSortNumber",members:"memberCount",organizationKey:"organizationId",patientCare:"__showPatientCare",patientNetwork:"__showPatientNetwork",pfNoAttachment:"__isPFAttachmentAllowed",pfNoPhoto:"__isPFPhotoAllowed",roleService:"canAdminRoles",rolesEscalation:"__isRolesEscalationEnabled",ssoWebSessionDuration:"desktopExtendedSession",teams:"__showTeams"},defaultValues:{__canEscalateMessages:!1,__canShowPatientCare:!1,__canShowTeams:!1,__canUploadRolesSchedule:!1,__isForwardAllowed:!1,__isPFAttachmentAllowed:!1,__isPFPhotoAllowed:!1,__isRolesEscalationEnabled:!1,__isRolesScheduleUploadEnabled:!1,__showPatientCare:!1,__showTeams:!1,canAdminRoles:!1,canShowTransactions:!1,desktopExtendedSession:-1,forumsEnabled:!1,highestSortNumber:0,isPatientNetworkEnabled:!1,lastIncomingMessageSortNumber:0,networks:null,paid:!1,rolesEnabled:!1,settings:{},unreadCount:0,unreadPriorityCount:0},transientAttrs:["unreadCount","unreadPriorityCount"],parseAttrs:function(e){var t;e.settings&&(e.settings=(t=(t=e.settings,o.default).call(t,function(e){return i.default.camelizeKey(e.name)}),a.default).call(t,function(e){isFinite(e.value)&&(e.value=+e.value),"true"===e.value&&(e.value=!0),"false"===e.value&&(e.value=!1)}));return e},afterAssignment:function(e){var t=e.__canEscalateMessages,n=e.__canShowPatientCare,r=e.__canShowPatientNetwork,o=e.__canShowTeams,a=e.__canUploadRolesSchedule,i=e.__desktopPriorityMessagingSounds,s=e.__isForwardAllowed,u=e.__isPFAttachmentAllowed,c=e.__isPFPhotoAllowed,l=e.__isRolesEscalationEnabled,f=e.__isRolesScheduleUploadEnabled,d=e.__showPatientCare,p=e.__showPatientNetwork,h=e.__showTeams,y=e.autoForwardReceiverId,v=e.id,g=e.name,m=e.paid,b=e.settings;h=h&&!!T(b,"teams"),p="individual"===p?!!T(b,"patientNetwork"):!!p,y=T(b,"dndAutoForwardReceiver"),e.allowPriorityMessage=!!T(b,"priorityMessaging"),e.autoLogoutMinutes=T(b,"autologoutTime")||1440,e.canUploadRolesSchedule=a&&f,e.deleteOnRead=!!T(b,"dor"),e.desktopAutoUpdate=!!T(b,"autoUpdate"),e.isEulaAccepted=!T(b,"eula"),e.isForwardAllowed=s&&1===T(b,"forward"),e.messageTimeToLive=T(b,"ttl")||-1,e.isPatientBroadcastEnabled=!!T(b,"pfBroadcast"),e.isPatientScheduledMessagesEnabled=!!T(b,"pfScheduleMessages"),e.isPFVideoCallEnabled=!!T(b,"pfVideoCall"),e.isPFVoiceCallEnabled=!!T(b,"pfVoiceCall"),e.isPFGroupVideoCallEnabled=!!T(b,"pfGroupVideoCall"),e.isPFGroupVoiceCallEnabled=!!T(b,"pfGroupVoiceCall"),e.isPFAttachmentAllowed=!u,e.isPFPhotoAllowed=!c;var _=e.id===A;if(e.allowedSenders=k.organizations._getAllowedSenders(e),e.autoForwardReceiverId=y,e.autoForwardReceiver=y?k.models.User.get(y):null,e.canEscalateMessages=t&&l,e.desktopPriorityMessagingSounds=m&&i,e.displayName=_?"Contacts":g,e.isContacts=_,e.showPatientCare=n&&d,e.isPatientNetworkEnabled=r&&p,k.currentUser&&(k.currentUser.isPatient||k.currentUser.isPatientContact)&&r&&(e.isPatientNetworkEnabled="off"!==p),e.showTeams=o&&h,e.userRoles=k.userRoles.getByOrganizationId(v),e.networks||(e.networks={}),e.networks.provider||(e.networks.provider={unreadCount:0,unreadPriorityCount:0}),e.networks.patient||(e.networks.patient={dnd:!1,dndText:"",unreadCount:0,unreadPriorityCount:0}),e.network){var w=e.network.patient,x=w.dnd,E=w.dndText;e.networks.patient.dnd=x,e.networks.patient.dndText=null!==E?E:"",delete e.network}},methods:{getSettingValue:function(e){return T(this.settings,e)},getSettingEntry:function(e){return this.settings&&e in this.settings?this.settings[e]:null}},relations:{hasMany:{__expirableMessages:{type:"message",foreignKey:"__organizationId",filter:function(e){return!!e.expiresAt},sortBy:[["expiresAt","asc"],["id","asc"]]},__expirableMutes:{type:"mute",foreignKey:"organizationId",filter:function(e){return!!e.expiresAt},sortBy:[["expiresAt","asc"],["id","asc"]]},__markingAsReadConversations:{type:"conversation",foreignKey:"organizationId",filter:function(e){return!!e._markingAsRead},sortBy:[["_markingAsReadExpiration","asc"],["id","asc"]]},conversations:{type:"conversation",foreignKey:"organizationId",filter:function(e){var t=e.counterParty;return!!t&&t.groupType!==s.GroupType.ROLE_ASSIGNMENT},sortBy:[["highestSortNumber","desc"],["_origIndex","asc"],["id","asc"]]},messageTemplates:{type:"messageTemplate",foreignKey:"organizationId",sortBy:[["title","asc"]]},roles:{type:"role",foreignKey:"organizationId"},roleTags:{type:"roleTag",foreignKey:"organizationId"}}}});return(0,u.default)(n,{finder:function(){var e;return(e=k.organizations).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return k.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return k.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Organization..."},defaultNotFoundAttrs:{displayName:"<Organization Not Found>"}}),n};var o=r(n(703)),a=r(n(700)),i=r(n(45)),s=n(36),u=r(n(92)),A=t.CONTACTS_ORG_ID="UpM28mnfW65vJkbqEATtKvxm"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({ACKNOWLEDGED:{serverValue:"confirmed"},CANCELLED:{serverValue:"cancelled"},IN_PROGRESS:{serverValue:"in_progress"},NO_RESPONSE:{serverValue:"no_response"}});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["PATIENT","PROVIDER"]);t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({UNKNOWN:{serverValue:"unknown"},AVAILABLE:{serverValue:"available"},UNAVAILABLE:{serverValue:"unavailable"}});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["GLOBAL","GROUP","ORGANIZATION"],{valueFn:function(e){return e.toLowerCase()}});t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["VISIBLE","HIDDEN","PRERENDER"]);t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.cloudFrontUrlTransform=void 0;var s=r(n(875)),u=r(n(115));t.cloudFrontUrlTransform=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!n||(0,u.default)(e.cloudfront))return n;var t=e.cloudfront,r=(0,s.default)(t,function(e,t){return-1!==n.indexOf(t)}),o=t[r]?r+"."+e.cloudfrontDomain:"",a=t[r]?e.assetDomain+"/"+t[r]:"",i=o&&a?n.replace(o,a):n;return i.replace("http://","https://")}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={WAITING:-1,CONNECTING:0,OPEN:1,CLOSED:2},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function v(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,_.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=v(t[0],n);return t.every(function(e){return v(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return v(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+v(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function g(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,_.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=g(t[0],n);return t.every(function(e){return g(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return g(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+g(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0});var o,a,i,s=r(n(5)),m=r(n(10)),b=r(n(4)),_=r(n(3)),w=r(n(13)),x=r(n(12)),u=r(n(9)),c=r(n(1)),l=r(n(2)),f=n(900),d=n(122),p=r(n(268)),h=["application/json","text/plain"],y=((0,l.default)(E,[{key:"appendField",value:(i=(0,u.default)(m.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(y)){e.next=43;break}if(n=0,!y||"function"!=typeof y[x.default]&&!Array.isArray(y))throw new TypeError("Expected fieldValue to be iterable, got "+v(y));e.next=4;break;case 4:if(!y||"function"!=typeof y[x.default]&&!Array.isArray(y))throw new TypeError("Expected fieldValue to be iterable, got "+g(y));e.next=6;break;case 6:o=!(r=!0),a=void 0,e.prev=9,i=(0,w.default)(y);case 11:if(r=(s=i.next()).done){e.next=27;break}if(u=s.value,"data"!==t||"object"!==(void 0===u?"undefined":(0,_.default)(u))){e.next=22;break}if(c=u.mimetype,l=void 0===c?"application/json":c,f=u.namespace,d=u.payload,p=void 0===d?"":d,f){e.next=17;break}throw new Error("Missing namespace on data["+n+"] object");case 17:h={"TT-X-Namespace":f},this._appendParsedField(t,{fieldValue:String(p),mimetype:l,filename:null,headers:h}),e.next=23;break;case 22:this.appendField(t,u);case 23:n++;case 24:r=!0,e.next=11;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(9),o=!0,a=e.t0;case 33:e.prev=33,e.prev=34,!r&&i.return&&i.return();case 36:if(e.prev=36,o)throw a;e.next=39;break;case 39:return e.finish(36);case 40:return e.finish(33);case 41:e.next=45;break;case 43:y&&y.nodeType&&y.nodeName&&y.getAttribute&&(y=y.value),"object"===(void 0===y?"undefined":(0,_.default)(y))?this._appendParsedField(t,{fieldValue:(0,b.default)(y),mimetype:"application/json"}):this._appendParsedField(t,{fieldValue:String(y),mimetype:"text/plain"});case 45:case"end":return e.stop()}},e,this,[[9,29,33,41],[34,,36,40]])})),function(e){return i.apply(this,arguments)})},{key:"_appendParsedField",value:function(e,t){var n=t.fieldValue,r=t.filename,o=t.headers,a=t.mimetype,i=this.body.fields;r?r=(0,d.doubleEncodeUtf8)(r):n=(0,d.doubleEncodeUtf8)(n),h.includes(a)&&(a+='; charset="utf-8"');var s=new f.RequestField(n,a,r,o);i.hasOwnProperty(e)?(Array.isArray(i[e])||(i[e]=[i[e]]),i[e].push(s)):i[e]=s}},{key:"appendFile",value:(a=(0,u.default)(m.default.mark(function e(t,n){var r;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="",n)return e.next=4,(0,p.default)(n,{idx:this.fileIdx++});e.next=5;break;case 4:r=e.sent;case 5:this._appendParsedField(t,r);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})},{key:"getContentType",value:function(){return this.body.getContentType()}},{key:"getPayload",value:(o=(0,u.default)(m.default.mark(function e(){var t;return m.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.next=4;break;case 4:return t=this.body.getData(),e.abrupt("return",new Blob([t]));case 7:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})}]),E);function E(){(0,c.default)(this,E),this.body=new f.RequestBody,this.fileIdx=0,this.body.setType("multipart")}t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(y){var v=this;return w.default.resolve().then((0,c.default)(x.default.mark(function e(){var o,a,i,s,u,c,t,n,r,l,f,d,p,h;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=[],u=s=void(i=a=0),(c=new FileReader).addEventListener("load",function(){return s&&s(c.result)},!1),c.addEventListener("error",function(e){return u&&u(e)},!1),t=x.default.mark(function e(){var t,n,r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0<i)return e.next=3,new w.default(function(e){return setTimeout(e,T)});e.next=3;break;case 3:return t=i+A,n=y.slice(i,t),i=t,e.next=8,new w.default(function(e,t){s=e,u=t,c.readAsArrayBuffer(n)});case 8:r=e.sent,o.push(r),a+=r.byteLength;case 11:case"end":return e.stop()}},e,v)});case 9:if(i<y.size)return e.delegateYield(t(),"t0",11);e.next=13;break;case 11:e.next=9;break;case 13:if(n=new Uint8Array(a),i=0,!o||"function"!=typeof o[_.default]&&!Array.isArray(o))throw new TypeError("Expected chunks to be iterable, got "+g(o));e.next=17;break;case 17:if(!o||"function"!=typeof o[_.default]&&!Array.isArray(o))throw new TypeError("Expected chunks to be iterable, got "+m(o));e.next=19;break;case 19:for(l=!(r=!0),f=void 0,e.prev=22,d=(0,b.default)(o);!(r=(p=d.next()).done);r=!0)h=p.value,n.set(new Uint8Array(h),i),i+=h.byteLength;e.next=30;break;case 26:e.prev=26,e.t1=e.catch(22),l=!0,f=e.t1;case 30:e.prev=30,e.prev=31,!r&&d.return&&d.return();case 33:if(e.prev=33,l)throw f;e.next=36;break;case 36:return e.finish(33);case 37:return e.finish(30);case 38:return e.abrupt("return",{fieldValue:(0,k.arrayBufferToBinaryString)(n.buffer),mimetype:y.type||E.DEFAULT_MIME_CONTENT_TYPE,filename:y.name});case 39:case"end":return e.stop()}},e,v,[[22,26,30,38],[31,,33,37]])})))}function g(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=g(t[0],n);return t.every(function(e){return g(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return g(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+g(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function m(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=m(t[0],n);return t.every(function(e){return m(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return m(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+m(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0});var a,i=r(n(4)),s=r(n(5)),u=r(n(3)),b=r(n(13)),_=r(n(12)),w=r(n(19)),x=r(n(10)),c=r(n(9)),l=(a=(0,c.default)(x.default.mark(function e(t,n){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r="",e.next=7;break;case 4:r=e.sent,e.next=11;break;case 7:return e.next=10,o(t);case 10:r=e.sent;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)}),E=n(174),k=n(122),T=100,A=1048576;t.default=l,e.exports=t.default},function(e,t,n){},function(e,t,n){"use strict";!function(){try{var e=n(960).request().constructor.prototype;e.setNoDelay||(e.setNoDelay=function(){}),e.abort||(e.abort=function(){this.xhr&&this.xhr.abort()})}catch(e){}}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function m(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,s.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=m(t[0],n);return t.every(function(e){return m(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return m(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+m(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function b(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,s.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=b(t[0],n);return t.every(function(e){return b(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return b(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+b(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i=r(n(4)),s=r(n(3)),u=r(n(47)),c=r(n(5)),l=r(n(16)),_=r(n(20)),w=r(n(24)),x=r(n(13)),E=r(n(12)),h=r(n(10)),y=r(n(9)),v=r(n(6)),g=r(n(1)),f=r(n(2)),k=r(n(8)),d=r(n(7)),p=r(n(340)),T=r(n(264)),A=r(n(449)),I=r(n(257)),O=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),j=r(n(123)),S=n(29),M=r(n(15)),R=["message:is_typing","presence","remote_wipe","sse:heartbeat"],C=["message:is_typing","presence","sse:heartbeat"],P=["00000000-0000-0000-0000-000000000001"],z=["remote_wipe"],V={autoDeliver:"auto-deliver",canConfirm:"can-confirm",closeAfterMessages:"close-after-messages",heartbeat:"heartbeat_5",hidden:"hidden",includeDistributionListEvents:"dl_sender_event",isTyping:"is-typing",keepAlive:"keep_alive_15_1",msgDeliveryDelay:"msg_delivery_delay",multiOrg:"multi-org",noOfflineMessages:"no-offline-messages",renderMetadata:"render_metadata",singleConversation:"single_conversation"},G={events:{allowManualRequestBatch:!0,basicAuthParam:"auth_basic",features:null,requiresBasicAuth:!1,routerName:"eventRouter",url:"/events"},simpleNotifications:{allowManualRequestBatch:!1,basicAuthParam:"auth",features:{heartbeat:!0},requiresBasicAuth:!0,routerName:"notificationRouter",url:"/events/simple_notifications"}},N=(o=M.default,(0,d.default)(D,o),(0,f.default)(D,[{key:"mounted",value:function(){this._throttled_flushQueuedAcks=(0,p.default)(this._flushQueuedAcks,this.config.flushAckInterval,{leading:!1}),this.__allEvents=[],this._connectionRetryCount=0,this._eventQueue=[],this._eventQueueDeferred=!1,this._eventQueueIsManual=!1,this._eventQueueTimeout=null,this._heartbeatInterval=this.config.eventsHeartbeatIntervalVisible,this._heartbeatTimeout=null,this._lastHeartbeatTime=null,this._openTimeout=null,this._pendingAckConnections=0,this._processedEventIds={},this._queuedAcks=[],this._reconnectWhenQueuesAreEmpty=!1,this._reconnectWhenQueuesAreEmpty=!1,this._retryHistoryTimeout=null,this._visibilityState=T.default.VISIBLE,this.isConnected=!1,this.isOpen=!1;var e=n(401);this.visibilityListenerId=e.change(this._onVisibilityChange)}},{key:"dispose",value:function(){this._throttled_flushQueuedAcks.cancel&&this._throttled_flushQueuedAcks.cancel(),this.disconnect({source:"EventsService cleanup"}),null!==this.visibilityListenerId&&(n(401).unbind(this.visibilityListenerId),this.visibilityListenerId=null)}},{key:"setAuth",value:function(e){this._auth=(0,l.default)({basicAuthParam:this.basicAuthParam},e)}},{key:"removeAuth",value:function(){this._auth=null}},{key:"getAuth",value:function(){return this._auth}},{key:"connect",value:function(){var a=this;if(!this.isSignedIn)throw this._cancelSessionTimers({source:"Connection attempt while not signed in"}),new O.NotSignedInError;if(this.requiresBasicAuth&&(!this._auth.key||!this._auth.secret))throw this._cancelSessionTimers({source:"Connection attempt without valid authorization"}),new O.RequiresBasicAuthError;if(this.eventSource)throw new Error("Already connected to EventSource");var e=[];if(!(s=(0,w.default)(this.features||this.config.events))||"function"!=typeof s[E.default]&&!Array.isArray(s))throw new TypeError("Expected _Object$entries2 to be iterable, got "+m(s));if(!s||"function"!=typeof s[E.default]&&!Array.isArray(s))throw new TypeError("Expected _Object$entries2 to be iterable, got "+b(s));var t=!0,n=!1,r=void 0;try{for(var o,i=(0,x.default)(s);!(t=(o=i.next()).done);t=!0){var s,u=(0,_.default)(o.value,2),c=u[0],l=u[1];if(l||0===l){var f=V[c],d=!0===l?f:f+":"+l;e.push(d)}}}catch(a){n=!0,r=a}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}var p=e.join(",");this.logger.info("connecting "+this.endpointType+". networkStatus="+this.httpClient.networkStatus+" features="+p);var h=!this._watchingNetworkConnection;if(this.httpClient.networkStatus!==j.default.OFFLINE&&h&&this.httpClient._setNetworkStatus(j.default.CONNECTING),this._watchNetworkConnection(),this.httpClient.networkStatus===j.default.OFFLINE)throw new Error("Cannot connect while network is offline, but will autoconnect when online");this._isClosed=!1,this._isHeartbeatTimeout=!1,this._reconnectWhenQueuesAreEmpty=!1,this._requestedClose=!1;var y=void 0,v=!1,g=!1;this._openTimeout=setTimeout(function(){a._openTimeout=null,g=!0,y.close()},this.config.eventsOpenTimeout),this.eventSource=y=this.host.eventSourceClient.createEventSource(this.url,{auth:this._auth,features:p,onOpen:function(){a.logger.info("open"),a._cancelSessionTimers({source:"Event source opened"}),a._setHeartbeatTimeout(),v=!0,a.isOpen=!0,a.emit("opened")},onMessage:function(e,t){var n=t.isFirstMessage;a._setHeartbeatTimeout(),n&&(a._setRetryHistoryTimeout(),a.isConnected=!0,a.emit("connected")),a._queueEvent(e)},onError:function(e){var t=!!e&&a.httpClient.isUnauthorizedError(e),n=a._isHeartbeatTimeout,r=a.httpClient.networkStatus,o=a._requestedClose;n?e=new Error("No activity within "+a._heartbeatInterval+" milliseconds; reconnecting"):g&&(e=new Error("Open timed out after "+a.config.eventsOpenTimeout+" milliseconds; reconnecting")),a.logger.info("error",e,e.message||"",e.code||"",void 0!==e.status?e.status:""),a.__allEvents.push({clientDisconnect:{error:{code:e.code,message:e.message,status:e.status},hasConnected:v,isHeartbeatTimeout:n,isUnauthorized:t,networkStatus:r,openTimedOut:g,requestedClose:o,timestamp:new Date}}),o||(t?a.disconnect({isRecoverable:!1,source:"Unauthorized during eventSource error handling"}):r!==j.default.OFFLINE&&(v||0!==a._connectionRetryCount||(a._connectionRetryCount=1),a._disconnectAndRetry()))}}),this.eventSource.start()}},{key:"_scheduleConnectRetry",value:function(){var e=this;this._cancelSessionTimers({source:"Scheduling connection retry"}),this.logger.info("scheduleConnectRetry",this._connectionRetryCount);var t=Math.min(this.config.eventsAutoReconnectDelay*this._connectionRetryCount,this.config.eventsAutoReconnectMaxDelay);this._scheduleConnectRetryTimeout=setTimeout(function(){return e.connect()},t),this._connectionRetryCount++}},{key:"_watchNetworkConnection",value:function(){this._watchingNetworkConnection||(this._watchingNetworkConnection=!0,this.host.on("networkStatus:change",this.onNetworkStatusChanged))}},{key:"_unwatchNetworkConnection",value:function(){this._watchingNetworkConnection&&(this.host.removeListener("networkStatus:change",this.onNetworkStatusChanged),this._watchingNetworkConnection=!1)}},{key:"_cancelSessionTimers",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).source;this._heartbeatTimeout&&(clearTimeout(this._heartbeatTimeout),this._heartbeatTimeout=null),this._openTimeout&&(clearTimeout(this._openTimeout),this._openTimeout=null),this._scheduleConnectRetryTimeout&&(this.__allEvents.push({cancelSessionTimer:{source:e,timestamp:new Date}}),clearTimeout(this._scheduleConnectRetryTimeout),this._scheduleConnectRetryTimeout=null),null!==this._eventQueueTimeout&&(clearTimeout(this._eventQueueTimeout),this._eventQueueTimeout=null)}},{key:"_setHeartbeatTimeout",value:function(e){var t=this;this._heartbeatTimeout&&clearTimeout(this._heartbeatTimeout),void 0!==e&&(this._heartbeatInterval=e),this._heartbeatTimeout=setTimeout(function(){t._heartbeatTimeout=null,t._isHeartbeatTimeout=!0,0===t._connectionRetryCount&&(t._connectionRetryCount=1),t._disconnectAndRetry()},this._heartbeatInterval)}},{key:"_cancelRetryHistoryTimeout",value:function(){this._retryHistoryTimeout&&(clearTimeout(this._retryHistoryTimeout),this._retryHistoryTimeout=null)}},{key:"_setRetryHistoryTimeout",value:function(){var e=this;this._retryHistoryTimeout&&clearTimeout(this._retryHistoryTimeout),this._retryHistoryTimeout=setTimeout(function(){e._retryHistoryTimeout=null,e._connectionRetryCount=0},this.config.eventsClearRetryHistoryInterval)}},{key:"reconnect",value:function(){this._connectionRetryCount=0,this.disconnect({unwatchNetwork:!1,source:"Reconnect"}),this.connect()}},{key:"_disconnectAndRetry",value:function(){var e=this;this.__allEvents.push({eventsDisconnectAndRetry:{eventQueueLength:this._eventQueue.length,pendingAckConnections:this._pendingAckConnections,queuedAcksLength:this._queuedAcks.length,connectionRetryCount:this._connectionRetryCount,timestamp:new Date}}),this.disconnect({clearQueues:!1,unwatchNetwork:!1,source:"Disconnect and retry"}),this.config.eventsAutoReconnect&&(this._reconnectWhenQueuesAreEmpty=!0),this.config.eventsAutoReconnect&&0===this._eventQueue.length&&0===this._pendingAckConnections&&0===this._queuedAcks.length?this._scheduleConnectRetry():this.config.eventsAutoReconnect&&(this._scheduleConnectRetryTimeout=setTimeout(function(){return e.connect()},this.config.eventDrainTimeout)),0<this._eventQueue.length&&this._scheduleEventQueue({immediate:!0}),(0<this._pendingAckConnections||0<this._queuedAcks.length)&&this._flushQueuedAcks()}},{key:"disconnect",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.clearQueues,n=void 0===t||t,r=e.isRecoverable,o=void 0===r||r,a=e.unwatchNetwork,i=void 0===a||a,s=e.source;if(this.__allEvents.push({eventsDisconnect:{clearQueues:n,source:s,unwatchNetwork:i}}),this._cancelSessionTimers({source:"Disconnect"}),this._cancelRetryHistoryTimeout(),i&&this._unwatchNetworkConnection(),this.eventSource){var u=this.eventSource;this.eventSource=null,this._requestedClose=!0,this._isClosed||(this._isClosed=!0,u.close()),this.emit("disconnected",{isRecoverable:o})}this.isConnected=!1,this.isOpen=!1,n&&(this._eventQueue=[],this._queuedAcks=[])}},{key:"_queueEvent",value:function(e){var t=e.data;if(t){if(z.some(function(e){return t.includes(e)})){var n=void 0;try{n=JSON.parse(t)}catch(e){return this.logger.error("error parsing SSE payload: <"+t+">"),void this._disconnectAndRetry()}var r=(0,c.default)(n.event)[0].replace("tigertext:iq:","");if(z.includes(r)){this.disconnect({source:"Immediate event "+r});var o=n.event_id;return void this._processImmediateEvent(o,t)}}this._eventQueue.push(t),this._scheduleEventQueue()}}},{key:"_handleEvent",value:function(e){var t=e.event_id;if(this._autoAck||!this._processedEventIds[t]||P.includes(t)){var n=(0,c.default)(e.event)[0],r=n.replace("tigertext:iq:",""),o=e.event[n];!this.config.eventsDebugging&&C.includes(r)||this.__allEvents.push(e),"sse:heartbeat"===r&&(this._lastHeartbeatTime=Date.now()),this.logger.debug("incoming",r,o);var a=new A.default(t,r,o);try{this.router.emit(a),this.emit("event",a),this._autoAck?R.includes(r)||this.__queueAck(t):this._processedEventIds[t]=!0}catch(e){this.logger.error("error in event "+r,e,e.stack,{data:o}),this.disconnect({isRecoverable:!1,source:"Error in event "+r})}}}},{key:"__queueAck",value:function(e){var t;e=(0,S.arrayWrap)(e),(t=this._queuedAcks).push.apply(t,(0,u.default)(e)),this._throttled_flushQueuedAcks()}},{key:"ack",value:(a=(0,y.default)(h.default.mark(function e(t){var n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.requireUser(),n=!1,t=(0,S.arrayWrap)(t),this.logger.log("ack",t),this._pendingAckConnections++,e.prev=5,e.next=8,this.host.api.events.ack(t);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(5),n=this.httpClient.isUnauthorizedError(e.t0),this.logger.warn("some events not acked",t);case 14:this._pendingAckConnections--,n&&(this.logger.warn("no longer authorized, terminating session"),this.disconnect({isRecoverable:!1,source:"Unauthorized during ack"}));case 16:case"end":return e.stop()}},e,this,[[5,10]])})),function(e){return a.apply(this,arguments)})},{key:"_autoAck",get:function(){return"events"===this.endpointType&&this.config.autoAckSuccessfullyHandledEvents}},{key:"hasConnection",get:function(){return!!this.eventSource}},{key:"isSignedIn",get:function(){return!!this._auth}},{key:"router",get:function(){return this.host[this.routerName]}},{key:"url",get:function(){var e=G[this.endpointType].url;return"/"+("events"===this.endpointType&&this.config.condensedReplays?"v5":"v2")+e}}]),D);function D(e,t){var o=this;(0,g.default)(this,D);var n,l=(0,k.default)(this,(D.__proto__||(0,v.default)(D)).call(this,e,t));if(l.onNetworkStatusChanged=function(e){var t=e.networkStatus,n=e.previousStatus;if(l.__allEvents.push({networkStatusChange:{previousStatus:n,networkStatus:t,timestamp:new Date}}),t===j.default.CONNECTING){if(l._reconnectIfHeartbeatIntervalPassed()&&l.eventSource)return;l._connectionRetryCount=1,l._disconnectAndRetry()}else t===j.default.OFFLINE&&(l._connectionRetryCount=0,l.disconnect({unwatchNetwork:!1,source:"Network went offline"}))},l._closeAllConnections=(0,y.default)(h.default.mark(function e(){var t,n,r;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.eventSource)throw new Error("Existing connections must be closed first");e.next=2;break;case 2:if("simpleNotifications"!==l.endpointType){e.next=10;break}if(t=l._auth,n=t.key,r=t.secret,n&&r){e.next=6;break}throw new O.RequiresBasicAuthError;case 6:return e.next=8,l.host.api.notifications.closeAllConnections(n,r);case 8:e.next=12;break;case 10:return e.next=12,l.host.api.events.closeAllConnections();case 12:case"end":return e.stop()}},e,o)})),l._processImmediateEvent=(n=(0,y.default)(h.default.mark(function e(t,n){return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l._eventQueue=[n],l._eventQueueDeferred=!1,l._autoAck)return e.next=5,l.ack([t]);e.next=5;break;case 5:l.processEventQueue();case 6:case"end":return e.stop()}},e,o)})),function(e,t){return n.apply(this,arguments)}),l._scheduleEventQueue=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).immediate,t=void 0!==e&&e;if(l.allowManualRequestBatch&&l.config.manuallyRequestEventQueueBatch&&(l._eventQueueIsManual=!0),t&&(clearTimeout(l._eventQueueTimeout),l._eventQueueTimeout=null),null===l._eventQueueTimeout){var n=l.config.eventCollectionInterval;if(t||null===n)l._eventQueueIsManual?l._emitBatch({immediate:t}):l.processEventQueue(l._eventQueue.length);else{var r=l._eventQueueIsManual?l._emitBatch:l.processEventQueue;l._eventQueueTimeout=setTimeout(r,n)}}},l._emitBatch=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).immediate,t=void 0!==e&&e;l._eventQueueTimeout=null,l.emit("batch:available",{maxEventBatch:l._eventQueue.length,immediate:t})},l.deferEventQueue=function(){l._eventQueueDeferred=!0,l._eventQueueTimeout&&(clearTimeout(l._eventQueueTimeout),l._eventQueueTimeout=null)},l.resumeEventQueue=function(){l._eventQueueDeferred=!1,l._eventQueueTimeout&&(clearTimeout(l._eventQueueTimeout),l._eventQueueTimeout=null),0<l._eventQueue.length&&l._scheduleEventQueue()},l.processEventQueue=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:l.config.maxEventBatch;if(l._eventQueueIsManual||(l._eventQueueTimeout=null),!l._eventQueueDeferred&&0!==l._eventQueue.length){var t=void 0,n=void 0,r=void 0;try{var o=l._eventQueue.splice(0,e);if(!o||"function"!=typeof o[E.default]&&!Array.isArray(o))throw new TypeError("Expected lines to be iterable, got "+m(o));if(!o||"function"!=typeof o[E.default]&&!Array.isArray(o))throw new TypeError("Expected lines to be iterable, got "+b(o));var a=!0,i=!1,s=void 0;try{for(var u,c=(0,x.default)(o);!(a=(u=c.next()).done);a=!0)t=u.value,n=!1,r=JSON.parse(t),n=!0,l._handleEvent(r)}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}0<l._eventQueue.length?l._scheduleEventQueue():l._reconnectWhenQueuesAreEmpty&&0===l._queuedAcks.length&&0===l._pendingAckConnections&&l._scheduleConnectRetry()}catch(e){n?(l.logger.error("error while processing SSE payload",e,e.stack,{data:r}),l.disconnect({isRecoverable:!1,source:"Error processing SSE payload"})):(l.logger.error("error parsing SSE payload: <"+t+">"),l._disconnectAndRetry())}}},l._flushQueuedAcks=(0,y.default)(h.default.mark(function e(){var t,n;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===l._queuedAcks.length)return e.abrupt("return");e.next=2;break;case 2:if(l._pendingAckConnections>=l.config.flushAckMaxConnections)return l._throttled_flushQueuedAcks(),e.abrupt("return");e.next=5;break;case 5:if(t=l._queuedAcks.splice(0,l.config.flushAckMaxEvents),n=l.ack(t),!(0<l._queuedAcks.length)){e.next=11;break}l._throttled_flushQueuedAcks(),e.next=19;break;case 11:return e.prev=11,e.next=14,n;case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:l._reconnectWhenQueuesAreEmpty&&0===l._eventQueue.length&&0===l._pendingAckConnections&&l._scheduleConnectRetry();case 19:case"end":return e.stop()}},e,o,[[11,16]])})),l._onVisibilityChange=function(e,t){t=t.toUpperCase();var n=l._visibilityState;l._visibilityState=t,l.isConnected&&(l.__allEvents.push({visibilityChange:{previousState:n,state:t,timestamp:new Date}}),t===T.default.HIDDEN?(l.host.configure({eventCollectionInterval:null}),l._setHeartbeatTimeout(l.config.eventsHeartbeatIntervalInvisible)):t===T.default.VISIBLE&&(l.host.configure({eventCollectionInterval:I.default.eventCollectionInterval}),l._setHeartbeatTimeout(l.config.eventsHeartbeatIntervalVisible))),n===T.default.HIDDEN&&t===T.default.VISIBLE&&l.httpClient.networkStatus===j.default.CONNECTING&&l._reconnectIfHeartbeatIntervalPassed(),l.emit("visibilityChange",e,t)},l._reconnectIfHeartbeatIntervalPassed=function(){return null!==l._lastHeartbeatTime&&(Date.now()-l._lastHeartbeatTime>=l._heartbeatInterval&&(l._lastHeartbeatTime=null,l.reconnect(),!0))},l.endpointType||(l.endpointType="events"),!(c=(0,w.default)(G[l.endpointType]))||"function"!=typeof c[E.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+m(c));if(!c||"function"!=typeof c[E.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+b(c));var r=!0,a=!1,i=void 0;try{for(var s,u=(0,x.default)(c);!(r=(s=u.next()).done);r=!0){var c,f=(0,_.default)(s.value,2),d=f[0],p=f[1];"url"!==d&&(l[d]=p)}}catch(e){a=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}return l}t.default=N,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.allExtensions=t.allContentTypes=void 0;var o=r(n(13)),s=r(n(4)),u=r(n(3)),c=r(n(5)),a=r(n(12));t.getMimeEntryByContentType=function(e){return l[e]},t.getMimeEntryByExtension=function(e){return e&&"."===e[0]&&(e=e.slice(1)),f[e]};var i=[{ext:"csv",mime:"text/csv"},{ext:"csv",mime:"text/plain"},{ext:"doc",mime:"application/msword"},{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},{ext:"gif",mime:"image/gif"},{ext:"gz",mime:"application/gzip"},{ext:"gz",mime:"application/x-gzip"},{ext:"gz",mime:"application/x-compressed"},{ext:"jpg",mime:"image/jpeg"},{ext:"jpeg",mime:"image/jpeg"},{ext:"m4a",mime:"audio/m4a"},{ext:"m4a",mime:"audio/x-m4a"},{ext:"m4a",mime:"audio/mp4"},{ext:"m4v",mime:"video/x-m4v"},{ext:"mov",mime:"video/quicktime"},{ext:"mp3",mime:"audio/mpeg"},{ext:"mp3",mime:"audio/mp3"},{ext:"mp3",mime:"audio/mpeg3"},{ext:"mp3",mime:"audio/x-mpeg"},{ext:"mp3",mime:"audio/x-mpeg-3"},{ext:"mp3",mime:"video/mpeg"},{ext:"mp3",mime:"video/x-mpeg"},{ext:"mp4",mime:"video/mp4"},{ext:"pdf",mime:"application/pdf"},{ext:"png",mime:"image/png"},{ext:"ppsx",mime:"application/vnd.openxmlformats-officedocument.presentationml.slideshow"},{ext:"ppt",mime:"application/vnd.ms-powerpoint"},{ext:"ppt",mime:"application/ms-powerpoint"},{ext:"ppt",mime:"application/mspowerpoint"},{ext:"ppt",mime:"application/powerpoint"},{ext:"ppt",mime:"application/x-mspowerpoint"},{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"},{ext:"svg",mime:"image/svg+xml"},{ext:"txt",mime:"text/plain"},{ext:"wav",mime:"audio/wav"},{ext:"wav",mime:"audio/wave"},{ext:"wav",mime:"audio/x-pn-wav"},{ext:"wav",mime:"audio/x-wav"},{ext:"xls",mime:"application/vnd.ms-excel"},{ext:"xls",mime:"application/excel"},{ext:"xls",mime:"application/x-excel"},{ext:"xls",mime:"application/x-msexcel"},{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},{ext:"zip",mime:"application/zip"}],l={},f={};if("function"!=typeof i[a.default]&&!Array.isArray(i))throw new TypeError("Expected supportedMimeEntries to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,u.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,s.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(i));if("function"!=typeof i[a.default]&&!Array.isArray(i))throw new TypeError("Expected supportedMimeEntries to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,u.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,s.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(i));var d=!0,p=!1,h=void 0;try{for(var y,v=(0,o.default)(i);!(d=(y=v.next()).done);d=!0){var g=y.value,m=g.ext,b=g.mime;l[b]||(l[b]=[]),l[b].push(g),f[m]||(f[m]=[]),f[m].push(g)}}catch(e){p=!0,h=e}finally{try{!d&&v.return&&v.return()}finally{if(p)throw h}}t.allContentTypes=(0,c.default)(l),t.allExtensions=(0,c.default)(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(11),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e,t){var n=(0,a.default)(e,t);return n&&n.configurable},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(4),a=(r=o)&&r.__esModule?r:{default:r};t.default=function(e){return void 0!==e?JSON.parse((0,a.default)(e)):null},e.exports=t.default},function(e,t,n){e.exports={default:n(551),__esModule:!0}},function(e,t,n){e.exports={default:n(553),__esModule:!0}},function(e,t,n){var r=n(31).document;e.exports=r&&r.documentElement},function(e,t,n){e.exports=!n(39)&&!n(68)(function(){return 7!=Object.defineProperty(n(180)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(78),o=n(27)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[o]===e)}},function(e,t,n){var r=n(96);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var a=n(48);e.exports=function(e,t,n,r){try{return r?t(a(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&a(o.call(e)),t}}},function(e,t,n){var a=n(27)("iterator"),i=!1;try{var r=[7][a]();r.return=function(){i=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var r=[7],o=r[a]();o.next=function(){return{done:n=!0}},r[a]=function(){return o},e(r)}catch(e){}return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var i=n(37),s=n(48),u=n(79);e.exports=n(39)?Object.defineProperties:function(e,t){s(e);for(var n,r=u(t),o=r.length,a=0;a<o;)i.f(e,n=r[a++],t[n]);return e}},function(e,t,n){var r=n(60),o=n(286).f,a={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return i&&"[object Window]"==a.call(e)?function(e){try{return o(e)}catch(e){return i.slice()}}(e):o(r(e))}},function(e,t,n){var r=n(287),o=n(181).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t,n){var i=n(69),s=n(60),u=n(566)(!1),c=n(189)("IE_PROTO");e.exports=function(e,t){var n,r=s(e),o=0,a=[];for(n in r)n!=c&&i(r,n)&&a.push(n);for(;t.length>o;)i(r,n=t[o++])&&(~u(a,n)||a.push(n));return a}},function(e,t,n){var u=n(79),c=n(60),l=n(98).f;e.exports=function(s){return function(e){for(var t,n=c(e),r=u(n),o=r.length,a=0,i=[];a<o;)l.call(n,t=r[a++])&&i.push(s?[t,n[t]]:n[t]);return i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(48),o=n(33),a=n(184);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=a.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){e.exports=n(59)},function(e,t,n){"use strict";var r=n(31),o=n(17),a=n(37),i=n(39),s=n(27)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:r[e];i&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var o=n(48),a=n(95),i=n(27)("species");e.exports=function(e,t){var n,r=o(e).constructor;return void 0===r||null==(n=o(r)[i])?t:a(n)}},function(e,t,n){function r(){var e=+this;if(b.hasOwnProperty(e)){var t=b[e];delete b[e],t()}}function o(e){r.call(e.data)}var a,i,s,u=n(55),c=n(575),l=n(277),f=n(180),d=n(31),p=d.process,h=d.setImmediate,y=d.clearImmediate,v=d.MessageChannel,g=d.Dispatch,m=0,b={},_="onreadystatechange";h&&y||(h=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return b[++m]=function(){c("function"==typeof e?e:Function(e),t)},a(m),m},y=function(e){delete b[e]},"process"==n(96)(p)?a=function(e){p.nextTick(u(r,e,1))}:g&&g.now?a=function(e){g.now(u(r,e,1))}:v?(s=(i=new v).port2,i.port1.onmessage=o,a=u(s.postMessage,s,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(a=function(e){d.postMessage(e+"","*")},d.addEventListener("message",o,!1)):a=_ in f("script")?function(e){l.appendChild(f("script"))[_]=function(){l.removeChild(this),r.call(e)}}:function(e){setTimeout(u(r,e,1),0)}),e.exports={set:h,clear:y}},function(e,t,n){var r=n(33);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){(function(t){!function(){"use strict";e.exports=function(e){return(e instanceof t?e:new t(e.toString(),"binary")).toString("base64")}}()}).call(t,n(49).Buffer)},function(e,t,n){var r=n(28),o=n(204),a=n(61),i=r("unscopables"),s=Array.prototype;null==s[i]&&a(s,i,o(null)),e.exports=function(e){s[i][e]=!0}},function(e,t,n){function r(s){return function(e,t,n){var r,o=u(e),a=c(o.length),i=l(n,a);if(s&&t!=t){for(;i<a;)if((r=o[i++])!=r)return!0}else for(;i<a;i++)if((s||i in o)&&o[i]===t)return s||i||0;return!s&&-1}}var u=n(84),c=n(85),l=n(659);e.exports={includes:r(!0),indexOf:r(!1)}},function(e,t,n){function r(p){var h=1==p,y=2==p,v=3==p,g=4==p,m=6==p,b=5==p||m;return function(e,t,n,r){for(var o,a,i=x(e),s=w(i),u=_(t,n,3),c=E(s.length),l=0,f=r||k,d=h?f(e,c):y?f(e,0):void 0;l<c;l++)if((b||l in s)&&(a=u(o=s[l],l,i),p))if(h)d[l]=a;else if(a)switch(p){case 3:return!0;case 5:return o;case 6:return l;case 2:T.call(d,o)}else if(g)return!1;return m?-1:v||g?g:d}}var _=n(197),w=n(200),x=n(86),E=n(85),k=n(300),T=[].push;e.exports={forEach:r(0),map:r(1),filter:r(2),some:r(3),every:r(4),find:r(5),findIndex:r(6)}},function(e,t,n){var r=n(51),o=n(202),a=n(28)("species");e.exports=function(e,t){var n;return o(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!o(n.prototype)?r(n)&&(null===(n=n[a])&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){var o=n(132),a=n(28)("toStringTag"),i="Arguments"==o(function(){return arguments}());e.exports=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:i?o(t):"Object"==(r=o(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t,n){var s=n(40),u=n(657),c=n(205),l=n(62);e.exports=function(e,t){for(var n=u(t),r=l.f,o=c.f,a=0;a<n.length;a++){var i=n[a];s(e,i)||r(e,i,o(t,i))}}},function(e,t,n){"use strict";var o=n(140),a=n(62),i=n(102);e.exports=function(e,t,n){var r=o(t);r in e?a.f(e,r,i(0,n)):e[r]=n}},function(e,t,n){var r=n(32),o=n(51),a=r.document,i=o(a)&&o(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},function(e,t,n){var r=n(105);e.exports=r("native-function-to-string",Function.toString)},function(e,t,n){function r(e){return"function"==typeof e?e:void 0}var o=n(71),a=n(32);e.exports=function(e,t){return arguments.length<2?r(o[e])||r(a[e]):o[e]&&o[e][t]||a[e]&&a[e][t]}},function(e,t,n){var r=n(56),o=n(50),a=n(304);e.exports=!r&&!o(function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";var r,o,a,i=n(310),s=n(61),u=n(40),c=n(28),l=n(134),f=c("iterator"),d=!1;[].keys&&("next"in(a=[].keys())?(o=i(i(a)))!==Object.prototype&&(r=o):d=!0),null==r&&(r={}),l||u(r,f)||s(r,f,function(){return this}),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:d}},function(e,t,n){var r=n(50);e.exports=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())})},function(e,t,n){var r=n(40),o=n(86),a=n(139),i=n(643),s=a("IE_PROTO"),u=Object.prototype;e.exports=i?Object.getPrototypeOf:function(e){return e=o(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?u:null}},function(e,t,n){var i=n(40),s=n(84),u=n(298).indexOf,c=n(133);e.exports=function(e,t){var n,r=s(e),o=0,a=[];for(n in r)!i(c,n)&&i(r,n)&&a.push(n);for(;t.length>o;)i(r,n=t[o++])&&(~u(a,n)||a.push(n));return a}},function(e,t,n){function r(s){return function(e){for(var t,n=l(e),r=c(n),o=r.length,a=0,i=[];a<o;)t=r[a++],u&&!f.call(n,t)||i.push(s?[t,n[t]]:n[t]);return i}}var u=n(56),c=n(136),l=n(84),f=n(137).f;e.exports={entries:r(!0),values:r(!1)}},function(e,t,n){t.f=n(28)},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(n,r,o){var a;(function(e){function l(e){var t,n,r,o="",a=-1;if(e&&e.length)for(r=e.length;(a+=1)<r;)t=e.charCodeAt(a),n=a+1<r?e.charCodeAt(a+1):0,55296<=t&&t<=56319&&56320<=n&&n<=57343&&(t=65536+((1023&t)<<10)+(1023&n),a+=1),t<=127?o+=String.fromCharCode(t):t<=2047?o+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?o+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(o+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return o}function O(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function j(e,t){return e<<t|e>>>32-t}function i(e,t){for(var n,r=t?"0123456789ABCDEF":"0123456789abcdef",o="",a=0,i=e.length;a<i;a+=1)n=e.charCodeAt(a),o+=r.charAt(n>>>4&15)+r.charAt(15&n);return o}function c(e){var t,n=32*e.length,r="";for(t=0;t<n;t+=8)r+=String.fromCharCode(e[t>>5]>>>24-t%32&255);return r}function y(e){var t,n=32*e.length,r="";for(t=0;t<n;t+=8)r+=String.fromCharCode(e[t>>5]>>>t%32&255);return r}function v(e){var t,n=8*e.length,r=Array(e.length>>2),o=r.length;for(t=0;t<o;t+=1)r[t]=0;for(t=0;t<n;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return r}function f(e){var t,n=8*e.length,r=Array(e.length>>2),o=r.length;for(t=0;t<o;t+=1)r[t]=0;for(t=0;t<n;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<24-t%32;return r}function g(e,t){var n,r,o,a,i,s,u,c,l=t.length,f=Array();for(a=(s=Array(Math.ceil(e.length/2))).length,n=0;n<a;n+=1)s[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);for(;0<s.length;){for(i=Array(),n=o=0;n<s.length;n+=1)o=(o<<16)+s[n],o-=(r=Math.floor(o/l))*l,(0<i.length||0<r)&&(i[i.length]=r);f[f.length]=o,s=i}for(u="",n=f.length-1;0<=n;n--)u+=t.charAt(f[n]);for(c=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),n=u.length;n<c;n+=1)u=t[0]+u;return u}function m(e,t){var n,r,o,a="",i=e.length;for(t=t||"=",n=0;n<i;n+=3)for(o=e.charCodeAt(n)<<16|(n+1<i?e.charCodeAt(n+1)<<8:0)|(n+2<i?e.charCodeAt(n+2):0),r=0;r<4;r+=1)a+=8*n+6*r>8*e.length?t:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-r)&63);return a}var t;t={VERSION:"1.0.6",Base64:function(){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="=",p=!0;this.encode=function(e){var t,n,r,o="",a=e.length;for(d=d||"=",e=p?l(e):e,t=0;t<a;t+=3)for(r=e.charCodeAt(t)<<16|(t+1<a?e.charCodeAt(t+1)<<8:0)|(t+2<a?e.charCodeAt(t+2):0),n=0;n<4;n+=1)o+=8*a<8*t+6*n?d:f.charAt(r>>>6*(3-n)&63);return o},this.decode=function(e){var t,n,r,o,a,i,s,u,c="",l=[];if(!e)return e;for(t=u=0,e=e.replace(new RegExp("\\"+d,"gi"),"");n=(s=f.indexOf(e.charAt(t+=1))<<18|f.indexOf(e.charAt(t+=1))<<12|(a=f.indexOf(e.charAt(t+=1)))<<6|(i=f.indexOf(e.charAt(t+=1))))>>16&255,r=s>>8&255,o=255&s,l[u+=1]=64===a?String.fromCharCode(n):64===i?String.fromCharCode(n,r):String.fromCharCode(n,r,o),t<e.length;);return c=l.join(""),p?function(e){var t,n,r,o,a,i,s=[];if(t=n=r=o=a=0,e&&e.length)for(i=e.length,e+="";t<i;)n+=1,(r=e.charCodeAt(t))<128?(s[n]=String.fromCharCode(r),t+=1):191<r&&r<224?(o=e.charCodeAt(t+1),s[n]=String.fromCharCode((31&r)<<6|63&o),t+=2):(o=e.charCodeAt(t+1),a=e.charCodeAt(t+2),s[n]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&a),t+=3);return s.join("")}(c):c},this.setPad=function(e){return d=e||d,this},this.setTab=function(e){return f=e||f,this},this.setUTF8=function(e){return"boolean"==typeof e&&(p=e),this}},CRC32:function(e){var t,n,r,o=0,a=0;for(e=l(e),t=["00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 ","79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 ","84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F ","63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD ","A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC ","51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 ","B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 ","06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 ","E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 ","12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 ","D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 ","33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 ","CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 ","9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E ","7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D ","806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 ","60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA ","AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 ","5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 ","B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 ","05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 ","F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA ","11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 ","D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F ","30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E ","C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D"].join(""),o^=-1,n=0,r=e.length;n<r;n+=1)a=255&(o^e.charCodeAt(n)),o=o>>>8^"0x"+t.substr(9*a,8);return(-1^o)>>>0},MD5:function(e){function n(e){return y(s(v(e=c?l(e):e),8*e.length))}function r(e,t){var n,r,o,a,i;for(e=c?l(e):e,t=c?l(t):t,16<(n=v(e)).length&&(n=s(n,8*e.length)),r=Array(16),o=Array(16),i=0;i<16;i+=1)r[i]=909522486^n[i],o[i]=1549556828^n[i];return a=s(r.concat(v(t)),512+8*t.length),y(s(o.concat(a),640))}function s(e,t){var n,r,o,a,i,s=1732584193,u=-271733879,c=-1732584194,l=271733878;for(e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t,n=0;n<e.length;n+=16)u=h(u=h(u=h(u=h(u=p(u=p(u=p(u=p(u=d(u=d(u=d(u=d(u=f(u=f(u=f(u=f(o=u,c=f(a=c,l=f(i=l,s=f(r=s,u,c,l,e[n+0],7,-680876936),u,c,e[n+1],12,-389564586),s,u,e[n+2],17,606105819),l,s,e[n+3],22,-1044525330),c=f(c,l=f(l,s=f(s,u,c,l,e[n+4],7,-176418897),u,c,e[n+5],12,1200080426),s,u,e[n+6],17,-1473231341),l,s,e[n+7],22,-45705983),c=f(c,l=f(l,s=f(s,u,c,l,e[n+8],7,1770035416),u,c,e[n+9],12,-1958414417),s,u,e[n+10],17,-42063),l,s,e[n+11],22,-1990404162),c=f(c,l=f(l,s=f(s,u,c,l,e[n+12],7,1804603682),u,c,e[n+13],12,-40341101),s,u,e[n+14],17,-1502002290),l,s,e[n+15],22,1236535329),c=d(c,l=d(l,s=d(s,u,c,l,e[n+1],5,-165796510),u,c,e[n+6],9,-1069501632),s,u,e[n+11],14,643717713),l,s,e[n+0],20,-373897302),c=d(c,l=d(l,s=d(s,u,c,l,e[n+5],5,-701558691),u,c,e[n+10],9,38016083),s,u,e[n+15],14,-660478335),l,s,e[n+4],20,-405537848),c=d(c,l=d(l,s=d(s,u,c,l,e[n+9],5,568446438),u,c,e[n+14],9,-1019803690),s,u,e[n+3],14,-187363961),l,s,e[n+8],20,1163531501),c=d(c,l=d(l,s=d(s,u,c,l,e[n+13],5,-1444681467),u,c,e[n+2],9,-51403784),s,u,e[n+7],14,1735328473),l,s,e[n+12],20,-1926607734),c=p(c,l=p(l,s=p(s,u,c,l,e[n+5],4,-378558),u,c,e[n+8],11,-2022574463),s,u,e[n+11],16,1839030562),l,s,e[n+14],23,-35309556),c=p(c,l=p(l,s=p(s,u,c,l,e[n+1],4,-1530992060),u,c,e[n+4],11,1272893353),s,u,e[n+7],16,-155497632),l,s,e[n+10],23,-1094730640),c=p(c,l=p(l,s=p(s,u,c,l,e[n+13],4,681279174),u,c,e[n+0],11,-358537222),s,u,e[n+3],16,-722521979),l,s,e[n+6],23,76029189),c=p(c,l=p(l,s=p(s,u,c,l,e[n+9],4,-640364487),u,c,e[n+12],11,-421815835),s,u,e[n+15],16,530742520),l,s,e[n+2],23,-995338651),c=h(c,l=h(l,s=h(s,u,c,l,e[n+0],6,-198630844),u,c,e[n+7],10,1126891415),s,u,e[n+14],15,-1416354905),l,s,e[n+5],21,-57434055),c=h(c,l=h(l,s=h(s,u,c,l,e[n+12],6,1700485571),u,c,e[n+3],10,-1894986606),s,u,e[n+10],15,-1051523),l,s,e[n+1],21,-2054922799),c=h(c,l=h(l,s=h(s,u,c,l,e[n+8],6,1873313359),u,c,e[n+15],10,-30611744),s,u,e[n+6],15,-1560198380),l,s,e[n+13],21,1309151649),c=h(c,l=h(l,s=h(s,u,c,l,e[n+4],6,-145523070),u,c,e[n+11],10,-1120210379),s,u,e[n+2],15,718787259),l,s,e[n+9],21,-343485551),s=O(s,r),u=O(u,o),c=O(c,a),l=O(l,i);return Array(s,u,c,l)}function u(e,t,n,r,o,a){return O(j(O(O(t,e),O(r,a)),o),n)}function f(e,t,n,r,o,a,i){return u(t&n|~t&r,e,t,o,a,i)}function d(e,t,n,r,o,a,i){return u(t&r|n&~r,e,t,o,a,i)}function p(e,t,n,r,o,a,i){return u(t^n^r,e,t,o,a,i)}function h(e,t,n,r,o,a,i){return u(n^(t|~r),e,t,o,a,i)}var o=!(!e||"boolean"!=typeof e.uppercase)&&e.uppercase,a=e&&"string"==typeof e.pad?e.pad:"=",c=!e||"boolean"!=typeof e.utf8||e.utf8;this.hex=function(e){return i(n(e),o)},this.b64=function(e){return m(n(e),a)},this.any=function(e,t){return g(n(e),t)},this.raw=function(e){return n(e)},this.hex_hmac=function(e,t){return i(r(e,t),o)},this.b64_hmac=function(e,t){return m(r(e,t),a)},this.any_hmac=function(e,t,n){return g(r(e,t),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(e){return"boolean"==typeof e&&(o=e),this},this.setPad=function(e){return a=e||a,this},this.setUTF8=function(e){return"boolean"==typeof e&&(c=e),this}},SHA1:function(e){function n(e){return c(s(f(e=u?l(e):e),8*e.length))}function r(e,t){var n,r,o,a,i;for(e=u?l(e):e,t=u?l(t):t,16<(n=f(e)).length&&(n=s(n,8*e.length)),r=Array(16),o=Array(16),a=0;a<16;a+=1)r[a]=909522486^n[a],o[a]=1549556828^n[a];return i=s(r.concat(f(t)),512+8*t.length),c(s(o.concat(i),672))}function s(e,t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y=Array(80),v=1732584193,g=-271733879,m=-1732584194,b=271733878,_=-1009589776;for(e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t,n=0;n<e.length;n+=16){for(a=v,i=g,s=m,u=b,c=_,r=0;r<80;r+=1)y[r]=r<16?e[n+r]:j(y[r-3]^y[r-8]^y[r-14]^y[r-16],1),o=O(O(j(v,5),(d=g,p=m,h=b,(f=r)<20?d&p|~d&h:f<40?d^p^h:f<60?d&p|d&h|p&h:d^p^h)),O(O(_,y[r]),(l=r)<20?1518500249:l<40?1859775393:l<60?-1894007588:-899497514)),_=b,b=m,m=j(g,30),g=v,v=o;v=O(v,a),g=O(g,i),m=O(m,s),b=O(b,u),_=O(_,c)}return Array(v,g,m,b,_)}var t=!(!e||"boolean"!=typeof e.uppercase)&&e.uppercase,o=e&&"string"==typeof e.pad?e.pad:"=",u=!e||"boolean"!=typeof e.utf8||e.utf8;this.hex=function(e){return i(n(e),t)},this.b64=function(e){return m(n(e),o)},this.any=function(e,t){return g(n(e),t)},this.raw=function(e){return n(e)},this.hex_hmac=function(e,t){return i(r(e,t))},this.b64_hmac=function(e,t){return m(r(e,t),o)},this.any_hmac=function(e,t,n){return g(r(e,t),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(e){return"boolean"==typeof e&&(t=e),this},this.setPad=function(e){return o=e||o,this},this.setUTF8=function(e){return"boolean"==typeof e&&(u=e),this}},SHA256:function(e){function n(e,t){return c(s(f(e=t?l(e):e),8*e.length))}function r(e,t){e=u?l(e):e,t=u?l(t):t;var n,r=0,o=f(e),a=Array(16),i=Array(16);for(16<o.length&&(o=s(o,8*e.length));r<16;r+=1)a[r]=909522486^o[r],i[r]=1549556828^o[r];return n=s(a.concat(f(t)),512+8*t.length),c(s(i.concat(n),768))}function k(e,t){return e>>>t|e<<32-t}function T(e,t){return e>>>t}function s(e,t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],E=new Array(64);for(e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t,l=0;l<e.length;l+=16){for(n=x[0],r=x[1],o=x[2],a=x[3],i=x[4],s=x[5],u=x[6],c=x[7],f=0;f<64;f+=1)E[f]=f<16?e[f+l]:O(O(O(k(w=E[f-2],17)^k(w,19)^T(w,10),E[f-7]),k(_=E[f-15],7)^k(_,18)^T(_,3)),E[f-16]),d=O(O(O(O(c,k(b=i,6)^k(b,11)^k(b,25)),(m=i)&s^~m&u),A[f]),E[f]),p=O(k(g=n,2)^k(g,13)^k(g,22),(h=n)&(y=r)^h&(v=o)^y&v),c=u,u=s,s=i,i=O(a,d),a=o,o=r,r=n,n=O(d,p);x[0]=O(n,x[0]),x[1]=O(r,x[1]),x[2]=O(o,x[2]),x[3]=O(a,x[3]),x[4]=O(i,x[4]),x[5]=O(s,x[5]),x[6]=O(u,x[6]),x[7]=O(c,x[7])}return x}e&&"boolean"==typeof e.uppercase&&e.uppercase;var A,o=e&&"string"==typeof e.pad?e.pad:"=",u=!e||"boolean"!=typeof e.utf8||e.utf8;this.hex=function(e){return i(n(e,u))},this.b64=function(e){return m(n(e,u),o)},this.any=function(e,t){return g(n(e,u),t)},this.raw=function(e){return n(e,u)},this.hex_hmac=function(e,t){return i(r(e,t))},this.b64_hmac=function(e,t){return m(r(e,t),o)},this.any_hmac=function(e,t,n){return g(r(e,t),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(e){return this},this.setPad=function(e){return o=e||o,this},this.setUTF8=function(e){return"boolean"==typeof e&&(u=e),this},A=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998]},SHA512:function(e){function n(e){return c(s(f(e=u?l(e):e),8*e.length))}function r(e,t){e=u?l(e):e,t=u?l(t):t;var n,r=0,o=f(e),a=Array(32),i=Array(32);for(32<o.length&&(o=s(o,8*e.length));r<32;r+=1)a[r]=909522486^o[r],i[r]=1549556828^o[r];return n=s(a.concat(f(t)),1024+8*t.length),c(s(i.concat(n),1536))}function s(e,t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k=new Array(80),T=new Array(16),A=[new $(1779033703,-205731576),new $(-1150833019,-2067093701),new $(1013904242,-23791573),new $(-1521486534,1595750129),new $(1359893119,-1377402159),new $(-1694144372,725511199),new $(528734635,-79577749),new $(1541459225,327033209)],I=new $(0,0),O=new $(0,0),j=new $(0,0),S=new $(0,0),M=new $(0,0),R=new $(0,0),C=new $(0,0),P=new $(0,0),z=new $(0,0),V=new $(0,0),G=new $(0,0),N=new $(0,0),D=new $(0,0),U=new $(0,0),F=new $(0,0),L=new $(0,0),B=new $(0,0);for(void 0===K&&(K=[new $(1116352408,-685199838),new $(1899447441,602891725),new $(-1245643825,-330482897),new $(-373957723,-2121671748),new $(961987163,-213338824),new $(1508970993,-1241133031),new $(-1841331548,-1357295717),new $(-1424204075,-630357736),new $(-670586216,-1560083902),new $(310598401,1164996542),new $(607225278,1323610764),new $(1426881987,-704662302),new $(1925078388,-226784913),new $(-2132889090,991336113),new $(-1680079193,633803317),new $(-1046744716,-815192428),new $(-459576895,-1628353838),new $(-272742522,944711139),new $(264347078,-1953704523),new $(604807628,2007800933),new $(770255983,1495990901),new $(1249150122,1856431235),new $(1555081692,-1119749164),new $(1996064986,-2096016459),new $(-1740746414,-295247957),new $(-1473132947,766784016),new $(-1341970488,-1728372417),new $(-1084653625,-1091629340),new $(-958395405,1034457026),new $(-710438585,-1828018395),new $(113926993,-536640913),new $(338241895,168717936),new $(666307205,1188179964),new $(773529912,1546045734),new $(1294757372,1522805485),new $(1396182291,-1651133473),new $(1695183700,-1951439906),new $(1986661051,1014477480),new $(-2117940946,1206759142),new $(-1838011259,344077627),new $(-1564481375,1290863460),new $(-1474664885,-1136513023),new $(-1035236496,-789014639),new $(-949202525,106217008),new $(-778901479,-688958952),new $(-694614492,1432725776),new $(-200395387,1467031594),new $(275423344,851169720),new $(430227734,-1194143544),new $(506948616,1363258195),new $(659060556,-544281703),new $(883997877,-509917016),new $(958139571,-976659869),new $(1322822218,-482243893),new $(1537002063,2003034995),new $(1747873779,-692930397),new $(1955562222,1575990012),new $(2024104815,1125592928),new $(-2067236844,-1578062990),new $(-1933114872,442776044),new $(-1866530822,593698344),new $(-1538233109,-561857047),new $(-1090935817,-1295615723),new $(-965641998,-479046869),new $(-903397682,-366583396),new $(-779700025,566280711),new $(-354779690,-840897762),new $(-176337025,-294727304),new $(116418474,1914138554),new $(174292421,-1563912026),new $(289380356,-1090974290),new $(460393269,320620315),new $(685471733,587496836),new $(852142971,1086792851),new $(1017036298,365543100),new $(1126000580,-1676669620),new $(1288033470,-885112138),new $(1501505948,-60457430),new $(1607167915,987167468),new $(1816402316,1246189591)]),r=0;r<80;r+=1)k[r]=new $(0,0);for(e[t>>5]|=128<<24-(31&t),e[31+(t+128>>10<<5)]=t,o=e.length,r=0;r<o;r+=32){for(q(j,A[0]),q(S,A[1]),q(M,A[2]),q(R,A[3]),q(C,A[4]),q(P,A[5]),q(z,A[6]),q(V,A[7]),n=0;n<16;n+=1)k[n].h=e[r+2*n],k[n].l=e[r+2*n+1];for(n=16;n<80;n+=1)H(F,k[n-2],19),Y(L,k[n-2],29),Z(B,k[n-2],6),N.l=F.l^L.l^B.l,N.h=F.h^L.h^B.h,H(F,k[n-15],1),H(L,k[n-15],8),Z(B,k[n-15],7),G.l=F.l^L.l^B.l,G.h=F.h^L.h^B.h,y=k[n],v=N,g=k[n-7],m=G,b=k[n-16],_=(65535&v.l)+(65535&g.l)+(65535&m.l)+(65535&b.l),w=(v.l>>>16)+(g.l>>>16)+(m.l>>>16)+(b.l>>>16)+(_>>>16),x=(65535&v.h)+(65535&g.h)+(65535&m.h)+(65535&b.h)+(w>>>16),E=(v.h>>>16)+(g.h>>>16)+(m.h>>>16)+(b.h>>>16)+(x>>>16),y.l=65535&_|w<<16,y.h=65535&x|E<<16;for(n=0;n<80;n+=1)D.l=C.l&P.l^~C.l&z.l,D.h=C.h&P.h^~C.h&z.h,H(F,C,14),H(L,C,18),Y(B,C,9),N.l=F.l^L.l^B.l,N.h=F.h^L.h^B.h,H(F,j,28),Y(L,j,2),Y(B,j,7),G.l=F.l^L.l^B.l,G.h=F.h^L.h^B.h,U.l=j.l&S.l^j.l&M.l^S.l&M.l,U.h=j.h&S.h^j.h&M.h^S.h&M.h,a=I,i=V,s=N,u=D,c=K[n],l=k[n],f=(65535&i.l)+(65535&s.l)+(65535&u.l)+(65535&c.l)+(65535&l.l),d=(i.l>>>16)+(s.l>>>16)+(u.l>>>16)+(c.l>>>16)+(l.l>>>16)+(f>>>16),p=(65535&i.h)+(65535&s.h)+(65535&u.h)+(65535&c.h)+(65535&l.h)+(d>>>16),h=(i.h>>>16)+(s.h>>>16)+(u.h>>>16)+(c.h>>>16)+(l.h>>>16)+(p>>>16),a.l=65535&f|d<<16,a.h=65535&p|h<<16,W(O,G,U),q(V,z),q(z,P),q(P,C),W(C,R,I),q(R,M),q(M,S),q(S,j),W(j,I,O);W(A[0],A[0],j),W(A[1],A[1],S),W(A[2],A[2],M),W(A[3],A[3],R),W(A[4],A[4],C),W(A[5],A[5],P),W(A[6],A[6],z),W(A[7],A[7],V)}for(r=0;r<8;r+=1)T[2*r]=A[r].h,T[2*r+1]=A[r].l;return T}function $(e,t){this.h=e,this.l=t}function q(e,t){e.h=t.h,e.l=t.l}function H(e,t,n){e.l=t.l>>>n|t.h<<32-n,e.h=t.h>>>n|t.l<<32-n}function Y(e,t,n){e.l=t.h>>>n|t.l<<32-n,e.h=t.l>>>n|t.h<<32-n}function Z(e,t,n){e.l=t.l>>>n|t.h<<32-n,e.h=t.h>>>n}function W(e,t,n){var r=(65535&t.l)+(65535&n.l),o=(t.l>>>16)+(n.l>>>16)+(r>>>16),a=(65535&t.h)+(65535&n.h)+(o>>>16),i=(t.h>>>16)+(n.h>>>16)+(a>>>16);e.l=65535&r|o<<16,e.h=65535&a|i<<16}e&&"boolean"==typeof e.uppercase&&e.uppercase;var K,o=e&&"string"==typeof e.pad?e.pad:"=",u=!e||"boolean"!=typeof e.utf8||e.utf8;this.hex=function(e){return i(n(e))},this.b64=function(e){return m(n(e),o)},this.any=function(e,t){return g(n(e),t)},this.raw=function(e){return n(e)},this.hex_hmac=function(e,t){return i(r(e,t))},this.b64_hmac=function(e,t){return m(r(e,t),o)},this.any_hmac=function(e,t,n){return g(r(e,t),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(e){return this},this.setPad=function(e){return o=e||o,this},this.setUTF8=function(e){return"boolean"==typeof e&&(u=e),this}},RMD160:function(e){function n(e){return s(u(v(e=c?l(e):e),8*e.length))}function r(e,t){e=c?l(e):e,t=c?l(t):t;var n,r,o=v(e),a=Array(16),i=Array(16);for(16<o.length&&(o=u(o,8*e.length)),n=0;n<16;n+=1)a[n]=909522486^o[n],i[n]=1549556828^o[n];return r=u(a.concat(v(t)),512+8*t.length),s(u(i.concat(r),672))}function s(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function u(e,t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m=1732584193,b=4023233417,_=2562383102,w=271733878,x=3285377520;for(e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t,a=e.length,o=0;o<a;o+=16){for(i=f=m,s=d=b,u=p=_,c=h=w,l=y=x,r=0;r<=79;r+=1)n=O(j(n=O(n=O(n=O(i,E(r,s,u,c)),e[o+k[r]]),0<=(g=r)&&g<=15?0:16<=g&&g<=31?1518500249:32<=g&&g<=47?1859775393:48<=g&&g<=63?2400959708:64<=g&&g<=79?2840853838:"rmd160_K1: j out of range"),A[r]),l),i=l,l=c,c=j(u,10),u=s,s=n,n=O(j(n=O(n=O(n=O(f,E(79-r,d,p,h)),e[o+T[r]]),0<=(v=r)&&v<=15?1352829926:16<=v&&v<=31?1548603684:32<=v&&v<=47?1836072691:48<=v&&v<=63?2053994217:64<=v&&v<=79?0:"rmd160_K2: j out of range"),I[r]),y),f=y,y=h,h=j(p,10),p=d,d=n;n=O(b,O(u,h)),b=O(_,O(c,y)),_=O(w,O(l,f)),w=O(x,O(i,d)),x=O(m,O(s,p)),m=n}return[m,b,_,w,x]}function E(e,t,n,r){return 0<=e&&e<=15?t^n^r:16<=e&&e<=31?t&n|~t&r:32<=e&&e<=47?(t|~n)^r:48<=e&&e<=63?t&r|n&~r:64<=e&&e<=79?t^(n|~r):"rmd160_f: j out of range"}e&&"boolean"==typeof e.uppercase&&e.uppercase;var o=e&&"string"==typeof e.pad?e.pa:"=",c=!e||"boolean"!=typeof e.utf8||e.utf8,k=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],T=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],A=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],I=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];this.hex=function(e){return i(n(e))},this.b64=function(e){return m(n(e),o)},this.any=function(e,t){return g(n(e),t)},this.raw=function(e){return n(e)},this.hex_hmac=function(e,t){return i(r(e,t))},this.b64_hmac=function(e,t){return m(r(e,t),o)},this.any_hmac=function(e,t,n){return g(r(e,t),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(e){return this},this.setPad=function(e){return void 0!==e&&(o=e),this},this.setUTF8=function(e){return"boolean"==typeof e&&(c=e),this}}},r&&"object"==typeof e&&e&&e.global,void 0===(a=function(){return t}.call(r,o,r,n))||(n.exports=a)}).call(r,function(){return this}())},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(325),a=n(326),i=n(327),s=n(328),u=n(329);r.prototype.clear=o,r.prototype.delete=a,r.prototype.get=i,r.prototype.has=s,r.prototype.set=u,e.exports=r},function(e,t,n){var r=n(320);e.exports=function(e,t){return!!(null==e?0:e.length)&&-1<r(e,t,0)}},function(e,t){e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},function(e,t,n){var r=n(743);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},function(e,t,n){var i=n(722),s=n(336);e.exports=function e(t,n,r,o,a){return t===n||(null==t||null==n||!s(t)&&!s(n)?t!=t&&n!=n:i(t,n,r,o,e,a))}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||n.test(e))&&-1<e&&e%1==0&&e<t}},function(e,t,n){var r=n(218);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(141),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(141);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(141);e.exports=function(e){return-1<r(this.__data__,e)}},function(e,t,n){var o=n(141);e.exports=function(e,t){var n=this.__data__,r=o(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}},function(e,t){e.exports=function(t,n){return function(e){return null!=e&&e[t]===n&&(void 0!==n||t in Object(e))}}},function(e,t){e.exports=function(t,n){return function(e){return t(n(e))}}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){e.exports=function(e){return e}},function(e,t){e.exports=function(){return!1}},function(e,t){e.exports=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";var r=n(778);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){"use strict";var r=n(784);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){"use strict";var r=n(785);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(p,e){(function(e){function a(r,n,e){function o(e){var t=u,n=c;return u=c=void 0,h=e,f=r.apply(n,t)}function a(e){var t=e-p;return void 0===p||n<=t||t<0||v&&l<=e-h}function i(){var e=E();return a(e)?t(e):void(d=setTimeout(i,function(e){var t=n-(e-p);return v?x(t,l-(e-h)):t}(e)))}function t(e){return d=void 0,g&&u?o(e):(u=c=void 0,f)}function s(){var e=E(),t=a(e);if(u=arguments,c=this,p=e,t){if(void 0===d)return function(e){return h=e,d=setTimeout(i,n),y?o(e):f}(p);if(v)return d=setTimeout(i,n),o(p)}return void 0===d&&(d=setTimeout(i,n)),f}var u,c,l,f,d,p,h=0,y=!1,v=!1,g=!0;if("function"!=typeof r)throw new TypeError(_);return n=b(n)||0,m(e)&&(y=!!e.leading,l=(v="maxWait"in e)?w(b(e.maxWait)||0,n):l,g="trailing"in e?!!e.trailing:g),s.cancel=function(){void 0!==d&&clearTimeout(d),u=p=c=d=void(h=0)},s.flush=function(){return void 0===d?f:t(E())},s}function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&d.call(e)==o}(e))return r;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=u.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):s.test(e)?r:+e}var _="Expected a function",r=NaN,o="[object Symbol]",i=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt,t="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,f=t||n||Function("return this")(),d=Object.prototype.toString,w=Math.max,x=Math.min,E=function(){return f.Date.now()};p.exports=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError(_);return m(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),a(e,t,{leading:r,maxWait:t,trailing:o})}}).call(e,function(){return this}())},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(148),o=n(157);e.exports=function(e,t,n){(void 0===n||o(e[t],n))&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){function r(e){if(!o(e))return{};if(a)return a(e);i.prototype=e;var t=new i;return i.prototype=void 0,t}var o=n(52),a=Object.create;function i(){}e.exports=r},function(e,t,n){var p=n(144),h=n(220),y=n(221),v=n(64),g=n(152),m=n(153);e.exports=function(e,t,n,r){var o=-1,a=h,i=!0,s=e.length,u=[],c=t.length;if(!s)return u;n&&(t=v(t,g(n))),r?(a=y,i=!1):200<=t.length&&(a=m,i=!1,t=new p(t));e:for(;++o<s;){var l=e[o],f=null==n?l:n(l);if(l=r||0!==l?l:0,i&&f==f){for(var d=c;d--;)if(t[d]===f)continue e;u.push(l)}else a(t,f,r)||u.push(l)}return u}},function(e,t,n){var r=n(837)();e.exports=r},function(e,t,n){var c=n(145),l=n(342),f=n(345),d=n(817),p=n(52),h=n(161),y=n(366);e.exports=function r(o,a,i,s,u){o!==a&&f(a,function(e,t){if(u=u||new c,p(e))d(o,a,t,i,r,s,u);else{var n=s?s(y(o,t),e,t+"",o,a,u):void 0;void 0===n&&(n=e),l(o,t,n)}},h)}},function(e,t,n){var a=n(64),i=n(57),s=n(814),u=n(824),c=n(152),l=n(833),f=n(112);e.exports=function(e,r,n){var o=-1;r=a(r.length?r:[f],c(i));var t=s(e,function(t,e,n){return{criteria:a(r,function(e){return e(t)}),index:++o,value:t}});return u(t,function(e,t){return l(e,t,n)})}},function(e,t,n){var u=n(150),c=n(823),l=n(88);e.exports=function(e,t,n){for(var r=-1,o=t.length,a={};++r<o;){var i=t[r],s=u(e,i);n(s,i)&&c(a,l(i,e),s)}return a}},function(e,i,s){(function(e){var t=s(233),n="object"==typeof i&&i&&!i.nodeType&&i,r=n&&"object"==typeof e&&e&&!e.nodeType&&e,o=r&&r.exports===n?t.Buffer:void 0,a=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(i,s(256)(e))},function(e,t,n){var r=n(58),u=n(154);e.exports=function(s){return r(function(e,t){var n=-1,r=t.length,o=1<r?t[r-1]:void 0,a=2<r?t[2]:void 0;for(o=3<s.length&&"function"==typeof o?(r--,o):void 0,a&&u(t[0],t[1],a)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var i=t[n];i&&s(e,i,n,o)}return e})}},function(e,t,n){var r=n(796),o=n(871),a=n(899),i=RegExp("['â€™]","g");e.exports=function(t){return function(e){return r(a(o(e).replace(i,"")),t,"")}}},function(e,t,n){var r=n(369),o=n(365),a=n(367);e.exports=function(e){return a(o(e,void 0,r),e+"")}},function(e,t,n){var r=n(155)(Object.keys,Object);e.exports=r},function(e,t,n){var s=n(88),u=n(158),c=n(26),l=n(357),f=n(372),d=n(89);e.exports=function(e,t,n){for(var r=-1,o=(t=s(t,e)).length,a=!1;++r<o;){var i=d(t[r]);if(!(a=null!=e&&n(e,i)))break;e=e[i]}return a||++r!=o?a:!!(o=null==e?0:e.length)&&f(o)&&l(i,o)&&(c(e)||u(e))}},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t,n){var r=n(343),o=n(229),a=n(232);e.exports=function(e){return"function"!=typeof e.constructor||a(e)?{}:r(o(e))}},function(e,t){var r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&r.test(e))&&-1<e&&e%1==0&&e<t}},function(e,t,n){var r=n(52);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(147),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(147);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(147);e.exports=function(e){return-1<r(this.__data__,e)}},function(e,t,n){var o=n(147);e.exports=function(e,t){var n=this.__data__,r=o(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}},function(e,t){e.exports=function(t,n){return function(e){return null!=e&&e[t]===n&&(void 0!==n||t in Object(e))}}},function(e,t,n){var u=n(341),c=Math.max;e.exports=function(a,i,s){return i=c(void 0===i?a.length-1:i,0),function(){for(var e=arguments,t=-1,n=c(e.length-i,0),r=Array(n);++t<n;)r[t]=e[i+t];t=-1;for(var o=Array(i+1);++t<i;)o[t]=e[t];return o[i]=s(r),u(a,this,o)}}},function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},function(e,t){e.exports=function(e){return e}},function(e,t,n){e.exports=n(877)},function(e,t,n){var r=n(149);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},function(e,t,n){var r=n(807),o=n(354);e.exports=function(e,t){return null!=e&&o(e,t,r)}},function(e,t){e.exports=function(e){return e&&e.length?e[0]:void 0}},function(e,t){e.exports=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991}},function(e,t,n){var r=n(223),o=n(229),a=n(159),i=Function.prototype,s=Object.prototype,u=i.toString,c=s.hasOwnProperty,l=u.call(Object);e.exports=function(e){if(!a(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==l}},function(e,t){e.exports=function(){return!1}},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,n){function r(o,a){if("function"!=typeof o||null!=a&&"function"!=typeof a)throw new TypeError(u);var i=function(){var e=arguments,t=a?a.apply(this,e):e[0],n=i.cache;if(n.has(t))return n.get(t);var r=o.apply(this,e);return i.cache=n.set(t,r)||n,r};return i.cache=new(r.Cache||s),i}var s=n(791),u="Expected a function";r.Cache=s,e.exports=r},function(e,t,n){var r=n(149),o=n(58),a=n(226),i=n(113),s=o(function(e){return a(r(e,1,i,!0))});e.exports=s},function(e,t,n){"use strict";function i(){}function s(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("Promise constructor's argument is not a function");this._h=0,this._i=0,this._j=null,this._k=null,e!==i&&l(e,this)}function u(e,t){for(;3===e._i;)e=e._j;return s._l&&s._l(e),0===e._i?0===e._h?(e._h=1,void(e._k=t)):1===e._h?(e._h=2,void(e._k=[e._k,t])):void e._k.push(t):void function(n,r){f(function(){var e=1===n._i?r.onFulfilled:r.onRejected;if(null!==e){var t=function(e,t){try{return e(t)}catch(e){return d=e,p}}(e,n._j);t===p?a(r.promise,d):o(r.promise,t)}else 1===n._i?o(r.promise,n._j):a(r.promise,n._j)})}(e,t)}function o(e,t){if(t===e)return a(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var n=function(e){try{return e.then}catch(e){return d=e,p}}(t);if(n===p)return a(e,d);if(n===e.then&&t instanceof s)return e._i=3,e._j=t,void r(e);if("function"==typeof n)return void l(n.bind(t),e)}e._i=1,e._j=t,r(e)}function a(e,t){e._i=2,e._j=t,s._m&&s._m(e,t),r(e)}function r(e){if(1===e._h&&(u(e,e._k),e._k=null),2===e._h){for(var t=0;t<e._k.length;t++)u(e,e._k[t]);e._k=null}}function c(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function l(e,t){var n=!1,r=function(e,t,n){try{e(t,n)}catch(e){return d=e,p}}(e,function(e){n||(n=!0,o(t,e))},function(e){n||(n=!0,a(t,e))});n||r!==p||(n=!0,a(t,d))}var f=n(404),d=null,p={};(e.exports=s)._l=null,s._m=null,s._n=i,s.prototype.then=function(e,t){if(this.constructor!==s)return function(r,o,a){return new r.constructor(function(e,t){var n=new s(i);n.then(e,t),u(r,new c(o,a,n))})}(this,e,t);var n=new s(i);return u(this,new c(e,t,n)),n}},function(e,t,n){"use strict";function r(e){return this instanceof r?void o.call(this,e):new r(e)}e.exports=r;var o=n(242),a=n(106);a.inherits=n(63),a.inherits(r,o),r.prototype._transform=function(e,t,n){n(null,e)}},function(O,e,j){(function(v){"use strict";function t(e,t){p=p||j(75),e=e||{},this.objectMode=!!e.objectMode,t instanceof p&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new A,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(T=T||j(397).StringDecoder,this.decoder=new T(e.encoding),this.encoding=e.encoding)}function n(e){return p=p||j(75),this instanceof n?(this._readableState=new t(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),void h.call(this)):new n(e)}function r(e,t,n,r,o){var a=function(e,t){var n=null;return y.isBuffer(t)||"string"==typeof t||null==t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(t,n);if(a)e.emit("error",a);else if(null===n)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,c(e)}}(e,t);else if(t.objectMode||n&&0<n.length)if(t.ended&&!o){var i=new Error("stream.push() after EOF");e.emit("error",i)}else if(t.endEmitted&&o){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||o||r||(n=t.decoder.write(n),u=!t.objectMode&&0===n.length),o||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&c(e))),function(e,t){t.readingMore||(t.readingMore=!0,b(l,e,t))}(e,t)}else o||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}function a(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return I<=e?e=I:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function c(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(k("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?b(o,e):o(e))}function o(e){k("emit readable"),e.emit("readable"),g(e)}function l(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(k("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function i(e){k("readable nexttick read 0"),e.read(0)}function s(e,t){t.reading||(k("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),g(e),t.flowing&&!t.reading&&e.read(0)}function g(e){var t=e._readableState;for(k("flow",t.flowing);t.flowing&&null!==e.read(););}function u(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,o=n.data;for(e-=o.length;n=n.next;){var a=n.data,i=e>a.length?a.length:e;if(o+=i===a.length?a:a.slice(0,e),0===(e-=i)){i===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n).data=a.slice(i);break}++r}return t.length-=r,o}(e,t):function(e,t){var n=x.allocUnsafe(e),r=t.head,o=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var a=r.data,i=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,i),0===(e-=i)){i===a.length?(++o,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r).data=a.slice(i);break}++o}return t.length-=o,n}(e,t),r}(e,t.buffer,t.decoder),n);var n}function f(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,b(d,t,e))}function d(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function m(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}O.exports=n;var p,b=j(241),_=j(314);n.ReadableState=t;var h,w=(j(41).EventEmitter,function(e,t){return e.listeners(t).length});!function(){try{h=j(254)}catch(e){}finally{h=h||j(41).EventEmitter}}();var y=j(49).Buffer,x=j(196),e=j(106);e.inherits=j(63);var E=j(982),k=void 0;k=E&&E.debuglog?E.debuglog("stream"):function(){};var T,A=j(909);e.inherits(n,h),n.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=x.from(e,t),t=""),r(this,n,e,t,!1)},n.prototype.unshift=function(e){return r(this,this._readableState,e,"",!0)},n.prototype.isPaused=function(){return!1===this._readableState.flowing},n.prototype.setEncoding=function(e){return T=T||j(397).StringDecoder,this._readableState.decoder=new T(e),this._readableState.encoding=e,this};var I=8388608;n.prototype.read=function(e){k("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return k("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?f(this):c(this),null;if(0===(e=a(e,t))&&t.ended)return 0===t.length&&f(this),null;var r,o=t.needReadable;return k("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&k("length less than watermark",o=!0),t.ended||t.reading?k("reading or ended",o=!1):o&&(k("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=a(n,t))),null===(r=0<e?u(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&f(this)),null!==r&&this.emit("data",r),r},n.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},n.prototype.pipe=function(t,e){function n(e){k("onunpipe"),e===l&&o()}function r(){k("onend"),t.end()}function o(){k("cleanup"),t.removeListener("close",s),t.removeListener("finish",u),t.removeListener("drain",p),t.removeListener("error",i),t.removeListener("unpipe",n),l.removeListener("end",r),l.removeListener("end",o),l.removeListener("data",a),h=!0,!f.awaitDrain||t._writableState&&!t._writableState.needDrain||p()}function a(e){k("ondata"),(y=!1)!==t.write(e)||y||((1===f.pipesCount&&f.pipes===t||1<f.pipesCount&&-1!==m(f.pipes,t))&&!h&&(k("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,y=!0),l.pause())}function i(e){k("onerror",e),c(),t.removeListener("error",i),0===w(t,"error")&&t.emit("error",e)}function s(){t.removeListener("finish",u),c()}function u(){k("onfinish"),t.removeListener("close",s),c()}function c(){k("unpipe"),l.unpipe(t)}var l=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=t;break;case 1:f.pipes=[f.pipes,t];break;default:f.pipes.push(t)}f.pipesCount+=1,k("pipe count=%d opts=%j",f.pipesCount,e);var d=(!e||!1!==e.end)&&t!==v.stdout&&t!==v.stderr?r:o;f.endEmitted?b(d):l.once("end",d),t.on("unpipe",n);var p=function(t){return function(){var e=t._readableState;k("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&w(t,"data")&&(e.flowing=!0,g(t))}}(l);t.on("drain",p);var h=!1,y=!1;return l.on("data",a),function(e,t,n){"function"==typeof e.prependListener?e.prependListener(t,n):e._events&&e._events[t]?_(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(t,"error",i),t.once("close",s),t.once("finish",u),t.emit("pipe",l),f.flowing||(k("pipe resume"),l.resume()),t},n.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this);return this}var a=m(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},n.prototype.addListener=n.prototype.on=function(e,t){var n=h.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&c(this):b(i,this))}return n},n.prototype.resume=function(){var e=this._readableState;return e.flowing||(k("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,b(s,e,t))}(this,e)),this},n.prototype.pause=function(){return k("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(k("pause"),this._readableState.flowing=!1,this.emit("pause")),this},n.prototype.wrap=function(t){var n=this._readableState,r=!1,o=this;for(var e in t.on("end",function(){if(k("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&o.push(e)}o.push(null)}),t.on("data",function(e){k("wrapped data"),n.decoder&&(e=n.decoder.write(e)),n.objectMode&&null==e||!(n.objectMode||e&&e.length)||(o.push(e)||(r=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));return function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}(["error","close","destroy","pause","resume"],function(e){t.on(e,o.emit.bind(o,e))}),o._read=function(e){k("wrapped _read",e),r&&(r=!1,t.resume())},o},n._fromList=u}).call(e,j(66))},function(e,t,n){var o=n(165),a=n(44)("toStringTag"),i="Arguments"==o(function(){return arguments}());e.exports=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:i?o(t):"Object"==(r=o(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(43).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(165);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";function b(){return this}var _=n(386),w=n(90),x=n(943),E=n(91),k=n(168),T=n(120),A=n(930),I=n(249),O=n(938),j=n(44)("iterator"),S=!([].keys&&"next"in[].keys()),M="values";e.exports=function(e,t,n,r,o,a,i){A(n,t,r);function s(e){if(!S&&e in h)return h[e];switch(e){case"keys":case M:return function(){return new n(this,e)}}return function(){return new n(this,e)}}var u,c,l,f=t+" Iterator",d=o==M,p=!1,h=e.prototype,y=h[j]||h["@@iterator"]||o&&h[o],v=y||s(o),g=o?d?s("entries"):v:void 0,m="Array"==t&&h.entries||y;if(m&&((l=O(m.call(new e)))!==Object.prototype&&l.next&&(I(l,f,!0),_||k(l,j)||E(l,j,b))),d&&y&&y.name!==M&&(p=!0,v=function(){return y.call(this)}),_&&!i||!S&&!p&&h[j]||E(h,j,v),T[t]=v,T[f]=b,o)if(u={values:d?v:s(M),keys:a?v:s("keys"),entries:g},i)for(c in u)c in h||x(h,c,u[c]);else w(w.P+w.F*(S||p),t,u);return u}},function(e,t){e.exports=!0},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(76),o=n(119),a=n(247);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=a.f(e);return(0,n.resolve)(t),n.promise}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(43),o="__core-js_shared__",a=r[o]||(r[o]={});e.exports=function(e){return a[e]||(a[e]={})}},function(e,t,n){var o=n(76),a=n(164),i=n(44)("species");e.exports=function(e,t){var n,r=o(e).constructor;return void 0===r||null==(n=o(r)[i])?t:a(n)}},function(e,t,n){function r(){var e=+this;if(b.hasOwnProperty(e)){var t=b[e];delete b[e],t()}}function o(e){r.call(e.data)}var a,i,s,u=n(166),c=n(927),l=n(383),f=n(246),d=n(43),p=d.process,h=d.setImmediate,y=d.clearImmediate,v=d.MessageChannel,g=d.Dispatch,m=0,b={},_="onreadystatechange";h&&y||(h=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return b[++m]=function(){c("function"==typeof e?e:Function(e),t)},a(m),m},y=function(e){delete b[e]},"process"==n(165)(p)?a=function(e){p.nextTick(u(r,e,1))}:g&&g.now?a=function(e){g.now(u(r,e,1))}:v?(s=(i=new v).port2,i.port1.onmessage=o,a=u(s.postMessage,s,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(a=function(e){d.postMessage(e+"","*")},d.addEventListener("message",o,!1)):a=_ in f("script")?function(e){l.appendChild(f("script"))[_]=function(){l.removeChild(this),r.call(e)}}:function(e){setTimeout(u(r,e,1),0)}),e.exports={set:h,clear:y}},function(e,t,n){var r=n(251),o=Math.min;e.exports=function(e){return 0<e?o(r(e),9007199254740991):0}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){"use strict";var h=n(790);e.exports=function(e,t,n,r){var o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var a=h(e),i=h(t),s=a.length;if(s!==i.length)return!1;r=r||null;for(var u=Object.prototype.hasOwnProperty.bind(t),c=0;c<s;c++){var l=a[c];if(!u(l))return!1;var f=e[l],d=t[l],p=n?n.call(r,f,d,l):void 0;if(!1===p||void 0===p&&f!==d)return!1}return!0}},function(e,s){(function(e){function n(){if(void 0!==o)return o;if(e.XMLHttpRequest){o=new e.XMLHttpRequest;try{o.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){o=null}}else o=null;return o}function t(e){var t=n();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}function r(e){return"function"==typeof e}s.fetch=r(e.fetch)&&r(e.ReadableStream),s.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),s.blobConstructor=!0}catch(e){}var o,a=void 0!==e.ArrayBuffer,i=a&&r(e.ArrayBuffer.prototype.slice);s.arraybuffer=s.fetch||a&&t("arraybuffer"),s.msstream=!s.fetch&&i&&t("ms-stream"),s.mozchunkedarraybuffer=!s.fetch&&a&&t("moz-chunked-arraybuffer"),s.overrideMimeType=s.fetch||!!n()&&r(n().overrideMimeType),s.vbArray=r(e.VBArray),o=null}).call(s,function(){return this}())},function(e,t,n){function r(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function a(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var i=n(49).Buffer,s=i.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!s(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=r)}this.charBuffer=new i(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!(55296<=(o=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))&&o<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var r=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,r),r-=this.charReceived);var o;r=(t+=e.toString(this.encoding,0,r)).length-1;if(55296<=(o=t.charCodeAt(r))&&o<=56319){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),e.copy(this.charBuffer,0,0,a),t.substring(0,r)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=3<=e.length?3:e.length;0<t;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,o=this.encoding;t+=r.slice(0,n).toString(o)}return t}},function(e,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return null!==e&&"object"===n(e)}},function(e,t){for(var o=[],n=0;n<256;++n)o[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=o;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}},function(a,e){(function(e){var t,n=e.crypto||e.msCrypto;if(n&&n.getRandomValues){var r=new Uint8Array(16);t=function(){return n.getRandomValues(r),r}}if(!t){var o=new Array(16);t=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}a.exports=t}).call(e,function(){return this}())},function(e,t,n){e.exports=n(977)},function(e,t){var n,r,o;n=this,r=-1,o={onVisible:function(n){var e=o.isSupported();if(!e||!o.hidden())return n(),e;var r=o.change(function(e,t){o.hidden()||(o.unbind(r),n())});return r},change:function(e){if(!o.isSupported())return!1;var t=r+=1;return o._callbacks[t]=e,o._listen(),t},unbind:function(e){delete o._callbacks[e]},afterPrerendering:function(n){var e=o.isSupported();if(!e||"prerender"!=o.state())return n(),e;var r=o.change(function(e,t){"prerender"!=t&&(o.unbind(r),n())});return r},hidden:function(){return!(!o._doc.hidden&&!o._doc.webkitHidden)},state:function(){return o._doc.visibilityState||o._doc.webkitVisibilityState||"visible"},isSupported:function(){return void 0!==o._doc.hidden||void 0!==o._doc.webkitHidden},_doc:document||{},_callbacks:{},_change:function(e){var t=o.state();for(var n in o._callbacks)o._callbacks[n].call(o._doc,e,t)},_listen:function(){if(!o._init){var e="visibilitychange";o._doc.webkitVisibilityState&&(e="webkit"+e);function t(){o._change.apply(o,arguments)}o._doc.addEventListener?o._doc.addEventListener(e,t):o._doc.attachEvent(e,t),o._init=!0}}},void 0!==e&&e.exports?e.exports=o:n.Visibility=o},function(t,n,r){var o,a;(function(e){void 0===(a="function"==typeof(o=function(){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}var c=function(){function e(){n(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return o(e,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,o=n.length;r<o;r++)if(n[r]===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(t){var n=this;if(t.type in this.listeners){for(var e=function(e){setTimeout(function(){return e.call(n,t)})},r=this.listeners[t.type],o=0,a=r.length;o<a;o++)e(r[o]);return!t.defaultPrevented}}}]),e}(),t=function(e){function t(){var e;return n(this,t),(e=function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?s(e):t}(this,a(t).call(this))).listeners||c.call(s(e)),Object.defineProperty(s(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(s(e),"onabort",{value:null,writable:!0,configurable:!0}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,e),o(t,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),u(a(t.prototype),"dispatchEvent",this).call(this,e)}}]),t}(c),l=function(){function e(){n(this,e),Object.defineProperty(this,"signal",{value:new t,writable:!0,configurable:!0})}return o(e,[{key:"abort",value:function(){var t;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(l.prototype[Symbol.toStringTag]="AbortController",t.prototype[Symbol.toStringTag]="AbortSignal"),function(e){!function(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}(e)||(e.AbortController=l,e.AbortSignal=t)}("undefined"!=typeof self?self:e)})?o.call(n,r,n,t):o)||(t.exports=a)}).call(n,function(){return this}())},function(d,e){(function(e){"use strict";function t(e){u.length||(o(),!0),u[u.length]=e}function n(){for(;c<u.length;){var e=c;if(c+=1,u[e].call(),1024<c){for(var t=0,n=u.length-c;t<n;t++)u[t]=u[t+c];u.length-=c,c=0}}u.length=0,c=0,!1}function r(r){return function(){function e(){clearTimeout(t),clearInterval(n),r()}var t=setTimeout(e,0),n=setInterval(e,50)}}d.exports=t;var o,a,i,s,u=[],c=0,l=void 0!==e?e:self,f=l.MutationObserver||l.WebKitMutationObserver;o="function"==typeof f?(a=1,i=new f(n),s=document.createTextNode(""),i.observe(s,{characterData:!0}),function(){a=-a,s.data=a}):r(n),t.requestFlush=o,t.makeRequestCallFromTimer=r}).call(e,function(){return this}())},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function M(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,h.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=M(t[0],n);return t.every(function(e){return M(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return M(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,G.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,p.default)(e))+": "+M(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function R(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,h.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=R(t[0],n);return t.every(function(e){return R(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return R(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,G.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,p.default)(e))+": "+R(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.TigerConnectClient=void 0;var a,i,s,u,c,l,f,d,p=o(n(4)),h=o(n(3)),g=o(n(19)),y=o(n(10)),v=o(n(9)),C=o(n(20)),P=o(n(13)),z=o(n(12)),V=o(n(24)),G=o(n(5)),N=o(n(16)),D=o(n(38)),U=o(n(1)),m=o(n(2)),F=o(n(888)),L=o(n(886)),B=o(n(235)),b=o(n(41)),_=o(n(697)),$=o(n(907)),w=o(n(255)),q=r(n(434)),H=r(n(18)),Y=o(n(257)),Z=o(n(406)),W=r(n(36)),x=o(n(172)),K=o(n(480)),X=o(n(494)),Q=o(n(123)),J=r(n(521)),ee=o(n(523)),te=n(29),ne=o(n(534)),E=t.TigerConnectClient=((0,m.default)(re,[{key:"_listenToEvents",value:function(){var r=this;this.on("signedIn",function(e,t){r.logger.info("signedIn",e.id)}),this.on("signedOut",function(e){e.resetClient&&r.reset()}),this.on("signUp",function(e){var t=e.user,n=e.auth;r.logger.info("signUp",t.id),r._setCurrentUser(t),r._setAuth(n)}),this.events.on("event",function(e){r.emit("event",e),"bang"===e.type&&r._resetLastBang()}),this.events.on("batch:available",function(e){return r.emit("events:batch:available",e)}),this.events.on("connected",function(){return r.emit("events:connected")}),this.events.on("disconnected",this._onDisconnected),this.events.on("processing:start",function(e){return r.emit("processing:start",e)}),this.events.on("processing:stop",function(e){return r.emit("processing:stop",e)}),this.events.on("visibilityChange",function(e,t){return r.emit("visibilityChange",e,t)}),this.calls.on("answered",function(e){return r.emit("call:answered",e)}),this.calls.on("ended",function(e){return r.emit("call:ended",e)}),this.calls.on("incoming",function(e){return r.emit("call:incoming",e)}),this.calls.on("state",function(e){return r.emit("call:state",e)}),this.conversations.on("clearTimeline",function(e){return r.emit("conversation:clearTimeline",e)}),this.conversations.on("clearMessageStatuses",function(e){return r.emit("conversation:clearMessageStatuses",e)}),this.conversations.on("message",function(e){return r.emit("message",e)}),this.conversations.on("friends",function(e){return r.emit("friends",e)}),this.eventSourceClient.on("auth:invalid",function(){return r.emit("auth:invalid")}),this.groups.on("membership:change",function(e){return r.emit("group:membership:change",e)}),this.httpClient.on("networkStatus:change",function(e){return r.emit("networkStatus:change",e)}),this.notifications.on("connected",function(){return r.emit("notifications:connected")}),this.notifications.on("disconnected",function(e){return r.emit("notifications:disconnected")}),this.notifications.on("signingIn",function(){return r.emit("notifications:signingIn")}),this.notifications.on("signedIn",function(e){return r.emit("notifications:signedIn",e)}),this.notifications.on("signingOut",function(e){return r.emit("notifications:signingOut",e)}),this.notifications.on("signedOut",function(e){return r.emit("notifications:signedOut",e)}),this.notifications.on("event",function(e){return r.emit("notifications:event",e)}),this.notifications.on("message",function(e){return r.emit("notification:message",e)}),this.notifications.on("unread:change",function(e){return r.emit("notification:unread:change",e)}),this.organizations.on("preferences:change",function(e){return r.emit("organization:preferences:change",e)}),this.presence.on("change",function(e){return r.emit("presence:change",e)}),this.roles.on("change",function(e){return r.emit("role:change",e)}),this.typingStatus.on("change",function(e){return r.emit("typing:change",e)}),this.users.on("preferences:change",function(e){return r.emit("user:preferences:change",e)}),"undefined"!=typeof window&&window.addEventListener("unload",this._onBrowserUnload)}},{key:"_startTicker",value:function(){this.__ticker=setTimeout(this._onTick,5e3),this.__tickerFrame=null}},{key:"_stopTicker",value:function(){null!==this.__ticker&&(clearTimeout(this.__ticker),this.__ticker=null),null!==this.__tickerFrame&&($.default.cancel(this.__tickerFrame),this.__tickerFrame=null)}},{key:"signIn",value:(d=(0,v.default)(y.default.mark(function e(t,n){var r,o,a,i,s,u,c,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.udid,o=void 0===r?(0,w.default)():r,a=l.refreshUser,i=void 0===a||a,this.emit("signingIn"),e.next=4,this.users.signIn(t,n,{udid:o});case 4:if(s=e.sent,u=s.auth,c=s.user,this._setCurrentUser(c),this._setAuth(u),i)return e.next=12,this.users.findMe({bypassCache:!0});e.next=12;break;case 12:return this.emit("signedIn",c,u),e.abrupt("return",{auth:u,user:c});case 14:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)})},{key:"signInWithApiKeyAndSecret",value:(f=(0,v.default)(y.default.mark(function e(t,n){var r,o,a,i,s,u,c,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.udid,o=void 0===r?(0,w.default)():r,a=l.refreshUser,i=void 0===a||a,this.emit("signingIn"),e.next=4,this.users.signInWithApiKeyAndSecret(t,n,{udid:o});case 4:if(s=e.sent,u=s.auth,c=s.user,this._setCurrentUser(c),this._setAuth(u),i)return e.next=12,this.users.findMe({bypassCache:!0});e.next=12;break;case 12:return this.emit("signedIn",c,u),e.abrupt("return",{auth:u,user:c});case 14:case"end":return e.stop()}},e,this)})),function(e,t){return f.apply(this,arguments)})},{key:"signInWithMagicToken",value:(l=(0,v.default)(y.default.mark(function e(t){var n,r,o,a,i,s,u,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.udid,r=void 0===n?(0,w.default)():n,o=c.refreshUser,a=void 0===o||o,this.emit("signingIn"),e.next=4,this.users.signInWithMagicToken(t,{udid:r});case 4:if(i=e.sent,s=i.auth,u=i.user,this._setCurrentUser(u),this._setAuth(s),a)return e.next=12,this.users.findMe({bypassCache:!0});e.next=12;break;case 12:return this.emit("signedIn",u,s),e.abrupt("return",{auth:s,user:u});case 14:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"signOut",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.async,n=void 0===t||t,r=e.fromServer,o=void 0!==r&&r,a=e.resetClient,i=void 0===a||a;if(!this.isSignedIn)return g.default.resolve(!1);if(!n&&"undefined"==typeof XMLHttpRequest)throw new Error("`async: false` option cannot be set unless using signOut() in a browser");if(this.events.disconnect({source:"On sign out"}),n)return this.users.signOut({fromServer:o,resetClient:i});this.emit("signingOut",{fromServer:o,resetClient:i});var s=new XMLHttpRequest;if(s.open("POST",this.config.baseUrl+"/v2/logout",!1),!(p=(0,V.default)(this.httpClient.getAuthHeaders()))||"function"!=typeof p[z.default]&&!Array.isArray(p))throw new TypeError("Expected _Object$entries3 to be iterable, got "+M(p));if(!p||"function"!=typeof p[z.default]&&!Array.isArray(p))throw new TypeError("Expected _Object$entries3 to be iterable, got "+R(p));var u=!0,c=!1,l=void 0;try{for(var f,d=(0,P.default)(p);!(u=(f=d.next()).done);u=!0){var p,h=(0,C.default)(f.value,2),y=h[0],v=h[1];s.setRequestHeader(y,v)}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}return s.send(null),this.emit("signedOut",{fromServer:o,resetClient:i,signedOut:!0}),g.default.resolve(!0)}},{key:"signOutAllDevices",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).async,t=void 0===e||e;if(!this.isSignedIn)return g.default.resolve();if(!t&&"undefined"==typeof XMLHttpRequest)throw new Error("`async: false` option cannot be set unless using signOutAllDevices() in a browser");if(t)return this.users.signOutAllDevices();var n=new XMLHttpRequest;if(n.open("POST",this.config.baseUrl+"/v2/wipe?token="+this.currentUserId,!1),!(u=(0,V.default)(this.httpClient.getAuthHeaders()))||"function"!=typeof u[z.default]&&!Array.isArray(u))throw new TypeError("Expected _Object$entries4 to be iterable, got "+M(u));if(!u||"function"!=typeof u[z.default]&&!Array.isArray(u))throw new TypeError("Expected _Object$entries4 to be iterable, got "+R(u));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,P.default)(u);!(r=(i=s.next()).done);r=!0){var u,c=(0,C.default)(i.value,2),l=c[0],f=c[1];n.setRequestHeader(l,f)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n.send(null),g.default.resolve()}},{key:"authenticate",value:(c=(0,v.default)(y.default.mark(function e(t,n){var r;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+R(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\nstring\n\nGot:\n'+R(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+M(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\nstring\n\nGot:\n'+M(n));e.next=8;break;case 8:return e.next=10,this._authenticateWithParams({key:t,secret:n});case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return c.apply(this,arguments)})},{key:"authenticateUsingOauth",value:(u=(0,v.default)(y.default.mark(function e(t){var n,r,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{udid:void 0};return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "bearerToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+R(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "bearerToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+M(t));e.next=4;break;case 4:return n=a.udid,r=void 0===n?(0,w.default)():n,e.next=7,this._authenticateWithParams({bearerToken:t,udid:r});case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"_authenticateWithParams",value:(s=(0,v.default)(y.default.mark(function e(t){var n;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._setAuth(t),e.prev=1,e.next=4,this.users.findMe();case 4:return n=e.sent,this._setCurrentUser(n),this.emit("signedIn",n,t),e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(1),this._removeAuth(),this._currentUser=null,e.t0;case 15:case"end":return e.stop()}},e,this,[[1,10]])})),function(e){return s.apply(this,arguments)})},{key:"_setCurrentUser",value:function(e){this._currentUser=e}},{key:"_setAuth",value:function(e){this._auth=e,this.httpClient.setAuth(e),this.events.setAuth(e)}},{key:"_removeAuth",value:function(){this._auth=null,this.httpClient.removeAuth(),this.events.removeAuth()}},{key:"getCurrentUser",value:function(){return this._currentUser||null}},{key:"getAuth",value:function(){return this._auth}},{key:"requireUser",value:function(){if(!this.isSignedIn)throw new H.NotSignedInError}},{key:"reactToAdvisoryEvent",value:function(e,t){switch(this.emit("advisory",{type:e,data:t}),e){case"replayStart":this.currentlyServingOfflineMessages=!0,this.emit("messages:offline:start",t),this.products._addProcessingEvent({actionType:x.default.MESSAGE_REPLAY,entity:this.products.getAll()[0],itemsEstimate:t.replayMessageCount});break;case"replayStop":null===this._checkBangTimer&&(this.emit("groups:offline:start"),this._startBangTimer()),this.products._removeProcessingEvent({actionType:x.default.MESSAGE_REPLAY,entity:this.products.getAll()[0]})}}},{key:"modelByTypeNS",value:function(e){return this.MODEL_BY_TYPE_NS[e]}},{key:"modelNameByTypeNS",value:function(e){var t=this.MODEL_BY_TYPE_NS[e];return t?t.name:((0,_.default)(t,"modelNameByTypeNS: Missing class for "+e),null)}},{key:"modelNameByEntityType",value:function(e){var t=this.modelsByEntityType[e]||this.MODEL_BY_TYPE_NS[e];return t?t.name:void(0,_.default)(t,"modelNameByEntityType: Missing class for "+e)}},{key:"ejectModel",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.xmlns||e.type,n=this.MODEL_BY_TYPE_NS[t]||this.modelsByEntityType[t];return n?n.eject(e):void(0,_.default)(n,"ejectModel: Missing class for "+t)}},{key:"injectModel",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.xmlns||e.type,n=this.MODEL_BY_TYPE_NS[t]||this.modelsByEntityType[t];return n?n.inject(e):((0,_.default)(n,"injectModel: Missing class for "+t),null)}},{key:"injectPlaceholderModel",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e.xmlns||e.type,n=this.modelByTypeNS(t)||this.modelsByEntityType[t];return n?n.injectPlaceholder(e):((0,_.default)(n,"injectPlaceholderModel: Missing class for "+t),null)}},{key:"getEntity",value:function(e,t){return this.modelsByEntityType[e].get(t)}},{key:"getEntities",value:function(e){var t=this;return e.map(function(e){return t.getEntity(e.type,e.id)})}},{key:"dispose",value:function(){if(this._stopTicker(),this.conversationsLoaded=!1,null!==this._checkBangTimer&&(clearTimeout(this._checkBangTimer),this._checkBangTimer=null),!(a=this._services)||"function"!=typeof a[z.default]&&!Array.isArray(a))throw new TypeError("Expected _services2 to be iterable, got "+M(a));if(!a||"function"!=typeof a[z.default]&&!Array.isArray(a))throw new TypeError("Expected _services2 to be iterable, got "+R(a));var e=!0,t=!1,n=void 0;try{for(var r,o=(0,P.default)(a);!(e=(r=o.next()).done);e=!0){var a,i=r.value;i.dispose&&i.dispose()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this.store&&this.store.clear()}},{key:"reset",value:function(){if(this.dispose(),!(a=this._services)||"function"!=typeof a[z.default]&&!Array.isArray(a))throw new TypeError("Expected _services3 to be iterable, got "+M(a));if(!a||"function"!=typeof a[z.default]&&!Array.isArray(a))throw new TypeError("Expected _services3 to be iterable, got "+R(a));var e=!0,t=!1,n=void 0;try{for(var r,o=(0,P.default)(a);!(e=(r=o.next()).done);e=!0){var a,i=r.value;i.mounted&&i.mounted()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}this._startTicker()}},{key:"configure",value:function(e){return(0,D.default)(this.config,e),this.httpClient.mounted(),this}},{key:"setDefaultOrganization",value:function(e){return this.configure({defaultOrganizationId:e})}},{key:"currentUser",get:function(){return this.getCurrentUser()}},{key:"currentUserId",get:function(){var e=this.getCurrentUser();return e?e.id:null}},{key:"isSignedIn",get:function(){return!!this.getAuth()}},{key:"MODEL_BY_TYPE_NS",get:function(){return this._MODEL_BY_TYPE_NS||(this._MODEL_BY_TYPE_NS={"tigertext:entity:account":this.models.User,"tigertext:entity:group":this.models.Group,"tigertext:entity:distribution_list":this.models.DistributionList,"tigertext:entity:dist_list_member":this.models.User,"tigertext:entity:list":this.models.DistributionList,"tigertext:entity:message_template":this.models.MessageTemplate,"tigertext:entity:patient_distribution_list":this.models.DistributionList,"tigertext:entity:schedule_message":this.models.ScheduledMessage,"tigertext:entity:tag":this.models.RoleTag,"tigertext:entity:team":this.models.Team,"tigertext:iq:message":this.models.Message,"tigertext:iq:group_message":this.models.Message,"tigertext:iq:group:message":this.models.Message}),this._MODEL_BY_TYPE_NS}},{key:"networkStatus",get:function(){return this.httpClient.networkStatus}},{key:"forgotPasswordUrl",get:function(){return Y.default.FORGOT_PASSWORD_URLS[this.config.apiEnv]}},{key:"adminUrl",get:function(){return this.config.adminFeatureBranch?"/feature/"+this.config.adminFeatureBranch+"/app/admin":this.config.localAdminUrl?this.config.localAdminUrl:Y.default.ADMIN_URLS[this.config.apiEnv]}},{key:"cnUrl",get:function(){return this.config.localCnUrl?this.config.localCnUrl:Y.default.CN_URLS[this.config.apiEnv]}},{key:"rolesUrl",get:function(){return this.config.localRolesUrl?this.config.localRolesUrl:Y.default.ROLES_URLS[this.config.apiEnv]}}]),i=a=re,a.CONSUMER_ORGANIZATION_ID=Y.default.CONSUMER_ORGANIZATION_ID,a.errors=H,a.VERSION=ne.default,a.version=ne.default,i);function re(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if((0,U.default)(this,re),this.errors=H,this.VERSION=ne.default,this.version=ne.default,this._onBrowserUnload=function(){var r=[];n.emit("browserUnload",function(e,t,n){return r.push({fn:e,priority:t,name:n})}),(0,F.default)(r,["priority"],["desc"]).forEach(function(e){var t=e.fn,n=e.priority,r=e.name;console.log("[unload]",n,r),t()})},this._onDisconnected=function(e){var t=e.isRecoverable;t||n._removeAuth(),n.emit("events:disconnected",{isRecoverable:t})},this._onTick=function(){n.__tickerFrame=(0,$.default)(function(){try{n.emit("tick")}finally{n.__ticker=setTimeout(n._onTick,5e3)}})},this._resetLastBang=function(){n._bangOccurredDuringReplay=!0},this._startBangTimer=function(){n._bangOccurredDuringReplay=!1,n._checkBangTimer=setTimeout(n._didBangOccur,n.config.detectBangReplayTimeout)},this._didBangOccur=function(){n._bangOccurredDuringReplay?n._startBangTimer():(n._checkBangTimer=null,n._bangReplayDone())},this._bangReplayDone=function(){n.currentlyServingOfflineMessages&&(n.currentlyServingOfflineMessages=!1,n.emit("conversations:loading:start"),n.conversations.hasPendingReloads()&&n.conversations.__flushConversationsToReload(),n.emit("groups:offline:stop"),n.emit("messages:offline:stop"),n.emit("conversations:loading:stop"),n.emit("messages:new:start"))},!(null==e||e instanceof Object))throw new TypeError('Value of argument "originalConfig" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+R(e));if(!(null==e||e instanceof Object))throw new TypeError('Value of argument "originalConfig" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+M(e));this.config=(0,D.default)({},e),(0,B.default)(this.config,Y.default.CONFIG_DEFAULT);var t=this.config,r=t.apiEnv,o=t.logLevel;if(this.config.cloudfront=Y.default.CLOUDFRONT[r],/(env\d+|lt\d*)/.test(r)&&(this.config.cloudfront=Y.default.CLOUDFRONT.development,Y.default.BASE_URLS[this.config.apiEnv]="https://"+r+"-devapi.tigertext.xyz",Y.default.FORGOT_PASSWORD_URLS[this.config.apiEnv]="https://"+r+"-forget.tigertext.com",Y.default.CN_URLS[this.config.apiEnv]="https://"+r+"-console.tigertext.xyz",Y.default.ADMIN_URLS[this.config.apiEnv]=Y.default.CN_URLS[r]+"/app/admin",Y.default.ROLES_URLS[this.config.apiEnv]="/"+r+"/app/roles/index.html"),this.config.baseUrl||(this.config.baseUrl=Y.default.BASE_URLS[r]),(0,D.default)(this,{attachments:te.attachments,date:te.date,email:te.email,phone:te.phone}),this.httpClient=new X.default({config:this.config,logger:new Z.default({name:"HttpClient",level:o})}),this.eventSourceClient=new K.default({config:this.config,httpClient:this.httpClient,logger:new Z.default({name:"EventSourceClient",level:o})}),this.enums=(0,N.default)({},W,{NetworkStatus:Q.default}),this.store=new ee.default(this,{logger:new Z.default({name:"Store",level:o})}),this.store.defineModels(),this.models=this.store.models,this.modelsByEntityType=(0,L.default)(this.store.models,function(e,t){return te.Camelizer.camelizeKey(t)}),this.modelsByEntityType.account=this.modelsByEntityType.user,this.modelsByEntityType.list=this.modelsByEntityType.distributionList,this.allModelEntityTypes=(0,G.default)(this.modelsByEntityType),this.logger=new Z.default({name:"TigerConnectClient",level:o}),this.api={},!(l=(0,V.default)(q))||"function"!=typeof l[z.default]&&!Array.isArray(l))throw new TypeError("Expected _Object$entries to be iterable, got "+M(l));if(!l||"function"!=typeof l[z.default]&&!Array.isArray(l))throw new TypeError("Expected _Object$entries to be iterable, got "+R(l));var a=!0,i=!1,s=void 0;try{for(var u,c=(0,P.default)(l);!(a=(u=c.next()).done);a=!0){var l,f=(0,C.default)(u.value,2),d=f[0],p=f[1],h=te.Camelizer.camelizeKey(d);this.api[h]=new p(this,{logger:new Z.default({name:d+"API",level:o})})}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}if(this._services=[],!(_=(0,V.default)(J))||"function"!=typeof _[z.default]&&!Array.isArray(_))throw new TypeError("Expected _Object$entries2 to be iterable, got "+M(_));if(!_||"function"!=typeof _[z.default]&&!Array.isArray(_))throw new TypeError("Expected _Object$entries2 to be iterable, got "+R(_));var y=!0,v=!1,g=void 0;try{for(var m,b=(0,P.default)(_);!(y=(m=b.next()).done);y=!0){var _,w=(0,C.default)(m.value,2),x=(d=w[0],p=w[1],te.Camelizer.camelizeKey(d)),E=new p(this,{logger:new Z.default({name:d+"Service",level:this.config.serviceLogLevels[x]||o})});this[x]=E,this._services.push(E)}}catch(e){v=!0,g=e}finally{try{!y&&b.return&&b.return()}finally{if(v)throw g}}if(!(j=this._services)||"function"!=typeof j[z.default]&&!Array.isArray(j))throw new TypeError("Expected _services to be iterable, got "+M(j));if(!j||"function"!=typeof j[z.default]&&!Array.isArray(j))throw new TypeError("Expected _services to be iterable, got "+R(j));var k=!0,T=!1,A=void 0;try{for(var I,O=(0,P.default)(j);!(k=(I=O.next()).done);k=!0){var j,S=I.value;S.mounted&&S.mounted()}}catch(e){T=!0,A=e}finally{try{!k&&O.return&&O.return()}finally{if(T)throw A}}this._listenToEvents(),this._startTicker(),this.on("browserUnload",function(e){return e(function(){n.config.autoSignOutOnBrowserUnload&&(n.notifications.disconnect({source:"On browser unload"}),n.signOut({async:!1,resetClient:!1}))},100,"signOut")}),this._checkBangTimer=null,this.conversationsLoaded=!1,this.currentlyServingOfflineMessages=!1}(0,D.default)(E.prototype,b.default.prototype)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,l.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,u.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,l.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,u.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.LOG_LEVELS=t.default=void 0;var u=r(n(4)),c=r(n(5)),l=r(n(3)),a=r(n(47)),o=r(n(1)),f=((0,r(n(2)).default)(d,[{key:"setLevel",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(e));if("string"!=typeof e)throw new TypeError('Value of argument "level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));if(this.level=e.toLowerCase(),"string"!=typeof this.level)throw new TypeError('Value of "this.level" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(this.level))}}]),d);function d(e){var t=e.name,n=e.level;if((0,o.default)(this,d),null==e||"string"!=typeof e.name||"string"!=typeof e.level)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  name: string;\n  level: string;\n}\n\nGot:\n"+s(e));if(null==e||"string"!=typeof e.name||"string"!=typeof e.level)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  name: string;\n  level: string;\n}\n\nGot:\n"+i(e));this.name=t,this.level=n}t.default=f;var p=t.LOG_LEVELS=["debug","log","info","warn","error"],h=p.reduce(function(e,t,n){return e[t]=n,e},{});p.forEach(function(r){var o=h[r];f.prototype[r]=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o>=h[this.level]&&(t=["["+this.name+"]"].concat((0,a.default)(t)),Function.prototype.apply.call(console[r],console,t))}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,d=r(n(16)),p=r(n(10)),h=r(n(9)),y=r(n(6)),v=r(n(1)),g=r(n(2)),m=r(n(8)),b=r(n(7)),_=r(n(73)),w=r(n(14)),x=r(n(45)),E=(o=w.default,(0,b.default)(k,o),(0,g.default)(k,[{key:"start",value:(f=(0,h.default)(p.default.mark(function e(t){var n,r,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v2/voip_call",{data:x.default.underscoreObject(t),headers:{"TT-X-Organization-Key":t.organizationId}});case 2:return n=e.sent,r=(0,_.default)(n,"data.disabled_participants",{}),(o=x.default.camelizeObject(n.data)).disabledParticipants=r,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"end",value:(l=(0,h.default)(p.default.mark(function e(t,n,r){var o,a,i,s=r.callId,u=r.payload,c=r.reason;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,_.default)(u,"disabledParticipants",{}),(a=x.default.underscoreObject({payload:u,reason:c,callId:s})).payload.disabled_participants=o,e.next=5,this.httpClient.post("/v2/voip_call/"+t+"/end",{data:a,headers:{"TT-X-Organization-Key":n}});case 5:return i=e.sent,e.abrupt("return",i.data);case 7:case"end":return e.stop()}},e,this)})),function(e,t,n){return l.apply(this,arguments)})},{key:"decline",value:(c=(0,h.default)(p.default.mark(function e(t,n,r){var o,a,i,s=r.callId,u=r.payload;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,_.default)(u,"disabledParticipants",{}),(a=x.default.underscoreObject({payload:(0,d.default)({},u,{reason:"declined",callId:s}),reason:"declined",callId:s,type:"call_ended",roomName:t})).payload.disabled_participants=o,e.next=6,this.httpClient.post("/v2/voip_call/"+t+"/end",{data:a,headers:{"TT-X-Organization-Key":n}});case 6:return i=e.sent,e.abrupt("return",i.data);case 8:case"end":return e.stop()}},e,this)})),function(e,t,n){return c.apply(this,arguments)})},{key:"join",value:(u=(0,h.default)(p.default.mark(function e(t,n){var r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("/v2/voip_call/"+t,{headers:{"TT-X-Organization-Key":n}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)})),function(e,t){return u.apply(this,arguments)})},{key:"answer",value:(s=(0,h.default)(p.default.mark(function e(t,n,r){var o,a,i,s=r.callId,u=r.payload;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,_.default)(u,"disabledParticipants",{}),(a=x.default.underscoreObject({callId:s,payload:(0,d.default)({},u,{reason:"answered",callId:s}),reason:"answered",type:"call_answered",roomName:t})).payload.disabled_participants=o,e.next=6,this.httpClient.post("/v2/voip_call/"+t+"/answer",{data:a,headers:{"TT-X-Organization-Key":n}});case 6:return i=e.sent,e.abrupt("return",i.data);case 8:case"end":return e.stop()}},e,this)})),function(e,t,n){return s.apply(this,arguments)})},{key:"invite",value:(i=(0,h.default)(p.default.mark(function e(t,n,r){var o,a,i=r.callId,s=r.payload,u=r.recipients;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,_.default)(s,"disabledParticipants",{}),(a=x.default.underscoreObject({callId:i,payload:s,recipients:u})).payload.disabled_participants=o,e.next=5,this.httpClient.post("/v2/voip_call/"+t+"/add_participants",{data:a,headers:{"TT-X-Organization-Key":n}});case 5:case"end":return e.stop()}},e,this)})),function(e,t,n){return i.apply(this,arguments)})},{key:"state",value:(a=(0,h.default)(p.default.mark(function e(t,n,r){var o,a,i=r.callId,s=r.payload;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,_.default)(s,"disabledParticipants",{}),(a=x.default.underscoreObject({callId:i,payload:(0,d.default)({},s,{callId:i})})).payload.disabled_participants=o,e.next=5,this.httpClient.post("/v2/voip_call/"+t+"/state",{data:a,headers:{"TT-X-Organization-Key":n}});case 5:case"end":return e.stop()}},e,this)})),function(e,t,n){return a.apply(this,arguments)})}]),k);function k(){return(0,v.default)(this,k),(0,m.default)(this,(k.__proto__||(0,y.default)(k)).apply(this,arguments))}t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function l(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,d.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=l(t[0],n);return t.every(function(e){return l(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return l(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,u.default)(e))+": "+l(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function f(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,d.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=f(t[0],n);return t.every(function(e){return f(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return f(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,u.default)(e))+": "+f(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u=r(n(4)),c=r(n(5)),d=r(n(3)),p=r(n(10)),h=r(n(9)),y=r(n(6)),v=r(n(1)),g=r(n(2)),m=r(n(8)),b=r(n(7)),_=r(n(14)),w=(o=_.default,(0,b.default)(x,o),(0,g.default)(x,[{key:"find",value:(s=(0,h.default)(p.default.mark(function e(t){var n;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=4;break;case 4:return e.next=6,this.httpClient.get("/v5/conversation/:id",{urlParams:{id:t}});case 6:return n=e.sent,e.abrupt("return",n.data);case 8:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"updateConversationStatus",value:(i=(0,h.default)(p.default.mark(function e(t,n){var r,o,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=a.highestSortNumber,s=a.lowestSortNumber;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "status" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "status" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=8;break;case 8:return r={status:n},i&&(r.highest_sort_number=i),s&&(r.lowest_sort_number=s),e.next=13,this.httpClient.post("/v5/conversation/:id/status",{urlParams:{id:t},data:r});case 13:return o=e.sent,e.abrupt("return",o.data);case 15:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"fetchTimeline",value:(a=(0,h.default)(p.default.mark(function e(t,n,r,o){var a,i=o.continuation,s=o.markAsDelivered,u=void 0===s||s,c=arguments;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "anchorPoint" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(n));e.next=4;break;case 4:if("number"!=typeof r)throw new TypeError('Value of argument "maxItems" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+f(r));e.next=6;break;case 6:if(null==c[3]||!(null==c[3].continuation||c[3].continuation instanceof Object)||null!=c[3].markAsDelivered&&"boolean"!=typeof c[3].markAsDelivered)throw new TypeError("Value of argument 3 violates contract.\n\nExpected:\n{\n  continuation: ?Object;\n  markAsDelivered: ?boolean;\n}\n\nGot:\n"+f(c[3]));e.next=8;break;case 8:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=10;break;case 10:if("string"!=typeof n)throw new TypeError('Value of argument "anchorPoint" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=12;break;case 12:if("number"!=typeof r)throw new TypeError('Value of argument "maxItems" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+l(r));e.next=14;break;case 14:if(null==c[3]||!(null==c[3].continuation||c[3].continuation instanceof Object)||null!=c[3].markAsDelivered&&"boolean"!=typeof c[3].markAsDelivered)throw new TypeError("Value of argument 3 violates contract.\n\nExpected:\n{\n  continuation: ?Object;\n  markAsDelivered: ?boolean;\n}\n\nGot:\n"+l(c[3]));e.next=16;break;case 16:return e.next=18,this.httpClient.post("/v5/conversation/:id/timeline",{urlParams:{id:t},data:{anchor_point:n,continuation:i,mark_as_delivered:u,max_items:r}});case 18:return a=e.sent,e.abrupt("return",a.data);case 20:case"end":return e.stop()}},e,this)})),function(e,t,n,r){return a.apply(this,arguments)})}]),x);function x(){return(0,v.default)(this,x),(0,m.default)(this,(x.__proto__||(0,y.default)(x)).apply(this,arguments))}t.default=w,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function f(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,E.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=f(t[0],n);return t.every(function(e){return f(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return f(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,x.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,w.default)(e))+": "+f(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function d(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,E.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=d(t[0],n);return t.every(function(e){return d(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return d(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,x.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,w.default)(e))+": "+d(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,p,h,y,v,g,m,b,_,w=r(n(4)),x=r(n(5)),E=r(n(3)),k=r(n(11)),T=r(n(10)),A=r(n(9)),I=r(n(6)),O=r(n(1)),j=r(n(2)),S=r(n(8)),M=r(n(30)),R=r(n(7)),C=n(14),P=r(C),z=C.VERSIONS.VERSION_TWO,V=C.ROUTES.DISTRIBUTION_LIST_FIND,G=(a=(0,C.recoverFromNotFound)(),i=(0,C.recoverFromNotFound)(),s=(0,C.recoverFromNotFound)(),u=(0,C.recoverFromNotFound)(),c=(0,C.recoverFromNotFound)(),p=P.default,(0,R.default)(N,p),(0,j.default)(N,[{key:"batch",value:(_=(0,A.default)(T.default.mark(function e(t){var n,r=t.ids,o=t.operation,a=t.organizationId,i=arguments;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=i[0]&&Array.isArray(i[0].ids)&&i[0].ids.every(function(e){return"string"==typeof e})&&"string"==typeof i[0].operation&&"string"==typeof i[0].organizationId){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  ids: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+d(i[0]));case 2:if(null!=i[0]&&Array.isArray(i[0].ids)&&i[0].ids.every(function(e){return"string"==typeof e})&&"string"==typeof i[0].operation&&"string"==typeof i[0].organizationId){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  ids: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+f(i[0]));case 4:return n={"TT-X-Organization-Key":a},e.next=7,this.httpClient.patch("/v5/dist_list",{data:{ids:r,operation:o},headers:n});case 7:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"create",value:(b=(0,A.default)(T.default.mark(function e(t){var n,r,o,a=t.adminOnly,i=t.members,s=t.name,u=t.network,c=t.organizationId,l=arguments;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=l[0]&&"boolean"==typeof l[0].adminOnly&&Array.isArray(l[0].members)&&l[0].members.every(function(e){return"string"==typeof e})&&"string"==typeof l[0].name&&"string"==typeof l[0].network&&"string"==typeof l[0].organizationId){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  adminOnly: boolean;\n  members: string[];\n  name: string;\n  network: string;\n  organizationId: string;\n}\n\nGot:\n"+d(l[0]));case 2:if(null!=l[0]&&"boolean"==typeof l[0].adminOnly&&Array.isArray(l[0].members)&&l[0].members.every(function(e){return"string"==typeof e})&&"string"==typeof l[0].name&&"string"==typeof l[0].network&&"string"==typeof l[0].organizationId){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  adminOnly: boolean;\n  members: string[];\n  name: string;\n  network: string;\n  organizationId: string;\n}\n\nGot:\n"+f(l[0]));case 4:return n={"TT-X-Organization-Key":c},e.next=7,this.httpClient.post("/v5/dist_list",{data:{admin_only:a,members:i,name:s,network:u},headers:n});case 7:return r=e.sent,o=r.data,e.abrupt("return",o);case 10:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"delete",value:(m=(0,A.default)(T.default.mark(function e(t,n){var r;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.del("/v5/dist_list/:id",{headers:r,urlParams:{id:t}});case 11:case"end":return e.stop()}},e,this)})),function(e,t){return m.apply(this,arguments)})},{key:"find",value:(g=(0,A.default)(T.default.mark(function e(t){var n,r,o,a,i,s,u=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).organizationId;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=4;break;case 4:return n=(0,M.default)(N.prototype.__proto__||(0,I.default)(N.prototype),"getVersion",this).call(this,V),r=n.version,o=void 0===r?z:r,a={},u&&(a["TT-X-Organization-Key"]=u),e.next=9,this.httpClient.get("/:version/dist_list/:id",{headers:a,urlParams:{id:t,version:o}});case 9:return i=e.sent,s=i.data,e.abrupt("return",s);case 12:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"findMemberIds",value:(v=(0,A.default)(T.default.mark(function e(t,n){var r,o,a,i,s,u,c,l=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).continuation;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(n));e.next=8;break;case 8:return r=(0,M.default)(N.prototype.__proto__||(0,I.default)(N.prototype),"getVersion",this).call(this,V),o=r.version,a=void 0===o?z:o,i={"TT-X-Organization-Key":n},s="/:version/dist_list/:id/members",l&&(s+="/?continuation=:continuation"),e.next=14,this.httpClient.get(s,{headers:i,urlParams:{continuation:l,id:t,version:a}});case 14:return u=e.sent,c=u.data,e.abrupt("return",c);case 17:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"membersBatch",value:(y=(0,A.default)(T.default.mark(function e(t){var n,r,o,a=t.id,i=t.members,s=t.operation,u=t.organizationId,c=arguments;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=c[0]&&"string"==typeof c[0].id&&Array.isArray(c[0].members)&&c[0].members.every(function(e){return"string"==typeof e})&&"string"==typeof c[0].operation&&"string"==typeof c[0].organizationId){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  id: string;\n  members: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+d(c[0]));case 2:if(null!=c[0]&&"string"==typeof c[0].id&&Array.isArray(c[0].members)&&c[0].members.every(function(e){return"string"==typeof e})&&"string"==typeof c[0].operation&&"string"==typeof c[0].organizationId){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  id: string;\n  members: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+f(c[0]));case 4:return n={"TT-X-Organization-Key":u},e.next=7,this.httpClient.patch("/v5/dist_list/:id/members",{data:{members:i,operation:s},headers:n,urlParams:{id:a}});case 7:return r=e.sent,o=r.data,e.abrupt("return",o);case 10:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"update",value:(h=(0,A.default)(T.default.mark(function e(t){var n,r,o,a=t.adminOnly,i=t.id,s=t.name,u=t.organizationId,c=arguments;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==c[0]||void 0!==c[0].adminOnly&&null!=c[0].adminOnly&&"boolean"!=typeof c[0].adminOnly||"string"!=typeof c[0].id||void 0!==c[0].name&&null!=c[0].name&&"string"!=typeof c[0].name||"string"!=typeof c[0].organizationId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  adminOnly?: ?boolean;\n  id: string;\n  name?: ?string;\n  organizationId: string;\n}\n\nGot:\n"+d(c[0]));e.next=2;break;case 2:if(null==c[0]||void 0!==c[0].adminOnly&&null!=c[0].adminOnly&&"boolean"!=typeof c[0].adminOnly||"string"!=typeof c[0].id||void 0!==c[0].name&&null!=c[0].name&&"string"!=typeof c[0].name||"string"!=typeof c[0].organizationId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  adminOnly?: ?boolean;\n  id: string;\n  name?: ?string;\n  organizationId: string;\n}\n\nGot:\n"+f(c[0]));e.next=4;break;case 4:return n={"TT-X-Organization-Key":u},e.next=7,this.httpClient.put("/v5/dist_list/:id",{data:{admin_only:a,name:s},headers:n,urlParams:{id:i}});case 7:return r=e.sent,o=r.data,e.abrupt("return",o);case 10:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})}]),o((l=N).prototype,"delete",[a],(0,k.default)(l.prototype,"delete"),l.prototype),o(l.prototype,"find",[i],(0,k.default)(l.prototype,"find"),l.prototype),o(l.prototype,"findMemberIds",[s],(0,k.default)(l.prototype,"findMemberIds"),l.prototype),o(l.prototype,"membersBatch",[u],(0,k.default)(l.prototype,"membersBatch"),l.prototype),o(l.prototype,"update",[c],(0,k.default)(l.prototype,"update"),l.prototype),l);function N(){return(0,O.default)(this,N),(0,S.default)(this,(N.__proto__||(0,I.default)(N)).apply(this,arguments))}t.default=G,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function d(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=d(t[0],n);return t.every(function(e){return d(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return d(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,g.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,v.default)(e))+": "+d(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function p(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=p(t[0],n);return t.every(function(e){return p(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return p(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,g.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,v.default)(e))+": "+p(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,h,y,v=r(n(4)),g=r(n(5)),m=r(n(3)),b=r(n(11)),_=r(n(10)),w=r(n(9)),x=r(n(6)),E=r(n(1)),k=r(n(2)),T=r(n(8)),A=r(n(30)),I=r(n(7)),O=n(14),j=r(O),S=O.VERSIONS.VERSION_TWO,M=O.ROUTES.ENTITIES_FIND_ALL,R=(o=(0,O.recoverFromNotFound)(),h=j.default,(0,I.default)(C,h),(0,k.default)(C,[{key:"findMulti",value:(y=(0,w.default)(_.default.mark(function e(t){var n,r,o,a,i,s,u=t.users,c=t.metadata,l=t.organizationId,f=arguments;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=f[0]&&Array.isArray(f[0].users)&&f[0].users.every(function(e){return"string"==typeof e})&&Array.isArray(f[0].metadata)&&f[0].metadata.every(function(e){return"string"==typeof e})&&"string"==typeof f[0].organizationId){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  users: Array<string>;\n  metadata: Array<string>;\n  organizationId: string;\n}\n\nGot:\n"+p(f[0]));case 2:if(null!=f[0]&&Array.isArray(f[0].users)&&f[0].users.every(function(e){return"string"==typeof e})&&Array.isArray(f[0].metadata)&&f[0].metadata.every(function(e){return"string"==typeof e})&&"string"==typeof f[0].organizationId){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  users: Array<string>;\n  metadata: Array<string>;\n  organizationId: string;\n}\n\nGot:\n"+d(f[0]));case 4:return n=(0,A.default)(C.prototype.__proto__||(0,x.default)(C.prototype),"getVersion",this).call(this,M),r=n.version,o=void 0===r?S:r,a={"TT-X-Organization-Key":l},i={render_owner_object:"true"},e.next=9,this.httpClient.post("/:version/entities_bulk",{urlParams:{version:o},data:{users:u,metadata:c},headers:a,query:i});case 9:return s=e.sent,e.abrupt("return",s.data);case 11:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})}]),i=(a=C).prototype,s="findMulti",u=[o],c=(0,b.default)(a.prototype,"findMulti"),l=a.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(i,s,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(i,s,f),f=null),a);function C(){return(0,E.default)(this,C),(0,T.default)(this,(C.__proto__||(0,x.default)(C)).apply(this,arguments))}t.default=R,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function l(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,b.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=l(t[0],n);return t.every(function(e){return l(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return l(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+l(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function f(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,b.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=f(t[0],n);return t.every(function(e){return f(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return f(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+f(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,d,p,h,y,v,g=r(n(4)),m=r(n(5)),b=r(n(3)),_=r(n(11)),w=r(n(10)),x=r(n(9)),E=r(n(6)),k=r(n(1)),T=r(n(2)),A=r(n(8)),I=r(n(30)),O=r(n(7)),j=n(14),S=r(j),M=j.VERSIONS.VERSION_TWO,R=j.ROUTES.ESCALATION,C=(a=(0,j.recoverFromNotFound)(),i=(0,j.recoverFromNotFound)(),s=(0,j.recoverFromNotFound)(),u=(0,j.recoverFromNotFound)(),d=S.default,(0,O.default)(P,d),(0,T.default)(P,[{key:"escalateMessage",value:(v=(0,x.default)(w.default.mark(function e(t){var n,r,o,a;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=4;break;case 4:return n=(0,I.default)(P.prototype.__proto__||(0,E.default)(P.prototype),"getVersion",this).call(this,R),r=n.version,o=void 0===r?M:r,e.next=7,this.httpClient.post("/:version/message/:messageId/escalation",{urlParams:{version:o,messageId:t}});case 7:return a=e.sent,e.abrupt("return",a.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"acknowledge",value:(y=(0,x.default)(w.default.mark(function e(t,n){var r,o,a,i,s=n.messageId,u=n.userTokens,c=arguments;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "escalationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=2;break;case 2:if(null!=c[1]&&"string"==typeof c[1].messageId&&Array.isArray(c[1].userTokens)&&c[1].userTokens.every(function(e){return"string"==typeof e})){e.next=4;break}throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  messageId: string;\n  userTokens: Array<string>;\n}\n\nGot:\n"+f(c[1]));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "escalationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=6;break;case 6:if(null!=c[1]&&"string"==typeof c[1].messageId&&Array.isArray(c[1].userTokens)&&c[1].userTokens.every(function(e){return"string"==typeof e})){e.next=8;break}throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  messageId: string;\n  userTokens: Array<string>;\n}\n\nGot:\n"+l(c[1]));case 8:return r=(0,I.default)(P.prototype.__proto__||(0,E.default)(P.prototype),"getVersion",this).call(this,R),o=r.version,a=void 0===o?M:o,e.next=11,this.httpClient.post("/:version/message/:messageId/escalation/:escalationId/confirm",{urlParams:{version:a,escalationId:t,messageId:s},data:{confirm_as:u}});case 11:return i=e.sent,e.abrupt("return",i.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})},{key:"cancel",value:(h=(0,x.default)(w.default.mark(function e(t){var n,r,o;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=4;break;case 4:return n=(0,I.default)(P.prototype.__proto__||(0,E.default)(P.prototype),"getVersion",this).call(this,R),r=n.version,o=void 0===r?M:r,e.next=7,this.httpClient.del("/:version/message/:messageId/escalation",{urlParams:{version:o,messageId:t}});case 7:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"skip",value:(p=(0,x.default)(w.default.mark(function e(t,n){var r,o,a,i,s=n.messageId,u=n.userTokens,c=arguments;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "escalationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));e.next=2;break;case 2:if(null!=c[1]&&"string"==typeof c[1].messageId&&Array.isArray(c[1].userTokens)&&c[1].userTokens.every(function(e){return"string"==typeof e})){e.next=4;break}throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  messageId: string;\n  userTokens: Array<string>;\n}\n\nGot:\n"+f(c[1]));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "escalationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=6;break;case 6:if(null!=c[1]&&"string"==typeof c[1].messageId&&Array.isArray(c[1].userTokens)&&c[1].userTokens.every(function(e){return"string"==typeof e})){e.next=8;break}throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  messageId: string;\n  userTokens: Array<string>;\n}\n\nGot:\n"+l(c[1]));case 8:return r=(0,I.default)(P.prototype.__proto__||(0,E.default)(P.prototype),"getVersion",this).call(this,R),o=r.version,a=void 0===o?M:o,e.next=11,this.httpClient.post("/:version/message/:messageId/escalation/:escalationId/skip",{urlParams:{version:a,escalationId:t,messageId:s},data:{skip_as:u}});case 11:return i=e.sent,e.abrupt("return",i.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})}]),o((c=P).prototype,"escalateMessage",[a],(0,_.default)(c.prototype,"escalateMessage"),c.prototype),o(c.prototype,"acknowledge",[i],(0,_.default)(c.prototype,"acknowledge"),c.prototype),o(c.prototype,"cancel",[s],(0,_.default)(c.prototype,"cancel"),c.prototype),o(c.prototype,"skip",[u],(0,_.default)(c.prototype,"skip"),c.prototype),c);function P(){return(0,k.default)(this,P),(0,A.default)(this,(P.__proto__||(0,E.default)(P)).apply(this,arguments))}t.default=C,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(10)),u=r(n(9)),c=r(n(6)),l=r(n(1)),f=r(n(2)),d=r(n(8)),p=r(n(30)),h=r(n(7)),y=n(14),v=r(y),g=y.VERSIONS.VERSION_TWO,m=y.ROUTES.EVENTS_ACK,b=y.ROUTES.EVENTS_CLOSE_ALL_CONNECTIONS,_=(o=v.default,(0,h.default)(w,o),(0,f.default)(w,[{key:"ack",value:(i=(0,u.default)(s.default.mark(function e(t){var n,r,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,p.default)(w.prototype.__proto__||(0,c.default)(w.prototype),"getVersion",this).call(this,m),r=n.version,o=void 0===r?g:r,e.next=3,this.httpClient.post("/:version/events/ack",{urlParams:{version:o},data:{events:t}});case 3:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"closeAllConnections",value:(a=(0,u.default)(s.default.mark(function e(){var t,n,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,p.default)(w.prototype.__proto__||(0,c.default)(w.prototype),"getVersion",this).call(this,b),n=t.version,r=void 0===n?g:n,e.next=3,this.httpClient.del("/:version/events",{urlParams:{version:r}});case 3:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})}]),w);function w(){return(0,l.default)(this,w),(0,d.default)(this,(w.__proto__||(0,c.default)(w)).apply(this,arguments))}t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,w.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function u(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,w.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=u(t[0],n);return t.every(function(e){return u(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return u(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+u(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,c,l,f,d,p,h,y,v,g,m,b=r(n(4)),_=r(n(5)),w=r(n(3)),x=r(n(11)),T=r(n(10)),E=r(n(9)),A=r(n(6)),k=r(n(1)),I=r(n(2)),O=r(n(8)),j=r(n(30)),S=r(n(7)),M=n(14),R=r(M),C=M.VERSIONS.VERSION_FIVE,P=M.VERSIONS.VERSION_TWO,z=M.ROUTES.GROUP_ADD_MEMBERS,V=M.ROUTES.GROUP_CREATE,G=M.ROUTES.GROUP_DESTROY,N=M.ROUTES.GROUP_FIND,D=M.ROUTES.GROUP_UPDATE,U=(a=(0,M.recoverFromNotFound)(),i=(0,M.recoverFromNotFound)(),c=(0,M.recoverFromNotFound)(),f=R.default,(0,S.default)(F,f),(0,I.default)(F,[{key:"create",value:(m=(0,E.default)(T.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p=t.avatarFile,h=t.description,y=t.excludeCreator,v=t.isPublic,g=void 0!==v&&v,m=t.memberIds,b=void 0===m?[]:m,_=t.metadata,w=t.name,x=t.organizationId,E=t.replayHistory,k=void 0!==E&&E;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,j.default)(F.prototype.__proto__||(0,A.default)(F.prototype),"getVersion",this).call(this,V),r=n.version,o=void 0===r?P:r,a={},i={is_public:g,members:b.join(","),metadata:_,name:w,replay_history:k},s={},u={exclude_creator:y},p&&(s.avatar=p),h&&(i.description=h),x&&(a["TT-X-Organization-Key"]=x),e.next=10,this.httpClient.post("/:version/group",{urlParams:{version:o},query:u,headers:a,data:i,files:s});case 10:if(c=e.sent,o===C)return e.abrupt("return",c.data);e.next=13;break;case 13:return l=c.getHeader("TT-X-Group-Avatar"),f=c.getHeader("TT-X-Group-Token"),d={avatarUrl:l,id:f,memberIds:b,metadata:_,name:w,organizationId:x},e.abrupt("return",d);case 17:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"update",value:(g=(0,E.default)(T.default.mark(function e(t,n){var r,o,a,i,s,u,c,l=n.name,f=void 0===l?void 0:l,d=n.avatarFile,p=void 0===d?void 0:d,h=n.replayHistory,y=void 0===h?void 0:h,v=n.memberIds;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,j.default)(F.prototype.__proto__||(0,A.default)(F.prototype),"getVersion",this).call(this,D),o=r.version,a=void 0===o?P:o,i={},s={},void 0!==f&&(i.name=f),void 0!==v&&(i.members=v.join(",")),void 0!==y&&(i.replay_history=y),p&&(s.avatar=p),e.next=9,this.httpClient.post("/:version/group/:id",{urlParams:{id:t,version:a},data:i,files:s});case 9:return u=e.sent,c=u.getHeader("TT-X-Group-Avatar"),e.abrupt("return",{id:t,avatarUrl:c});case 12:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"find",value:(v=(0,E.default)(T.default.mark(function e(t){var n,r,o,a;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=4;break;case 4:return n=(0,j.default)(F.prototype.__proto__||(0,A.default)(F.prototype),"getVersion",this).call(this,N),r=n.version,o=void 0===r?P:r,e.next=7,this.httpClient.get("/:version/group/:id",{urlParams:{id:t,version:o},query:{render_metadata:"true"}});case 7:return a=e.sent,e.abrupt("return",a.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"findAllMemberIds",value:(y=(0,E.default)(T.default.mark(function e(t){var n;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=4;break;case 4:return e.next=6,this.httpClient.get("/:version/group/:id/members",{urlParams:{id:t,version:P}});case 6:return n=e.sent,e.abrupt("return",n.data);case 8:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"destroy",value:(h=(0,E.default)(T.default.mark(function e(t){var n,r,o;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=4;break;case 4:return n=(0,j.default)(F.prototype.__proto__||(0,A.default)(F.prototype),"getVersion",this).call(this,G),r=n.version,o=void 0===r?P:r,e.next=7,this.httpClient.del("/:version/group/:id",{urlParams:{id:t,version:o}});case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"addMembers",value:(p=(0,E.default)(T.default.mark(function e(t,n){var r,o,a,i;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})){e.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+u(n));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=6;break;case 6:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})){e.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+s(n));case 8:return r=(0,j.default)(F.prototype.__proto__||(0,A.default)(F.prototype),"getVersion",this).call(this,z),o=r.version,a=void 0===o?P:o,e.next=11,this.httpClient.post("/:version/group/:id/members",{urlParams:{id:t,version:a},data:{members:n}});case 11:return i=e.sent,e.abrupt("return",i.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})},{key:"removeMembers",value:(d=(0,E.default)(T.default.mark(function e(t,n){return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})){e.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+u(n));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=6;break;case 6:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})){e.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+s(n));case 8:return e.next=10,this.httpClient.post("/v2/group/:id/members/remove",{urlParams:{id:t},data:{members:n}});case 10:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)})}]),o((l=F).prototype,"find",[a],(0,x.default)(l.prototype,"find"),l.prototype),o(l.prototype,"findAllMemberIds",[i],(0,x.default)(l.prototype,"findAllMemberIds"),l.prototype),o(l.prototype,"destroy",[c],(0,x.default)(l.prototype,"destroy"),l.prototype),l);function F(){return(0,k.default)(this,F),(0,O.default)(this,(F.__proto__||(0,A.default)(F)).apply(this,arguments))}t.default=U,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function p(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,w.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=p(t[0],n);return t.every(function(e){return p(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return p(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+p(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function h(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,w.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=h(t[0],n);return t.every(function(e){return h(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return h(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+h(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,y,v,g,m,b=r(n(4)),_=r(n(5)),w=r(n(3)),x=r(n(11)),E=r(n(16)),k=r(n(10)),T=r(n(9)),A=r(n(6)),I=r(n(1)),O=r(n(2)),j=r(n(8)),S=r(n(7)),M=n(14),R=r(M),C=(a=(0,M.recoverFromNotFound)(),i=(0,M.recoverFromNotFound)(),s=(0,M.recoverFromNotFound)(),u=(0,M.recoverFromNotFound)(),l=R.default,(0,S.default)(P,l),(0,O.default)(P,[{key:"batch",value:(m=(0,T.default)(k.default.mark(function e(t){var n,r=t.ids,o=t.operation,a=t.organizationId,i=arguments;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=i[0]&&Array.isArray(i[0].ids)&&i[0].ids.every(function(e){return"string"==typeof e})&&"string"==typeof i[0].operation&&"string"==typeof i[0].organizationId){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  ids: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+h(i[0]));case 2:if(null!=i[0]&&Array.isArray(i[0].ids)&&i[0].ids.every(function(e){return"string"==typeof e})&&"string"==typeof i[0].operation&&"string"==typeof i[0].organizationId){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  ids: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+p(i[0]));case 4:return n={"TT-X-Organization-Key":a},e.next=7,this.httpClient.patch("/v5/message_template",{data:{ids:r,operation:o},headers:n});case 7:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"create",value:(g=(0,T.default)(k.default.mark(function e(t){var n,r,o,a,i=t.attachment,s=t.body,u=t.network,c=t.organizationId,l=t.repository,f=t.title,d=arguments;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=d[0]&&(void 0===d[0].attachment||null==d[0].attachment||d[0].attachment instanceof Object||null==d[0].attachment||"string"==typeof d[0].attachment)&&"string"==typeof d[0].body&&"string"==typeof d[0].network&&"string"==typeof d[0].organizationId&&"string"==typeof d[0].repository&&"string"==typeof d[0].title){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?Object | ?string;\n  body: string;\n  network: string;\n  organizationId: string;\n  repository: string;\n  title: string;\n}\n\nGot:\n"+h(d[0]));case 2:if(null!=d[0]&&(void 0===d[0].attachment||null==d[0].attachment||d[0].attachment instanceof Object||null==d[0].attachment||"string"==typeof d[0].attachment)&&"string"==typeof d[0].body&&"string"==typeof d[0].network&&"string"==typeof d[0].organizationId&&"string"==typeof d[0].repository&&"string"==typeof d[0].title){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?Object | ?string;\n  body: string;\n  network: string;\n  organizationId: string;\n  repository: string;\n  title: string;\n}\n\nGot:\n"+p(d[0]));case 4:return n={},r={"TT-X-Organization-Key":c},i&&(n.attachment=i),e.next=9,this.httpClient.post("/v5/message_template",{files:n,data:{body:s,network:u,repository:l,template_label:f},headers:r,timeout:!i});case 9:return o=e.sent,a=o.data,e.abrupt("return",a);case 12:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"delete",value:(v=(0,T.default)(k.default.mark(function e(t,n){var r;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+h(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+h(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.del("/v5/message_template/:id",{headers:r,urlParams:{id:t}});case 11:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"downloadTemplateFile",value:(y=(0,T.default)(k.default.mark(function e(t){var n,r,o=t.templateId,a=t.fileName,i=t.organizationId;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={"TT-X-Organization-Key":i},r="/v5/message_template/"+o+"/attachment/"+a,e.abrupt("return",this.httpClient.downloadFileBlob(r,{headers:n}));case 3:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"find",value:(d=(0,T.default)(k.default.mark(function e(t,n){var r,o,a;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+h(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+h(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.get("/v5/message_template/:id",{headers:r,urlParams:{id:t}});case 11:return o=e.sent,a=o.data,e.abrupt("return",a);case 14:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)})},{key:"update",value:(f=(0,T.default)(k.default.mark(function e(t){var n,r,o,a,i=t.attachment,s=t.body,u=t.id,c=t.organizationId,l=t.repository,f=t.title,d=arguments;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=d[0]&&(void 0===d[0].attachment||null==d[0].attachment||null==d[0].attachment||null==d[0].attachment||d[0].attachment instanceof Object||null==d[0].attachment||"string"==typeof d[0].attachment)&&"string"==typeof d[0].body&&"string"==typeof d[0].id&&"string"==typeof d[0].organizationId&&"string"==typeof d[0].repository&&"string"==typeof d[0].title){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?null | ?Object | ?string;\n  body: string;\n  id: string;\n  organizationId: string;\n  repository: string;\n  title: string;\n}\n\nGot:\n"+h(d[0]));case 2:if(null!=d[0]&&(void 0===d[0].attachment||null==d[0].attachment||null==d[0].attachment||null==d[0].attachment||d[0].attachment instanceof Object||null==d[0].attachment||"string"==typeof d[0].attachment)&&"string"==typeof d[0].body&&"string"==typeof d[0].id&&"string"==typeof d[0].organizationId&&"string"==typeof d[0].repository&&"string"==typeof d[0].title){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?null | ?Object | ?string;\n  body: string;\n  id: string;\n  organizationId: string;\n  repository: string;\n  title: string;\n}\n\nGot:\n"+p(d[0]));case 4:return n={},r={"TT-X-Organization-Key":c},i&&(n.attachment=i),e.next=9,this.httpClient.put("/v5/message_template/:id",{files:n,data:(0,E.default)({},n.attachment?null:{attachment:i},{body:s,repository:l,template_label:f}),headers:r,timeout:!i,urlParams:{id:u}});case 9:return o=e.sent,a=o.data,e.abrupt("return",a);case 12:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})}]),o((c=P).prototype,"delete",[a],(0,x.default)(c.prototype,"delete"),c.prototype),o(c.prototype,"downloadTemplateFile",[i],(0,x.default)(c.prototype,"downloadTemplateFile"),c.prototype),o(c.prototype,"find",[s],(0,x.default)(c.prototype,"find"),c.prototype),o(c.prototype,"update",[u],(0,x.default)(c.prototype,"update"),c.prototype),c);function P(){return(0,I.default)(this,P),(0,j.default)(this,(P.__proto__||(0,A.default)(P)).apply(this,arguments))}t.default=C,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function T(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=T(t[0],n);return t.every(function(e){return T(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return T(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,g.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,j.default)(e))+": "+T(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function A(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=A(t[0],n);return t.every(function(e){return A(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return A(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,g.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,j.default)(e))+": "+A(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g=r(n(5)),m=r(n(3)),b=r(n(11)),I=r(n(10)),O=r(n(19)),j=r(n(4)),S=r(n(16)),_=r(n(9)),M=r(n(6)),w=r(n(1)),x=r(n(2)),E=r(n(8)),R=r(n(30)),k=r(n(7)),C=n(14),P=r(C),z=n(67),V=C.VERSIONS.VERSION_FIVE,G=C.VERSIONS.VERSION_TWO,N=C.ROUTES.MESSAGE_FIND,D=C.ROUTES.MESSAGE_FORWARD,U=C.ROUTES.MESSAGE_SEND,F=C.ROUTES.MESSAGE_UPDATE_RECIPIENT_STATUS_MULTI,L=(a=(0,C.recoverFromNotFound)(),i=(0,C.recoverFromNotFound)(),u=P.default,(0,k.default)(B,u),(0,x.default)(B,[{key:"send",value:(v=(0,_.default)(I.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d=t.attachment,p=t.body,h=t.conversationId,y=t.counterPartyId,v=t.deleteOnRead,g=t.escalate,m=t.localId,b=t.metadata,_=t.priority,w=t.recipientOrganizationId,x=t.senderOrganizationId,E=t.ttl,k=arguments;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==k[0]||!(void 0===k[0].attachment||null==k[0].attachment||k[0].attachment instanceof Object||null==k[0].attachment||"string"==typeof k[0].attachment)||"string"!=typeof k[0].body||void 0!==k[0].conversationId&&null!=k[0].conversationId&&"string"!=typeof k[0].conversationId||void 0!==k[0].counterPartyId&&null!=k[0].counterPartyId&&"string"!=typeof k[0].counterPartyId||void 0!==k[0].deleteOnRead&&null!=k[0].deleteOnRead&&"boolean"!=typeof k[0].deleteOnRead||void 0!==k[0].escalate&&null!=k[0].escalate&&"boolean"!=typeof k[0].escalate||"string"!=typeof k[0].localId||!(void 0===k[0].metadata||null==k[0].metadata||k[0].metadata instanceof Object)||void 0!==k[0].priority&&null!=k[0].priority&&"number"!=typeof k[0].priority||void 0!==k[0].recipientOrganizationId&&null!=k[0].recipientOrganizationId&&"string"!=typeof k[0].recipientOrganizationId||"string"!=typeof k[0].senderOrganizationId||void 0!==k[0].ttl&&null!=k[0].ttl&&"number"!=typeof k[0].ttl)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?Object | ?string;\n  body: string;\n  conversationId?: ?string;\n  counterPartyId?: ?string;\n  deleteOnRead?: ?boolean;\n  escalate?: ?boolean;\n  localId: string;\n  metadata?: ?Object;\n  priority?: ?number;\n  recipientOrganizationId?: ?string;\n  senderOrganizationId: string;\n  ttl?: ?number;\n}\n\nGot:\n"+A(k[0]));e.next=2;break;case 2:if(null==k[0]||!(void 0===k[0].attachment||null==k[0].attachment||k[0].attachment instanceof Object||null==k[0].attachment||"string"==typeof k[0].attachment)||"string"!=typeof k[0].body||void 0!==k[0].conversationId&&null!=k[0].conversationId&&"string"!=typeof k[0].conversationId||void 0!==k[0].counterPartyId&&null!=k[0].counterPartyId&&"string"!=typeof k[0].counterPartyId||void 0!==k[0].deleteOnRead&&null!=k[0].deleteOnRead&&"boolean"!=typeof k[0].deleteOnRead||void 0!==k[0].escalate&&null!=k[0].escalate&&"boolean"!=typeof k[0].escalate||"string"!=typeof k[0].localId||!(void 0===k[0].metadata||null==k[0].metadata||k[0].metadata instanceof Object)||void 0!==k[0].priority&&null!=k[0].priority&&"number"!=typeof k[0].priority||void 0!==k[0].recipientOrganizationId&&null!=k[0].recipientOrganizationId&&"string"!=typeof k[0].recipientOrganizationId||"string"!=typeof k[0].senderOrganizationId||void 0!==k[0].ttl&&null!=k[0].ttl&&"number"!=typeof k[0].ttl)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?Object | ?string;\n  body: string;\n  conversationId?: ?string;\n  counterPartyId?: ?string;\n  deleteOnRead?: ?boolean;\n  escalate?: ?boolean;\n  localId: string;\n  metadata?: ?Object;\n  priority?: ?number;\n  recipientOrganizationId?: ?string;\n  senderOrganizationId: string;\n  ttl?: ?number;\n}\n\nGot:\n"+T(k[0]));e.next=4;break;case 4:return n=(0,R.default)(B.prototype.__proto__||(0,M.default)(B.prototype),"getVersion",this).call(this,U),r=n.version,a={body:p},i={},s={},(o=void 0===r?G:r)===G?((0,z.isEmail)(y)&&(y=y.toLowerCase()),a.recipient=y,i.response_format="message",w=w||x,x&&(a.sender_organization=x),w&&(a.recipient_organization=w)):o===V&&(a.conversation_id=h),b&&(a.data=b.map(function(e){return(0,S.default)({},e,{payload:(0,j.default)(e.payload)})})),d&&(s.attachment=d),v&&(a.dor=v),g&&(a.escalate=g),void 0!==_&&(a.priority=_),E&&(a.ttl=E),e.prev=15,e.next=18,this.httpClient.post("/:version/message",{urlParams:{version:o},data:a,files:s,query:i,requestId:m,timeout:!d});case 18:if(u=e.sent,c=u.headers["tt-x-message-id"],this.config.condensedReplays&&u.data.last_message&&c!==u.data.last_message.message_id)return e.next=24,this.host.api.messages.find(c);e.next=26;break;case 24:(l=e.sent)&&(u.data.last_message=l.message);case 26:return e.abrupt("return",u.data);case 29:if(e.prev=29,e.t0=e.catch(15),304!==e.t0.status)return e.abrupt("return",O.default.reject(e.t0));e.next=33;break;case 33:if(f=e.t0.response.headers["TT-X-Message-Id".toLowerCase()]){e.next=36;break}return e.abrupt("return",O.default.reject(e.t0));case 36:return e.abrupt("return",{message_id:f});case 37:case"end":return e.stop()}},e,this,[[15,29]])})),function(e){return v.apply(this,arguments)})},{key:"destroy",value:(y=(0,_.default)(I.default.mark(function e(t){return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+A(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+T(t));e.next=4;break;case 4:return e.prev=4,e.next=7,this.httpClient.del("/v2/message/:id",{urlParams:{id:t}});case 7:return e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",!1);case 13:case"end":return e.stop()}},e,this,[[4,10]])})),function(e){return y.apply(this,arguments)})},{key:"forward",value:(h=(0,_.default)(I.default.mark(function e(t,n,r){var o,a,i,s,u,c,l=r.conversationId,f=r.localId,d=r.metadata,p=r.priority,h=r.recipientOrganizationId,y=r.senderOrganizationId,v=arguments;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+A(t));e.next=2;break;case 2:if(void 0!==n&&null!=n&&"string"!=typeof n)throw new TypeError('Value of optional argument "counterPartyId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+A(n));e.next=4;break;case 4:if(null==v[2]||void 0!==v[2].conversationId&&null!=v[2].conversationId&&"string"!=typeof v[2].conversationId||"string"!=typeof v[2].localId||!(void 0===v[2].metadata||null==v[2].metadata||v[2].metadata instanceof Object)||void 0!==v[2].priority&&null!=v[2].priority&&"number"!=typeof v[2].priority||void 0!==v[2].recipientOrganizationId&&null!=v[2].recipientOrganizationId&&"string"!=typeof v[2].recipientOrganizationId||void 0!==v[2].senderOrganizationId&&null!=v[2].senderOrganizationId&&"string"!=typeof v[2].senderOrganizationId)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  conversationId?: ?string;\n  localId: string;\n  metadata?: ?Object;\n  priority?: ?number;\n  recipientOrganizationId?: ?string;\n  senderOrganizationId?: ?string;\n}\n\nGot:\n"+A(v[2]));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+T(t));e.next=8;break;case 8:if(void 0!==n&&null!=n&&"string"!=typeof n)throw new TypeError('Value of optional argument "counterPartyId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+T(n));e.next=10;break;case 10:if(null==v[2]||void 0!==v[2].conversationId&&null!=v[2].conversationId&&"string"!=typeof v[2].conversationId||"string"!=typeof v[2].localId||!(void 0===v[2].metadata||null==v[2].metadata||v[2].metadata instanceof Object)||void 0!==v[2].priority&&null!=v[2].priority&&"number"!=typeof v[2].priority||void 0!==v[2].recipientOrganizationId&&null!=v[2].recipientOrganizationId&&"string"!=typeof v[2].recipientOrganizationId||void 0!==v[2].senderOrganizationId&&null!=v[2].senderOrganizationId&&"string"!=typeof v[2].senderOrganizationId)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  conversationId?: ?string;\n  localId: string;\n  metadata?: ?Object;\n  priority?: ?number;\n  recipientOrganizationId?: ?string;\n  senderOrganizationId?: ?string;\n}\n\nGot:\n"+T(v[2]));e.next=12;break;case 12:return o=(0,R.default)(B.prototype.__proto__||(0,M.default)(B.prototype),"getVersion",this).call(this,D),a=o.version,s={},(i=void 0===a?G:a)===G?(s.recipient=n,h=h||y,y&&(s.sender_organization=y),h&&(s.recipient_organization=h)):i===V&&(s.conversation_id=l),d&&(s.data=d.map(function(e){return(0,S.default)({},e,{payload:(0,j.default)(e.payload)})})),void 0!==p&&(s.priority=p),e.next=19,this.httpClient.post("/:version/message/:id/forward",{urlParams:{id:t,version:i},data:s,requestId:f});case 19:if(u=e.sent,i===G)return c={message_id:u.getHeader("TT-X-Message-Id")},e.abrupt("return",c);e.next=25;break;case 25:return e.abrupt("return",u.data);case 26:case"end":return e.stop()}},e,this)})),function(e,t,n){return h.apply(this,arguments)})},{key:"find",value:(p=(0,_.default)(I.default.mark(function e(t){var n,r,o,a;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+A(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+T(t));e.next=4;break;case 4:return n=(0,R.default)(B.prototype.__proto__||(0,M.default)(B.prototype),"getVersion",this).call(this,N),r=n.version,o=void 0===r?G:r,e.next=7,this.httpClient.get("/:version/message/:id",{urlParams:{id:t,version:o}});case 7:return a=e.sent,e.abrupt("return",a.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"findRecipientStatus",value:(d=(0,_.default)(I.default.mark(function e(t){var n;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+A(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+T(t));e.next=4;break;case 4:return e.next=6,this.httpClient.get("/:version/message/:id/status",{urlParams:{id:t,version:G}});case 6:return n=e.sent,e.abrupt("return",n.data);case 8:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"findRecipientStatusMulti",value:(f=(0,_.default)(I.default.mark(function e(t){var n;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+A(t));case 2:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){e.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+T(t));case 4:return e.next=6,this.httpClient.post("/:version/get_bulk_message_status",{urlParams:{version:G},data:{messages:t}});case 6:return n=e.sent,e.abrupt("return",n.data.bulk_message_statuses);case 8:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"updateRecipientStatusMulti",value:(l=(0,_.default)(I.default.mark(function e(t){var n,r,o,a;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,R.default)(B.prototype.__proto__||(0,M.default)(B.prototype),"getVersion",this).call(this,F),r=n.version,o=void 0===r?G:r,e.next=3,this.httpClient.post("/:version/message/status",{urlParams:{version:o},data:t});case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"createAttachmentTokens",value:(c=(0,_.default)(I.default.mark(function e(){var t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:20;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n&&"number"!=typeof n)throw new TypeError('Value of optional argument "count" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+A(n));e.next=2;break;case 2:if(void 0!==n&&"number"!=typeof n)throw new TypeError('Value of optional argument "count" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+T(n));e.next=4;break;case 4:return e.next=6,this.httpClient.post("/v5/attachment_tokens_bulk",{data:{count:n,expire_after_sec:43200,expire_after_used_sec:5}});case 6:return t=e.sent,e.abrupt("return",t.data);case 8:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})}]),o((s=B).prototype,"find",[a],(0,b.default)(s.prototype,"find"),s.prototype),o(s.prototype,"findRecipientStatus",[i],(0,b.default)(s.prototype,"findRecipientStatus"),s.prototype),s);function B(){return(0,w.default)(this,B),(0,E.default)(this,(B.__proto__||(0,M.default)(B)).apply(this,arguments))}t.default=L,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,f.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,l.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,c.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function u(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,f.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=u(t[0],n);return t.every(function(e){return u(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return u(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,l.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,c.default)(e))+": "+u(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,c=r(n(4)),l=r(n(5)),f=r(n(3)),d=r(n(10)),p=r(n(9)),h=r(n(6)),y=r(n(1)),v=r(n(2)),g=r(n(8)),m=r(n(30)),b=r(n(7)),_=n(14),w=r(_),x=_.VERSIONS.VERSION_TWO,E=_.ROUTES.METADATA_FIND,k=(o=w.default,(0,b.default)(T,o),(0,v.default)(T,[{key:"update",value:(i=(0,p.default)(d.default.mark(function e(t,n,r){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if(n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+u(n));case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=8;break;case 8:if(n instanceof Object){e.next=10;break}throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+s(n));case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=12;break;case 12:return e.next=14,this.httpClient.post("/v2/metadata/:id",{urlParams:{id:t},data:n,headers:{"TT-X-Organization-Key":r}});case 14:case"end":return e.stop()}},e,this)})),function(e,t,n){return i.apply(this,arguments)})},{key:"find",value:(a=(0,p.default)(d.default.mark(function e(t,n){var r,o,a,i;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=8;break;case 8:return r=(0,m.default)(T.prototype.__proto__||(0,h.default)(T.prototype),"getVersion",this).call(this,E),o=r.version,a=void 0===o?x:o,e.next=11,this.httpClient.get("/:version/metadata/:id",{urlParams:{id:t,version:a},headers:{"TT-X-Organization-Key":n}});case 11:return i=e.sent,e.abrupt("return",i.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})}]),T);function T(){return(0,y.default)(this,T),(0,g.default)(this,(T.__proto__||(0,h.default)(T)).apply(this,arguments))}t.default=k,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,T.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,k.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,E.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,T.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,k.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,E.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E=r(n(4)),k=r(n(5)),T=r(n(3)),A=r(n(11)),I=r(n(10)),O=r(n(9)),j=r(n(6)),S=r(n(1)),M=r(n(2)),R=r(n(8)),C=r(n(30)),P=r(n(7)),z=n(14),V=r(z),G=z.VERSIONS.VERSION_TWO,N=z.ROUTES.MUTE_FIND_ALL,D=(a=(0,z.recoverFromNotFound)(),u=(0,z.recoverFromNotFound)(),c=(0,z.recoverFromNotFound)(),l=(0,z.recoverFromNotFound)(),f=(0,z.recoverFromNotFound)(),d=(0,z.recoverFromNotFound)(),h=V.default,(0,P.default)(U,h),(0,M.default)(U,[{key:"findAll",value:(x=(0,O.default)(I.default.mark(function e(){var t,n,r,o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,C.default)(U.prototype.__proto__||(0,j.default)(U.prototype),"getVersion",this).call(this,N),n=t.version,r=void 0===n?G:n,e.next=3,this.httpClient.get("/:version/mute",{urlParams:{version:r}});case 3:return o=e.sent,e.abrupt("return",o.data);case 5:case"end":return e.stop()}},e,this)})),function(){return x.apply(this,arguments)})},{key:"unmuteAll",value:(w=(0,O.default)(I.default.mark(function e(){return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.del("/v2/mute");case 2:case"end":return e.stop()}},e,this)})),function(){return w.apply(this,arguments)})},{key:"muteUser",value:(_=(0,O.default)(I.default.mark(function e(t,n,r){var o=(3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}).recipientOrganizationId,a=void 0===o?r:o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=8;break;case 8:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));e.next=12;break;case 12:return e.next=14,this.httpClient.post("/v2/mute/p2p",{data:{sender_token:t,sender_organization:r,receiver_organization:a,duration:n.toString()}});case 14:case"end":return e.stop()}},e,this)})),function(e,t,n){return _.apply(this,arguments)})},{key:"unmuteUser",value:(b=(0,O.default)(I.default.mark(function e(t,n){var r=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).recipientOrganizationId,o=void 0===r?n:r;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=8;break;case 8:return e.next=10,this.httpClient.del("/v2/mute/p2p",{headers:{"TT-X-Sender-Token":t,"TT-X-Sender-Organization":n,"TT-X-Receiver-Organization":o}});case 10:case"end":return e.stop()}},e,this)})),function(e,t){return b.apply(this,arguments)})},{key:"muteGroup",value:(m=(0,O.default)(I.default.mark(function e(t,n,r){return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=8;break;case 8:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));e.next=12;break;case 12:return e.next=14,this.httpClient.post("/v2/mute/group/:groupId",{urlParams:{groupId:t},data:{duration:n.toString(),receiver_organization:r}});case 14:case"end":return e.stop()}},e,this)})),function(e,t,n){return m.apply(this,arguments)})},{key:"unmuteGroup",value:(g=(0,O.default)(I.default.mark(function e(t,n){return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=8;break;case 8:return e.next=10,this.httpClient.del("/v2/mute/group/:groupId",{urlParams:{groupId:t},headers:{"TT-X-Receiver-Organization":n}});case 10:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"muteOrganization",value:(v=(0,O.default)(I.default.mark(function e(t,n){return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=6;break;case 6:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+i(n));e.next=8;break;case 8:return e.next=10,this.httpClient.post("/v2/mute/organization/:organizationId",{urlParams:{organizationId:t},data:{duration:n.toString(),receiver_organization:t}});case 10:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"unmuteOrganization",value:(y=(0,O.default)(I.default.mark(function e(t){return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=4;break;case 4:return e.next=6,this.httpClient.del("/v2/mute/organization/:organizationId",{urlParams:{organizationId:t},headers:{"TT-X-Receiver-Organization":t}});case 6:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})}]),o((p=U).prototype,"muteUser",[a],(0,A.default)(p.prototype,"muteUser"),p.prototype),o(p.prototype,"unmuteUser",[u],(0,A.default)(p.prototype,"unmuteUser"),p.prototype),o(p.prototype,"muteGroup",[c],(0,A.default)(p.prototype,"muteGroup"),p.prototype),o(p.prototype,"unmuteGroup",[l],(0,A.default)(p.prototype,"unmuteGroup"),p.prototype),o(p.prototype,"muteOrganization",[f],(0,A.default)(p.prototype,"muteOrganization"),p.prototype),o(p.prototype,"unmuteOrganization",[d],(0,A.default)(p.prototype,"unmuteOrganization"),p.prototype),p);function U(){return(0,S.default)(this,U),(0,R.default)(this,(U.__proto__||(0,j.default)(U)).apply(this,arguments))}t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u=r(n(10)),c=r(n(9)),l=r(n(6)),f=r(n(1)),d=r(n(2)),p=r(n(8)),h=r(n(7)),y=r(n(14)),v=(o=y.default,(0,h.default)(g,o),(0,d.default)(g,[{key:"closeAllConnections",value:(s=(0,c.default)(u.default.mark(function e(t,n){var r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.httpClient.getAuthHeaders({key:t,secret:n}),e.next=3,this.httpClient.del("/v2/events/simple_notifications",{headers:r});case 3:case"end":return e.stop()}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"signIn",value:(i=(0,c.default)(u.default.mark(function e(){var t,n,r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.httpClient.post("/v2/events/simple_notifications/key");case 2:return t=e.sent,n=t.getHeader("TT-X-Api-Key"),r=t.getHeader("TT-X-Api-Secret"),e.abrupt("return",{key:n,secret:r});case 6:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"signOut",value:(a=(0,c.default)(u.default.mark(function e(t,n){var r;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.httpClient.getAuthHeaders({key:t,secret:n}),e.abrupt("return",this.httpClient.post("/v2/logout",{headers:r}));case 2:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})}]),g);function g(){return(0,f.default)(this,g),(0,p.default)(this,(g.__proto__||(0,l.default)(g)).apply(this,arguments))}t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,b.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function u(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,b.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=u(t[0],n);return t.every(function(e){return u(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return u(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+u(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,c,l,f,d,p,h,y,v,g=r(n(4)),m=r(n(5)),b=r(n(3)),_=r(n(11)),w=r(n(10)),x=r(n(9)),E=r(n(6)),k=r(n(1)),T=r(n(2)),A=r(n(8)),I=r(n(30)),O=r(n(7)),j=n(14),S=r(j),M=r(n(45)),R=j.VERSIONS.VERSION_TWO,C=j.ROUTES.ORGANIZATION_FIND_ALL_OF_USER,P=j.ROUTES.ORGANIZATION_FIND,z=(a=(0,j.recoverFromNotFound)(),i=(0,j.recoverFromNotFound)(),c=(0,j.recoverFromNotFound)(),l=(0,j.recoverFromNotFound)(),d=S.default,(0,O.default)(V,d),(0,T.default)(V,[{key:"find",value:(v=(0,x.default)(w.default.mark(function e(t,n){var r,o,a,i;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=8;break;case 8:return r=(0,I.default)(V.prototype.__proto__||(0,E.default)(V.prototype),"getVersion",this).call(this,P),o=r.version,a=void 0===o?R:o,e.next=11,this.httpClient.get("/:version/user/:userId/organization/:id",{urlParams:{version:a,userId:t,id:n}});case 11:return i=e.sent,e.abrupt("return",i.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"findAllOfUser",value:(y=(0,x.default)(w.default.mark(function e(t){var n,r,o,a;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=4;break;case 4:return n=(0,I.default)(V.prototype.__proto__||(0,E.default)(V.prototype),"getVersion",this).call(this,C),r=n.version,o=void 0===r?R:r,e.next=7,this.httpClient.get("/:version/user/:userId/organization",{urlParams:{version:o,userId:t}});case 7:return a=e.sent,e.abrupt("return",a.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"getPreferences",value:(h=(0,x.default)(w.default.mark(function e(t){var n;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("/v2/organization/:organizationId/preferences",{urlParams:{organizationId:t}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"editPreferences",value:(p=(0,x.default)(w.default.mark(function e(t){var n,r=t.organizationId,o=t.quickReplies;return w.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v2/organization/:organizationId/preferences",{headers:{"TT-X-Organization-Key":r},data:M.default.underscoreObject({network:{patient:{quickReplies:o}}}),urlParams:{organizationId:r}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})}]),o((f=V).prototype,"find",[a],(0,_.default)(f.prototype,"find"),f.prototype),o(f.prototype,"findAllOfUser",[i],(0,_.default)(f.prototype,"findAllOfUser"),f.prototype),o(f.prototype,"getPreferences",[c],(0,_.default)(f.prototype,"getPreferences"),f.prototype),o(f.prototype,"editPreferences",[l],(0,_.default)(f.prototype,"editPreferences"),f.prototype),f);function V(){return(0,k.default)(this,V),(0,A.default)(this,(V.__proto__||(0,E.default)(V)).apply(this,arguments))}t.default=z,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function d(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,w.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=d(t[0],n);return t.every(function(e){return d(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return d(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+d(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function p(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,w.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=p(t[0],n);return t.every(function(e){return p(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return p(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+p(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,h,y,v,g,m,b=r(n(4)),_=r(n(5)),w=r(n(3)),x=r(n(10)),E=r(n(9)),k=r(n(6)),T=r(n(1)),A=r(n(2)),I=r(n(8)),O=r(n(7)),j=r(n(541)),S=r(n(177)),M=r(n(116)),R=r(n(14)),C=r(n(45)),P=((0,S.default)(G,j.default,{value:function(e){return G(e)}}),G),z=(o=R.default,(0,O.default)(V,o),(0,A.default)(V,[{key:"create",value:(m=(0,E.default)(x.default.mark(function e(t){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v5/patient",{data:C.default.underscoreObject((0,M.default)(t,"organizationId")),headers:{"TT-X-Organization-Key":t.organizationId}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"delete",value:(g=(0,E.default)(x.default.mark(function e(t,n){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(n));e.next=8;break;case 8:return e.next=10,this.httpClient.del("/v5/patient/:id",{urlParams:{id:t},headers:{"TT-X-Organization-Key":n}});case 10:return r=e.sent,e.abrupt("return",r.data);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"update",value:(v=(0,E.default)(x.default.mark(function e(t){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v5/patient/:id",{data:C.default.underscoreObject((0,M.default)(t,["organizationId","patientId"])),headers:{"TT-X-Organization-Key":t.organizationId},urlParams:{id:t.patientId}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"createContact",value:(y=(0,E.default)(x.default.mark(function e(t){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v5/patient/:patient_id/contact",{data:C.default.underscoreObject((0,M.default)(t,["organizationId","patientId"])),headers:{"TT-X-Organization-Key":t.organizationId},urlParams:{patient_id:t.patientId}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"deleteContact",value:(h=(0,E.default)(x.default.mark(function e(t){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.del("/v5/patient/:patient_id/contact/:contact_id",{urlParams:{contact_id:t.contactId,patient_id:t.patientId},headers:{"TT-X-Organization-Key":t.organizationId}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"updateContact",value:(f=(0,E.default)(x.default.mark(function e(t){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v5/patient/:patient_id/contact/:contact_id",{data:C.default.underscoreObject((0,M.default)(t,["organizationId","patientId","contactId"])),headers:{"TT-X-Organization-Key":t.organizationId},urlParams:{patient_id:t.patientId,contact_id:t.contactId}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"login",value:(l=(0,E.default)(x.default.mark(function e(t,n,r,o){var a,i,s,u,c,l,f;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "linkToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(t));e.next=2;break;case 2:if(void 0!==n&&"string"!=typeof n)throw new TypeError('Value of optional argument "accessToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(n));e.next=4;break;case 4:if(void 0!==r&&"string"!=typeof r)throw new TypeError('Value of optional argument "dateOfBirth" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(r));e.next=6;break;case 6:if(void 0===o||Array.isArray(o)&&o.every(function(e){return P(e)})){e.next=8;break}throw new TypeError('Value of optional argument "sessions" violates contract.\n\nExpected:\nSessionObject[]\n\nGot:\n'+p(o));case 8:if("string"!=typeof t)throw new TypeError('Value of argument "linkToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=10;break;case 10:if(void 0!==n&&"string"!=typeof n)throw new TypeError('Value of optional argument "accessToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(n));e.next=12;break;case 12:if(void 0!==r&&"string"!=typeof r)throw new TypeError('Value of optional argument "dateOfBirth" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(r));e.next=14;break;case 14:if(void 0===o||Array.isArray(o)&&o.every(function(e){return P(e)})){e.next=16;break}throw new TypeError('Value of optional argument "sessions" violates contract.\n\nExpected:\nSessionObject[]\n\nGot:\n'+d(o));case 16:return a={want_condensed_replays:this.config.wantCondensedReplays,want_processing_events:this.config.wantCondensedReplays},n?(a.auth={access_token:n},r&&(a.auth.dob=r)):r&&(a.auth={dob:r}),Array.isArray(o)&&(a.session_tokens=C.default.underscoreObject(o)),e.next=21,this.httpClient.post("/v5/patient/login/:linkToken",{urlParams:{linkToken:t},data:a});case 21:return(i=e.sent).data&&(s=i.data,u=s.condensed_replays,c=void 0!==u&&u,l=s.processing_events,f=void 0!==l&&l,this.host.configure({condensedReplays:c,processingEvents:f})),e.abrupt("return",i.data);case 24:case"end":return e.stop()}},e,this)})),function(e,t,n,r){return l.apply(this,arguments)})},{key:"loginCheck",value:(c=(0,E.default)(x.default.mark(function e(t,n){var r,o;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "linkToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(t));e.next=2;break;case 2:if(void 0===n||Array.isArray(n)&&n.every(function(e){return P(e)})){e.next=4;break}throw new TypeError('Value of optional argument "sessions" violates contract.\n\nExpected:\nSessionObject[]\n\nGot:\n'+p(n));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "linkToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=6;break;case 6:if(void 0===n||Array.isArray(n)&&n.every(function(e){return P(e)})){e.next=8;break}throw new TypeError('Value of optional argument "sessions" violates contract.\n\nExpected:\nSessionObject[]\n\nGot:\n'+d(n));case 8:return r={},Array.isArray(n)&&(r.session_tokens=C.default.underscoreObject(n)),e.next=12,this.httpClient.post("/v5/patient/login_check/:linkToken",{urlParams:{linkToken:t},data:r});case 12:return o=e.sent,e.abrupt("return",o.data);case 14:case"end":return e.stop()}},e,this)})),function(e,t){return c.apply(this,arguments)})},{key:"requestAccessToken",value:(u=(0,E.default)(x.default.mark(function e(t){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "linkToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "linkToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=4;break;case 4:return e.next=6,this.httpClient.post("/v5/patient/request_access_token/:linkToken",{urlParams:{linkToken:t},data:{}});case 6:return n=e.sent,e.abrupt("return",n.data);case 8:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"csvUpload",value:(s=(0,E.default)(x.default.mark(function e(t,n){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "file" violates contract.\n\nExpected:\nstring\n\nGot:\n'+p(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "file" violates contract.\n\nExpected:\nstring\n\nGot:\n'+d(n));e.next=8;break;case 8:return e.next=10,this.httpClient.post("/v5/patient/csv/upload",{data:n,headers:{"TT-X-Organization-Key":t}});case 10:return r=e.sent,e.abrupt("return",r.data);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"getWhiteLabel",value:(i=(0,E.default)(x.default.mark(function e(t){var n;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("/v5/patient/white_label/:organizationId",{urlParams:{organizationId:t},headers:{"TT-X-Organization-Key":t}});case 2:return n=e.sent,e.abrupt("return",C.default.camelizeObject(n.data));case 4:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"setWhiteLabel",value:(a=(0,E.default)(x.default.mark(function e(t,n){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v5/patient/white_label/:organizationId",{urlParams:{organizationId:t},headers:{"TT-X-Organization-Key":t},data:C.default.underscoreObject(n)});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})}]),V);function V(){return(0,T.default)(this,V),(0,I.default)(this,(V.__proto__||(0,k.default)(V)).apply(this,arguments))}function G(e){return null!=e&&"string"==typeof e.account_token&&"string"==typeof e.session_token}t.default=z,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,d,p,h=r(n(11)),y=r(n(10)),v=r(n(9)),g=r(n(6)),m=r(n(1)),b=r(n(2)),_=r(n(8)),w=r(n(7)),x=n(14),E=r(x),k=(o=(0,x.recoverFromNotFound)(),d=E.default,(0,w.default)(T,d),(0,b.default)(T,[{key:"create",value:(p=(0,v.default)(y.default.mark(function e(){var t,n;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.httpClient.getAuthHeaders(),e.next=3,this.httpClient.get("/v2/qr_login_code/",{headers:t});case 3:return n=e.sent,e.abrupt("return",n.data.qr_key);case 5:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)})}]),i=(a=T).prototype,s="create",u=[o],c=(0,h.default)(a.prototype,"create"),l=a.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(i,s,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(i,s,f),f=null),a);function T(){return(0,m.default)(this,T),(0,_.default)(this,(T.__proto__||(0,g.default)(T)).apply(this,arguments))}t.default=k,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function v(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=v(t[0],n);return t.every(function(e){return v(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return v(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,y.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+v(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function g(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=g(t[0],n);return t.every(function(e){return g(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return g(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,y.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+g(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,d,p,h=r(n(4)),y=r(n(5)),m=r(n(3)),b=r(n(11)),_=r(n(10)),w=r(n(9)),x=r(n(6)),E=r(n(1)),k=r(n(2)),T=r(n(8)),A=r(n(7)),I=n(14),O=r(I),j=["messageId","sender.name","sender.title","sender.department","sender.mrn","senderRoleDisplayName","recipient.name","recipient.title","recipient.department","recipient.mrn","recipientRoleDisplayName","group.name","distributionList.name","sentTimestamp","attachment.hasAttachment","recalledTimestamp","forwardedMessageId","expireTimestamp","dndAutoForwardedFrom"],S={script:"(doc['deliveredTimestamp'].empty ? '' : _source.deliveredTimestamp < _source.sentTimestamp ? _source.sentTimestamp : _source.deliveredTimestamp)"},M={script:"(doc['readTimestamp'].empty ? '' :_source.readTimestamp < _source.sentTimestamp ? _source.sentTimestamp : _source.readTimestamp)"},R=["sender.title","recipient.title","sender.department","sender.mrn","recipient.mrn","senderRoleDisplayName","recipient.department","recipientRoleDisplayName","sender.username","recipient.username","sender.verifiedEmails","recipient.verifiedEmails","sender.unverifiedEmails","recipient.unverifiedEmails","sender.verifiedPhones","recipient.verifiedPhones","sender.unverifiedPhones","recipient.unverifiedPhones","group.groupId","group.name","distributionList.distributionListId","distributionList.name","forwardedMessageId","messageId"],C=(o=(0,I.recoverFromNotFound)(),d=O.default,(0,A.default)(P,d),(0,k.default)(P,[{key:"fetchTransactions",value:(p=(0,w.default)(_.default.mark(function e(t,n){var r,o,a,i,s,u,c,l=n.page,f=n.size,d=n.startDate,p=n.endDate,h=n.query,y=arguments;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+g(t));e.next=2;break;case 2:if(null==y[1]||"number"!=typeof y[1].page||"number"!=typeof y[1].size||"string"!=typeof y[1].startDate||"string"!=typeof y[1].endDate||"string"!=typeof y[1].query)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  page: number;\n  size: number;\n  startDate: string;\n  endDate: string;\n  query: string;\n}\n\nGot:\n"+g(y[1]));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+v(t));e.next=6;break;case 6:if(null==y[1]||"number"!=typeof y[1].page||"number"!=typeof y[1].size||"string"!=typeof y[1].startDate||"string"!=typeof y[1].endDate||"string"!=typeof y[1].query)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  page: number;\n  size: number;\n  startDate: string;\n  endDate: string;\n  query: string;\n}\n\nGot:\n"+v(y[1]));e.next=8;break;case 8:return r={"TT-X-Organization-Key":t},o=l*f-f,a=t,s=(i=h)&&h.split(" ").join("*"),u=[{range:{sentTimestamp:{from:d,to:p}}},{match:{"sender.organization.orgId":a}},{constant_score:{filter:{missing:{field:"message.hideMessage"}}}},{bool:{should:[{query_string:{query:"*"+s+"*",fields:["sender.name","recipient.name"]}},{multi_match:{query:i,fields:R}}]}}],e.next=16,this.httpClient.post("/v2/report/messages",{headers:r,data:{from:o,size:f,fields:j,script_fields:{deliveredTimestamp:S,readTimestamp:M},sort:{sentTimestamp:{order:"desc"}},query:{bool:{must:u}}}});case 16:return c=e.sent,e.abrupt("return",c);case 18:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})}]),i=(a=P).prototype,s="fetchTransactions",u=[o],c=(0,b.default)(a.prototype,"fetchTransactions"),l=a.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(i,s,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(i,s,f),f=null),a);function P(){var e,t,i,n,r,s=this;(0,E.default)(this,P);for(var o=arguments.length,a=Array(o),u=0;u<o;u++)a[u]=arguments[u];return t=i=(0,T.default)(this,(e=P.__proto__||(0,x.default)(P)).call.apply(e,[this].concat(a))),i.generateLookerEmbed=(r=(0,w.default)(_.default.mark(function e(t,n){var r,o,a;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+g(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "dashboard_type" violates contract.\n\nExpected:\nstring\n\nGot:\n'+g(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+v(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "dashboard_type" violates contract.\n\nExpected:\nstring\n\nGot:\n'+v(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":t},e.next=11,i.httpClient.post("/v2/looker",{headers:r,data:{dashboard_type:n}});case 11:return o=e.sent,a=o.data,e.abrupt("return",a&&a.looker_url);case 14:case"end":return e.stop()}},e,s)})),function(e,t){return r.apply(this,arguments)}),n=t,(0,T.default)(i,n)}t.default=C,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function c(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,k.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=c(t[0],n);return t.every(function(e){return c(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return c(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,E.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,x.default)(e))+": "+c(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function l(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,k.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=l(t[0],n);return t.every(function(e){return l(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return l(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,E.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,x.default)(e))+": "+l(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,f,d,p,h,y,v,g,m,b,_,w,x=r(n(4)),E=r(n(5)),k=r(n(3)),T=r(n(11)),A=r(n(10)),I=r(n(9)),O=r(n(6)),j=r(n(1)),S=r(n(2)),M=r(n(8)),R=r(n(7)),C=n(14),P=r(C),z=(o=(0,C.recoverFromNotFound)(),h=P.default,(0,R.default)(V,h),(0,S.default)(V,[{key:"findAll",value:(w=(0,I.default)(A.default.mark(function e(t){var n,r;return A.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=4;break;case 4:return n={"TT-X-Organization-Key":t},e.next=7,this.httpClient.get("/v2/role/tags",{headers:n});case 7:return r=e.sent,e.abrupt("return",r.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)})},{key:"createOrUpdateTag",value:(_=(0,I.default)(A.default.mark(function e(t,n,r,o){var a,i;return A.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "color" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "name" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "color" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "name" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(r));e.next=12;break;case 12:if(a={color:t,name:n,organizationId:r},i=void 0,o)return e.next=17,this.updateTag(o,a);e.next=20;break;case 17:i=e.sent,e.next=23;break;case 20:return e.next=22,this.createTag(a);case 22:i=e.sent;case 23:return e.abrupt("return",i);case 24:case"end":return e.stop()}},e,this)})),function(e,t,n,r){return _.apply(this,arguments)})},{key:"createTag",value:(b=(0,I.default)(A.default.mark(function e(t){var n,r,o=t.color,a=t.name,i=t.organizationId,s=arguments;return A.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==s[0]||"string"!=typeof s[0].color||"string"!=typeof s[0].name||"string"!=typeof s[0].organizationId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  color: string;\n  name: string;\n  organizationId: string;\n}\n\nGot:\n"+l(s[0]));e.next=2;break;case 2:if(null==s[0]||"string"!=typeof s[0].color||"string"!=typeof s[0].name||"string"!=typeof s[0].organizationId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  color: string;\n  name: string;\n  organizationId: string;\n}\n\nGot:\n"+c(s[0]));e.next=4;break;case 4:return n={"TT-X-Organization-Key":i},e.next=7,this.httpClient.post("/v2/tags",{data:{color:o,name:a},headers:n});case 7:return(r=e.sent).token=r.headers["tt-x-tag-id"],e.abrupt("return",r);case 10:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"updateTag",value:(m=(0,I.default)(A.default.mark(function e(t,n){var r,o,a=n.color,i=n.name,s=n.organizationId,u=arguments;return A.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==u[1]||"string"!=typeof u[1].color||"string"!=typeof u[1].name||"string"!=typeof u[1].organizationId)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  color: string;\n  name: string;\n  organizationId: string;\n}\n\nGot:\n"+l(u[1]));e.next=2;break;case 2:if(null==u[1]||"string"!=typeof u[1].color||"string"!=typeof u[1].name||"string"!=typeof u[1].organizationId)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  color: string;\n  name: string;\n  organizationId: string;\n}\n\nGot:\n"+c(u[1]));e.next=4;break;case 4:return r={"TT-X-Organization-Key":s},e.next=7,this.httpClient.put("/v2/tags/:token",{urlParams:{token:t},data:{color:a,name:i},headers:r});case 7:return(o=e.sent).token=t,e.abrupt("return",o);case 10:case"end":return e.stop()}},e,this)})),function(e,t){return m.apply(this,arguments)})},{key:"destroy",value:(g=(0,I.default)(A.default.mark(function e(t,n){var r,o;return A.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "token" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "token" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":t},e.next=11,this.httpClient.del("/v2/tags/:token",{urlParams:{token:n},headers:r});case 11:return o=e.sent,e.abrupt("return",o.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"findColors",value:(v=(0,I.default)(A.default.mark(function e(t){var n,r;return A.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=4;break;case 4:return n={"TT-X-Organization-Key":t},e.next=7,this.httpClient.get("/v2/tag/color_list/:organizationId",{urlParams:{organizationId:t},headers:n});case 7:return r=e.sent,e.abrupt("return",r.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"findTag",value:(y=(0,I.default)(A.default.mark(function e(t,n){var r,o;return A.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "tagId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "tagId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":t},e.next=11,this.httpClient.get("/v2/tags/:tagId",{urlParams:{tagId:n},headers:r});case 11:return o=e.sent,e.abrupt("return",o.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})}]),i=(a=V).prototype,s="findAll",u=[o],f=(0,T.default)(a.prototype,"findAll"),d=a.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=u.slice().reverse().reduce(function(e,t){return t(i,s,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(i,s,p),p=null),a);function V(){return(0,j.default)(this,V),(0,M.default)(this,(V.__proto__||(0,O.default)(V)).apply(this,arguments))}t.default=z,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function m(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,T.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=m(t[0],n);return t.every(function(e){return m(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return m(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,k.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,E.default)(e))+": "+m(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function b(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,T.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=b(t[0],n);return t.every(function(e){return b(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return b(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,k.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,E.default)(e))+": "+b(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,_,w,x,E=r(n(4)),k=r(n(5)),T=r(n(3)),A=r(n(11)),I=r(n(10)),O=r(n(9)),j=r(n(6)),S=r(n(1)),M=r(n(2)),R=r(n(8)),C=r(n(30)),P=r(n(7)),z=n(14),V=r(z),G=z.VERSIONS.VERSION_TWO,N=z.ROUTES.ROLES_CREATE_P2P_GROUP,D=(a=(0,z.recoverFromNotFound)(),i=(0,z.recoverFromNotFound)(),u=V.default,(0,P.default)(U,u),(0,M.default)(U,[{key:"createP2PGroup",value:(x=(0,O.default)(I.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p=t.createdByUserId,h=t.name,y=t.replayHistory,v=void 0!==y&&y,g=t.memberIds,m=void 0===g?[]:g,b=t.organizationId;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,C.default)(U.prototype.__proto__||(0,j.default)(U.prototype),"getVersion",this).call(this,N),r=n.version,o=void 0===r?G:r,a={"TT-X-Organization-Key":b},i={created_by:p,members:m,name:h,replay_history:v},e.next=5,this.httpClient.post("/:version/role_group",{urlParams:{version:o},headers:a,data:i});case 5:return s=e.sent,u=s.data,c=u.conversation_id,l=u.metadata,f=s.data.token,d={conversationId:c,memberIds:m,metadata:l,name:h,organizationId:b,token:f},e.abrupt("return",d);case 10:case"end":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)})},{key:"find",value:(w=(0,O.default)(I.default.mark(function e(t,n){var r,o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.get("/v2/role/:id",{urlParams:{id:t},headers:r});case 11:return o=e.sent,e.abrupt("return",o.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return w.apply(this,arguments)})},{key:"createRole",value:(_=(0,O.default)(I.default.mark(function e(t){var n,r,o,a=t.description,i=t.name,s=t.openAssignment,u=t.organizationId,c=t.ownerRequired,l=t.owners,f=t.replayHistory,d=t.tagColor,p=t.tagName,h=t.tagToken,y=t.escalationPolicy,v=arguments;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==v[0]||void 0!==v[0].description&&null!=v[0].description&&"string"!=typeof v[0].description||"string"!=typeof v[0].name||"boolean"!=typeof v[0].openAssignment||"string"!=typeof v[0].organizationId||void 0!==v[0].ownerRequired&&null!=v[0].ownerRequired&&"boolean"!=typeof v[0].ownerRequired||!(void 0===v[0].owners||null==v[0].owners||Array.isArray(v[0].owners)&&v[0].owners.every(function(e){return"string"==typeof e}))||"string"!=typeof v[0].replayHistory||void 0!==v[0].tagColor&&null!=v[0].tagColor&&"string"!=typeof v[0].tagColor||void 0!==v[0].tagName&&null!=v[0].tagName&&"string"!=typeof v[0].tagName||void 0!==v[0].tagToken&&null!=v[0].tagToken&&"string"!=typeof v[0].tagToken||!(void 0===v[0].escalationPolicy||null==v[0].escalationPolicy||v[0].escalationPolicy instanceof Object))throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  description?: ?string;\n  name: string;\n  openAssignment: boolean;\n  organizationId: string;\n  ownerRequired?: ?boolean;\n  owners?: ?Array<string>;\n  replayHistory: string;\n  tagColor?: ?string;\n  tagName?: ?string;\n  tagToken?: ?string;\n  escalationPolicy?: ?Object;\n}\n\nGot:\n"+b(v[0]));e.next=2;break;case 2:if(null==v[0]||void 0!==v[0].description&&null!=v[0].description&&"string"!=typeof v[0].description||"string"!=typeof v[0].name||"boolean"!=typeof v[0].openAssignment||"string"!=typeof v[0].organizationId||void 0!==v[0].ownerRequired&&null!=v[0].ownerRequired&&"boolean"!=typeof v[0].ownerRequired||!(void 0===v[0].owners||null==v[0].owners||Array.isArray(v[0].owners)&&v[0].owners.every(function(e){return"string"==typeof e}))||"string"!=typeof v[0].replayHistory||void 0!==v[0].tagColor&&null!=v[0].tagColor&&"string"!=typeof v[0].tagColor||void 0!==v[0].tagName&&null!=v[0].tagName&&"string"!=typeof v[0].tagName||void 0!==v[0].tagToken&&null!=v[0].tagToken&&"string"!=typeof v[0].tagToken||!(void 0===v[0].escalationPolicy||null==v[0].escalationPolicy||v[0].escalationPolicy instanceof Object))throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  description?: ?string;\n  name: string;\n  openAssignment: boolean;\n  organizationId: string;\n  ownerRequired?: ?boolean;\n  owners?: ?Array<string>;\n  replayHistory: string;\n  tagColor?: ?string;\n  tagName?: ?string;\n  tagToken?: ?string;\n  escalationPolicy?: ?Object;\n}\n\nGot:\n"+m(v[0]));e.next=4;break;case 4:return n={"TT-X-Organization-Key":u},r={display_name:i,open_assignment:s?"1":"0",replay_history:f},void 0!==a&&(r.description=a),void 0!==y&&(r.escalation_policy=y),void 0!==c&&(r.owner_required=c?"1":"0"),void 0!==l&&(r.owners=l),void 0!==d&&(r.tag_color=d),void 0!==h&&(r.tag_id=h),void 0!==p&&(r.tag_name=p),e.next=15,this.httpClient.post("/v2/role",{headers:n,data:r});case 15:return(o=e.sent).token=o.headers["tt-x-role-token"],e.abrupt("return",o);case 18:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"updateRole",value:(g=(0,O.default)(I.default.mark(function e(t,n){var r,o,a,i=n.description,s=n.name,u=n.openAssignment,c=n.organizationId,l=n.ownerRequired,f=n.owners,d=n.replayHistory,p=n.tagColor,h=n.tagName,y=n.tagToken,v=n.escalationPolicy,g=arguments;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "token" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if(null==g[1]||void 0!==g[1].description&&null!=g[1].description&&"string"!=typeof g[1].description||void 0!==g[1].name&&null!=g[1].name&&"string"!=typeof g[1].name||void 0!==g[1].openAssignment&&null!=g[1].openAssignment&&"boolean"!=typeof g[1].openAssignment||"string"!=typeof g[1].organizationId||void 0!==g[1].ownerRequired&&null!=g[1].ownerRequired&&"boolean"!=typeof g[1].ownerRequired||!(void 0===g[1].owners||null==g[1].owners||Array.isArray(g[1].owners)&&g[1].owners.every(function(e){return"string"==typeof e}))||void 0!==g[1].replayHistory&&null!=g[1].replayHistory&&"string"!=typeof g[1].replayHistory||void 0!==g[1].tagColor&&null!=g[1].tagColor&&"string"!=typeof g[1].tagColor||void 0!==g[1].tagName&&null!=g[1].tagName&&"string"!=typeof g[1].tagName||void 0!==g[1].tagToken&&null!=g[1].tagToken&&"string"!=typeof g[1].tagToken||!(void 0===g[1].escalationPolicy||null==g[1].escalationPolicy||g[1].escalationPolicy instanceof Object))throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  description?: ?string;\n  name?: ?string;\n  openAssignment?: ?boolean;\n  organizationId: string;\n  ownerRequired?: ?boolean;\n  owners?: ?Array<string>;\n  replayHistory?: ?string;\n  tagColor?: ?string;\n  tagName?: ?string;\n  tagToken?: ?string;\n  escalationPolicy?: ?Object;\n}\n\nGot:\n"+b(g[1]));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "token" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=6;break;case 6:if(null==g[1]||void 0!==g[1].description&&null!=g[1].description&&"string"!=typeof g[1].description||void 0!==g[1].name&&null!=g[1].name&&"string"!=typeof g[1].name||void 0!==g[1].openAssignment&&null!=g[1].openAssignment&&"boolean"!=typeof g[1].openAssignment||"string"!=typeof g[1].organizationId||void 0!==g[1].ownerRequired&&null!=g[1].ownerRequired&&"boolean"!=typeof g[1].ownerRequired||!(void 0===g[1].owners||null==g[1].owners||Array.isArray(g[1].owners)&&g[1].owners.every(function(e){return"string"==typeof e}))||void 0!==g[1].replayHistory&&null!=g[1].replayHistory&&"string"!=typeof g[1].replayHistory||void 0!==g[1].tagColor&&null!=g[1].tagColor&&"string"!=typeof g[1].tagColor||void 0!==g[1].tagName&&null!=g[1].tagName&&"string"!=typeof g[1].tagName||void 0!==g[1].tagToken&&null!=g[1].tagToken&&"string"!=typeof g[1].tagToken||!(void 0===g[1].escalationPolicy||null==g[1].escalationPolicy||g[1].escalationPolicy instanceof Object))throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  description?: ?string;\n  name?: ?string;\n  openAssignment?: ?boolean;\n  organizationId: string;\n  ownerRequired?: ?boolean;\n  owners?: ?Array<string>;\n  replayHistory?: ?string;\n  tagColor?: ?string;\n  tagName?: ?string;\n  tagToken?: ?string;\n  escalationPolicy?: ?Object;\n}\n\nGot:\n"+m(g[1]));e.next=8;break;case 8:return r={"TT-X-Organization-Key":c},o={},void 0!==i&&(o.description=i),void 0!==s&&(o.display_name=s),void 0!==v&&(o.escalation_policy=v),void 0!==u&&(o.open_assignment=u?"1":"0"),void 0!==l&&(o.owner_required=l?"1":"0"),void 0!==f&&(o.owners=f),void 0!==d&&(o.replay_history=d),void 0!==p&&(o.tag_color=p),void 0!==y&&(o.tag_id=y),void 0!==h&&(o.tag_name=h),e.next=22,this.httpClient.put("/v2/role/:token",{urlParams:{token:t},headers:r,data:o});case 22:return(a=e.sent).token=t,e.abrupt("return",a);case 25:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"deleteRole",value:(v=(0,O.default)(I.default.mark(function e(t,n){var r;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "token" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "token" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":t},e.next=11,this.httpClient.del("/v2/role/:token",{urlParams:{token:n},headers:r});case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"findSavedRoles",value:(y=(0,O.default)(I.default.mark(function e(t,n){var r,o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.get("/v2/user/:userId/saved_roles",{urlParams:{userId:t},headers:r});case 11:return o=e.sent,e.abrupt("return",o.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})},{key:"saveRole",value:(h=(0,O.default)(I.default.mark(function e(t,n,r){var o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(r));e.next=12;break;case 12:return o={"TT-X-Organization-Key":r},e.next=15,this.httpClient.post("/v2/user/:userId/saved_roles",{urlParams:{userId:n},data:{role_id:t},headers:o});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return h.apply(this,arguments)})},{key:"removeSavedRole",value:(p=(0,O.default)(I.default.mark(function e(t,n,r){var o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(r));e.next=12;break;case 12:return o={"TT-X-Organization-Key":r},e.next=15,this.httpClient.del("/v2/user/:userId/saved_roles/:roleId",{urlParams:{userId:n,roleId:t},headers:o});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return p.apply(this,arguments)})},{key:"optIn",value:(d=(0,O.default)(I.default.mark(function e(t,n,r){var o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(r));e.next=12;break;case 12:return o={"TT-X-Organization-Key":r},e.next=15,this.httpClient.post("/v2/role/:roleId/members/:userId",{urlParams:{roleId:t,userId:n},headers:o});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return d.apply(this,arguments)})},{key:"optOut",value:(f=(0,O.default)(I.default.mark(function e(t,n,r){var o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(r));e.next=12;break;case 12:return o={"TT-X-Organization-Key":r},e.next=15,this.httpClient.del("/v2/role/:roleId/members/:userId",{urlParams:{roleId:t,userId:n},headers:o});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return f.apply(this,arguments)})},{key:"saveAwayResponse",value:(l=(0,O.default)(I.default.mark(function e(t,n,r){var o;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "status" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "status" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(r));e.next=12;break;case 12:return o={"TT-X-Organization-Key":n},e.next=15,this.httpClient.post("/v2/role/:roleId/away",{urlParams:{roleId:t},headers:o,data:{status:r}});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return l.apply(this,arguments)})},{key:"removeAwayResponse",value:(c=(0,O.default)(I.default.mark(function e(t,n){var r;return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+m(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.del("/v2/role/:roleId/away",{urlParams:{roleId:t},headers:r});case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return c.apply(this,arguments)})}]),o((s=U).prototype,"find",[a],(0,A.default)(s.prototype,"find"),s.prototype),o(s.prototype,"findSavedRoles",[i],(0,A.default)(s.prototype,"findSavedRoles"),s.prototype),s);function U(){return(0,S.default)(this,U),(0,R.default)(this,(U.__proto__||(0,j.default)(U)).apply(this,arguments))}t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,u,c,l,f=r(n(4)),d=r(n(5)),p=r(n(3)),h=r(n(10)),y=r(n(9)),v=r(n(6)),g=r(n(1)),m=r(n(2)),b=r(n(8)),_=r(n(30)),w=r(n(7)),x=r(n(879)),E=n(14),k=r(E),T=E.VERSIONS.VERSION_TWO,A=E.VERSIONS.VERSION_FIVE,I=["user","distributionList"],O=E.ROUTES.CONVERSATION_FIND_ALL,j=(o=k.default,(0,w.default)(S,o),(0,m.default)(S,[{key:"findAll",value:(l=(0,y.default)(h.default.mark(function e(){var t,n,r,o,a,i,s,u=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{organizationId:null};return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,_.default)(S.prototype.__proto__||(0,v.default)(S.prototype),"getVersion",this).call(this,O),n=t.version,a={render_metadata:"true"},(r=(o=void 0)===n?T:n)===A&&(o=u.organizationId,a.mark_as_delivered="true",a.paginated="true",a.organization_id=o||void 0),e.next=6,this.httpClient.get("/:version/roster",{query:a,urlParams:{version:r}});case 6:if((i=e.sent).data.continuation)return e.next=10,this._findAllPaginated(i.data.continuation,o,i.data.items);e.next=12;break;case 10:return s=e.sent,e.abrupt("return",s);case 12:return e.abrupt("return",i.data.items||i.data);case 13:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"_findAllPaginated",value:(c=(0,y.default)(h.default.mark(function e(t,n,r){var o;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t)return e.abrupt("return",r);e.next=2;break;case 2:return e.next=4,this.httpClient.get("/v5/roster",{query:{render_metadata:"true",mark_as_delivered:"true",paginated:"true",continuation:encodeURI(t),organization_id:n||void 0}});case 4:return o=e.sent,r=r.concat(o.data.items),e.abrupt("return",this._findAllPaginated(o.data.continuation,n,r));case 7:case"end":return e.stop()}},e,this)})),function(e,t,n){return c.apply(this,arguments)})},{key:"add",value:(u=(0,y.default)(h.default.mark(function e(t,n,r){var o,a;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));e.next=12;break;case 12:if((0,x.default)(I,t)){e.next=14;break}return e.abrupt("return");case 14:return o={},r&&(o["TT-X-Organization-Key"]=r),a=this.__typeToNS(t),e.next=19,this.httpClient.post("/v2/roster",{headers:o,data:{entity:n,type:a}});case 19:case"end":return e.stop()}},e,this)})),function(e,t,n){return u.apply(this,arguments)})},{key:"remove",value:(a=(0,y.default)(h.default.mark(function e(t,n,r){var o,a;return h.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));e.next=12;break;case 12:if((0,x.default)(I,t)){e.next=14;break}return e.abrupt("return");case 14:return o={},a=this.__typeToNS(t),r&&(o["TT-X-Organization-Key"]=r,o["TT-X-Type"]=a),e.next=19,this.httpClient.del("/v2/roster/:counterPartyId",{headers:o,urlParams:{counterPartyId:n},data:{type:a}});case 19:case"end":return e.stop()}},e,this)})),function(e,t,n){return a.apply(this,arguments)})},{key:"__typeToNS",value:function(e){return M[e]}}]),S);function S(){return(0,g.default)(this,S),(0,b.default)(this,(S.__proto__||(0,v.default)(S)).apply(this,arguments))}t.default=j;var M={user:"tigertext:entity:account",distributionList:"tigertext:entity:list"};e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function _(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,x.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=_(t[0],n);return t.every(function(e){return _(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return _(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,b.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,m.default)(e))+": "+_(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function w(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,x.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=w(t[0],n);return t.every(function(e){return w(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return w(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,b.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,m.default)(e))+": "+w(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m=r(n(4)),b=r(n(5)),x=r(n(3)),E=r(n(11)),k=r(n(16)),T=r(n(10)),A=r(n(9)),I=r(n(6)),O=r(n(1)),j=r(n(2)),S=r(n(8)),M=r(n(7)),R=n(14),C=r(R),P=(a=(0,R.recoverFromNotFound)(),i=(0,R.recoverFromNotFound)(),s=(0,R.recoverFromNotFound)(),u=(0,R.recoverFromNotFound)(),l=C.default,(0,M.default)(z,l),(0,j.default)(z,[{key:"batch",value:(g=(0,A.default)(T.default.mark(function e(t){var n,r=t.ids,o=t.operation,a=t.organizationId,i=arguments;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=i[0]&&Array.isArray(i[0].ids)&&i[0].ids.every(function(e){return"string"==typeof e})&&"string"==typeof i[0].operation&&"string"==typeof i[0].organizationId){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  ids: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+w(i[0]));case 2:if(null!=i[0]&&Array.isArray(i[0].ids)&&i[0].ids.every(function(e){return"string"==typeof e})&&"string"==typeof i[0].operation&&"string"==typeof i[0].organizationId){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  ids: string[];\n  operation: string;\n  organizationId: string;\n}\n\nGot:\n"+_(i[0]));case 4:return n={"TT-X-Organization-Key":a},e.next=7,this.httpClient.patch("/v5/schedule_message",{data:{ids:r,operation:o},headers:n});case 7:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"create",value:(v=(0,A.default)(T.default.mark(function e(t){var n,r,o,a,i=t.attachment,s=t.body,u=t.end_date,c=t.network,l=t.no_reply,f=t.organizationId,d=t.recipients,p=t.repeating,h=t.send_now,y=t.start_date,v=t.start_time,g=t.template_id,m=t.timezone_name,b=arguments;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==b[0]||!(void 0===b[0].attachment||null==b[0].attachment||b[0].attachment instanceof Object||null==b[0].attachment||"string"==typeof b[0].attachment)||"string"!=typeof b[0].body||void 0!==b[0].end_date&&null!=b[0].end_date&&"string"!=typeof b[0].end_date||"string"!=typeof b[0].network||void 0!==b[0].no_reply&&null!=b[0].no_reply&&"boolean"!=typeof b[0].no_reply||"string"!=typeof b[0].organizationId||!Array.isArray(b[0].recipients)||!b[0].recipients.every(function(e){return"string"==typeof e})||void 0!==b[0].repeating&&null!=b[0].repeating&&"string"!=typeof b[0].repeating||void 0!==b[0].send_now&&null!=b[0].send_now&&"boolean"!=typeof b[0].send_now||void 0!==b[0].start_date&&null!=b[0].start_date&&"string"!=typeof b[0].start_date||void 0!==b[0].start_time&&null!=b[0].start_time&&"string"!=typeof b[0].start_time||void 0!==b[0].template_id&&null!=b[0].template_id&&"string"!=typeof b[0].template_id||"string"!=typeof b[0].timezone_name)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?Object | ?string;\n  body: string;\n  end_date?: ?string;\n  network: string;\n  no_reply?: ?boolean;\n  organizationId: string;\n  recipients: string[];\n  repeating?: ?string;\n  send_now?: ?boolean;\n  start_date?: ?string;\n  start_time?: ?string;\n  template_id?: ?string;\n  timezone_name: string;\n}\n\nGot:\n"+w(b[0]));e.next=2;break;case 2:if(null==b[0]||!(void 0===b[0].attachment||null==b[0].attachment||b[0].attachment instanceof Object||null==b[0].attachment||"string"==typeof b[0].attachment)||"string"!=typeof b[0].body||void 0!==b[0].end_date&&null!=b[0].end_date&&"string"!=typeof b[0].end_date||"string"!=typeof b[0].network||void 0!==b[0].no_reply&&null!=b[0].no_reply&&"boolean"!=typeof b[0].no_reply||"string"!=typeof b[0].organizationId||!Array.isArray(b[0].recipients)||!b[0].recipients.every(function(e){return"string"==typeof e})||void 0!==b[0].repeating&&null!=b[0].repeating&&"string"!=typeof b[0].repeating||void 0!==b[0].send_now&&null!=b[0].send_now&&"boolean"!=typeof b[0].send_now||void 0!==b[0].start_date&&null!=b[0].start_date&&"string"!=typeof b[0].start_date||void 0!==b[0].start_time&&null!=b[0].start_time&&"string"!=typeof b[0].start_time||void 0!==b[0].template_id&&null!=b[0].template_id&&"string"!=typeof b[0].template_id||"string"!=typeof b[0].timezone_name)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?Object | ?string;\n  body: string;\n  end_date?: ?string;\n  network: string;\n  no_reply?: ?boolean;\n  organizationId: string;\n  recipients: string[];\n  repeating?: ?string;\n  send_now?: ?boolean;\n  start_date?: ?string;\n  start_time?: ?string;\n  template_id?: ?string;\n  timezone_name: string;\n}\n\nGot:\n"+_(b[0]));e.next=4;break;case 4:return n={},r={"TT-X-Organization-Key":f},i&&(n.attachment=i),e.next=9,this.httpClient.post("/v5/schedule_message",{files:n,data:(0,k.default)({},n.attachment?null:{attachment:i},{body:s},p?{end_date:u}:null,{network:c,no_reply:l,recipients:d},p?{repeating:p}:null,{send_now:h,start_date:y,start_time:v},g?{template_id:g}:null,{timezone_name:m}),headers:r,timeout:!(i||g)});case 9:return o=e.sent,a=o.data,e.abrupt("return",a);case 12:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"delete",value:(y=(0,A.default)(T.default.mark(function e(t,n){var r;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+w(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+w(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.del("/v5/schedule_message/:id",{headers:r,urlParams:{id:t}});case 11:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})},{key:"downloadScheduledMessageFile",value:(h=(0,A.default)(T.default.mark(function e(t){var n,r,o=t.scheduleId,a=t.fileName,i=t.organizationId;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={"TT-X-Organization-Key":i},r="/v5/schedule_message/"+o+"/attachment/"+a,e.abrupt("return",this.httpClient.downloadFileBlob(r,{headers:n}));case 3:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"find",value:(p=(0,A.default)(T.default.mark(function e(t,n){var r,o,a;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+w(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+w(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":n},e.next=11,this.httpClient.get("/v5/schedule_message/:id",{headers:r,urlParams:{id:t}});case 11:return o=e.sent,a=o.data,e.abrupt("return",a);case 14:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})},{key:"findCoarseTimezone",value:(d=(0,A.default)(T.default.mark(function e(t,n){var r,o,a;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={"TT-X-Organization-Key":n},e.next=3,this.httpClient.get("/v5/timezone/:timezone",{headers:r,urlParams:{timezone:t}});case 3:return o=e.sent,a=o.data,e.abrupt("return",a);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)})},{key:"update",value:(f=(0,A.default)(T.default.mark(function e(t){var n,r,o,a,i=t.attachment,s=t.body,u=t.end_date,c=t.id,l=t.organizationId,f=t.repeating,d=t.start_date,p=t.start_time,h=t.template_id,y=t.timezone_name,v=arguments;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==v[0]||!(void 0===v[0].attachment||null==v[0].attachment||null==v[0].attachment||null==v[0].attachment||v[0].attachment instanceof Object||null==v[0].attachment||"string"==typeof v[0].attachment)||"string"!=typeof v[0].body||void 0!==v[0].end_date&&null!=v[0].end_date&&"string"!=typeof v[0].end_date||"string"!=typeof v[0].id||"string"!=typeof v[0].organizationId||void 0!==v[0].repeating&&null!=v[0].repeating&&"string"!=typeof v[0].repeating||void 0!==v[0].start_date&&null!=v[0].start_date&&"string"!=typeof v[0].start_date||void 0!==v[0].start_time&&null!=v[0].start_time&&"string"!=typeof v[0].start_time||void 0!==v[0].template_id&&null!=v[0].template_id&&"string"!=typeof v[0].template_id||"string"!=typeof v[0].timezone_name)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?null | ?Object | ?string;\n  body: string;\n  end_date?: ?string;\n  id: string;\n  organizationId: string;\n  repeating?: ?string;\n  start_date?: ?string;\n  start_time?: ?string;\n  template_id?: ?string;\n  timezone_name: string;\n}\n\nGot:\n"+w(v[0]));e.next=2;break;case 2:if(null==v[0]||!(void 0===v[0].attachment||null==v[0].attachment||null==v[0].attachment||null==v[0].attachment||v[0].attachment instanceof Object||null==v[0].attachment||"string"==typeof v[0].attachment)||"string"!=typeof v[0].body||void 0!==v[0].end_date&&null!=v[0].end_date&&"string"!=typeof v[0].end_date||"string"!=typeof v[0].id||"string"!=typeof v[0].organizationId||void 0!==v[0].repeating&&null!=v[0].repeating&&"string"!=typeof v[0].repeating||void 0!==v[0].start_date&&null!=v[0].start_date&&"string"!=typeof v[0].start_date||void 0!==v[0].start_time&&null!=v[0].start_time&&"string"!=typeof v[0].start_time||void 0!==v[0].template_id&&null!=v[0].template_id&&"string"!=typeof v[0].template_id||"string"!=typeof v[0].timezone_name)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachment?: ?null | ?Object | ?string;\n  body: string;\n  end_date?: ?string;\n  id: string;\n  organizationId: string;\n  repeating?: ?string;\n  start_date?: ?string;\n  start_time?: ?string;\n  template_id?: ?string;\n  timezone_name: string;\n}\n\nGot:\n"+_(v[0]));e.next=4;break;case 4:return n={},r={"TT-X-Organization-Key":l},i&&(n.attachment=i),e.next=9,this.httpClient.put("/v5/schedule_message/:id",{files:n,data:(0,k.default)({},n.attachment?null:{attachment:i},{body:s},f?{end_date:u}:null,f?{repeating:f}:null,{start_date:d,start_time:p},h?{template_id:h}:null,{timezone_name:y}),headers:r,timeout:!(i||h),urlParams:{id:c}});case 9:return o=e.sent,a=o.data,e.abrupt("return",a);case 12:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})}]),o((c=z).prototype,"delete",[a],(0,E.default)(c.prototype,"delete"),c.prototype),o(c.prototype,"downloadScheduledMessageFile",[i],(0,E.default)(c.prototype,"downloadScheduledMessageFile"),c.prototype),o(c.prototype,"find",[s],(0,E.default)(c.prototype,"find"),c.prototype),o(c.prototype,"update",[u],(0,E.default)(c.prototype,"update"),c.prototype),c);function z(){return(0,O.default)(this,z),(0,S.default)(this,(z.__proto__||(0,I.default)(z)).apply(this,arguments))}t.default=P,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function c(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=c(t[0],n);return t.every(function(e){return c(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return c(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+c(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function l(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=l(t[0],n);return t.every(function(e){return l(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return l(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+l(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,f=r(n(4)),d=r(n(5)),p=r(n(3)),h=r(n(19)),y=r(n(10)),v=r(n(9)),g=r(n(6)),m=r(n(1)),b=r(n(2)),_=r(n(8)),w=r(n(7)),x=r(n(14)),E=(o=x.default,(0,w.default)(k,o),(0,b.default)(k,[{key:"findIntegrationIds",value:(u=(0,v.default)(y.default.mark(function e(t){var n,r;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=4;break;case 4:return n={Accept:"*","TT-X-Organization-Key":t},e.next=7,this.httpClient.post("/v1/integrations/scheduler/configs/info/org",{headers:n,data:{org:t}});case 7:return r=e.sent,e.abrupt("return",r.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"sendCsvSchedule",value:(s=(0,v.default)(y.default.mark(function e(t,n,r,o){var a,i,s,u;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "integrationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "file" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(r));e.next=6;break;case 6:if("string"!=typeof o)throw new TypeError('Value of argument "timezone" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(o));e.next=8;break;case 8:if("string"!=typeof t)throw new TypeError('Value of argument "integrationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=10;break;case 10:if("string"!=typeof n)throw new TypeError('Value of argument "file" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(n));e.next=12;break;case 12:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(r));e.next=14;break;case 14:if("string"!=typeof o)throw new TypeError('Value of argument "timezone" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(o));e.next=16;break;case 16:return a={"Content-Type":"text/csv","TT-X-Organization-Key":r,"TT-X-Integration-Id":t,"TT-X-Timezone":o},s=i=void 0,e.prev=19,e.next=22,this.httpClient.post("/v1/integrations/scheduler/webhook/csv",{data:n,headers:a});case 22:u=e.sent,i=u.data,s=u.status,e.next=35;break;case 27:if(e.prev=27,e.t0=e.catch(19),400!==e.t0.status){e.next=34;break}i=e.t0.response&&(e.t0.response.body||e.t0.response.text),s=e.t0.status,e.next=35;break;case 34:return e.abrupt("return",h.default.reject(e.t0));case 35:return e.abrupt("return",{json:i,status:s});case 36:case"end":return e.stop()}},e,this,[[19,27]])})),function(e,t,n,r){return s.apply(this,arguments)})},{key:"findCsv",value:(i=(0,v.default)(y.default.mark(function e(t,n){var r,o;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":t},e.next=11,this.httpClient.post("/v1/integrations/scheduler/webhook/csv/download",{headers:r,data:{org:t,id:n},resFormat:"text"});case 11:return o=e.sent,e.abrupt("return",o);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"clearSchedule",value:(a=(0,v.default)(y.default.mark(function e(t,n){var r,o;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(n));e.next=8;break;case 8:return r={Accept:"*","TT-X-Organization-Key":t},e.next=11,this.httpClient.post("/v1/integrations/scheduler/configs/truncate",{headers:r,data:{id:n}});case 11:return o=e.sent,e.abrupt("return",o.status);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})}]),k);function k(){return(0,m.default)(this,k),(0,_.default)(this,(k.__proto__||(0,g.default)(k)).apply(this,arguments))}t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(10)),u=r(n(9)),c=r(n(6)),l=r(n(1)),f=r(n(2)),d=r(n(8)),p=r(n(30)),h=r(n(7)),y=n(14),v=r(y),g=y.VERSIONS.VERSION_TWO,m=y.ROUTES.SEARCH_QUERY,b=(o=v.default,(0,h.default)(_,o),(0,f.default)(_,[{key:"query",value:(i=(0,u.default)(s.default.mark(function e(t){var n,r,o,a;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,p.default)(_.prototype.__proto__||(0,c.default)(_.prototype),"getVersion",this).call(this,m),r=n.version,o=void 0===r?g:r,e.next=3,this.httpClient.post("/:version/search",{data:t,urlParams:{version:o}});case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"patientQuery",value:(a=(0,u.default)(s.default.mark(function e(t){var n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v5/patient/search",{data:t});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})}]),_);function _(){return(0,l.default)(this,_),(0,d.default)(this,(_.__proto__||(0,c.default)(_)).apply(this,arguments))}t.default=b,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function u(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,v.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=u(t[0],n);return t.every(function(e){return u(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return u(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,y.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+u(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function c(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,v.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=c(t[0],n);return t.every(function(e){return c(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return c(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,y.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+c(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,l,f,d,p,h=r(n(4)),y=r(n(5)),v=r(n(3)),_=r(n(10)),g=r(n(9)),w=r(n(6)),m=r(n(1)),b=r(n(2)),x=r(n(8)),E=r(n(30)),k=r(n(7)),T=n(14),A=r(T),I=T.VERSIONS.VERSION_TWO,O=T.ROUTES.TEAMS_CREATE,j=T.ROUTES.TEAMS_FIND,S=T.ROUTES.TEAMS_LEAVE,M=T.ROUTES.TEAMS_UPDATE,R=(o=A.default,(0,k.default)(C,o),(0,b.default)(C,[{key:"find",value:(p=(0,g.default)(_.default.mark(function e(t,n){var r,o,a,i,s=n.organizationId;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+c(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=4;break;case 4:return r=(0,E.default)(C.prototype.__proto__||(0,w.default)(C.prototype),"getVersion",this).call(this,j),o=r.version,a=void 0===o?I:o,e.next=7,this.httpClient.get("/:version/team/:team_id",{headers:{"TT-X-Organization-Key":s},urlParams:{team_id:t,version:a}});case 7:return i=e.sent,e.abrupt("return",i.data);case 9:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})},{key:"create",value:(d=(0,g.default)(_.default.mark(function e(t){var n,r,o,a,i,s,u,c=t.avatar,l=t.canMembersLeave,f=void 0===l||l,d=t.canRequestToJoin,p=void 0===d||d,h=t.description,y=t.displayName,v=t.memberIds,g=void 0===v?[]:v,m=t.organizationId;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,E.default)(C.prototype.__proto__||(0,w.default)(C.prototype),"getVersion",this).call(this,O),r=n.version,o=void 0===r?I:r,a={},i={can_members_leave:f,can_request_to_join:p,display_name:y,members:g},s={},c&&(s.avatar=c),h&&(i.description=h),m&&(a["TT-X-Organization-Key"]=m),e.next=9,this.httpClient.post("/:version/team",{urlParams:{version:o},headers:a,data:i,files:s});case 9:return u=e.sent,e.abrupt("return",u.data);case 11:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"update",value:(f=(0,g.default)(_.default.mark(function e(t){var n,r,o,a,i,s,u,c=t.avatar,l=t.canMembersLeave,f=void 0===l||l,d=t.canRequestToJoin,p=void 0===d||d,h=t.description,y=t.displayName,v=t.id,g=t.memberIds,m=void 0===g?[]:g,b=t.organizationId;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,E.default)(C.prototype.__proto__||(0,w.default)(C.prototype),"getVersion",this).call(this,M),r=n.version,o=void 0===r?I:r,a={},i={can_members_leave:f,can_request_to_join:p,display_name:y,members:m},s={},c&&(s.avatar=c),h&&(i.description=h),b&&(a["TT-X-Organization-Key"]=b),e.next=9,this.httpClient.post("/:version/team/:id",{urlParams:{id:v,version:o},headers:a,data:i,files:s});case 9:return u=e.sent,e.abrupt("return",u.data);case 11:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"delete",value:(l=(0,g.default)(_.default.mark(function e(t,n){var r,o,a,i,s=n.organizationId;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,E.default)(C.prototype.__proto__||(0,w.default)(C.prototype),"getVersion",this).call(this,O),o=r.version,a=void 0===o?I:o,e.next=3,this.httpClient.del("/:version/team/:id",{headers:{"TT-X-Organization-Key":s},urlParams:{version:a,id:t}});case 3:return i=e.sent,e.abrupt("return",i.status);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"requestToJoin",value:(s=(0,g.default)(_.default.mark(function e(t,n){var r,o,a,i,s=n.organizationId,u=n.requestedById;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,E.default)(C.prototype.__proto__||(0,w.default)(C.prototype),"getVersion",this).call(this,O),o=r.version,a=void 0===o?I:o,e.next=3,this.httpClient.post("/:version/team/:id/request",{headers:{"TT-X-Organization-Key":s},urlParams:{id:t,version:a},data:{requested_by:u}});case 3:return i=e.sent,e.abrupt("return",i.status);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"updateJoinRequest",value:(i=(0,g.default)(_.default.mark(function e(t,n){var r,o,a,i,s=n.organizationId,u=n.teamId,c=n.handledAsId,l=n.status;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,E.default)(C.prototype.__proto__||(0,w.default)(C.prototype),"getVersion",this).call(this,O),o=r.version,a=void 0===o?I:o,e.next=3,this.httpClient.post("/:version/team/:team_id/request/:request_id",{headers:{"TT-X-Organization-Key":s},urlParams:{version:a,team_id:u,request_id:t},data:{handled_as:c,status:l}});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"leave",value:(a=(0,g.default)(_.default.mark(function e(t,n){var r,o,a,i,s=n.organizationId;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,E.default)(C.prototype.__proto__||(0,w.default)(C.prototype),"getVersion",this).call(this,S),o=r.version,a=void 0===o?I:o,e.next=3,this.httpClient.post("/:version/team/:team_id/leave",{headers:{"TT-X-Organization-Key":s},urlParams:{team_id:t,version:a},data:{}});case 3:return i=e.sent,e.abrupt("return",i.status);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})}]),C);function C(){return(0,m.default)(this,C),(0,x.default)(this,(C.__proto__||(0,w.default)(C)).apply(this,arguments))}t.default=R,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,d.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,f.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,l.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,d.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,f.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,l.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,u,c,l=r(n(4)),f=r(n(5)),d=r(n(3)),p=r(n(10)),h=r(n(9)),y=r(n(6)),v=r(n(1)),g=r(n(2)),m=r(n(8)),b=r(n(7)),_=r(n(14)),w=(o=_.default,(0,b.default)(x,o),(0,g.default)(x,[{key:"getTwilioNumbers",value:(c=(0,h.default)(p.default.mark(function e(t,n){var r,o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "areaCode" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "areaCode" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=8;break;case 8:return r={"TT-X-Organization-Key":t},e.next=11,this.httpClient.post("/v2/twilio/numbers",{headers:r,data:{area_code:n}});case 11:return o=e.sent,e.abrupt("return",o.data);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return c.apply(this,arguments)})},{key:"assignPagerNumber",value:(u=(0,h.default)(p.default.mark(function e(t,n,r){var o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "number" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "roleToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "number" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "roleToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));e.next=12;break;case 12:return o={"TT-X-Organization-Key":t},e.next=15,this.httpClient.post("/v2/user/:roleToken/organization/:organizationId/pagers?process_number=true",{headers:o,urlParams:{organizationId:t,roleToken:r},data:{pager_numbers:n}});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return u.apply(this,arguments)})},{key:"removePagerNumber",value:(a=(0,h.default)(p.default.mark(function e(t,n,r){var o;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "number" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "roleToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "number" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "roleToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));e.next=12;break;case 12:return o={"TT-X-Organization-Key":t},e.next=15,this.httpClient.del("/v2/user/:roleToken/organization/:organizationId/pagers/:number?process_number=true",{headers:o,urlParams:{organizationId:t,roleToken:r,number:n}});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return a.apply(this,arguments)})}]),x);function x(){return(0,v.default)(this,x),(0,m.default)(this,(x.__proto__||(0,y.default)(x)).apply(this,arguments))}t.default=w,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,f.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,l.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,c.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,f.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,l.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,c.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,u,c=r(n(4)),l=r(n(5)),f=r(n(3)),d=r(n(10)),p=r(n(9)),h=r(n(6)),y=r(n(1)),v=r(n(2)),g=r(n(8)),m=r(n(7)),b=r(n(14)),_=(o=b.default,(0,m.default)(w,o),(0,v.default)(w,[{key:"startTyping",value:(u=(0,p.default)(d.default.mark(function e(t,n,r){var o;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=8;break;case 8:if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(r));e.next=12;break;case 12:return o={recipient:t},n&&n!==this.host.currentUserId&&(o.proxy_token=n),e.next=16,this.httpClient.post("/v2/message/typing",{data:o,headers:{"TT-X-Organization-Key":r}});case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return u.apply(this,arguments)})},{key:"stopTyping",value:(a=(0,p.default)(d.default.mark(function e(t,n){return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=6;break;case 6:if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+i(n));e.next=8;break;case 8:if(n)return e.next=11,this.httpClient.del("/v2/message/typing/:recipientId/:senderId",{urlParams:{recipientId:t,senderId:n}});e.next=13;break;case 11:e.next=15;break;case 13:return e.next=15,this.httpClient.del("/v2/message/typing/:recipientId",{urlParams:{recipientId:t}});case 15:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})}]),w);function w(){return(0,y.default)(this,w),(0,g.default)(this,(w.__proto__||(0,h.default)(w)).apply(this,arguments))}t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,g.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,v.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,m.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,g.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,v.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,u,c,l,f,d,p,h,y,v=r(n(4)),g=r(n(5)),m=r(n(3)),b=r(n(11)),_=r(n(10)),w=r(n(9)),x=r(n(6)),E=r(n(1)),k=r(n(2)),T=r(n(8)),A=r(n(7)),I=n(14),O=r(I),j=(o=(0,I.recoverFromNotFound)(),h=O.default,(0,A.default)(S,h),(0,k.default)(S,[{key:"findAll",value:(y=(0,w.default)(_.default.mark(function e(t,n){var r;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(n));e.next=8;break;case 8:return e.next=10,this.httpClient.get("/v2/user/:userId/organization/:organizationId/roles",{urlParams:{userId:t,organizationId:n}});case 10:return r=e.sent,e.abrupt("return",r.data.roles);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})}]),u=(a=S).prototype,c="findAll",l=[o],f=(0,b.default)(a.prototype,"findAll"),d=a.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(u,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(u,c,p),p=null),a);function S(){return(0,E.default)(this,S),(0,T.default)(this,(S.__proto__||(0,x.default)(S)).apply(this,arguments))}t.default=j,e.exports=t.default},function(ee,te,ne){(function(l){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function t(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function x(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,j.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=x(t[0],n);return t.every(function(e){return x(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return x(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,O.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,I.default)(e))+": "+x(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function E(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,j.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=E(t[0],n);return t.every(function(e){return E(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return E(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,O.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,I.default)(e))+": "+E(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(te,"__esModule",{value:!0}),te.default=void 0;var n,r,o,a,i,s,u,c,f,d,p,h,y,v,g,m,b,_,w,k,T,A,I=e(ne(4)),O=e(ne(5)),j=e(ne(3)),S=e(ne(11)),M=e(ne(16)),R=e(ne(10)),C=e(ne(9)),P=e(ne(6)),z=e(ne(1)),V=e(ne(2)),G=e(ne(8)),N=e(ne(30)),D=e(ne(7)),U=ne(14),F=e(U),L=e(ne(337)),B=e(ne(296)),$=e(ne(315)),q=ne(67),H=ne(46),Y=e(ne(45)),Z=U.VERSIONS.VERSION_TWO,W=U.ROUTES.USER_FIND,K=U.ROUTES.USER_FIND_ME,X=new $.default.MD5,Q=(n=(0,U.recoverFromNotFound)({httpStatusCodes:[400]}),r=(0,U.recoverFromNotFound)(),o=(0,U.recoverFromNotFound)(),a=(0,U.recoverFromNotFound)(),s=F.default,(0,D.default)(J,s),(0,V.default)(J,[{key:"getAnonymousAuthHeader",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "udid" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(e));if("string"!=typeof e)throw new TypeError('Value of argument "udid" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(e));var t=this.config.signUpHashKey,n=this.config.signUpHashSalt,r=[t,n,e].join(":"),o=X.hex(r),a=[o.substr(0,2),o.substr(o.length-2)].join(""),i=[this.config.productKey,t,n,e,a].join(":");return"XMPP-Anonymous "+(0,B.default)(i)}},{key:"getSignInAuthHeader",value:function(){var e;return(e=this.constructor).getSignInAuthHeader.apply(e,arguments)}},{key:"checkLogin",value:(A=(0,C.default)(R.default.mark(function e(t,n){var r,o,a;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={Authorization:this.getAnonymousAuthHeader(n.udid)},o={device:n.udid,tt_product_version:this.config.partnerName},(0,H.isPhone)(t)?o.phones=(0,H.normalizePhoneUS)(t):o.emails=t,e.next=5,this.httpClient.get("/v4/login_check",{headers:r,query:o});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)})),function(e,t){return A.apply(this,arguments)})},{key:"signUp",value:(T=(0,C.default)(R.default.mark(function e(t){var n,r,o;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={Authorization:this.getAnonymousAuthHeader(t.udid)},r={primary_email:t.email,unique_id:t.email,password:t.password,push_routing:this.config.pushAgent,product:this.config.productKey,country_code:t.countryCode,device_id:t.udid,version:this.config.version},e.next=4,this.httpClient.post("/v2/signup",{headers:n,data:r});case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)})),function(e){return T.apply(this,arguments)})},{key:"signIn",value:(k=(0,C.default)(R.default.mark(function e(t,n){var r,o,a,i,s,u,c;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={device_id:n.udid,metadata:{device_type:"js_sdk",device_version:"11.7.0",tt_product_version:this.config.partnerName,user_agent:l.navigator&&l.navigator.userAgent},push_routing:this.config.pushAgent,version:this.config.version,want_condensed_replays:this.config.wantCondensedReplays,want_processing_events:this.config.wantCondensedReplays},e.next=3,this.httpClient.post("/v5/login",{headers:t,data:r});case 3:return(o=e.sent).data&&o.data.settings&&(a=o.data.settings,i=a.condensed_replays,s=void 0!==i&&i,u=a.processing_events,c=void 0!==u&&u,this.host.configure({condensedReplays:s,processingEvents:c})),e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return k.apply(this,arguments)})},{key:"signOut",value:(w=(0,C.default)(R.default.mark(function e(){var t;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v2/logout");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)})),function(){return w.apply(this,arguments)})},{key:"lookup",value:(_=(0,C.default)(R.default.mark(function e(t){var n,r,o,a,i;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=4;break;case 4:return n=(0,N.default)(J.prototype.__proto__||(0,P.default)(J.prototype),"getVersion",this).call(this,W),r=n.version,o=void 0===r?Z:r,a={display_name:t},(0,q.isEmail)(t)?a.email_address=t:(0,H.isPhone)(t)&&(a.phone_number=(0,H.normalizePhoneUS)(t)),e.next=9,this.httpClient.post("/:version/user_lookup/:id",{urlParams:{id:t,version:o},data:a});case 9:return i=e.sent,e.abrupt("return",i.data);case 11:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"wipe",value:(b=(0,C.default)(R.default.mark(function e(t){var n;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=4;break;case 4:return e.next=6,this.httpClient.post("/v2/wipe",{data:{},query:{token:t}});case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"find",value:(m=(0,C.default)(R.default.mark(function e(t){var n,r,o,a,i,s=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).organizationId;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=4;break;case 4:return n=(0,N.default)(J.prototype.__proto__||(0,P.default)(J.prototype),"getVersion",this).call(this,W),r=n.version,o=void 0===r?Z:r,(0,q.isEmail)(t)&&(t=t.toLowerCase()),a=s?{"TT-X-Organization-Key":s}:null,e.next=9,this.httpClient.get("/:version/user/:id",{headers:a,urlParams:{id:t,version:o},query:{render_metadata:!0}});case 9:return i=e.sent,e.abrupt("return",i.data);case 11:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"findMe",value:(g=(0,C.default)(R.default.mark(function e(){var t,n,r,o,a,i=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).organizationId;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,N.default)(J.prototype.__proto__||(0,P.default)(J.prototype),"getVersion",this).call(this,K),n=t.version,r=void 0===n?Z:n,o=i?{"TT-X-Organization-Key":i}:null,e.next=4,this.httpClient.get("/:version/user",{headers:o,query:{render_metadata:!0},urlParams:{version:r}});case 4:return a=e.sent,e.abrupt("return",a.data);case 6:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)})},{key:"update",value:(v=(0,C.default)(R.default.mark(function e(t,n){var r,o,a,i=n.firstName,s=void 0===i?void 0:i,u=n.lastName,c=void 0===u?void 0:u,l=n.displayName,f=void 0===l?void 0:l,d=n.status,p=void 0===d?void 0:d,h=n.dnd,y=void 0===h?void 0:h,v=n.dndText,g=void 0===v?void 0:v,m=n.avatarFile,b=void 0===m?void 0:m,_=n.removeAvatar,w=void 0===_?void 0:_;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=4;break;case 4:return o={},w?o.avatar=null:b&&(o.avatar=b),a=(r={first_name:s,last_name:c,display_name:f,status:p,dnd:y,dnd_text:g},L.default).call(r,function(e,t){return void 0===e}),e.next=9,this.httpClient.post("/v2/user/:id/settings",{urlParams:{id:t},data:a,files:o});case 9:return e.abrupt("return",(0,M.default)({id:t},b&&b.preview?{avatarUrl:b.preview}:null));case 10:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"updatePassword",value:(y=(0,C.default)(R.default.mark(function e(t,n,r,o){var a,i;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(r));e.next=6;break;case 6:if("string"!=typeof o)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(o));e.next=8;break;case 8:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=10;break;case 10:if("string"!=typeof n)throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=12;break;case 12:if("string"!=typeof r)throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(r));e.next=14;break;case 14:if("string"!=typeof o)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(o));e.next=16;break;case 16:return a={Authorization:this.getSignInAuthHeader(o,t,n)},e.next=19,this.httpClient.post("/v2/user/:id/password",{urlParams:{id:t},headers:a,data:{password:r}});case 19:return i=e.sent,e.abrupt("return",i);case 21:case"end":return e.stop()}},e,this)})),function(e,t,n,r){return y.apply(this,arguments)})},{key:"setAutoForward",value:(h=(0,C.default)(R.default.mark(function e(t,n,r){var o,a=r.dnd,i=r.receiverId,s=arguments;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if(null==s[2]||"boolean"!=typeof s[2].dnd||"string"!=typeof s[2].receiverId)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  dnd: boolean;\n  receiverId: string;\n}\n\nGot:\n"+E(s[2]));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=10;break;case 10:if(null==s[2]||"boolean"!=typeof s[2].dnd||"string"!=typeof s[2].receiverId)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  dnd: boolean;\n  receiverId: string;\n}\n\nGot:\n"+x(s[2]));e.next=12;break;case 12:return e.next=14,this.httpClient.post("/v2/user/:userId/organization/:organizationId",{urlParams:{userId:t,organizationId:n},data:{dnd:a,dnd_auto_forward_receiver:i}});case 14:return o=e.sent,e.abrupt("return",o);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return h.apply(this,arguments)})},{key:"removeAutoForward",value:(p=(0,C.default)(R.default.mark(function e(t,n){var r;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=8;break;case 8:return e.next=10,this.httpClient.del("/v2/user/:userId/organization/:organizationId/dnd_auto_forward_receiver",{urlParams:{userId:t,organizationId:n}});case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})},{key:"setAwayMessage",value:(d=(0,C.default)(R.default.mark(function e(t,n,r){var o=r.dnd,a=r.dndText,i=arguments;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if(null==i[2]||"boolean"!=typeof i[2].dnd||void 0!==i[2].dndText&&null!=i[2].dndText&&"string"!=typeof i[2].dndText)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  dnd: boolean;\n  dndText?: ?string;\n}\n\nGot:\n"+E(i[2]));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=10;break;case 10:if(null==i[2]||"boolean"!=typeof i[2].dnd||void 0!==i[2].dndText&&null!=i[2].dndText&&"string"!=typeof i[2].dndText)throw new TypeError("Value of argument 2 violates contract.\n\nExpected:\n{\n  dnd: boolean;\n  dndText?: ?string;\n}\n\nGot:\n"+x(i[2]));e.next=12;break;case 12:return e.next=14,this.httpClient.post("/v5/user/:userId/organization/:organizationId",{urlParams:{userId:t,organizationId:n},data:{network:{patient:{dnd:o,dnd_text:a}}}});case 14:case"end":return e.stop()}},e,this)})),function(e,t,n){return d.apply(this,arguments)})},{key:"setEulaAccepted",value:(f=(0,C.default)(R.default.mark(function e(t,n,r){var o;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if("boolean"!=typeof r)throw new TypeError('Value of argument "accept" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+E(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=10;break;case 10:if("boolean"!=typeof r)throw new TypeError('Value of argument "accept" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+x(r));e.next=12;break;case 12:return e.next=14,this.httpClient.post("/v2/user/:userId/organization/:organizationId",{urlParams:{userId:t,organizationId:n},data:{eula:!r}});case 14:return o=e.sent,e.abrupt("return",o);case 16:case"end":return e.stop()}},e,this)})),function(e,t,n){return f.apply(this,arguments)})},{key:"getPreferences",value:(c=(0,C.default)(R.default.mark(function e(t){var n;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.get("/v2/user/:userId/preferences",{urlParams:{userId:t}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"editPreferences",value:(u=(0,C.default)(R.default.mark(function e(t){var n,r=t.organizationId,o=t.quickReplies,a=t.userId;return R.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpClient.post("/v2/user/:userId/preferences",{headers:{"TT-X-Organization-Key":r},data:Y.default.underscoreObject({quickReplies:o}),urlParams:{userId:a}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})}],[{key:"getSignInAuthHeader",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));if("string"!=typeof n)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));if("string"!=typeof e)throw new TypeError('Value of argument "productKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));if("string"!=typeof n)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));var r=[e,t,n].join(":");return"XMPP-Simple "+(0,B.default)(r)}}]),t((i=J).prototype,"lookup",[n],(0,S.default)(i.prototype,"lookup"),i.prototype),t(i.prototype,"find",[r],(0,S.default)(i.prototype,"find"),i.prototype),t(i.prototype,"getPreferences",[o],(0,S.default)(i.prototype,"getPreferences"),i.prototype),t(i.prototype,"editPreferences",[a],(0,S.default)(i.prototype,"editPreferences"),i.prototype),i);function J(){return(0,z.default)(this,J),(0,G.default)(this,(J.__proto__||(0,P.default)(J)).apply(this,arguments))}te.default=Q,ee.exports=te.default}).call(te,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Users=t.UserRoles=t.TypingStatus=t.Twilio=t.Teams=t.Search=t.ScheduledMessages=t.Scheduler=t.Roster=t.RoleTags=t.Roles=t.Reporting=t.QRCode=t.Patients=t.Organizations=t.Notifications=t.Mute=t.Metadata=t.MessageTemplates=t.Messages=t.Groups=t.Events=t.Escalations=t.Entities=t.DistributionLists=t.Conversations=t.Calls=void 0;var o=r(n(407)),a=r(n(408)),i=r(n(409)),s=r(n(410)),u=r(n(411)),c=r(n(412)),l=r(n(413)),f=r(n(415)),d=r(n(414)),p=r(n(416)),h=r(n(417)),y=r(n(418)),v=r(n(419)),g=r(n(420)),m=r(n(421)),b=r(n(422)),_=r(n(424)),w=r(n(423)),x=r(n(425)),E=r(n(427)),k=r(n(426)),T=r(n(428)),A=r(n(429)),I=r(n(430)),O=r(n(431)),j=r(n(432)),S=r(n(433));t.Calls=o.default,t.Conversations=a.default,t.DistributionLists=i.default,t.Entities=s.default,t.Escalations=u.default,t.Events=c.default,t.Groups=l.default,t.Messages=f.default,t.MessageTemplates=d.default,t.Metadata=p.default,t.Mute=h.default,t.Notifications=y.default,t.Organizations=v.default,t.Patients=g.default,t.QRCode=m.default,t.Reporting=b.default,t.Roles=_.default,t.RoleTags=w.default,t.Roster=x.default,t.Scheduler=E.default,t.ScheduledMessages=k.default,t.Search=T.default,t.Teams=A.default,t.Twilio=I.default,t.TypingStatus=O.default,t.UserRoles=j.default,t.Users=S.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="connection-unavailable",a);function d(){(0,u.default)(this,d);var e=(0,c.default)(this,(d.__proto__||(0,s.default)(d)).call(this,"No internet connection"));return e.code=d.CODE,e}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="not-found",a);function d(e,t,n){(0,u.default)(this,d),n=n||e+" '"+t+"' not found";var r=(0,c.default)(this,(d.__proto__||(0,s.default)(d)).call(this,n));return r.code=d.CODE,r.resource=e,r.id=t,r}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="not-signed-in",a);function d(){var e;(0,u.default)(this,d);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=(0,c.default)(this,(e=d.__proto__||(0,s.default)(d)).call.apply(e,[this].concat(n)));return o.code=d.CODE,o}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="not-supported",a);function d(e){(0,u.default)(this,d);var t=(0,c.default)(this,(d.__proto__||(0,s.default)(d)).call(this,e));return t.code=d.CODE,t}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="permission-denied",a);function d(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"can't perform action '"+n+"' on "+(e.name||e)+" #"+t;(0,u.default)(this,d);var o=(0,c.default)(this,(d.__proto__||(0,s.default)(d)).call(this,r));return o.code=d.CODE,o.resource=e,o.action=n,o.id=t,o}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="requires-basic-auth",a);function d(){var e;(0,u.default)(this,d);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=(0,c.default)(this,(e=d.__proto__||(0,s.default)(d)).call.apply(e,[this].concat(n)));return o.code=d.CODE,o}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(2)),l=r(n(8)),f=r(n(7)),d=(i=Error,(0,f.default)(p,i),(0,c.default)(p,null,[{key:"raise",value:function(e){throw new this(e)}}]),a=o=p,o.CODE="target-not-supported",a);function p(e){return(0,u.default)(this,p),(0,l.default)(this,(p.__proto__||(0,s.default)(p)).call(this,"method"+(e?" "+e:"")+" not supported in target web"))}t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s=r(n(6)),u=r(n(1)),c=r(n(8)),l=r(n(7)),f=(i=Error,(0,l.default)(d,i),a=o=d,o.CODE="wrong-credentials",a);function d(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,u.default)(this,d);for(var n=arguments.length,r=Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var a=(0,c.default)(this,(e=d.__proto__||(0,s.default)(d)).call.apply(e,[this].concat(r))),i=t.tt_login_attempts_left;return a.code=d.CODE,a.loginAttemptsLeft=void 0===i?null:i,a}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(47));t.default=function(e,t){return t.host,e.defineModel("call",{replaceKeys:{},defaultValues:{},skipCamelizationForKeys:["payload"],parseAttrs:function(e){if(e.id||(e.id=e.roomName),e.payload){var t={};e.payload.disabled_participants&&(t=e.payload.disabled_participants,delete e.payload.disabled_participants),e.payload=a.default.camelizeObject(e.payload),e.payload.disabledParticipants=t}return e.payload&&(e.payload.orgId&&(e.organizationId=e.payload.orgId),e.payload.callId&&(e.callId=e.payload.callId),e.payload.groupId&&(e.groupId=e.payload.groupId),e.payload.participantsTokens&&e.payload.callerId&&(e.memberIds=[].concat((0,o.default)(e.payload.participantsTokens),[e.payload.callerId]))),delete e.serverId,e}})};var a=r(n(45));e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(5));t.default=function(p,e){var h=e.host;return p.defineModel("conversation",{instanceEvents:!0,transientAttrs:["_counterPartyAddedOnServer","_origIndex","highestSortNumber","unreadCount","unreadPriorityCount"],defaultValues:{_markingAsRead:!1,_markingAsReadSortNumber:null,_markingAsReadExpiration:null,firstExpiringUnreadMessage:null,firstUnreadMessage:null,higherContinuation:null,highestSortNumber:0,inProgressEscalationCount:0,isLive:!1,lastBangMessageSortNumber:0,lastIncomingMessageSortNumber:0,lastMessage:null,lowerContinuation:null,markableAsReadMessages:null,messages:null,muted:null,network:v.default.PROVIDER,timeline:null,unreadCount:0,unreadPriorityCount:0},skipCamelizationForKeys:["metadata","muted"],parseAttrs:function(e){if("muted"in e&&e.muted){var t=e.muted;if(0<(0,a.default)(t).length){var n=t.mute_duration,r=t.mute_start;r=r&&1e3*+r;var o=h.mute._addEntry(e.id,{durationInMinutes:n,organizationId:e.organizationId,startedAt:r});e.muted=o}else e.muted=null}return e},afterAssignment:function(e){var t=e.counterParty,n=e.counterPartyId,r=e.counterPartyType,o=e.id,a=e.isDeletable,i=e.isMuteable,s=e.metadata,u=e.muted;if(u=p.host.config.condensedReplays?u||h.mute.getById(o):h.mute._getByConversationHandle(o),e.muted=u,e.isMuted=!!e.muted,t?(n=t.id,r=t.$entityType):t=r&&n?p.store.get(r,n):null,e.counterParty=t,e.counterPartyId=n,e.counterPartyType=r,e.shouldDisplay=!("user"===r&&t&&!t.shouldDisplay),h.conversations._setAllowedSenders(e),a=!0,i="distributionList"!==r,t&&"group"===r){var c=t,l=c.groupType,f=c.p2pSender;if(l===y.default.ROLE_P2P){var d=f&&"role"===f.$entityType;a=0<e.allowedSenders.length&&!d,i=i&&0<e.allowedSenders.length}else l===y.default.ESCALATION?i=!(a=!1):l===y.default.PATIENT_MESSAGING&&(a=2<e.counterParty.memberCount)}else t&&"team"===r&&(i=a=!1);e.isDeletable=a,e.isMuteable=i,e.markableAsReadMessages||(e.markableAsReadMessages=[]),e.messages||(e.messages=[]),e.timeline||(e.timeline=[]),e.higherContinuation||(e.higherContinuation={continuation:p.host.config.condensedReplays?{higher_continuation:null}:"HIGHER",itemsEstimate:null}),e.lowerContinuation||(e.lowerContinuation={continuation:p.host.config.condensedReplays?{lower_continuation:null}:"LOWER",itemsEstimate:null}),s&&"patient_messaging"===s.feature_service&&(e.network=v.default.PATIENT,"group"===r&&(e.patientId="patient:"+s.patient_id,s.patient_contact_id&&(e.patientContactId="patientContact:"+s.patient_contact_id)))},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}},hasMany:{content:{type:"message",foreignKey:"conversationId",sortBy:[["sortNumber","asc"],["id","asc"]]}}}})};var y=r(n(171)),v=r(n(261));e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.defineModel("distributionList",{replaceKeys:{avatar:"avatarUrl",createdBy:"createdById",displayName:"name",organizationKey:"organizationId",totalMembers:"memberCount",updatedBy:"updatedById"},skipCamelizationForKeys:["metadata"],transientAttrs:["$deleted"],defaultValues:{memberCount:0},afterAssignment:function(e){e.displayName=e.name},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},organization:{type:"organization",foreignKey:"organizationId"},updatedBy:{type:"user",foreignKey:"updatedById"}}}});return(0,a.default)(n,{finder:function(){var e;return(e=t.host.distributionLists).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return e.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return e.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Distribution List..."},defaultNotFoundAttrs:{name:"<Distribution List Not Found>"}}),n};var r,o=n(92),a=(r=o)&&r.__esModule?r:{default:r};e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function x(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=x(t[0],n);return t.every(function(e){return x(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return x(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+x(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function E(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=E(t[0],n);return t.every(function(e){return E(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return E(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+E(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(4)),s=r(n(5)),u=r(n(3)),k=r(n(13)),T=r(n(12));t.default=function(e,t){var w=t.host;return e.defineModel("escalationExecution",{replaceKeys:{destructionDuration:"minutesToExpire",destructionTime:"expiresAt",displayName:"displayId",escalationExecutionId:"id",escalationGroupToken:"groupId",escalationPath:"path",escalationStatus:"status",level:"currentStep",organizationToken:"organizationId",targetDuration:"targetMinutesToAcknowledge",targetToken:"targetId",triggeredMessageToken:"carbonCopyMessageId",triggeringConversationId:"originalGroupConversationId",triggeringMessageToken:"originalMessageId"},defaultValues:{currentStep:0,status:A.default.IN_PROGRESS},parseAttrs:function(e){if("actionTime"in e&&"string"==typeof e.actionTime&&(e.actionTime=new Date(e.actionTime)),"carbonCopyMessageId"in e&&"string"==typeof e.carbonCopyMessageId&&"undefined"===e.carbonCopyMessageId&&(e.carbonCopyMessageId=null),"displayId"in e&&(e.displayId.startsWith("#")&&(e.displayId=e.displayId.slice(1)),e.displayId=e.displayId.toUpperCase()),"expiresAt"in e&&"string"==typeof e.expiresAt&&(e.expiresAt=new Date(e.expiresAt).getTime()),"groupId"in e&&"string"==typeof e.groupId&&"undefined"===e.groupId&&(e.groupId=null),"path"in e){var t=[],n=!1;if(!(u=e.path)||"function"!=typeof u[T.default]&&!Array.isArray(u))throw new TypeError("Expected _attrs$path to be iterable, got "+x(u));if(!u||"function"!=typeof u[T.default]&&!Array.isArray(u))throw new TypeError("Expected _attrs$path to be iterable, got "+E(u));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,k.default)(u);!(r=(i=s.next()).done);r=!0){var u,c=i.value,l=c.targets,f=c.duration,d=[];if(!l||"function"!=typeof l[T.default]&&!Array.isArray(l))throw new TypeError("Expected targetIds to be iterable, got "+x(l));if(!l||"function"!=typeof l[T.default]&&!Array.isArray(l))throw new TypeError("Expected targetIds to be iterable, got "+E(l));var p=!0,h=!1,y=void 0;try{for(var v,g=(0,k.default)(l);!(p=(v=g.next()).done);p=!0){var m=v.value;if("string"==typeof m)d.push(w.injectPlaceholderModel({id:m},"user"));else if(m&&m.token){var b=m.displayName,_=m.token;d.push(w.injectPlaceholderModel({id:_,displayName:b},"user"))}else n=!0}}catch(e){h=!0,y=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw y}}t.push({minutesToAcknowledge:f,targets:d})}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}n?delete e.path:e.path=t}return"status"in e&&("init"===e.status&&(e.status="in_progress"),"destruct"===e.status&&(e.status="cancelled"),e.status=A.default.resolve(e.status)),e},afterAssignment:function(e){},relations:{belongsTo:{carbonCopyMessage:{type:"message",foreignKey:"carbonCopyMessageId"},group:{type:"group",foreignKey:"groupId"},organization:{type:"organization",foreignKey:"organizationId"},originalConversation:{type:"conversation",foreignKey:"originalGroupConversationId"},originalMessage:{type:"message",foreignKey:"originalMessageId"},target:{type:"user",foreignKey:"targetId"},escalationGroupConversation:{type:"conversation",foreignKey:"escalationGroupConversationId"}}}})};var A=r(n(260));e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.host,e.defineModel("escalationExecutionChange",{parseAttrs:function(e){return"actionTime"in e&&"string"==typeof e.actionTime&&(e.actionTime=new Date(e.actionTime)),e}})},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function x(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=x(t[0],n);return t.every(function(e){return x(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return x(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+x(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function E(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=E(t[0],n);return t.every(function(e){return E(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return E(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+E(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(4)),s=r(n(5)),u=r(n(3)),k=r(n(13)),T=r(n(12));t.default=function(e,t){var w=t.host;return e.defineModel("escalationPolicy",{replaceKeys:{destructionDuration:"minutesToExpire",escalationPath:"path",target:"targetId",targetDuration:"targetMinutesToAcknowledge"},defaultValues:{alwaysEscalate:!1},parseAttrs:function(e){if("path"in e){var t=[],n=!1;if(!(u=e.path)||"function"!=typeof u[T.default]&&!Array.isArray(u))throw new TypeError("Expected _attrs$path to be iterable, got "+x(u));if(!u||"function"!=typeof u[T.default]&&!Array.isArray(u))throw new TypeError("Expected _attrs$path to be iterable, got "+E(u));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,k.default)(u);!(r=(i=s.next()).done);r=!0){var u,c=i.value,l=c.targets,f=c.duration,d=[];if(!l||"function"!=typeof l[T.default]&&!Array.isArray(l))throw new TypeError("Expected targetIds to be iterable, got "+x(l));if(!l||"function"!=typeof l[T.default]&&!Array.isArray(l))throw new TypeError("Expected targetIds to be iterable, got "+E(l));var p=!0,h=!1,y=void 0;try{for(var v,g=(0,k.default)(l);!(p=(v=g.next()).done);p=!0){var m=v.value;if("string"==typeof m)d.push(w.injectPlaceholderModel({id:m},"user"));else if(m&&m.token){var b=m.displayName,_=m.token;d.push(w.injectPlaceholderModel({id:_,displayName:b},"user"))}else n=!0}}catch(e){h=!0,y=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw y}}t.push({minutesToAcknowledge:f,targets:d})}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}n?delete e.path:e.path=t}return e},afterAssignment:function(e){},relations:{belongsTo:{target:{type:"user",foreignKey:"targetId"}}}})},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(1)),a=((0,r(n(2)).default)(i,null,[{key:"is",value:function(e){return e instanceof this}}]),i);function i(e,t,n){(0,o.default)(this,i),this.id=e,this.type=t,this.data=n}t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var d=r(n(4)),p=r(n(5)),h=r(n(3)),y=r(n(13)),v=r(n(12));t.default=function(e,t){var f=t.host,n=e.defineModel("group",{replaceKeys:{avatar:"avatarUrl",createdTime:"createdAt",displayName:"name",members:"memberIds",numMembers:"__memberCount",organizationKey:"organizationId",proxied_members:"proxiedMembers"},transientAttrs:["__memberCount"],defaultValues:{hasCurrentUser:!1,isPublic:!1,memberIds:null},skipCamelizationForKeys:["escalation","metadata","proxied_members"],parseAttrs:function(e){if("createdAt"in e&&(e.createdAt=new Date(e.createdAt)),"createdBy"in e&&delete e.createdBy,e.avatarUrl&&(e.avatarUrl=(0,g.cloudFrontUrlTransform)(e.avatarUrl,f.config)),"escalation"in e){var t=f.escalations._updateEscalation(e.escalation,{inGroupInject:!0});delete e.escalation,e.escalationExecutionId=t.id}if(e.memberIds){var n=[];if(!(u=e.memberIds)||"function"!=typeof u[v.default]&&!Array.isArray(u))throw new TypeError("Expected _attrs$memberIds to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,h.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,p.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,d.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(u));if(!u||"function"!=typeof u[v.default]&&!Array.isArray(u))throw new TypeError("Expected _attrs$memberIds to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,h.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,p.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,d.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(u));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,y.default)(u);!(r=(i=s.next()).done);r=!0){var u,c=i.value;"string"==typeof c?n.push(c):c.id&&n.push(c.id)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}e.memberIds=n}if(e.metadata&&"patient_care"===e.metadata.feature_service&&(e.patientDetails=e.metadata.patient),e.metadata&&"patient_messaging"===e.metadata.feature_service&&(e.patientDetails={dob:e.metadata.patient_dob,gender:e.metadata.patient_gender,id:e.metadata.patient_id,isPatientContact:e.metadata.is_patient_contact,mrn:e.metadata.patient_mrn,name:e.metadata.patient_name,phoneNumber:e.metadata.phone_number,smsOptedOut:e.metadata.sms_opted_out},e.patientDetails.isPatientContact&&e.metadata.relation_name&&(e.patientDetails.relationName=e.metadata.relation_name)),e.metadata)if(e.metadata.team&&(e.metadata.team.token||e.metadata.team.id)){var l=f.models.Team.inject(e.metadata.team);l&&(e.teamId=l.id)}else e.metadata.team_token&&(e.teamId=e.metadata.team_token);return"metadata"in e&&delete e.metadata,e},afterAssignment:function(e){var t=e.id,n=e.memberIds,r=e.organizationId,o=void 0;f.config.condensedReplays?e.conversationId&&(o=f.conversations.getById(e.conversationId)):o=r?f.conversations.get("group",t,r):null;var a=r?f.metadata.get(t,r):null;a=a&&a.data;var i=f.groups.__extractGroupTypeFromAttrs(e),s=a&&i===u.GroupType.ROLE_P2P?a.target_display_name:e.name;e.conversation=o,e.displayName=s,e.groupType=i,e.memberCount=n&&n.length||e.__memberCount||0,e.metadata=a,"FORUM"!==i&&delete e.hasCurrentUser,f.users._setMembersOnEntity(e),f.groups._setMembership(e),f.groups._setP2PEntities(e)},beforeCreateInstance:function(e){!function(e,t,n){t&&0!==t.length&&f.groups.ensureMembersWithIds(e,t,{onlyPlaceholder:!0,attrs:{organizationId:n}})}(e.id,e.memberIds,e.organizationId)},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"},escalationExecution:{type:"escalationExecution",foreignKey:"escalationExecutionId"},team:{type:"team",foreignKey:"teamId"}}}});return(0,o.default)(n,{finder:function(){var e;return(e=f.groups).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return f.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return f.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading group..."},defaultNotFoundAttrs:{displayName:"<Group Not Found>"},shouldEnsure:function(e,t,n){var r=n.groupMembersOnlyPlaceholder;return!e.members||!e.metadata||e.groupType===u.GroupType.ROLE_P2P||e.members.some(function(e){return f.models.User.shouldEnsure(e,r)})}}),n};var o=r(n(92)),g=n(265),u=n(36);e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.host,e.defineModel("groupMembersChange",{parseAttrs:function(e){return"actionTime"in e&&"string"==typeof e.actionTime&&(e.actionTime=new Date(e.actionTime)),e}})},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var C=r(n(4)),P=r(n(5)),z=r(n(3)),V=r(n(13)),G=r(n(12)),N=r(n(868));t.default=function(f,e){var R=e.host;return f.defineModel("message",{replaceKeys:{clientId:"id",createdTime:"createdAt",data:"metadata",dndAutoForwardedFrom:"autoForwardedFromId",dor:"deleteOnRead",escalationExecId:"escalationExecutionId",groupAvatar:"groupAvatarUrl",groupToken:"groupId",messageId:"id",originalData:"originalMetadata",originalMsgId:"originalMessageId",originalSenderName:"originalSenderDisplayName",originalTimestamp:"originalForwardedMessageCreatedAt",recipient:"recipientId",recipientOrganization:"recipientOrganizationId",recipientOrgToken:"recipientOrganizationId",recipientToken:"recipientId",sender:"senderId",senderAvatar:"senderAvatarUrl",senderOrganization:"senderOrganizationId",senderOrgToken:"senderOrganizationId",senderToken:"senderId"},transientAttrs:["__organizationId","$synced","escalationExecutionChange","groupMembersChange","inTimeline"],defaultValues:{inTimeline:!1,isUnread:!1,messageType:D.MessageType.USER_SENT,senderStatus:D.MessageRecipientStatus.NEW,shouldEnsureRecipientStatus:!1,sortNumber:0},skipCamelizationForKeys:["escalation","metadata","originalMetadata"],parseAttrs:function(e){if(e.teamRequest&&(e.senderId||(e.senderId=e.teamRequest.createdById),e.teamRequestId=e.teamRequest.id,delete e.teamRequest),"attachmentName"in e){var t=e.attachmentName;delete e.attachmentName,"undefined"!==t&&Array.isArray(e.attachments)&&0<e.attachments.length&&t&&(e.attachments[0].name=t)}if(Array.isArray(e.attachments)&&e.attachments.forEach(function(e,t){return e.id=""+(t+1)}),"priority"in e&&(e.priority=D.MessagePriority.resolve(e.priority)),"createdAt"in e&&"string"==typeof e.createdAt&&(e.createdAt=new Date(e.createdAt)),"expireIn"in e&&(e.expiresAt=Date.now()+1e3*e.expireIn,delete e.expireIn),"recipientStatus"in e&&delete e.recipientStatus,"status"in e&&delete e.status,"xmlns"in e&&delete e.xmlns,"escalation"in e){var n=R.escalations._updateEscalation(e.escalation);delete e.escalation,e.escalationExecutionId=n.id}if("subType"in e&&(e.subType=D.MessageSubType.resolve(e.subType)),e.metadata){e.metadata=(0,N.default)(e.metadata).map(R.metadata.__parseMessageMetadata).filter(Boolean);var r=e.metadata.find(function(e){return"tigertext:message:role:sender"===e.namespace}),o=e.metadata.find(function(e){return"tigertext:message:role:owner"===e.namespace}),a=e.metadata.find(function(e){return"tigertext:message:patient_care"===e.namespace});if(r&&r.payload){var i=e.senderOrganizationId,s=r.payload;e.senderRole=R.roles.__parseRoleFromMetadata({metadata:s,organizationId:i}),e.currentSenderRoleId=e.senderRole.id}if(o&&o.payload){var u=e.senderOrganizationId,c=e.senderId,l=o.payload;e.senderId=l.token,c!==l.token&&(e.senderRole={$entityType:"role",botUserId:c,id:"role:"+c,organizationId:u},e.currentSenderRoleId="role:"+c)}if(a&&a.payload){var f=[];if(!(g=a.payload.components)||"function"!=typeof g[G.default]&&!Array.isArray(g))throw new TypeError("Expected _patientCareAttrs$pay to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,z.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,P.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,C.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(g));if(!g||"function"!=typeof g[G.default]&&!Array.isArray(g))throw new TypeError("Expected _patientCareAttrs$pay to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,z.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,P.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,C.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(g));var d=!0,p=!1,h=void 0;try{for(var y,v=(0,V.default)(g);!(d=(y=v.next()).done);d=!0){var g,m=y.value;"type"in m&&(m.type=D.PatientCareCardUIType.resolve(m.type)),"sub_type"in m&&(m.sub_type=D.PatientCareCardType.resolve(m.sub_type)),"action_type"in m&&(m.action_type=D.PatientCareCardActionType.resolve(m.action_type)),f.push(m)}}catch(e){p=!0,h=e}finally{try{!d&&v.return&&v.return()}finally{if(p)throw h}}e.patientCareCard=f}}else"metadata"in e&&delete e.metadata;if(e.originalMetadata){e.originalMetadata=(0,N.default)(e.originalMetadata).map(R.metadata.__parseMessageMetadata).filter(Boolean);var b=e.originalMetadata.find(function(e){return"tigertext:message:role:sender"===e.namespace}),_=e.originalMetadata.find(function(e){return"tigertext:message:role:owner"===e.namespace}),w=e.originalMetadata.find(function(e){return"tigertext:message:patient_messaging"===e.namespace});if(b&&b.payload){var x=e.senderOrganizationId,E=b.payload;e.originalSenderRole=R.roles.__parseRoleFromMetadata({metadata:E,organizationId:x})}if(_&&_.payload){var k=e.originalSender,T=e.originalSenderDisplayName,A=e.originalSenderRole,I=e.senderOrganizationId,O=_.payload;A||"string"!=typeof k||(e.originalSenderRole={$entityType:"role",botUserId:k,displayName:T,id:"role:"+k,organizationId:I}),(!k||k&&"string"==typeof k)&&(e.originalSender={$entityType:"user",displayName:O.display_name,id:O.token,organizationId:I})}"isForwarded"in e&&e.isForwarded&&w&&(e.isForwardedFromPatientNetwork=!0,w.payload&&(e.patientDetails={isPatientContact:w.payload.is_patient_contact,mrn:w.payload.patient_mrn,patientId:w.payload.patient_id,patientName:w.payload.patient_name},w.payload.is_patient_contact&&(e.patientDetails.contactId=w.payload.patient_contact_id,e.patientDetails.contactName=w.payload.patient_contact_name,e.patientDetails.relation=w.payload.relation_name)))}if("originalSender"in e&&"string"==typeof e.originalSender){var j=e.senderOrganizationId,S=e.originalSender,M=e.originalSenderDisplayName;e.originalSender={$entityType:"user",displayName:M,id:S,organizationId:j},"patientDetails"in e&&(e.patientDetails.patientId===e.originalSender.id&&(e.originalSender.isPatient=!0),e.patientDetails.contactId===e.originalSender.id&&(e.originalSender.isPatientContact=!0,e.originalSender.relation=e.patientDetails.relation)),delete e.originalSenderDisplayName}return e},afterAssignment:function(e){var t=e.__organizationId,n=e.counterParty,r=e.counterPartyId,o=e.counterPartyType,a=e.createdAt,i=e.isOutgoing,s=e.recipientOrganizationId,u=e.senderId,c=e.senderOrganizationId,l=R.currentUserId;if(n)switch(r=n.id,o=n.$entityType){case"group":e.groupId=r,delete e.recipientId;break;case"distributionList":e.distributionListId=r,delete e.recipientId}else n=o&&r?f.store.get(o,r):null;e.counterParty=n,e.counterPartyId=r,e.counterPartyType=o,a=a||new Date,u&&(i=R.messages._isMessageOutgoing(e)),i&&c?t=c:!i&&s&&(t=s),e.__organizationId=t,e.canRecall="distributionList"!==o&&u===l,e.createdAt=a,e.isOutgoing=i,e.isAutoForwarded=!!e.autoForwardedFromId,e.subType||(e.subType=D.MessageSubType.NA),R.messages._setRecipientStatus(e)},relations:{belongsTo:{autoForwardedFrom:{type:"user",foreignKey:"autoForwardedFromId"},conversation:{type:"conversation",foreignKey:"conversationId"},currentSenderRole:{type:"role",foreignKey:"currentSenderRoleId"},distributionList:{type:"distributionList",foreignKey:"distributionListId"},escalationExecution:{type:"escalationExecution",foreignKey:"escalationExecutionId"},group:{type:"group",foreignKey:"groupId"},recipient:{type:"user",foreignKey:"recipientId"},recipientOrganization:{type:"organization",foreignKey:"recipientOrganizationId"},sender:{type:"user",foreignKey:"senderId"},senderOrganization:{type:"organization",foreignKey:"senderOrganizationId"},teamRequest:{type:"teamRequest",foreignKey:"teamRequestId"}},hasMany:{statusesPerRecipient:{type:"messageStatusPerRecipient",foreignKey:"messageId"}}}})};var D=n(36);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.defineModel("messageStatusPerRecipient",{replaceKeys:{accountId:"userId",timestamp:"createdAt"},defaultValues:{status:a.default.NA},parseAttrs:function(e){return e.status&&(e.status=a.default.resolve(e.status)),e.createdAt&&"string"==typeof e.createdAt&&(e.createdAt=new Date(e.createdAt)),e},beforeInject:function(e,t){if(t){var n=t.status,r=e.status;o.MESSAGE_STATUS_ORDER[r]<o.MESSAGE_STATUS_ORDER[n]&&(delete e.createdAt,delete e.status)}},relations:{belongsTo:{distributionList:{type:"distributionList",foreignKey:"distributionListId"},message:{type:"message",foreignKey:"messageId"},user:{type:"user",foreignKey:"userId"}}}})};var r,o=n(121),a=(r=o)&&r.__esModule?r:{default:r};e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.host,e.defineModel("messageTemplate",{replaceKeys:{createdBy:"createdById",templateLabel:"title",updatedBy:"updatedById"},transientAttrs:["$deleted"],parseAttrs:function(e){return e.hasAttachment=!1,e.attachmentName&&e.attachmentSize&&e.attachmentType&&(e.hasAttachment=!0),e},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},organization:{type:"organization",foreignKey:"organizationId"},updatedBy:{type:"user",foreignKey:"updatedById"}}}})},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.defineModel("metadata",{parseAttrs:function(e,t){return e.data=t.data,e},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}})},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.host,e.defineModel("mute",{parseAttrs:function(e){return e},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}})},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.host,e.defineModel("patient",{replaceKeys:{patientMrn:"mrn",patientGender:"gender",patientDob:"dob"},parseAttrs:function(e){return"featureService"in e&&delete e.featureService,"patientContacts"in e&&delete e.patientContacts,"isPatientContact"in e&&delete e.isPatientContact,"dob"in e&&(e.dob=(0,r.formatDob)(e.dob)),"phoneNumber"in e&&(e.phoneNumber=(0,o.formatPhoneWithDash)(e.phoneNumber)),e},relations:{belongsTo:{user:{type:"user",foreignKey:"userId"}},hasMany:{contacts:{type:"patientContact",foreignKey:"patientId"},sharedConversations:{type:"conversation",foreignKey:"patientId",filter:function(e,t){var n=e.counterParty;if(!n)return!1;var r=n.groupType,o=n.hasCurrentUserOrRole,a=n.memberIds;return!(r!==i.GroupType.PATIENT_MESSAGING||!o||!a.includes(t.userId))},sortBy:[["highestSortNumber","desc"],["_origIndex","asc"],["id","asc"]]}}}})};var r=n(124),o=n(46),i=n(36);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.host,e.defineModel("patientContact",{replaceKeys:{patientDob:"dob",patientGender:"gender",patientMrn:"mrn",relationName:"relation"},parseAttrs:function(e){return"entity"in e&&delete e.entity,"dob"in e&&(e.dob=(0,r.formatDob)(e.dob)),"phoneNumber"in e&&(e.phoneNumber=(0,o.formatPhoneWithDash)(e.phoneNumber)),e},relations:{belongsTo:{patient:{type:"patient",foreignKey:"patientId"},user:{type:"user",foreignKey:"userId"}},hasMany:{sharedConversations:{type:"conversation",foreignKey:"patientContactId",filter:function(e,t){var n=e.counterParty;if(!n)return!1;var r=n.groupType,o=n.hasCurrentUserOrRole,a=n.memberIds;return!(r!==i.GroupType.PATIENT_MESSAGING||!o||!a.includes(t.userId))},sortBy:[["highestSortNumber","desc"],["_origIndex","asc"],["id","asc"]]}}}})};var r=n(124),o=n(46),i=n(36);e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.host;return e.defineModel("product",{defaultValues:{activeProcessingEvents:null,conversationCount:0,organizations:null,rolesOptingIn:null,unreadCount:0,unreadPriorityCount:0},transientAttrs:["conversationCount","organizations","unreadCount","unreadPriorityCount"],afterAssignment:function(e){var t=e.id;e.productRoles=n.userRoles.getByProductId(t),null===e.activeProcessingEvents&&(e.activeProcessingEvents=[]),null===e.organizations&&(e.organizations=[]),null===e.rolesOptingIn&&(e.rolesOptingIn=[])}})},e.exports=t.default},function(e,t){"use strict";function n(e,t){return!!e&&e.includes(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.defineModel("productRoles",{defaultValues:{roles:[]},afterAssignment:function(e){var t=e.roles;e.isAdmin=n(t,"tt_admin"),e.isAnalyticsAdmin=n(t,"tt_reporting"),e.isLdapAdmin=n(t,"tt_ldap"),e.isSuperAdmin=n(t,"tt_super_admin")},methods:{hasRole:function(e){return!!this.roles&&this.roles.includes(e)}},relations:{belongsTo:{product:{type:"product",foreignKey:"productId"},user:{type:"user",foreignKey:"userId"}}}})},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.host;return e.defineModel("role",{defaultValues:{description:"",memberIds:null,roleTagId:null},afterAssignment:function(e){n.users._setMembersOnEntity(e)},relations:{belongsTo:{assignmentGroup:{type:"group",foreignKey:"assignmentGroupId"},botUser:{type:"user",foreignKey:"botUserId"},escalationPolicy:{type:"escalationPolicy",foreignKey:"escalationPolicyId"},organization:{type:"organization",foreignKey:"organizationId"},roleTag:{type:"roleTag",foreignKey:"roleTagId"}}}})},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.defineModel("roleTag",{replaceKeys:{tagColor:"color",tagName:"name"},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}},hasMany:{roles:{type:"role",foreignKey:"roleTagId"}}},parseAttrs:function(e){if("colorValue"in e){var t=e.color,n=e.colorValue;e.color=n,e.colorId=t,delete e.colorValue}return"color"in e&&(e.color=e.color.replace("0x","#")),e},afterAssignment:function(e){var t=e.name;e.displayName=t,e.isDefault=t&&t.startsWith("Default")}})},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(o,e){var t=e.host;return o.defineModel("scheduledMessage",{replaceKeys:{createdBy:"createdById",recipient:"recipientId",recipientType:"_recipientType",senderToken:"senderId",scheduleStatus:"status",updatedBy:"updatedById"},transientAttrs:["$deleted"],parseAttrs:function(e){return e.hasAttachment=!1,e.attachmentName&&e.attachmentSize&&e.attachmentType&&(e.hasAttachment=!0),e._recipientType&&(e.recipientType=t.modelsByEntityType[r.Camelizer.camelizeKey(e._recipientType)].name),e},afterAssignment:function(e){var t=e.recipient,n=e.recipientId,r=e.recipientType;t?(n=t.id,r=t.$entityType):t=r&&n?o.store.get(r,n):null,e.recipient=t,e.recipientId=n,e.recipientType=r},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},organization:{type:"organization",foreignKey:"organizationId"},sender:{type:"user",foreignKey:"senderId"},template:{type:"messageTemplate",foreignKey:"templateId"},updatedBy:{type:"user",foreignKey:"updatedById"}}}})};var r=n(29);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(1)),a=((0,r(n(2)).default)(i,null,[{key:"is",value:function(e){return e instanceof this}}]),i);function i(e,t,n,r){(0,o.default)(this,i),this.id="searchResult:"+t+":"+e.id,this.entity=e,this.entityId=e.id,this.entityType=e.$entityType,this.metadata=r,this.organizationId=t,this.conversationId=n}t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(4)),d=r(n(5)),p=r(n(3)),h=r(n(13)),y=r(n(12));t.default=function(e,t){var l=t.host,n=e.defineModel("team",{replaceKeys:{avatar:"avatarUrl",group_token:"groupToken",members:"__members",numMembers:"__memberCount",name:"displayName"},transientAttrs:["__memberCount","__members"],defaultValues:{canMembersLeave:!1,canRequestToJoin:!1,hasCurrentUserOrRole:!1,hasCurrentUserPending:!1,hasCurrentUserBeenDeclined:!1,memberIds:[]},skipCamelizationForKeys:["members"],parseAttrs:function(e){var t=e.__members;if(t){var n=[];if(!t||"function"!=typeof t[y.default]&&!Array.isArray(t))throw new TypeError("Expected rawMembers to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,p.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(t));if(!t||"function"!=typeof t[y.default]&&!Array.isArray(t))throw new TypeError("Expected rawMembers to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,p.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(t));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,h.default)(t);!(r=(i=s.next()).done);r=!0){var u=i.value;if("object"===(void 0===u?"undefined":(0,p.default)(u)))if(u.token){n.push(u.token);var c=l.models.User.inject(u);l.models.User.removePlaceholder({entity:c,attrs:u})}else u.id&&n.push(u.id);else"string"==typeof u&&n.push(u)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}e.memberIds=n,delete e.__members}return e},afterAssignment:function(e){var t=e.memberIds;l.groups._setMembership(e),l.users._setMembersOnEntity(e),l.teams._setHasUserPending(e),e.memberCount=t&&t.length||e.__memberCount||0},relations:{belongsTo:{group:{type:"group",foreignKey:"groupId"}}}});return(0,o.default)(n,{finder:function(){var e;return(e=l.teams).find.apply(e,arguments)},placeholderEntityDelayBeforeRefreshing:function(){return l.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return l.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading..."},defaultNotFoundAttrs:{displayName:"<Team Not Found>"}}),n};var o=r(n(92));e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t.host,e.defineModel("teamRequest",{replaceKeys:{},transientAttrs:[],defaultValues:{},parseAttrs:function(e){return e.createdBy&&(e.createdById=e.createdBy.token,delete e.createdBy),e.team&&(e.teamId=e.team.id,delete e.team),e},afterAssignment:function(e){},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},team:{type:"team",foreignKey:"teamId"}}}})},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.defineModel("userRoles",{defaultValues:{roles:[]},afterAssignment:function(e){var t=e.organizationId===r.CONTACTS_ORG_ID,n=e.roles;e.isAdmin=n.includes("admin"),e.isHelpDesk=n.includes("help_desk"),e.isPatientAdmin=n.includes("patient_messaging_admin"),e.isRoleAdmin=n.includes("feature_role_admin"),e.isTeamAdmin=n.includes("team_admin"),e.reportingEnabled=n.includes("reporting")&&!t,e.reportingEnabledOnAllOrgs=n.includes("reporting_view_orgs")&&!t,e.tigerTouchPlusReportingEnabled=n.includes("tigertouchplus_reporting")},methods:{hasRole:function(e){return this.roles.includes(e)}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"},user:{type:"user",foreignKey:"userId"}}}})};var r=n(259);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["CONTACTS_MESSAGING_BLOCKED_BY_ADMIN","CONVERSATION_NOT_FULLY_LOADED","CONVERSATION_WITH_ROLE_YOU_ARE_CURRENTLY_IN","COUNTER_PARTY_IS_TIGERPAGE","COUNTER_PARTY_NOT_FULLY_LOADED","COUNTER_PARTY_TYPE_NOT_SUPPORTED","GROUP_HAS_NO_MEMBERS","GROUP_MEMBERS_NOT_LOADED","IS_ROLE_ASSIGNMENT_GROUP","NO_COUNTER_PARTY","ORGANIZATION_DOES_NOT_EXIST","USER_IS_NOT_IN_THIS_ROLE_CONVERSATION","USER_IS_NOT_MEMBER_OF_GROUP","NONE"]);t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({CONTINUATION:{serverValue:"continuation"},CONVERSATION_END:{serverValue:"conversation_end"},FIRST_UNREAD_ITEM:{serverValue:"first_unread_item"}});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({ACKNOWLEDGED:{serverValue:"escalation_acknowledged"},CANCELLED:{serverValue:"escalation_cancelled"},INITIATED:{serverValue:"escalation_initiated"},MEMBER_ADDED:{serverValue:"escalation_member_added"},NO_RESPONSE:{serverValue:"escalation_no_response"}});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({LOW:{serverValue:-1},NORMAL:{serverValue:0},HIGH:{serverValue:1}},{defaultValue:"NORMAL"});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["SENDING","SENT","FAILED","RETRYING","NEW","NA"]);t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({EMPTY_ROLE_NOTIFICATION:{serverValue:"empty_role_notification"},NA:{key:"NA"},ROLE_AWAY_NOTIFICATION:{serverValue:"role_away_notification"},SCHEDULE_MESSAGE:{serverValue:"schedule_message"},SMS_OPT_IN_NOTIFICATION:{serverValue:"sms_optin_notification"},SMS_OPT_OUT_NOTIFICATION:{serverValue:"sms_optout_notification"},SYSTEM:{serverValue:"system"},TEAM_REQUEST:{serverValue:"team_request"},USER_AWAY_NOTIFICATION:{serverValue:"user_away_notification"}},{defaultValue:"NA"});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(22),a=new((r=o)&&r.__esModule?r:{default:r}).default(["CALL_CHANGE","ESCALATION_EXECUTION_CHANGE","GROUP_MEMBERSHIP_CHANGE","HIGHER_CONTINUATION","LOWER_CONTINUATION","USER_SENT"]);t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({ADD_MEMBERS:{serverValue:"add_members"}},{defaultValue:"NA"});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({ADMIT:{serverValue:"admit"},DISCHARGE:{serverValue:"discharge"},LAB:{serverValue:"lab"},TRANSFER:{serverValue:"transfer"}},{defaultValue:"NA"});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({ACTION:{serverValue:"ehr_action_item"},HEADER:{serverValue:"ehr_header"},ITEM:{serverValue:"table_item"},TEXT:{serverValue:"ehr_text_view"}},{defaultValue:"NA"});t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(22).ServerValueEnum)({DISTRIBUTION_LIST_MEMBER:{serverValue:"dist_list_member"},DISTRIBUTION_LIST:{serverValue:"distribution_list"},FORUM:{serverValue:"public_group"},GROUP:{serverValue:"group"},MESSAGE_TEMPLATE:{serverValue:"message_template"},ORGANIZATION:{serverValue:"organization"},PATIENT_DISTRIBUTION_LIST:{serverValue:"patient_distribution_list"},PATIENT:{serverValue:"patient_account"},SCHEDULED_MESSAGE:{serverValue:"schedule_message"},TAG:{serverValue:"tag"},TEAM:{serverValue:"team"},USER:{serverValue:"account"}});t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserRoles=t.User=t.TeamRequest=t.Team=t.ScheduledMessage=t.RoleTag=t.Role=t.ProductRoles=t.Product=t.PatientContact=t.Patient=t.Organization=t.Mute=t.Metadata=t.MessageTemplate=t.MessageStatusPerRecipient=t.Message=t.GroupMembersChange=t.Group=t.EscalationPolicy=t.EscalationExecutionChange=t.EscalationExecution=t.DistributionList=t.Conversation=t.Call=void 0;var o=r(n(443)),a=r(n(444)),i=r(n(445)),s=r(n(446)),u=r(n(447)),c=r(n(448)),l=r(n(450)),f=r(n(451)),d=r(n(452)),p=r(n(453)),h=r(n(454)),y=r(n(455)),v=r(n(456)),g=r(n(259)),m=r(n(457)),b=r(n(458)),_=r(n(459)),w=r(n(460)),x=r(n(461)),E=r(n(462)),k=r(n(463)),T=r(n(465)),A=r(n(466)),I=r(n(170)),O=r(n(467));t.Call=o.default,t.Conversation=a.default,t.DistributionList=i.default,t.EscalationExecution=s.default,t.EscalationExecutionChange=u.default,t.EscalationPolicy=c.default,t.Group=l.default,t.GroupMembersChange=f.default,t.Message=d.default,t.MessageStatusPerRecipient=p.default,t.MessageTemplate=h.default,t.Metadata=y.default,t.Mute=v.default,t.Organization=g.default,t.Patient=m.default,t.PatientContact=b.default,t.Product=_.default,t.ProductRoles=w.default,t.Role=x.default,t.RoleTag=E.default,t.ScheduledMessage=k.default,t.Team=T.default,t.TeamRequest=A.default,t.User=I.default,t.UserRoles=O.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function y(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=y(t[0],n);return t.every(function(e){return y(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return y(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+y(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function v(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=v(t[0],n);return t.every(function(e){return v(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return v(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+v(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0});var o,i=r(n(4)),s=r(n(5)),u=r(n(3)),a=r(n(6)),c=r(n(1)),l=r(n(2)),f=r(n(8)),d=r(n(7)),p=r(n(41)),g=n(18),m=r(n(492)),b=r(n(123)),h=(o=p.default,(0,d.default)(_,o),(0,l.default)(_,[{key:"createEventSource",value:function(o,e){var a=this,t=e.auth,n=void 0===t?this.httpClient.getAuth():t,r=e.features,i=e.onOpen,s=e.onMessage,u=e.onError;if("string"!=typeof o)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+v(o));if(null==e||void 0!==e.features&&null!=e.features&&"string"!=typeof e.features||void 0!==e.onOpen&&null!=e.onOpen&&"function"!=typeof e.onOpen||void 0!==e.onMessage&&null!=e.onMessage&&"function"!=typeof e.onMessage||void 0!==e.onError&&null!=e.onError&&"function"!=typeof e.onError)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  features?: ?string;\n  onOpen?: ?Function;\n  onMessage?: ?Function;\n  onError?: ?Function;\n}\n\nGot:\n"+v(e));if("string"!=typeof o)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+y(o));if(null==e||void 0!==e.features&&null!=e.features&&"string"!=typeof e.features||void 0!==e.onOpen&&null!=e.onOpen&&"function"!=typeof e.onOpen||void 0!==e.onMessage&&null!=e.onMessage&&"function"!=typeof e.onMessage||void 0!==e.onError&&null!=e.onError&&"function"!=typeof e.onError)throw new TypeError("Value of argument 1 violates contract.\n\nExpected:\n{\n  features?: ?string;\n  onOpen?: ?Function;\n  onMessage?: ?Function;\n  onError?: ?Function;\n}\n\nGot:\n"+y(e));var c=/https?:/.test(o)?o:this.config.baseUrl+o,l=this.httpClient.getAuthHeaders(n,r);"TT-Route-Xmpp"===this.config.ttRoute&&(l["TT-Route-Xmpp"]="true"),r&&(l["TT-X-Features"]=r);var f=new m.default(c,{headers:l}),d=!1,p=!1,h=!1;return f.addEventListener("open",function e(){h||(h=!0,f.removeEventListener("open",e),i&&i())}),f.addEventListener("error",function e(t){if(!d){d=!0,f.removeEventListener("error",e);var n=t?t.status:void 0,r=void 0;401===n?(r=new g.WrongCredentialsError,a.emit("auth:invalid")):403===n?(r=new g.PermissionDeniedError(o,"403","get"),a.emit("auth:invalid")):t&&t.message&&t.stack?(r=new Error(t.message)).stack=t.stack:r=p?new Error("EventSource connection closed"+(n?": status "+n:"")):new Error("Could not establish EventSource connection"+(n?": status "+n:"")),n&&(r.status=n),a.httpClient.networkStatus!==b.default.OFFLINE&&a.httpClient._setNetworkStatus(b.default.UNREACHABLE),u&&u(r)}}),f.addEventListener("message",function(e){var t=!p;p||(p=!0,a.httpClient._setNetworkStatus(b.default.ONLINE)),s&&s(e,{isFirstMessage:t})}),f}}]),_);function _(e){var t=e.config,n=e.httpClient,r=e.logger;(0,c.default)(this,_);var o=(0,f.default)(this,(_.__proto__||(0,a.default)(_)).call(this));return o.config=t,o.httpClient=n,o.logger=r,o}t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(13)),s=r(n(4)),u=r(n(5)),c=r(n(3)),a=r(n(12)),i={};if("function"!=typeof(y=["\n","\r"," ",":"])[a.default]&&!Array.isArray(y))throw new TypeError("Expected _ref to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,c.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,u.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,s.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(y));if("function"!=typeof y[a.default]&&!Array.isArray(y))throw new TypeError("Expected _ref to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,c.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,u.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,s.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(y));var l=!0,f=!1,d=void 0;try{for(var p,h=(0,o.default)(y);!(l=(p=h.next()).done);l=!0){var y,v=p.value;i[v]=v.charCodeAt(0)}}catch(e){f=!0,d=e}finally{try{!l&&h.return&&h.return()}finally{if(f)throw d}}t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,s=r(n(6)),u=r(n(1)),c=r(n(8)),a=r(n(7)),i=r(n(173)),l=(o=i.default,(0,a.default)(f,o),f);function f(e,t){var n=t.headers,r=t.message,o=t.status,a=t.statusText;(0,u.default)(this,f);var i=(0,c.default)(this,(f.__proto__||(0,s.default)(f)).call(this,e));return i.headers=n,i.message=r,i.status=o,i.statusText=a,i}t.default=l,e.exports=t.default},function(e,g,m){(function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(g,"__esModule",{value:!0}),g.NativeEventSource=g.EventSourcePolyfill=void 0;var n,r,o,a=t(m(10)),i=t(m(9)),s=t(m(1)),u=t(m(2)),c=t(m(41)),l=t(m(266)),f=t(m(484)),d=m(485),p=m(490),h=((0,u.default)(v,[{key:"addEventListener",value:function(e,t){this._events.on(e,t)}},{key:"removeEventListener",value:function(e,t){this._events.removeListener(e,t)}},{key:"dispatchEvent",value:function(e){e&&e.type&&this._events.emit(e.type,e)}},{key:"start",value:(o=(0,i.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.readyState!==l.default.WAITING)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,this._esRequest.start();case 4:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"close",value:function(){this.readyState!==l.default.CLOSED&&(this._esRequest.close(),this._esRequest.onFinish(new Error("Connection closed by caller")))}}]),r=n=v,n.CLOSED=l.default.CLOSED,n.CONNECTING=l.default.CONNECTING,n.OPEN=l.default.OPEN,n.FetchRequest=d.FetchRequest,n.XHRRequest=p.XHRRequest,n.isFetchSupported=d.isFetchSupported,r),y=e.EventSource;function v(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.RequestClass,o=n.headers,a=n.lastEventId,i=n.withCredentials;(0,s.default)(this,v),this.CLOSED=l.default.CLOSED,this.CONNECTING=l.default.CONNECTING,this.OPEN=l.default.OPEN,this.FetchRequest=d.FetchRequest,this.XHRRequest=p.XHRRequest,this.isFetchSupported=d.isFetchSupported,this._events=new c.default,this.onerror=void 0,this.onmessage=void 0,this.onopen=void 0,this.readyState=l.default.WAITING,this.url=e=String(e),this.withCredentials=i,r=r||(d.isFetchSupported?d.FetchRequest:p.XHRRequest),this._esRequest=new f.default({RequestClass:r,dispatchEvent:function(e){return t.dispatchEvent(e)},headers:o,lastEventId:a,onError:function(e){return t.onerror&&t.onerror(e)},onMessage:function(e){return t.onmessage&&t.onmessage(e)},onOpen:function(e){return t.onopen&&t.onopen(e)},onReadyStateChange:function(e){t.readyState=e},url:e,withCredentials:i})}g.default=h,g.EventSourcePolyfill=h,g.NativeEventSource=y}).call(g,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function h(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=h(t[0],n);return t.every(function(e){return h(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return h(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+h(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function y(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=y(t[0],n);return t.every(function(e){return y(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return y(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+y(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i=r(n(4)),s=r(n(5)),u=r(n(3)),v=r(n(10)),g=r(n(20)),m=r(n(13)),b=r(n(12)),_=r(n(24)),c=r(n(9)),d=r(n(1)),l=r(n(2)),w=r(n(481)),f=r(n(482)),x=r(n(266)),p=r(n(173)),E=r(n(487)),k=r(n(488)),T=/^text\/event\-stream?(\s*charset\=utf\-8)?$/i,A=((0,l.default)(I,[{key:"start",value:(a=(0,c.default)(v.default.mark(function e(){var t,n,r,o,a,i,s,u,c,l,f,d,p=this;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.onReadyStateChange(x.default.CONNECTING),this.currentState=x.default.CONNECTING,t=this.url,n=this.withCredentials,"data:"!==t.slice(0,5)&&"blob:"!==t.slice(0,5)&&(t+=-1===t.indexOf("?")?"?":"&",t+="lastEventId="+encodeURIComponent(this.lastEventId)),r={Accept:"text/event-stream"},!this.headers){e.next=31;break}if(!(c=(0,_.default)(this.headers))||"function"!=typeof c[b.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+h(c));e.next=10;break;case 10:if(!c||"function"!=typeof c[b.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+y(c));e.next=12;break;case 12:for(a=!(o=!0),i=void 0,e.prev=15,s=(0,m.default)(c);!(o=(u=s.next()).done);o=!0)l=(0,g.default)(u.value,2),f=l[0],d=l[1],r[f]=d;e.next=23;break;case 19:e.prev=19,e.t0=e.catch(15),a=!0,i=e.t0;case 23:e.prev=23,e.prev=24,!o&&s.return&&s.return();case 26:if(e.prev=26,a)throw i;e.next=29;break;case 29:return e.finish(26);case 30:return e.finish(23);case 31:return e.prev=31,this.request=new this.RequestClass({headers:r,onProgress:function(e){return p.onProgress(e)},onStart:function(e){return p.onStart(e)},url:t,withCredentials:n}),e.next=35,this.request.fetch();case 35:throw new Error("Connection closed by server");case 38:if(e.prev=38,e.t1=e.catch(31),this.request.isAborted)return e.abrupt("return");e.next=42;break;case 42:this.close(),this.onFinish(e.t1);case 44:case"end":return e.stop()}},e,this,[[15,19,23,31],[24,,26,30],[31,38]])})),function(){return a.apply(this,arguments)})},{key:"onStart",value:function(e){var t=e.contentType,n=e.headers,r=e.status,o=e.statusText;if(this.currentState===x.default.CONNECTING)if(200===r&&t&&T.test(t)){this.currentState=x.default.OPEN,this.onReadyStateChange(x.default.OPEN);var a=new f.default("open",{headers:n,status:r,statusText:o});this.dispatchEvent(a),this.onOpen(a)}else{var i="";i=200!==r?"EventSource's response has a status "+r+" "+(o=o&&o.replace(/\s+/g," "))+" that is not 200. Aborting the connection.":"EventSource's response has a Content-Type specifying an unsupported type: "+(t?"-":t.replace(/\s+/g," "))+". Aborting the connection.";var s=new f.default("error",{headers:n,message:i,status:r,statusText:o});this.close(),this.dispatchEvent(s),this.onError(s)}}},{key:"onProgress",value:function(e){if(this.currentState===x.default.OPEN){for(var t=this.parserState,n=t.dataBuffer,r=t.eventTypeBuffer,o=t.fieldStart,a=t.lastEventIdBuffer,i=t.state,s=t.textBuffer,u=t.valueStart,c=-1,l=0;l<e.length;l+=1){var f=e.charCodeAt(l);f!==w.default["\n"]&&f!==w.default["\r"]||(c=l)}var d=(-1!==c?s:"")+e.slice(0,c+1);s=(-1===c?s:"")+e.slice(c+1);for(var p=0;p<d.length;p+=1){var h=d.charCodeAt(p);if(i!==k.default.AFTER_CR||h!==w.default["\n"])if(i===k.default.AFTER_CR&&(i=k.default.FIELD_START),h===w.default["\n"]||h===w.default["\r"]){if(i!==k.default.FIELD_START){i===k.default.FIELD&&(u=p+1);var y=d.slice(o,u-1),v=u<p&&d.charCodeAt(u)===w.default[" "]?1:0,g=d.slice(u+v,p);"data"===y?(n+="\n",n+=g):"id"===y?a=g:"event"===y&&(r=g)}if(i===k.default.FIELD_START){if(""!==n){this.lastEventId=a,""===r&&(r="message");var m=new E.default(r,{data:n.slice(1),lastEventId:a});if(this.dispatchEvent(m),"message"===r&&this.onMessage(m),this.currentState===x.default.CLOSED)return}r=n=""}i=h===w.default["\r"]?k.default.AFTER_CR:k.default.FIELD_START}else i===k.default.FIELD_START&&(o=p,i=k.default.FIELD),i===k.default.FIELD?h===w.default[":"]&&(u=p+1,i=k.default.VALUE_START):i===k.default.VALUE_START&&(i=k.default.VALUE);else i=k.default.FIELD_START}this.parserState={dataBuffer:n,eventTypeBuffer:r,fieldStart:o,lastEventIdBuffer:a,state:i,textBuffer:s,valueStart:u}}}},{key:"onFinish",value:function(e){var t=new p.default("error");e&&(t.message=e.message,t.stack=e.stack),this.dispatchEvent(t),this.onError(t)}},{key:"close",value:(o=(0,c.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentState=x.default.CLOSED,this.onReadyStateChange(x.default.CLOSED),this.request&&!this.request.isAborted)return e.next=5,this.request.abort();e.next=5;break;case 5:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})}]),I);function I(e){var t=e.RequestClass,n=e.dispatchEvent,r=e.headers,o=e.lastEventId,a=void 0===o?"":o,i=e.onError,s=e.onMessage,u=e.onOpen,c=e.onReadyStateChange,l=e.url,f=e.withCredentials;(0,d.default)(this,I),this.RequestClass=t,this.dispatchEvent=n,this.headers=r,this.lastEventId=a,this.onError=i,this.onMessage=s,this.onOpen=u,this.onReadyStateChange=c,this.url=l,this.withCredentials=f,this.currentState=x.default.WAITING,this.parserState={dataBuffer:"",eventTypeBuffer:"",fieldStart:0,lastEventIdBuffer:a,state:k.default.FIELD_START,textBuffer:"",valueStart:0},this.request=void 0}t.default=A,e.exports=t.default},function(e,_,w){(function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_,"__esModule",{value:!0}),_.FetchRequest=_.isFetchSupported=void 0;var n,r,o,a,i=t(w(19)),s=t(w(10)),u=t(w(9)),c=t(w(1)),l=t(w(2)),f=w(489),d=e.navigator&&e.navigator.userAgent,p=!!d&&d.includes("Trident/"),h=!!d&&/\/([0-9]|1[0-2])[\.\d]* Mobile\/[0-9A-F]* Safari/.test(d),y=(_.isFetchSupported=!(p||h||!e.fetch||!e.Headers||!e.Response||!e.AbortController),(0,f.supportsStreamOption)()?f.NativeTextDecoder:f.TextDecoderPolyfill),v=e.fetch,g=((0,l.default)(m,[{key:"get",value:function(e){return this._headers.get(e)}}]),m);function m(e){(0,c.default)(this,m),this._headers=e}function b(e){var t=e.headers,n=e.onProgress,r=e.onStart,o=e.url,a=e.withCredentials;(0,c.default)(this,b),this.controller=new AbortController,this.headers=new Headers(t),this.isAborted=!1,this.onProgress=n,this.onStart=r,this.response=null,this.textDecoder=new y,this.url=o,this.withCredentials=a,this._reader=null,this._stream=null}_.FetchRequest=((0,l.default)(b,[{key:"fetch",value:(a=(0,u.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAborted)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,v(this.url,{headers:this.headers,credentials:this.withCredentials?"include":"same-origin",signal:this.controller.signal,cache:"no-store"});case 4:if((t=this.response=e.sent).body.on)return this._emitStart(),e.next=9,this._streamBody();e.next=11;break;case 9:e.next=18;break;case 11:if("getReader"in t.body)return this._emitStart(),e.next=15,this._readBody();e.next=17;break;case 15:e.next=18;break;case 17:throw new Error("Cannot read from response.body, lacks 'getReader' or 'on' property");case 18:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},{key:"_emitStart",value:function(){var e=this.response,t=e.headers,n=e.status,r=e.statusText;this.onStart({contentType:t.get("Content-Type"),headers:new g(t),status:n,statusText:r})}},{key:"_streamBody",value:(o=(0,u.default)(s.default.mark(function e(){var o=this;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new i.default(function(e,t){function n(){r||(r=!0,e())}var r=!1;o._stream=o.response.body.on("data",function(e){var t=e.toString("utf8");o.onProgress(t)}).on("close",n).on("end",n).on("error",function(e){return t(e)})});case 2:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"_readBody",value:(r=(0,u.default)(s.default.mark(function e(){var t,n,r;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._reader=this.response.body.getReader(),t=!1;case 2:if(t||this.isAborted){e.next=9;break}return e.next=5,this._reader.read();case 5:(n=e.sent).done?t=!0:(r=this.textDecoder.decode(n.value,{stream:!0}),this.onProgress(r)),e.next=2;break;case 9:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"abort",value:(n=(0,u.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAborted)return e.abrupt("return");e.next=2;break;case 2:if(this.isAborted=!0,this._reader)return e.prev=4,e.next=7,this._reader.cancel();e.next=12;break;case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:this._reader=null;case 12:this._stream&&(this._stream.destroy(),this._stream=null),this.controller.abort();case 14:case"end":return e.stop()}},e,this,[[4,9]])})),function(){return n.apply(this,arguments)})}]),b)}).call(_,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function s(e){return e.replace(/[A-Z]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+32)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=r(n(176)),c=r(n(1)),o=((0,r(n(2)).default)(l,[{key:"get",value:function(e){return this._map[s(e)]}}]),l);function l(e){(0,c.default)(this,l);for(var t=(0,u.default)(null),n=e.split("\r\n"),r=0;r<n.length;r+=1){var o=n[r].split(": "),a=o.shift(),i=o.join(": ");t[s(a)]=i}this._map=t}t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a=r(n(6)),i=r(n(1)),s=r(n(8)),u=r(n(7)),c=r(n(173)),l=(o=c.default,(0,u.default)(f,o),f);function f(e,t){(0,i.default)(this,f);var n=(0,s.default)(this,(f.__proto__||(0,a.default)(f)).call(this,e));return n.data=t.data,n.lastEventId=t.lastEventId,n}t.default=l,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={AFTER_CR:-1,FIELD_START:0,FIELD:1,VALUE_START:2,VALUE:3},e.exports=t.default},function(e,u,c){(function(e){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){if(1===n)return 128>>t<=e&&e<<t<=2047;if(2===n)return 2048>>t<=e&&e<<t<=55295||57344>>t<=e&&e<<t<=65535;if(3===n)return 65536>>t<=e&&e<<t<=1114111;throw new Error("Invalid octetsCount")}function s(e,t){if(6===e)return 15<t>>6?3:31<t?2:1;if(12===e)return 15<t?3:2;if(18===e)return 3;throw new Error}Object.defineProperty(u,"__esModule",{value:!0}),u.TextDecoderPolyfill=u.NativeTextDecoder=void 0;var n=t(c(1)),r=t(c(2));u.supportsStreamOption=function(){if(!o||"undefined"==typeof TextEncoder)return!1;try{return"test"===(new o).decode((new TextEncoder).encode("test"),{stream:!0})}catch(e){}return!1};var o=u.NativeTextDecoder=e.TextDecoder;function a(){(0,n.default)(this,a),this.bitsNeeded=0,this.codePoint=0}u.TextDecoderPolyfill=((0,r.default)(a,[{key:"decode",value:function(e){for(var t="",n=this.bitsNeeded,r=this.codePoint,o=0;o<e.length;o+=1){var a=e[o];0!==n&&(a<128||191<a||!i(r<<6|63&a,n-6,s(n,r)))&&(n=0,r=65533,t+=String.fromCharCode(r)),0===n?(r=0<=a&&a<=127?(n=0,a):192<=a&&a<=223?(n=6,31&a):224<=a&&a<=239?(n=12,15&a):240<=a&&a<=247?(n=18,7&a):(n=0,65533),0===n||i(r,n,s(n,r))||(n=0,r=65533)):(n-=6,r=r<<6|63&a),0===n&&(r<=65535?t+=String.fromCharCode(r):(t+=String.fromCharCode(55296+(r-65535-1>>10)),t+=String.fromCharCode(56320+(r-65535-1&1023))))}return this.bitsNeeded=n,this.codePoint=r,t}}]),a)}).call(u,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function p(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=p(t[0],n);return t.every(function(e){return p(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return p(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+p(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function h(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=h(t[0],n);return t.every(function(e){return h(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return h(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+h(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.XHRRequest=void 0;var o,a,i=r(n(4)),s=r(n(5)),u=r(n(3)),y=r(n(10)),v=r(n(20)),g=r(n(13)),m=r(n(12)),b=r(n(24)),_=r(n(19)),c=r(n(9)),l=r(n(1)),f=r(n(2)),w=r(n(486)),d=r(n(491));function x(e){var t=e.headers,n=e.onProgress,r=e.onStart,o=e.url,a=e.withCredentials;(0,l.default)(this,x),this.headers=t,this.isAborted=!1,this.offset=0,this.onProgress=n,this.onStart=r,this.url=o,this.withCredentials=a,this.xhr=new d.default(new XMLHttpRequest)}t.XHRRequest=((0,f.default)(x,[{key:"fetch",value:(a=(0,c.default)(y.default.mark(function e(){var n,t,r,o,a,i,s,u,c,l,f,d=this;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAborted)return e.abrupt("return");e.next=2;break;case 2:if(n=void 0,t=new _.default(function(e){n=e}),this.xhr.open("GET",this.url),this.xhr.onprogress=function(){var e=d.xhr.responseText.slice(d.offset);d.offset+=e.length,d.onProgress(e)},this.xhr.onreadystatechange=function(){if(d.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED){var e=d.xhr.getResponseHeader("Content-Type"),t=d.xhr.getAllResponseHeaders();d.onStart({contentType:e,headers:new w.default(t),status:d.xhr.status,statusText:d.xhr.statusText})}else d.xhr.readyState===XMLHttpRequest.DONE&&n()},this.xhr.withCredentials=this.withCredentials,this.xhr.responseType="text",!(u=(0,b.default)(this.headers))||"function"!=typeof u[m.default]&&!Array.isArray(u))throw new TypeError("Expected _Object$entries to be iterable, got "+p(u));e.next=12;break;case 12:if(!u||"function"!=typeof u[m.default]&&!Array.isArray(u))throw new TypeError("Expected _Object$entries to be iterable, got "+h(u));e.next=14;break;case 14:for(o=!(r=!0),a=void 0,e.prev=17,i=(0,g.default)(u);!(r=(s=i.next()).done);r=!0)c=(0,v.default)(s.value,2),l=c[0],f=c[1],this.xhr.setRequestHeader(l,f);e.next=25;break;case 21:e.prev=21,e.t0=e.catch(17),o=!0,a=e.t0;case 25:e.prev=25,e.prev=26,!r&&i.return&&i.return();case 28:if(e.prev=28,o)throw a;e.next=31;break;case 31:return e.finish(28);case 32:return e.finish(25);case 33:return this.xhr.send(),e.next=36,t;case 36:case"end":return e.stop()}},e,this,[[17,21,25,33],[26,,28,32]])})),function(){return a.apply(this,arguments)})},{key:"abort",value:(o=(0,c.default)(y.default.mark(function e(){return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isAborted)return e.abrupt("return");e.next=2;break;case 2:this.isAborted=!0,this.xhr.abort();case 4:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})}]),x)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;function c(){}var o=r(n(1)),a=r(n(2)),i=((0,a.default)(s,[{key:"open",value:function(e,t){this._abort(!0);var o=this,a=this._xhr,i=1,n=0;function r(){if(1===i){var t="",n=void 0,r=0;if("contentType"in a)r=200,t="OK",n=a.contentType;else try{r=a.status,t=a.statusText,n=a.getResponseHeader("Content-Type")}catch(e){t="",n=void(r=0)}0!==r&&(i=2,o.readyState=2,o.status=r,o.statusText=t,o._contentType=n,o.onreadystatechange())}}function s(){if(r(),2===i||3===i){i=3;var e="";try{e=a.responseText}catch(e){}o.readyState=3,o.responseText=e,o.onprogress()}}function u(){s(),1!==i&&2!==i&&3!==i||(i=4,0!==n&&(clearTimeout(n),n=0),o.readyState=4,o.onreadystatechange())}this._abort=function(e){0!==o._sendTimeout&&(clearTimeout(o._sendTimeout),o._sendTimeout=0),1!==i&&2!==i&&3!==i||(i=4,a.onload=c,a.onerror=c,a.onabort=c,a.onprogress=c,a.onreadystatechange=c,a.abort(),0!==n&&(clearTimeout(n),n=0),e||(o.readyState=4,o.onreadystatechange())),i=0},a.onload=u,a.onerror=u,a.onabort=u,"sendAsBinary"in XMLHttpRequest.prototype||"mozAnon"in XMLHttpRequest.prototype||(a.onprogress=s),a.onreadystatechange=function(){a&&(4===a.readyState?u():3===a.readyState?s():2===a.readyState&&r())},"contentType"in a&&(t+=(-1===t.indexOf("?")?"?":"&")+"padding=true"),a.open(e,t,!0),"readyState"in a&&(n=setTimeout(function(){!function e(){n=setTimeout(function(){e()},500),3===a.readyState&&s()}()},0))}},{key:"abort",value:function(){this._abort(!1)}},{key:"getResponseHeader",value:function(e){return this._contentType}},{key:"setRequestHeader",value:function(e,t){var n=this._xhr;"setRequestHeader"in n&&n.setRequestHeader(e,t)}},{key:"getAllResponseHeaders",value:function(){return this._xhr.getAllResponseHeaders?this._xhr.getAllResponseHeaders():""}},{key:"send",value:function(){if("ontimeout"in XMLHttpRequest.prototype||!document||!document.readyState||"complete"===document.readyState){var e=this._xhr;e.withCredentials=this.withCredentials,e.responseType=this.responseType;try{e.send(void 0)}catch(t){throw t}}else{var t=this;t._sendTimeout=setTimeout(function(){t._sendTimeout=0,t.send()},4)}}}]),s);function s(e){(0,o.default)(this,s),this.withCredentials=!1,this.responseType="",this.readyState=0,this.status=0,this.statusText="",this.responseText="",this.onprogress=c,this.onreadystatechange=c,this._contentType="",this._xhr=e,this._sendTimeout=0,this._abort=c}t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventSourcePolyfill=void 0;var r,o=n(483),a=(r=o)&&r.__esModule?r:{default:r};t.default=a.default,t.EventSourcePolyfill=a.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function I(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=I(t[0],n);return t.every(function(e){return I(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return I(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+I(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function O(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=O(t[0],n);return t.every(function(e){return O(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return O(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+O(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0});var j=r(n(16)),i=r(n(4)),s=r(n(5)),u=r(n(3)),S=r(n(38)),M=r(n(20)),R=r(n(13)),C=r(n(12)),P=r(n(24)),z=r(n(19)),V=r(n(10)),a=r(n(9)),c=r(n(1)),o=r(n(2)),G=r(n(73)),N=r(n(35)),l=r(n(296)),f=r(n(41)),d=n(21),D=r(n(965)),p=r(n(963)),U=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),h=r(n(123)),F=r(n(267)),y=["get","post","put","patch","del"],v=[U.PermissionDeniedError.CODE,U.WrongCredentialsError.CODE],g=((0,o.default)(m,[{key:"mounted",value:function(){this._prefixBaseUrl=(0,p.default)(this.config.baseUrl)}},{key:"_contentType",value:function(e){switch(e){case"json":return"application/json";case"event-stream":return"text/event-stream";case"text":default:return"plain/text"}}},{key:"getAuth",value:function(e){return this._auth}},{key:"setAuth",value:function(e){this._auth=e}},{key:"removeAuth",value:function(){this._auth=null}},{key:"getAuthForKeyAndSecret",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+O(e));if("string"!=typeof t)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\nstring\n\nGot:\n'+O(t));if("string"!=typeof e)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+I(e));if("string"!=typeof t)throw new TypeError('Value of argument "secret" violates contract.\n\nExpected:\nstring\n\nGot:\n'+I(t));return e&&t?(0,l.default)(e+":"+t):null}},{key:"getAuthHeaders",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._auth;if(!e)return{};var t={};if(e.key&&e.secret)t.Authorization="Basic "+this.getAuthForKeyAndSecret(e.key,e.secret);else{if(!e.bearerToken||!e.udid)return{};t.Authorization="Bearer "+e.bearerToken,t["X-Device-ID"]=e.udid}return t}},{key:"isUnauthorizedError",value:function(e){return e&&v.includes(e.code)}},{key:"downloadFileBlob",value:function(_){var w=this,e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).headers,x=void 0===e?{}:e;if("string"!=typeof _)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+O(_));if("string"!=typeof _)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+I(_));return new z.default(function(e,t){var n=new XMLHttpRequest,r=w.config.baseUrl+_;if(n.open("GET",r,!0),!(c=(0,P.default)(w.getAuthHeaders()))||"function"!=typeof c[C.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+I(c));if(!c||"function"!=typeof c[C.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+O(c));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,R.default)(c);!(o=(s=u.next()).done);o=!0){var c,l=(0,M.default)(s.value,2),f=l[0],d=l[1];n.setRequestHeader(f,d)}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}if(!(m=(0,P.default)(x))||"function"!=typeof m[C.default]&&!Array.isArray(m))throw new TypeError("Expected _Object$entries2 to be iterable, got "+I(m));if(!m||"function"!=typeof m[C.default]&&!Array.isArray(m))throw new TypeError("Expected _Object$entries2 to be iterable, got "+O(m));var p=!0,h=!1,y=void 0;try{for(var v,g=(0,R.default)(m);!(p=(v=g.next()).done);p=!0){var m,b=(0,M.default)(v.value,2);f=b[0],d=b[1],n.setRequestHeader(f,d)}}catch(e){h=!0,y=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw y}}n.responseType="blob",n.onreadystatechange=function(){4===n.readyState&&(n.status<200||299<n.status?t(new Error("Failed downloading "+r+". Status = "+n.status)):e(n.response))},n.send(null)})}},{key:"downloadToFile",value:function(e,t){U.TargetNotSupportedError.raise()}},{key:"_watchNetworkConnection",value:function(){var e=this;this.networkStatus=navigator.onLine?h.default.ONLINE:h.default.OFFLINE,window.addEventListener("online",function(){e.config.eventsAutoReconnect?e._setNetworkStatus(h.default.CONNECTING):e._setNetworkStatus(h.default.ONLINE)}),window.addEventListener("offline",function(){e._setNetworkStatus(h.default.OFFLINE)})}},{key:"_setNetworkStatus",value:function(e){var t=this.networkStatus;e!==t&&(this.networkStatus=e,this.emit("networkStatus:change",{networkStatus:e,previousStatus:t}))}},{key:"isSignedIn",get:function(){return!!this._auth}}]),m);function m(e){var t,r=this,n=e.config,o=e.logger;(0,c.default)(this,m),this.downloadFileBlobAndUrl=(t=(0,a.default)(V.default.mark(function e(t){var n;return V.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+O(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "path" violates contract.\n\nExpected:\nstring\n\nGot:\n'+I(t));e.next=4;break;case 4:return e.next=6,r.downloadFileBlob(t);case 6:return n=e.sent,e.t0=n,e.abrupt("return",{blob:e.t0,get url(){return this._url||(this._url=URL.createObjectURL(n))}});case 9:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}),this.config=n,this.logger=o,this._prefixBaseUrl=(0,p.default)(this.config.baseUrl),this._watchNetworkConnection()}if("function"!=typeof y[C.default]&&!Array.isArray(y))throw new TypeError("Expected HTTP_METHODS to be iterable, got "+I(y));if("function"!=typeof y[C.default]&&!Array.isArray(y))throw new TypeError("Expected HTTP_METHODS to be iterable, got "+O(y));var b,_,w=!0,x=!1,E=void 0;try{for(var k,T=function(){var t,A=k.value;g.prototype[A]=(t=(0,a.default)(V.default.mark(function e(c){var t,n,r,o,a,i,s,u,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k=this,T=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return V.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((T=(0,N.default)(T||{},{reqFormat:"json",resFormat:"json",withCredentials:!0,withHeaders:!0})).urlParams&&(c=c.replace(/:([\w\-]+)/g,function(e,t){var n=T.urlParams[t];return void 0!==n?encodeURIComponent(n):":"+t})),this.logger&&this.logger.info("start",A.toUpperCase(),c,T),(t=(0,j.default)({},T.headers,"TT-Route-Xmpp"===this.config.ttRoute?{"TT-Route-Xmpp":"true"}:null)).Accept=t.Accept||this._contentType(T.resFormat),T.requestId&&(t["Request-ID"]=T.requestId),"Authorization"in t||(0,S.default)(t,this.getAuthHeaders(T.auth)),n=D.default[A](c).use(this._prefixBaseUrl).query(T.query||{}),T.withCredentials&&(n=n.withCredentials()),!1!==T.retry&&(n=n.retry(T.retryCount||3)),!1!==T.timeout&&(n=n.timeout(!0===T.timeout?1e4:T.timeout)),r=void 0,(o=T.files&&(0,P.default)(T.files))&&0<o.length?(r=new F.default,t["Content-Type"]=r.getContentType()):t["Content-Type"]=t["Content-Type"]||this._contentType(T.reqFormat),T.withHeaders&&(n=n.set(t)),!r){e.next=73;break}if(a=[],!T.data){e.next=42;break}if(!(d=(0,P.default)(T.data))||"function"!=typeof d[C.default]&&!Array.isArray(d))throw new TypeError("Expected _Object$entries3 to be iterable, got "+I(d));e.next=21;break;case 21:if(!d||"function"!=typeof d[C.default]&&!Array.isArray(d))throw new TypeError("Expected _Object$entries3 to be iterable, got "+O(d));e.next=23;break;case 23:for(s=!(i=!0),u=void 0,e.prev=26,l=(0,R.default)(d);!(i=(f=l.next()).done);i=!0)p=(0,M.default)(f.value,2),h=p[0],y=p[1],a.push(r.appendField(h,y));e.next=34;break;case 30:e.prev=30,e.t0=e.catch(26),s=!0,u=e.t0;case 34:e.prev=34,e.prev=35,!i&&l.return&&l.return();case 37:if(e.prev=37,s)throw u;e.next=40;break;case 40:return e.finish(37);case 41:return e.finish(34);case 42:if(!o||"function"!=typeof o[C.default]&&!Array.isArray(o))throw new TypeError("Expected fileEntries to be iterable, got "+I(o));e.next=44;break;case 44:if(!o||"function"!=typeof o[C.default]&&!Array.isArray(o))throw new TypeError("Expected fileEntries to be iterable, got "+O(o));e.next=46;break;case 46:for(g=!(v=!0),m=void 0,e.prev=49,b=(0,R.default)(o);!(v=(_=b.next()).done);v=!0)w=(0,M.default)(_.value,2),h=w[0],x=w[1],a.push(r.appendFile(h,x));e.next=57;break;case 53:e.prev=53,e.t1=e.catch(49),g=!0,m=e.t1;case 57:e.prev=57,e.prev=58,!v&&b.return&&b.return();case 60:if(e.prev=60,g)throw m;e.next=63;break;case 63:return e.finish(60);case 64:return e.finish(57);case 65:return e.next=67,z.default.all(a);case 67:return e.next=69,r.getPayload(r);case 69:E=e.sent,n=n.send(E),e.next=74;break;case 73:n=n.send(T.data);case 74:return e.abrupt("return",new z.default(function(s,u){n.end(function(e,t){var n=(t||{}).headers;if(e)if(k.logger&&k.logger.info("error",A.toUpperCase(),c,e),e.status)if(401===e.status)u(new U.WrongCredentialsError(n));else if(403===e.status){var r=(T.urlParams||{}).userId,o=void 0===r?"403":r;u(new U.PermissionDeniedError(c,o,A,(0,G.default)(t,"body.error.message")))}else u(e);else u(new U.ConnectionUnavailableError);else switch(T.resFormat){case"json":var a=t.body||{};"reply"in a&&(a=a.reply);var i={data:a,headers:n,getHeader:function(e){return n[e.toLowerCase()]},status:t.status};k.logger&&k.logger.info("success",A.toUpperCase(),c,i),s(i);break;default:k.logger&&k.logger.info("success",A.toUpperCase(),c,t.text?t.text.substr(0,80)+"...":"[null]"),s(t.text)}})}));case 75:case"end":return e.stop()}},e,this,[[26,30,34,42],[35,,37,41],[49,53,57,65],[58,,60,64]])})),function(e){return t.apply(this,arguments)})},A=(0,R.default)(y);!(w=(k=A.next()).done);w=!0)T()}catch(e){x=!0,E=e}finally{try{!w&&A.return&&A.return()}finally{if(x)throw E}}b=g.prototype.get,_=(0,d.decorator)(b),g.prototype.get=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t.reusePromise?_.call(this,e,t):b.call(this,e,t)},(0,S.default)(g.prototype,f.default.prototype),t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.HttpClient=t.readFile=t.MultiPart=t.mimeTypes=t.encoding=void 0;var a=o(n(122)),i=o(n(174)),s=r(n(267)),u=r(n(268)),c=r(n(493));t.encoding=a,t.mimeTypes=i,t.MultiPart=s.default,t.readFile=u.default,t.default=c.default,t.HttpClient=c.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function f(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,h.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=f(t[0],n);return t.every(function(e){return f(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return f(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,A.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,p.default)(e))+": "+f(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function d(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,h.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=d(t[0],n);return t.every(function(e){return d(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return d(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,A.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,p.default)(e))+": "+d(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,p=r(n(4)),h=r(n(3)),y=r(n(38)),T=r(n(10)),A=r(n(5)),v=r(n(9)),g=r(n(6)),m=r(n(1)),b=r(n(2)),_=r(n(8)),w=r(n(7)),x=r(n(73)),E=r(n(15)),I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),k=n(29),O=r(n(45)),j=(o=E.default,(0,w.default)(S,o),(0,b.default)(S,[{key:"start",value:(l=(0,v.default)(T.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_=t.organizationId,w=t.recipients,x=t.payload,E=t.context,k=void 0===E?{}:E;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_){e.next=2;break}throw new I.ValidationError("organizationId","required");case 2:if(w){e.next=4;break}throw new I.ValidationError("recipients","required");case 4:if(x){e.next=6;break}throw new I.ValidationError("payload","required");case 6:if(w.length){e.next=8;break}throw new I.ValidationError("recipients array","required");case 8:if(n=x.callId,r=x.callerId,o=x.date,a=x.groupId,i=x.identity,s=x.isVideo,u=x.name,c=x.networkType,l=x.orgId,f=x.participantsTokens,d=x.recipientToken,p=x.roleTokens,n){e.next=11;break}throw new I.ValidationError("payload.callId","required");case 11:if(r){e.next=13;break}throw new I.ValidationError("payload.callerId","required");case 13:if(o){e.next=15;break}throw new I.ValidationError("payload.date","required");case 15:if(a){e.next=17;break}throw new I.ValidationError("payload.groupId","required");case 17:if(i){e.next=19;break}throw new I.ValidationError("payload.identity","required");case 19:if(s){e.next=21;break}throw new I.ValidationError("payload.isVideo","required");case 21:if(u){e.next=23;break}throw new I.ValidationError("payload.name","required");case 23:if(c){e.next=25;break}throw new I.ValidationError("payload.networkType","required");case 25:if(l){e.next=27;break}throw new I.ValidationError("payload.orgId","required");case 27:if(f){e.next=29;break}throw new I.ValidationError("payload.participantsTokens","required");case 29:if(d){e.next=31;break}throw new I.ValidationError("payload.recipientToken","required");case 31:if(p){e.next=33;break}throw new I.ValidationError("payload.roleTokens","required");case 33:return e.next=35,this.host.api.calls.start({organization:_,recipients:w,payload:O.default.underscoreObject(x),context:k});case 35:if(h=e.sent,y=h.accessToken,v=h.roomName,g=h.disabledParticipants,m=void 0===g?{}:g,b={},!v){e.next=43;break}if(b=this.host.models.Call.inject({id:v,payload:x,accessToken:y,roomName:v}),"patient"===c&&(0,A.default)(m).length)return e.next=43,this.host.api.calls.state(v,l,{callId:n,payload:{callState:"disabled_participants",disabledParticipants:m}});e.next=43;break;case 43:return e.abrupt("return",b);case 44:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"decline",value:(c=(0,v.default)(T.default.mark(function e(t){var n,r,o,a,i,s=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).payload;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+d(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 4:if(n=this._resolveModelId(t),t=this._resolveEntity(n,"call"),o=(r=t).callId,a=r.organizationId,i=r.id,a){e.next=9;break}throw new I.ValidationError("organizationId","required");case 9:if(s){e.next=11;break}throw new I.ValidationError("payload","required");case 11:if(i){e.next=13;break}throw new I.ValidationError("roomName","required");case 13:if(o){e.next=15;break}throw new I.ValidationError("callId","required");case 15:return e.next=17,this.host.api.calls.decline(i,a,{callId:o,payload:s});case 17:return e.abrupt("return");case 18:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"end",value:(u=(0,v.default)(T.default.mark(function e(t,n){var r,o,a,i,s,u=n.payload,c=n.reason;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+d(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 4:if(r=this._resolveModelId(t),t=this._resolveEntity(r,"call"),a=(o=t).callId,i=o.organizationId,s=o.id,i){e.next=9;break}throw new I.ValidationError("organizationId","required");case 9:if(u){e.next=11;break}throw new I.ValidationError("payload","required");case 11:if(c){e.next=13;break}throw new I.ValidationError("reason","required");case 13:if(s){e.next=15;break}throw new I.ValidationError("roomName","required");case 15:if(a){e.next=17;break}throw new I.ValidationError("callId","required");case 17:return e.next=19,this.host.api.calls.end(s,i,{callId:a,payload:u,reason:c});case 19:return e.abrupt("return");case 20:case"end":return e.stop()}},e,this)})),function(e,t){return u.apply(this,arguments)})},{key:"join",value:(s=(0,v.default)(T.default.mark(function e(t){var n,r,o,a,i;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+d(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 4:if(n=this._resolveModelId(t),t=this._resolveEntity(n,"call"),o=(r=t).organizationId,a=r.id,o){e.next=9;break}throw new I.ValidationError("organizationId","required");case 9:if(a){e.next=11;break}throw new I.ValidationError("roomName","required");case 11:return e.next=13,this.host.api.calls.join(a,o);case 13:return i=e.sent,e.abrupt("return",O.default.camelizeObject(i));case 15:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"answer",value:(i=(0,v.default)(T.default.mark(function e(t){var n,r,o,a,i,s,u=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).payload;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+d(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 4:if(n=this._resolveModelId(t),t=this._resolveEntity(n,"call"),o=(r=t).callId,a=r.organizationId,i=r.id){e.next=9;break}throw new I.ValidationError("roomName","required");case 9:if(a){e.next=11;break}throw new I.ValidationError("organizationId","required");case 11:if(u){e.next=13;break}throw new I.ValidationError("payload","required");case 13:if(o){e.next=15;break}throw new I.ValidationError("callId","required");case 15:return e.next=17,this.host.api.calls.answer(i,a,{payload:u,callId:o});case 17:return s=e.sent,e.abrupt("return",O.default.camelizeObject(s));case 19:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"invite",value:(a=(0,v.default)(T.default.mark(function e(t,n){var r,o,a,i,s,u=n.currentUserId,c=n.payload,l=n.recipients;return T.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+d(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "call" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 4:if(r=this._resolveModelId(t),t=this._resolveEntity(r,"call"),a=(o=t).callId,i=o.organizationId,s=o.id,i){e.next=9;break}throw new I.ValidationError("organizationId","required");case 9:if(s){e.next=11;break}throw new I.ValidationError("roomName","required");case 11:if(c){e.next=13;break}throw new I.ValidationError("payload","required");case 13:if(l){e.next=15;break}throw new I.ValidationError("recipients","required");case 15:if(a){e.next=17;break}throw new I.ValidationError("callId","required");case 17:if(u){e.next=19;break}throw new I.ValidationError("currentUserId","required");case 19:return e.next=21,this.host.api.calls.invite(s,i,{callId:a,payload:c,recipients:l});case 21:return e.next=23,this.host.api.calls.state(s,i,{callId:a,payload:{callState:"participants_updated",inviteInitiator:u,newParticipants:l,roleTokens:{}}});case 23:return e.abrupt("return");case 24:case"end":return e.stop()}},e,this)})),function(e,t){return a.apply(this,arguments)})},{key:"reactToVoipSSE",value:function(e){var t=e.data,n=e.type;if("provider"!==(0,x.default)(t,"payload.network_type")){t=(0,k.jsonCloneDeep)(t);var r=n.split(":")[1],o=this.host.models.Call.inject((0,y.default)(t,{callStatus:r}));this.emit(r,o)}}}]),S);function S(){return(0,m.default)(this,S),(0,_.default)(this,(S.__proto__||(0,g.default)(S)).apply(this,arguments))}t.default=j,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function q(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,F.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=q(t[0],n);return t.every(function(e){return q(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return q(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,U.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,D.default)(e))+": "+q(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function H(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,F.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=H(t[0],n);return t.every(function(e){return H(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return H(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,U.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,D.default)(e))+": "+H(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z,V,G,N,D=r(n(4)),U=r(n(5)),F=r(n(3)),L=r(n(11)),B=r(n(77)),$=r(n(19)),Y=r(n(20)),Z=r(n(10)),W=r(n(47)),K=r(n(9)),X=r(n(13)),Q=r(n(16)),J=r(n(12)),ee=r(n(6)),te=r(n(1)),ne=r(n(2)),re=r(n(8)),oe=r(n(7)),ae=r(n(54)),ie=r(n(375)),se=r(n(73)),ue=r(n(235)),ce=r(n(35)),le=r(n(15)),fe=r(n(211)),de=r(n(702)),pe=r(n(212)),he=r(n(87)),ye=r(n(339)),ve=r(n(240)),ge=n(21),me=r(n(315)),be=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),_e=n(36),we=n(121),xe=r(we),Ee=n(29),ke=n(67),Te=n(46),Ae=n(124),Ie=new me.default.MD5,Oe=[_e.MessageType.ESCALATION_EXECUTION_CHANGE,_e.MessageType.GROUP_MEMBERSHIP_CHANGE],je=xe.default.toServer(xe.default.DELIVERED),Se=(a={},(0,ae.default)(a,_e.EscalationChangeAction.ACKNOWLEDGED,"Acknowledged"),(0,ae.default)(a,_e.EscalationChangeAction.CANCELLED,"Cancelled"),(0,ae.default)(a,_e.EscalationChangeAction.INITIATED,"Initiated"),(0,ae.default)(a,_e.EscalationChangeAction.MEMBER_ADDED,"Added"),(0,ae.default)(a,_e.EscalationChangeAction.NO_RESPONSE,"ended with No Response"),a),Me=[_e.GroupType.GROUP,_e.GroupType.FORUM,_e.GroupType.ROLE_ASSIGNMENT,_e.GroupType.ROLE_P2P],Re=(i={},(0,ae.default)(i,"ADD","added"),(0,ae.default)(i,"JOIN","joined"),(0,ae.default)(i,"LEAVE","left"),(0,ae.default)(i,"REMOVE","removed"),(0,ae.default)(i,"DENY","declined"),i),Ce=(s={},(0,ae.default)(s,"ADD","to"),(0,ae.default)(s,"REMOVE","from"),(0,ae.default)(s,"DENY","to join"),s),Pe=(u={},(0,ae.default)(u,_e.GroupType.ACTIVATED_TEAM,"group"),(0,ae.default)(u,_e.GroupType.ESCALATION,"escalation"),(0,ae.default)(u,_e.GroupType.FORUM,"forum"),(0,ae.default)(u,_e.GroupType.GROUP,"group"),(0,ae.default)(u,_e.GroupType.PATIENT_CARE,"care team"),(0,ae.default)(u,_e.GroupType.ROLE_P2P,"conversation"),(0,ae.default)(u,_e.GroupType.PATIENT_MESSAGING,"group"),(0,ae.default)(u,_e.GroupType.INTRA_TEAM,"team"),u),ze=[xe.default.NEW,xe.default.DELIVERED],Ve=xe.default.toServer(xe.default.READ),Ge=(c={},(0,ae.default)(c,"OPT_IN","opted into"),(0,ae.default)(c,"OPT_OUT","opted out of"),c),Ne=(l=(0,ge.decorator)(),f=(0,ge.decorator)(),d=(0,ge.decorator)(),h=le.default,(0,oe.default)(De,h),(0,ne.default)(De,[{key:"mounted",value:function(){this.__escalationEnabledOrganizations=[],this.__queuedConversationsToReload=[],this._convByConvHandle={},this._fetched=!1,this._roleConversationsProcessingEvent={},this._rolesFriendsEventPromise=null,this.host.on("message:sending",this._onSendingMessage),this.host.on("message:sent",this._onSentMessage),this.host.models.Group.on("afterEject",this._onRemoveGroup),this.host.models.Group.on("afterInject",this._onChangeGroup),this.host.models.Team.on("afterEject",this._onRemoveTeam),this.host.models.Message.on("afterInject",this._onChangeMessage),this.host.models.Message.on("afterEject",this._onRemoveMessage),this.host.models.Organization.on("afterInject",this._onChangeOrganization)}},{key:"dispose",value:function(){this._convByConvHandle={},this._fetched=!1,this._rolesFriendsEventPromise=null,this.__escalationEnabledOrganizations=[],this.__queuedConversationsToReload=[],this.host.removeListener("message:sending",this._onSendingMessage),this.host.removeListener("message:sent",this._onSentMessage),this.host.models.Group.removeListener("afterEject",this._onRemoveGroup),this.host.models.Group.removeListener("afterInject",this._onChangeGroup),this.host.models.Team.removeListener("afterEject",this._onRemoveTeam),this.host.models.Message.removeListener("afterInject",this._onChangeMessage),this.host.models.Message.removeListener("afterEject",this._onRemoveMessage),this.host.models.Organization.removeListener("afterInject",this._onChangeOrganization)}},{key:"clearTimeline",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).emit,n=void 0===t||t;if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(e));var r=this._resolveEntity(e,"conversation");if(!r)throw new be.NotFoundError(this.host.models.Conversation.name,e);e=this._resolveModelId(e),this.clearMessageStatuses(r,{emit:!1});var o=r.higherContinuation,a=r.lowerContinuation,i=r.timeline,s=0;if(!i||"function"!=typeof i[J.default]&&!Array.isArray(i))throw new TypeError("Expected timeline to be iterable, got "+q(i));if(!i||"function"!=typeof i[J.default]&&!Array.isArray(i))throw new TypeError("Expected timeline to be iterable, got "+H(i));var u=!0,c=!1,l=void 0;try{for(var f,d=(0,X.default)(i);!(u=(f=d.next()).done);u=!0){var p=f.value;p.isEphemeral||(p.inTimeline=!1,s+=1)}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}return r.isLive=!1,o.itemsEstimate=null,a.itemsEstimate=null,n&&this.emit("clearTimeline",e),this.config.condensedReplays?this.host.models.Conversation.inject(r):this.__reloadConversation(r,{notify:!1}),s}},{key:"fetchTimeline",value:(N=(0,K.default)(Z.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},V=z.anchorPoint,G=void 0===V?_e.ConversationAnchorPoints.CONVERSATION_END:V,N=z.continuation,D=z.fetchAllItems,U=void 0!==D&&D,F=z.markAsDelivered,L=void 0===F||F,B=z.maxItems,$=void 0===B?15:B;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));case 4:if(n=this._resolveEntity(t,"conversation")){e.next=7;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 7:if(t=this._resolveModelId(t),this.config.condensedReplays)return e.next=11,this._fetchTimelineCR(t,{anchorPoint:G,continuation:N,conversation:n,fetchAllItems:U,markAsDelivered:L,maxItems:$});e.next=13;break;case 11:return r=e.sent,e.abrupt("return",r);case 13:if(o=n.content,a=n.timeline,i=n.firstUnreadMessage,s=o.length,u=0,c=[],l=s-$,f=s,G!==_e.ConversationAnchorPoints.CONVERSATION_END){e.next=24;break}this.clearTimeline(n,{emit:!1}),e.next=105;break;case 24:if(G!==_e.ConversationAnchorPoints.FIRST_UNREAD_ITEM){e.next=62;break}if(this.clearTimeline(n,{emit:!1}),d=-1,!o||"function"!=typeof o[J.default]&&!Array.isArray(o))throw new TypeError("Expected content to be iterable, got "+q(o));e.next=29;break;case 29:if(!o||"function"!=typeof o[J.default]&&!Array.isArray(o))throw new TypeError("Expected content to be iterable, got "+H(o));e.next=31;break;case 31:h=!(p=!0),y=void 0,e.prev=34,v=(0,X.default)(o);case 36:if(p=(g=v.next()).done){e.next=45;break}if(m=g.value,f=++d,i===m)return e.abrupt("break",45);e.next=42;break;case 42:p=!0,e.next=36;break;case 45:e.next=51;break;case 47:e.prev=47,e.t0=e.catch(34),h=!0,y=e.t0;case 51:e.prev=51,e.prev=52,!p&&v.return&&v.return();case 54:if(e.prev=54,h)throw y;e.next=57;break;case 57:return e.finish(54);case 58:return e.finish(51);case 59:f<o.length&&(f=Math.min(f+$,o.length)),e.next=105;break;case 62:if(G!==_e.ConversationAnchorPoints.CONTINUATION){e.next=105;break}if(b=a[0]?a[0].sortNumber:1/0,_=a[a.length-1]?a[a.length-1].sortNumber:0,0!==(w="LOWER"===N?b:_)){e.next=70;break}f-=$,e.next=105;break;case 70:if(x=-1,!o||"function"!=typeof o[J.default]&&!Array.isArray(o))throw new TypeError("Expected content to be iterable, got "+q(o));e.next=73;break;case 73:if(!o||"function"!=typeof o[J.default]&&!Array.isArray(o))throw new TypeError("Expected content to be iterable, got "+H(o));e.next=75;break;case 75:k=!(E=!0),T=void 0,e.prev=78,A=(0,X.default)(o);case 80:if(E=(I=A.next()).done){e.next=91;break}if(O=I.value,f=++x,"HIGHER"===N&&O.sortNumber>w)return e.abrupt("break",91);e.next=86;break;case 86:if("LOWER"===N&&O.sortNumber>=w)return e.abrupt("break",91);e.next=88;break;case 88:E=!0,e.next=80;break;case 91:e.next=97;break;case 93:e.prev=93,e.t1=e.catch(78),k=!0,T=e.t1;case 97:e.prev=97,e.prev=98,!E&&A.return&&A.return();case 100:if(e.prev=100,k)throw T;e.next=103;break;case 103:return e.finish(100);case 104:return e.finish(97);case 105:if(G!==_e.ConversationAnchorPoints.CONVERSATION_END&&(G===_e.ConversationAnchorPoints.CONTINUATION&&"HIGHER"===N?s=(l=f)+$:(f===o.length-1&&(f+=1),l=(s=f)-$)),s=Math.min(s,o.length+1),l=Math.max(l,0),c.push.apply(c,(0,W.default)(o.slice(l,s))),!c||"function"!=typeof c[J.default]&&!Array.isArray(c))throw new TypeError("Expected messagesToAdd to be iterable, got "+q(c));e.next=111;break;case 111:if(!c||"function"!=typeof c[J.default]&&!Array.isArray(c))throw new TypeError("Expected messagesToAdd to be iterable, got "+H(c));e.next=113;break;case 113:for(S=!(j=!0),M=void 0,e.prev=116,R=(0,X.default)(c);!(j=(C=R.next()).done);j=!0)(P=C.value).inTimeline||(P.inTimeline=!0,this.host.models.Message.inject(P),u+=1);e.next=124;break;case 120:e.prev=120,e.t2=e.catch(116),S=!0,M=e.t2;case 124:e.prev=124,e.prev=125,!j&&R.return&&R.return();case 127:if(e.prev=127,S)throw M;e.next=130;break;case 130:return e.finish(127);case 131:return e.finish(124);case 132:return e.abrupt("return",u);case 133:case"end":return e.stop()}},e,this,[[34,47,51,59],[52,,54,58],[78,93,97,105],[98,,100,104],[116,120,124,132],[125,,127,131]])})),function(e){return N.apply(this,arguments)})},{key:"_fetchTimelineCR",value:(G=(0,K.default)(Z.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},j=O.anchorPoint,S=void 0===j?_e.ConversationAnchorPoints.CONVERSATION_END:j,M=O.continuation,R=O.conversation,C=O.fetchAllItems,P=void 0!==C&&C,z=O.markAsDelivered,V=void 0===z||z,G=O.maxItems,N=void 0===G?15:G;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(S!==_e.ConversationAnchorPoints.CONTINUATION&&R.isLive&&(!P&&R.timeline.length>=N||R.lowerContinuation&&0===R.lowerContinuation.itemsEstimate))return e.abrupt("return",0);e.next=2;break;case 2:return S===_e.ConversationAnchorPoints.CONVERSATION_END?this.clearTimeline(R,{emit:!1}):S===_e.ConversationAnchorPoints.FIRST_UNREAD_ITEM&&(R.firstUnreadMessage=null,this.clearTimeline(R,{emit:!1})),e.next=5,this.host.api.conversations.fetchTimeline(t,_e.ConversationAnchorPoints.toServer(S),N,{continuation:M,markAsDelivered:V});case 5:if(n=e.sent,r=n.direction,o=n.higher_continuation,a=n.lower_continuation,i=n.max_items,s=n.timeline,u=R.higherContinuation,c=R.lowerContinuation,l=null,i&&(N=i),!s||"function"!=typeof s[J.default]&&!Array.isArray(s))throw new TypeError("Expected timeline to be iterable, got "+q(s));e.next=16;break;case 16:if(!s||"function"!=typeof s[J.default]&&!Array.isArray(s))throw new TypeError("Expected timeline to be iterable, got "+H(s));e.next=18;break;case 18:for(d=!(f=!0),p=void 0,e.prev=21,h=(0,X.default)(s);!(f=(y=h.next()).done);f=!0)v=y.value,"tigertext:iq:bang"===(g=v.xmlns)?(m=v.bang_id||""+v.sort_number)?this.host.groups.__handleBang({data:v,eventId:m,alwaysAddToTimeline:!0}):this.logger.warn("Skipping bang with no event id"):"tigertext:iq:message"===g||"tigertext:iq:group_message"===g?(v.conversation_id||(v.conversation_id=t),b=this._reactToMessageEventCR({data:v,injectConversation:!1}),(_=b.message).inTimeline=!0,_.isOutgoing||(w={id:_.id+":"+_.counterPartyId,messageId:_.id,status:xe.default.resolve(v.status),userId:this.host.currentUserId},this.host.models.MessageStatusPerRecipient.inject(w)),_.senderStatus=_e.MessageSenderStatus.SENT,x=this.host.models.Message.inject(_),l=l||x):this.logger.warn("Skipping timeline entry with unrecognized xmlns: "+g);e.next=29;break;case 25:e.prev=25,e.t0=e.catch(21),d=!0,p=e.t0;case 29:e.prev=29,e.prev=30,!f&&h.return&&h.return();case 32:if(e.prev=32,d)throw p;e.next=35;break;case 35:return e.finish(32);case 36:return e.finish(29);case 37:if("Higher"!==r&&"Initial"!==r||(E=0===s.length||s.length<N?0:1,S===_e.ConversationAnchorPoints.CONVERSATION_END&&(E=0),1===E&&"Initial"===r&&(k=s[s.length-1],T=R.lastMessage,S===_e.ConversationAnchorPoints.FIRST_UNREAD_ITEM&&l&&!l.isUnread?E=0:T&&k.message_id===T.id&&(E=T.isUnread?1:0)),u={continuation:{higher_continuation:o},itemsEstimate:E}),"Lower"!==r&&"Initial"!==r||(A=0===s.length||s.length<N?0:1,c={continuation:{lower_continuation:a},itemsEstimate:A}),I=s.length,R.isLive=0===u.itemsEstimate,R.higherContinuation=u,R.lowerContinuation=c,this.host.models.Conversation.inject(R),S!==_e.ConversationAnchorPoints.CONTINUATION&&void 0!==R.lowestSortNumber)return e.next=47,this.markAsDelivered(R.id);e.next=47;break;case 47:return e.abrupt("return",I);case 48:case"end":return e.stop()}},e,this,[[21,25,29,37],[30,,32,36]])})),function(e){return G.apply(this,arguments)})},{key:"findAll",value:(V=(0,K.default)(Z.default.mark(function e(){var t,n,r,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(0,ce.default)(o,{includeMutes:!0}),this.config.condensedReplays&&(o.includeMutes=!1),this._fetched)return e.abrupt("return",this.getAll());e.next=4;break;case 4:return e.next=6,$.default.all([this.host.api.roster.findAll(),o.includeMutes?this.host.mute.findAll():$.default.resolve()]);case 6:if(t=e.sent,n=(0,Y.default)(t,1),r=n[0],this.config.condensedReplays)return e.abrupt("return",this._processFindAllCR(r));e.next=13;break;case 13:return e.abrupt("return",this._processFindAll(r));case 14:case"end":return e.stop()}},e,this)})),function(){return V.apply(this,arguments)})},{key:"findAllForOrganization",value:(z=(0,K.default)(Z.default.mark(function e(t){var n;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._resolveModelIdWithTypes(t,"organization"),this.config.condensedReplays){e.next=3;break}throw new be.NotSupportedError("findAllForOrganization() may not be called if this.config.condensedReplays=false");case 3:if(this._fetched)return e.abrupt("return",this.getAllForOrganization(t));e.next=5;break;case 5:return e.next=7,this.host.api.roster.findAll({organizationId:t});case 7:return n=e.sent,e.abrupt("return",this._processFindAllCR(n));case 9:case"end":return e.stop()}},e,this)})),function(e){return z.apply(this,arguments)})},{key:"_processFindAllCR",value:function(e){for(var t=[],n=[],r={counterParty:"full",groupMembers:"full",organization:"placeholder"},o=0;o<e.length;o++){var a=e[o],i=a.entity;if(i){var s=this.host.modelNameByEntityType(i.type);"user"===s?n.push({rawConversation:a,origIndex:o}):s&&t.push({rawConversation:a,origIndex:o})}}if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected users to be iterable, got "+q(n));if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected users to be iterable, got "+H(n));var u=!0,c=!1,l=void 0;try{for(var f,d=(0,X.default)(n);!(u=(f=d.next()).done);u=!0){var p=f.value,h=p.rawConversation,y=p.origIndex;p.conversation=this.__injectConversation(h,{origIndex:y})}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}if(!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected nonUsers to be iterable, got "+q(t));if(!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected nonUsers to be iterable, got "+H(t));var v=!0,g=!1,m=void 0;try{for(var b,_=(0,X.default)(t);!(v=(b=_.next()).done);v=!0){var w=b.value,x=w.rawConversation,E=w.origIndex;w.conversation=this.__injectConversation(x,{hasCurrentUser:!0,origIndex:E})}}catch(e){g=!0,m=e}finally{try{!v&&_.return&&_.return()}finally{if(g)throw m}}for(var k=[];0<t.length||0<n.length;){var T=(0===t.length?n.shift():0===n.length?t.shift():t[0].origIndex<n[0].origIndex?t.shift():n.shift()).conversation;this.__ensureEntities(T,r),k.push(T)}return this._fetched=!0,k}},{key:"_processFindAll",value:function(e){for(var t=[],n=[],r=[],o=0;o<e.length;o++){var a=e[o],i=a,s=i.organization_key,u=i.type,c=(0,B.default)(i,["organization_key","type"]),l=this.host.modelNameByTypeNS(u);if(c.organizationId=s,"user"===(a={entityAttrs:c,entityType:l,organizationId:s,origIndex:o}).entityType)a.counterParty=this.__injectCounterParty(a),r.push(a);else if(a.entityType){if("group"===l&&(a.groupType=this.host.groups.__extractGroupTypeFromAttrs(c)),a.groupType===_e.GroupType.FORUM)delete c.members;else if(a.groupType===_e.GroupType.PATIENT_MESSAGING&&a.entityAttrs&&a.entityAttrs.metadata){var f=a.entityAttrs,d=f.avatar,p=f.display_name,h=f.metadata,y=h.patient_id,v=h.patient_contact_id;this.host.models.User.injectPlaceholder({id:v||y,avatar:d,displayName:p,metadata:h})}n.push(a)}}if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected toProcess to be iterable, got "+q(n));if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected toProcess to be iterable, got "+H(n));var g=!0,m=!1,b=void 0;try{for(var _,w=(0,X.default)(n);!(g=(_=w.next()).done);g=!0){var x=_.value;x.counterParty=this.__injectCounterParty((0,Q.default)({},x,{hasCurrentUser:!0})),t.push(x)}}catch(e){m=!0,b=e}finally{try{!g&&w.return&&w.return()}finally{if(m)throw b}}for(var E=[];0<t.length||0<r.length;){var k=0===t.length?r.shift():0===r.length?t.shift():t[0].origIndex<r[0].origIndex?t.shift():r.shift(),T=k.conversationId,A=k.counterParty,I=k.lastMessage,O=k.muted,j=(s=k.organizationId,k.entityType),S=k.groupType,M="group"===j&&S&&"PATIENT_MESSAGING"===S?_e.Networks.PATIENT:_e.Networks.PROVIDER;delete A.$placeholder;var R=void 0;this.host.config.condensedReplays&&I&&I.sort_number&&(R=I.sort_number);var C=this.ensureConversation(A.$entityType,A.id,s,{conversationId:T,ensureEntities:{counterParty:"full",groupMembers:"full",organization:"placeholder"},highestSortNumber:R,muted:O,network:M});C._counterPartyAddedOnServer=!0,E.push(C)}return this._fetched=!0,E}},{key:"find",value:(P=(0,K.default)(Z.default.mark(function e(t){var n,r,o,a,i,s,u,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));e.next=4;break;case 4:if(c=(0,ue.default)(c,{ensureEntities:{counterParty:"full",escalationExecution:"full",groupMembers:"placeholder",messageCounterParties:"full",organization:"placeholder",touchOnRelatedEntityLoad:!1}}),n=void 0,!this.config.condensedReplays){e.next=19;break}if((n=this.getById(t))&&n.$localOnly){e.next=17;break}return e.next=11,this.host.api.conversations.find(t);case 11:if(r=e.sent){e.next=14;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 14:if(n=this.__injectConversation(r)){e.next=17;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 17:e.next=28;break;case 19:if(a=(o=c).groupId,i=o.organizationId,s=o.includeMutes,u=a&&i?this.getConversationKey("group",a,i):t,n=this.getById(u)){e.next=26;break}return e.next=25,this.findAll({includeMutes:s});case 25:n=this.getById(u);case 26:if(n){e.next=28;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 28:if(c.ensureEntities)return e.next=31,this.__ensureEntities(n,c.ensureEntities);e.next=31;break;case 31:return e.abrupt("return",n);case 32:case"end":return e.stop()}},e,this)})),function(e){return P.apply(this,arguments)})},{key:"__injectConversation",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.hasCurrentUser,r=t.highestSortNumber,o=t.origIndex,a=void 0===o?this.host.models.Conversation.getAll().length:o,i=void 0,s=e.conversation_id,u=e.entity,c=e.first_expiring_unread_message,l=e.in_progress_escalation_count,f=e.last_message,d=e.lowest_sort_number,p=e.muted,h=e.organization_id,y=e.unread_message_count,v=e.unread_priority_message_count,g=this.getById(s);if(g)i=g.counterParty,h=g.organizationId;else{if(h=h||e.organization_key,!p&&u&&u.muted&&(p=u.muted,delete u.muted),u&&(i=this.__injectCounterParty({conversationId:s,entityAttrs:u,entityType:u.$entityType,hasCurrentUser:n,organizationId:h})),!i)return null;delete i.$placeholder,g=g||this.host.models.Conversation.createInstance({id:s,counterParty:i,organizationId:h,_origIndex:a})}var m=i,b=m.id,_=m.$entityType,w=m.groupType;if("group"!==_||w!==_e.GroupType.FORUM||i.hasCurrentUser||(f=null),c?(f&&(f.message_id===c.message_id?c=f:(c.senderId=f.sender_token,c.senderOrganizationId=f.sender_organization)),g.firstExpiringUnreadMessage=this._ensureFirstExpiringUnreadMessage({rawFirstExpiringUnreadMessage:c,conversationId:s,counterParty:i})):null===c&&(g.firstExpiringUnreadMessage=null),void 0!==f){var x=f?this._ensureLastMessage({rawLastMessage:f,conversationId:s,counterParty:i}):null;if(x&&x.isEphemeral){var E=g.lastEphemeralMessage;(!E||x.sortNumber>E.sortNumber)&&(g.lastEphemeralMessage=x)}if(g.lastEphemeralMessage){var k=g.lastEphemeralMessage;(!x||k.sortNumber>x.sortNumber)&&(x=k)}g.lastMessage=x,void 0===r&&f&&f.sort_number&&(r=f.sort_number)}g._counterPartyAddedOnServer=!0,u&&u.metadata&&(g.metadata=u.metadata),void 0!==r&&r>g.highestSortNumber&&(g.highestSortNumber=r),void 0!==d&&0!==d&&(g.lowestSortNumber=d),void 0!==l&&(g.inProgressEscalationCount=l),void 0!==p&&(g.muted=p),g._markingAsRead&&(void 0===r||r<=g._markingAsReadSortNumber)||(void 0!==y&&(g.unreadCount=y),void 0!==v&&(g.unreadPriorityCount=v)),this.host.models.Conversation.inject(g);var T=this.getConversationKey(_,b,h);return this._convByConvHandle[T]=g}},{key:"refetch",value:(C=(0,K.default)(Z.default.mark(function e(){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._fetched=!1,e.abrupt("return",this.findAll());case 2:case"end":return e.stop()}},e,this)})),function(){return C.apply(this,arguments)})},{key:"_ensureLastMessage",value:function(e){var t=e.rawLastMessage,n=e.conversationId,r=e.counterParty,o=t.message_id,a=(0,B.default)(t,["message_id"]);if(!o)return null;var i=this.host.messages.getById(o);return i?(i.shouldEnsureRecipientStatus=!0,i.senderStatus=_e.MessageSenderStatus.SENT,this.host.models.Message.inject(i)):(a.senderStatus=_e.MessageSenderStatus.SENT,a.id=o,a.shouldEnsureRecipientStatus=!0,a.conversationId=n,a.counterParty=r,i=this.host.models.Message.injectPlaceholder(a)),i}},{key:"_ensureFirstExpiringUnreadMessage",value:function(e){var t=e.rawFirstExpiringUnreadMessage,n=e.conversationId,r=e.counterParty,o=t.expire_in,a=t.message_id,i=(0,B.default)(t,["expire_in","message_id"]);if(a){var s=this.host.messages.getById(a);return s?(s.shouldEnsureRecipientStatus=!0,s.expireIn=o,this.host.models.Message.inject(s)):(i.id=a,i.shouldEnsureRecipientStatus=!0,i.expireIn=o,i.conversationId=n,i.counterParty=r,s=this.host.models.Message.injectPlaceholder(i)),s}return null}},{key:"markAsDelivered",value:(R=(0,K.default)(Z.default.mark(function e(t){var n,r,o;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));case 4:if(n=this._resolveEntity(t,"conversation")){e.next=7;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 7:if(t=this._resolveModelId(t),this.config.condensedReplays)return r=n.highestSortNumber,o=n.lowestSortNumber,e.prev=10,e.next=13,this.host.api.conversations.updateConversationStatus(t,je,{highestSortNumber:r,lowestSortNumber:o});e.next=22;break;case 13:n.lowestSortNumber=null,e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),this.logger.warn("failed to mark conversation "+t+" as delivered");case 19:this.host.models.Conversation.inject(n),e.next=23;break;case 22:return e.abrupt("return",this.host.messages.markAsDelivered(n.messages));case 23:case"end":return e.stop()}},e,this,[[10,16]])})),function(e){return R.apply(this,arguments)})},{key:"markAsRead",value:(M=(0,K.default)(Z.default.mark(function e(t){var n,r,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));case 4:if(n=this._resolveEntity(t,"conversation")){e.next=7;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 7:if(t=this._resolveModelId(t),!this.config.condensedReplays){e.next=29;break}if(r=n.highestSortNumber,o=n.unreadCount,n._markingAsRead){e.next=17;break}if(0===o)return e.abrupt("return");e.next=13;break;case 13:n._markingAsRead=!0,n._markingAsReadSortNumber=r,n._markingAsReadExpiration=(new Date).getTime()+3e4,this.__reloadConversation(n);case 17:if(a.localOnly)return e.abrupt("return");e.next=19;break;case 19:return e.prev=19,e.next=22,this.host.api.conversations.updateConversationStatus(t,Ve,{highestSortNumber:r});case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(19),this.logger.warn("failed to mark conversation "+t+" as read");case 27:e.next=30;break;case 29:return e.abrupt("return",this.host.messages.markAsRead(n.markableAsReadMessages,a));case 30:case"end":return e.stop()}},e,this,[[19,24]])})),function(e){return M.apply(this,arguments)})},{key:"add",value:(S=(0,K.default)(Z.default.mark(function e(t,n,r){var o;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(r));e.next=12;break;case 12:return o=this.ensureConversation(t,n,r),e.prev=13,e.next=16,this.host.api.roster.add(t,n,r);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(13),this.logger.warn("can't add "+n+" "+t,e.t0);case 21:o._counterPartyAddedOnServer=!0;case 22:case"end":return e.stop()}},e,this,[[13,18]])})),function(e,t,n){return S.apply(this,arguments)})},{key:"remove",value:(j=(0,K.default)(Z.default.mark(function e(t){var n,r,o,a;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));case 4:if(t=this._resolveModelId(t),n=this._resolveEntity(t,"conversation")){e.next=8;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 8:return r=n.counterPartyId,o=n.counterPartyType,a=n.organizationId,e.prev=9,e.next=12,this.host.api.roster.remove(o,r,a);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),this.logger.warn("can't remove conversation "+t);case 17:case"end":return e.stop()}},e,this,[[9,14]])})),function(e){return j.apply(this,arguments)})},{key:"ensureConversation",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(n));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(n));var o=(r=(0,ue.default)(r,{ensureEntities:{counterParty:!1,organization:!1,messageCounterParties:!1,groupMembers:!1,touchOnRelatedEntityLoad:!0}})).conversationId,a=this.getConversationKey(e,t,n);if(this.config.condensedReplays&&!o){var i=this._convByConvHandle[a];i&&(o=i.id)}o=o||a;var s=this.getById(o);if(s){this.__ensureEntities(s,r.ensureEntities);var u=!1;return this.config.condensedReplays&&void 0!==r.highestSortNumber&&(s.highestSortNumber=r.highestSortNumber,u=!0),this.config.condensedReplays&&void 0!==r.muted&&(s.muted=r.muted,u=!0),this._convByConvHandle[a]=s,u&&this.host.models.Conversation.inject(s),s}var c={id:o,counterPartyType:e,counterPartyId:t,organizationId:n,_origIndex:this.host.models.Conversation.getAll().length};r.highestSortNumber&&(c.highestSortNumber=r.highestSortNumber),r.muted&&(c.muted=r.muted),r.network&&(c.network=r.network);var l=this.host.models.Group.get(t);l&&l.groupType===_e.GroupType.PATIENT_MESSAGING&&(c.network=_e.Networks.PATIENT);var f=this.host.metadata.get(t,n);if(f){var d=f.data;c.metadata=d}return s=this.host.models.Conversation.createInstance(c),this.__ensureEntities(s,r.ensureEntities),this.host.models.Conversation.inject(s),this._convByConvHandle[a]=s}},{key:"__ejectConversation",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof e)throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));var t=this.getById(e);if(t){var n=t.counterPartyType,r=t.counterPartyId,o=t.organizationId,a=this.getConversationKey(n,r,o);delete this._convByConvHandle[a],this.host.models.Conversation.eject(t),this.__queuedConversationsToReload=this.__queuedConversationsToReload.filter(function(e){return e.id!==t.id})}return t}},{key:"reactToMessageEvent",value:function(e){var t=e.data;if(this.config.condensedReplays)this.reactToMessageEventCR({data:t});else{var n=this._reactToMessageEvent({data:t}),r=n.message,o=n.conversation;this.host.models.Message.inject(r),this.emit("message",r),o&&(this.__addConversationCounterPartyToServerRosterIfShould(o),o.emit("message",r),this.config.condensedReplays&&o._markingAsRead&&r.sortNumber>o._markingAsReadSortNumber&&this.__clearOptimisticStatus([o])),we.MESSAGE_STATUS_ORDER[r.markedRecipientStatus]<we.MESSAGE_STATUS_ORDER[xe.default.DELIVERED]&&this.host.messages.markAsReceived(r,{})}}},{key:"reactToMessageEventCR",value:function(e){var t=e.data,n={},r=this._reactToMessageEventCR({data:t}),o=r.message,a=r.conversation;this.emit("message",o),a&&(this.__addConversationCounterPartyToServerRosterIfShould(a),a.emit("message",o)),n.queue=!0,this.host.messages.markAsReceived(o,n)}},{key:"_reactToMessageEvent",value:function(e){var t=e.data,n=e.conversationId,r=void 0===n?null:n;t=(0,Ee.jsonCloneDeep)(t);var o=this.host.currentUserId,a=t.recipient_status;a=a||[];var i={status:t.status,timestamp:t.created_time};t.team_request&&this.host.teams.__injectTeamRequest(t.team_request);var s=this.host.models.Message.parseAttrs(t);s.messageType=_e.MessageType.USER_SENT;var u=!0;if(s.groupId)s.counterPartyType="group",s.counterPartyId=s.groupId;else if(s.recipientId){if(this.host.distributionLists.getById(s.recipientId))s.counterPartyType="distributionList";else if(this.host.users.getById(s.recipientId))s.counterPartyType="user";else{u=!1;var c=this.host.messages._looksLikeDistributionListMessage(s);s.counterPartyType=c?"distributionList":"user"}s.counterPartyId="distributionList"===s.counterPartyType||s.senderId===o?s.recipientId:s.senderId}var l=this.host.messages._isMessageOutgoing(s);"distributionList"!==s.counterPartyType&&(i.account_id=l?s.recipientId:this.host.currentUserId,i.account_id&&a.push(i)),s.senderStatus=_e.MessageSenderStatus.SENT;var f=u&&this.ensureConversation(s.counterPartyType,s.counterPartyId,s.recipientOrganizationId,{conversationId:r,ensureEntities:{counterParty:"placeholder",groupMembers:"placeholder",organization:"placeholder"}});s.conversationId=f?f.id:null;var d=this.host.models.Message.get(s.id);if(d){var p=s.body,h=s.escalationExecutionId,y=s.isForwardedFromPatientNetwork,v=s.originalSender,g=s.patientDetails,m=s.priority,b=s.sortNumber,_=s.sortSeries;d.body=p,d.escalationExecutionId=h||null,d.isForwardedFromPatientNetwork=y,d.originalSender=v,d.patientDetails=g,d.priority=m,d.shouldEscalate=!1,d.sortNumber=b,d.sortSeries=_}else d=this.host.models.Message.createInstance(s,!1);var w=d.senderId===o?d.recipientId:d.senderId;if(w&&"distributionList"!==d.counterPartyType&&this.__ensureMessageCounterParty(f,w,{messageCounterParties:this.host.currentlyServingOfflineMessages?"placeholder":"full",touchOnRelatedEntityLoad:!0}),!a||"function"!=typeof a[J.default]&&!Array.isArray(a))throw new TypeError("Expected recipientStatuses to be iterable, got "+q(a));if(!a||"function"!=typeof a[J.default]&&!Array.isArray(a))throw new TypeError("Expected recipientStatuses to be iterable, got "+H(a));var x=!0,E=!1,k=void 0;try{for(var T,A=(0,X.default)(a);!(x=(T=A.next()).done);x=!0){var I=T.value;this.config.condensedReplays||this.host.messages.__injectMessageStatus(d,I)}}catch(e){E=!0,k=e}finally{try{!x&&A.return&&A.return()}finally{if(E)throw k}}return"group"!==s.counterPartyType&&!this.config.condensedReplays||(d.shouldEnsureRecipientStatus=!0),d.inTimeline=!(!f||!f.isLive),{message:d,conversation:f}}},{key:"_reactToMessageEventCR",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=void 0===t?{}:t,r=e.injectConversation,o=void 0===r||r;n=(0,Ee.jsonCloneDeep)(n);var a=this.host.currentUserId,i=n,s=i.first_expiring_unread_message,u=i.last_message,c=(i.type,i.unread_message_count),l=i.unread_priority_message_count,f=(i.xmlns,(0,B.default)(i,["first_expiring_unread_message","last_message","type","unread_message_count","unread_priority_message_count","xmlns"])),d=void 0;f.team_request&&this.host.teams.__injectTeamRequest(f.team_request),u&&(u.conversation_id=f.conversation_id,d=u.sort_number,u.is_group&&!u.group_token&&(u.group_token=u.recipient_token),u.message_id===f.client_id&&(f.attachmentName=u.attachment_name)),f.is_group&&!f.group_token&&(f.group_token=f.recipient_token);var p=this.host.models.Message.parseAttrs(f);if(p.messageType=_e.MessageType.USER_SENT,p.groupId)p.counterPartyType="group",p.counterPartyId=p.groupId;else if(p.recipientId){if(this.host.distributionLists.getById(p.recipientId))p.counterPartyType="distributionList";else if(this.host.users.getById(p.recipientId))p.counterPartyType="user";else{var h=this.host.messages._looksLikeDistributionListMessage(p);p.counterPartyType=h?"distributionList":"user"}p.counterPartyId="distributionList"===p.counterPartyType||p.senderId===a?p.recipientId:p.senderId}p.senderStatus=_e.MessageSenderStatus.SENT;var y=this.host.models.Message.get(p.id);y?this.host.models.Message.inject((0,Q.default)({shouldEscalate:!1},p)):y=this.host.models.Message.inject(p);var v=void 0;if(o){var g={conversation_id:y.conversationId,entity:this._resolveEntity(p.counterPartyId,p.counterPartyType),first_expiring_unread_message:s,last_message:u,organization_id:y.__organizationId,unread_message_count:c,unread_priority_message_count:l};if(u&&u.sort_number<y.sortNumber?(d=y.sortNumber,g.last_message={message_id:y.id},(v=this.__injectConversation(g,{highestSortNumber:d}))&&this._ensureLastMessage({rawLastMessage:u,conversationId:v.id,counterParty:v.counterParty})):v=this.__injectConversation(g,{highestSortNumber:d}),u&&u.message_id&&v&&v.isLive){var m=this.host.models.Message.get(u.message_id);m&&!m.inTimeline&&(m.inTimeline=!0,this.host.models.Message.inject(m))}}else v=this.host.conversations.getById(f.conversation_id);var b=y.senderId===a?y.recipientId:y.senderId,_="group"!==y.counterPartyType||y.counterParty&&"FORUM"===y.counterParty.groupType;return b&&"distributionList"!==y.counterPartyType&&_&&this.__ensureMessageCounterParty(v,b,{messageCounterParties:this.host.currentlyServingOfflineMessages?"placeholder":"full",touchOnRelatedEntityLoad:!0}),y.inTimeline=!!y.isEphemeral||!(!v||!v.isLive),y.shouldEnsureRecipientStatus=!0,this.host.models.Message.inject(y),{conversation:v,message:y}}},{key:"reactToFriendsEventCR",value:function(e){var t=e.data,n=e.eventId,r=t=(0,Ee.jsonCloneDeep)(t),o=r.action,a=(r.xmlns,(0,B.default)(r,["action","xmlns"])),i=a.entity,s=a.organization_id||a.organization_key,u=i.metadata,c=i.id||i.token;if(i.type){var l=this.host.modelNameByEntityType(i.type);if(u&&"patient_messaging"===u.feature_service&&"string"==typeof u.is_patient_contact&&(u.is_patient_contact="true"===u.is_patient_contact),i.organizationId=s,"group"===l&&u&&"role"===u.feature_service&&"role_assignment"===u.meta_type)return void(this._rolesFriendsEventPromise=this.host.roles.reactToFriendsEventCR({action:o,attrs:i,id:n}));var f=a.conversation_id,d=a.last_message,p=a.lowest_sort_number,h=this.getById(f);if("add"===o||"update"===o){h&&"update"===o&&this.clearMessageStatuses(h);var y=d&&d.sort_number?d.sort_number:void 0,v=!1,g=(0,se.default)(t,"entity.is_public")||(0,se.default)(t,"entity.metadata.team");if((void 0===y||g)&&"add"===o)if("group"===l){if(i.proxied_members&&i.proxied_members[this.host.currentUserId]){var m=this.host.models.Product.getAll()[0];if(!(k=i.proxied_members[this.host.currentUserId])||"function"!=typeof k[J.default]&&!Array.isArray(k))throw new TypeError("Expected _entityAttrs$proxied_ to be iterable, got "+q(k));if(!k||"function"!=typeof k[J.default]&&!Array.isArray(k))throw new TypeError("Expected _entityAttrs$proxied_ to be iterable, got "+H(k));var b=!0,_=!1,w=void 0;try{for(var x,E=(0,X.default)(k);!(b=(x=E.next()).done);b=!0){var k,T=x.value;if(m.rolesOptingIn.includes(T.token)){v=!0;break}}}catch(e){_=!0,w=e}finally{try{!b&&E.return&&E.return()}finally{if(_)throw w}}}y=v?1:this.host.messages.__getNextSortNumber(s)}else y=h?h.highestSortNumber:1;var A=h&&h.lastMessage;if("add"===o){var I="group"===l&&this.host.groups.__extractGroupTypeFromAttrs(i);I!==_e.GroupType.GROUP&&I!==_e.GroupType.FORUM||(i.members=null),this.__injectCounterParty({entityAttrs:i,entityType:l,groupType:I,hasCurrentUser:!0,isPlaceholder:!0,organizationId:s}),h=this.__injectConversation(a,{highestSortNumber:y}),A&&!d&&this.find(f),this.clearTimeline(h)}else"update"===o&&(h=this.__injectConversation(a,{highestSortNumber:y}),A&&!d&&this.find(f));p&&this.markAsDelivered(h)}else"del"===o?this.__removeFriend({attrs:i,entityType:l,id:c,organizationId:s}):this.logger.error("friends action not implemented",o,t);h&&this.__clearOptimisticStatus([h]),this.emit("friends",(0,Q.default)({action:o},i))}}},{key:"reactToFriendsEvent",value:function(e){var t=e.data,n=e.id;if(this.config.condensedReplays)this.reactToFriendsEventCR({data:t,eventId:n});else{var r=(t=(0,Ee.jsonCloneDeep)(t)).friend,o=r.action,a=r.organization_id,i=(0,B.default)(r,["action","organization_id"]),s=i.metadata,u=i.token,c=this.host.modelNameByTypeNS(i.xmlns);if(c){if("group"===c&&s&&"role"===s.feature_service&&"role_assignment"===s.meta_type)return void(this._rolesFriendsEventPromise=this.host.roles.reactToFriendsEvent({data:t,id:n}));if("add"===o){var l="group"===c&&this.host.groups.__extractGroupTypeFromAttrs(i);l!==_e.GroupType.GROUP&&l!==_e.GroupType.FORUM||(i.members=null);var f=l===_e.GroupType.PATIENT_MESSAGING?"PATIENT":"PROVIDER";this.__injectCounterParty({entityAttrs:i,entityType:c,groupType:l,hasCurrentUser:!0,isPlaceholder:!0,organizationId:a});var d="group"===c?this.host.messages.__getNextSortNumber(a):1;this.ensureConversation(c,u,a,{highestSortNumber:d,network:f})}else"del"===o?this.__removeFriend({attrs:i,entityType:c,id:u,organizationId:a}):this.logger.error("friends action not implemented",o,t);this.emit("friends",(0,Q.default)({action:o},i))}}}},{key:"reactToUpdateTeamRequestEvent",value:function(e){var t=e.data,n=(t=(0,Ee.jsonCloneDeep)(t)).team_request;n&&this.host.teams.__injectTeamRequest(n)}},{key:"reactToUpdateEventCR",value:function(e){var t=e.data,n=t=(0,Ee.jsonCloneDeep)(t),r=n.entity,o=n.organization_id,a=r.metadata,i=r.token,s=r.type;r.organizationId=o,this._sanitizeGroupAttrs(r);var u=this.host.modelNameByEntityType(s),c=this.host.groups.__extractGroupTypeFromAttrs(r);if(a&&o&&i&&Me.includes(c)&&this.host.metadata.__injectMetadata(i,o,a),a&&a.feature_service&&"role"===a.feature_service){if("group"===u&&a.target_id)return this.__injectTargetEntity(a,o);this.host.roles.reactToUpdateEventCR({entity:r})}this.host.injectModel(r,s)}},{key:"reactToUpdateEvent",value:function(e){var t=e.data;if(this.config.condensedReplays)this.reactToUpdateEventCR({data:t});else{var n=t=(0,Ee.jsonCloneDeep)(t),r=n.metadata,o=n.organization_key,a=n.token,i=n.type;this._sanitizeGroupAttrs(t);var s=this.host.modelNameByTypeNS(i),u=this.host.groups.__extractGroupTypeFromAttrs(t);if(r&&o&&a&&Me.includes(u)&&this.host.metadata.__injectMetadata(a,o,r),r&&r.feature_service&&"role"===r.feature_service){if("group"===s&&r.target_id)return this.__injectTargetEntity(r,o);this.host.roles.reactToUpdateEvent({data:t})}var c=t,l=(0,B.default)(c,[]);this.host.injectModel(l,i)}}},{key:"__queueReload",value:function(e){this.__queuedConversationsToReload.includes(e)||this.__queuedConversationsToReload.push(e),this.__flushConversationsToReload()}},{key:"hasPendingReloads",value:function(){return this.__queuedConversationsToReload&&0<this.__queuedConversationsToReload.length}},{key:"__updateTimeline",value:function(e){var t=e.content,n=e.timeline;if(n.length=0,!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected content to be iterable, got "+q(t));if(!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected content to be iterable, got "+H(t));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,X.default)(t);!(r=(i=s.next()).done);r=!0){var u=i.value;u.inTimeline&&n.push(u)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}this.host.models.Conversation.inject(e)}},{key:"__reloadConversation",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).notify,n=void 0===t||t;if(this.config.condensedReplays)return this.__reloadConversationCR(e);var r=e.content,o=e.higherContinuation,a=e.lowerContinuation,i=e.markableAsReadMessages,s=e.messages,u=e.timeline,c=[],l=[],f=0,d=null,p=null,h=null;i.length=0,s.length=0,u.length=0;var y=-1;if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected content to be iterable, got "+q(r));if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected content to be iterable, got "+H(r));var v=!0,g=!1,m=void 0;try{for(var b,_=(0,X.default)(r);!(v=(b=_.next()).done);v=!0){var w=b.value;y++;var x=w.escalationExecution,E=w.inTimeline,k=w.isOutgoing,T=w.isUnread,A=w.markedRecipientStatus,I=w.messageType,O=w.priority;E&&(null===d&&(d=y),p=y,u.push(w)),I===_e.MessageType.USER_SENT?(s.push(w),k||!T||h||(h=w),x&&"IN_PROGRESS"===x.status&&f++,ze.includes(A)&&i.push(w),k||(T&&(c.push(w),O===_e.MessagePriority.HIGH&&l.push(w)),e.lastIncomingMessageSortNumber=w.sortNumber)):Oe.includes(I)&&(e.lastBangMessageSortNumber=w.sortNumber)}}catch(e){g=!0,m=e}finally{try{!v&&_.return&&_.return()}finally{if(g)throw m}}a.itemsEstimate=d,o.itemsEstimate=null===p?null:r.length-1-p,e.isLive=0===o.itemsEstimate||0===r.length;var j=0<s.length?s[s.length-1]:null,S=j||(0,ie.default)(r.filter(function(e){return e.messageType===_e.MessageType.GROUP_MEMBERSHIP_CHANGE&&e.groupMembersChange&&"ADD"===e.groupMembersChange.action}));if(e.firstUnreadMessage=h,e.inProgressEscalationCount=f,e.lastMessage=j,e.unreadCount=c.length,e.unreadPriorityCount=l.length,e.highestSortNumber=S&&S.sortNumber||e.lastConversationSortNumber||0,n){var M=e.counterPartyType,R=e.counterPartyId,C=e.organizationId,P=this.getConversationKey(M,R,C);this._convByConvHandle[P]=e,this.host.models.Conversation.inject(e)}}},{key:"__reloadConversationCR",value:function(e){var t=e._markingAsRead,n=e._markingAsReadSortNumber,r=e.content,o=e.higherContinuation,a=e.messages,i=e.timeline,s=[],u=[],c=null;if(a.length=0,i.length=0,!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected content to be iterable, got "+q(r));if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected content to be iterable, got "+H(r));var l=!0,f=!1,d=void 0;try{for(var p,h=(0,X.default)(r);!(l=(p=h.next()).done);l=!0){var y=p.value,v=y.inTimeline,g=y.isOutgoing,m=y.isUnread,b=y.messageType,_=y.priority,w=y.sortNumber;v&&i.push(y),b===_e.MessageType.USER_SENT?(a.push(y),!g&&m&&(c=c||y,t&&w<=n||(s.push(y),_===_e.MessagePriority.HIGH&&u.push(y)))):Oe.includes(b)&&(e.lastBangMessageSortNumber=y.sortNumber)}}catch(e){f=!0,d=e}finally{try{!l&&h.return&&h.return()}finally{if(f)throw d}}e.firstUnreadMessage=c,e.highestSortNumber=e.highestSortNumber||0,e.isLive=0===o.itemsEstimate||0===r.length,t&&(e.unreadCount=s.length,e.unreadPriorityCount=u.length);var x=e.counterPartyType,E=e.counterPartyId,k=e.organizationId,T=this.getConversationKey(x,E,k);this._convByConvHandle[T]=e,this.host.models.Conversation.inject(e)}},{key:"__addConversationCounterPartyToServerRosterIfShould",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(e));if(!(e instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(e));if(e&&!e._counterPartyAddedOnServer){var t=e.organization;t&&!t.$placeholder&&this.add(e.counterPartyType,e.counterPartyId,e.organizationId)}}},{key:"addMembershipChangeLog",value:function(e){var t,n=e.action,r=e.actionTime,o=e.actor,a=e.alwaysAddToTimeline,i=e.createdAt,s=e.group,u=e.id,c=e.memberIds,l=e.members,f=e.removedFromGroup,d=void 0!==f&&f,p=e.sortNumber,h=o.id,y=s.id,v=s.organizationId,g=this.host.currentUser,m=this.get("group",y,v),b=void 0;if(this.config.condensedReplays){if(!m)return;b=m.id}else b=this.getConversationKey("group",y,v);t=!!a||!d&&!!m&&m.isLive;var _=this.host.models.GroupMembersChange.inject({id:"groupMembersChange:"+u,action:n,actionTime:r,actor:o,memberIds:c,members:l});this.host.models.Message.inject({body:this.__generateGroupMembershipChangeBody(e),conversationId:b,counterPartyId:y,counterPartyType:"group",createdAt:i,groupId:y,groupMembersChange:_,id:"bang:"+u,inTimeline:t,isOutgoing:!1,messageType:_e.MessageType.GROUP_MEMBERSHIP_CHANGE,recipient:g,senderId:h,sortNumber:p}),"OPT_IN"!==n&&"OPT_OUT"!==n||this.host.roles.refresh(v)}},{key:"__generateGroupMembershipChangeBody",value:function(e){var t,n=this,r=e.action,o=e.actor,a=e.group,i=e.members,s=a.groupType,u=Re[r]||Ge[r],c=o.id===this.host.currentUserId?"You":o.displayName,l=Ce[r]||"",f=null;return(r in Ce||r in Ge)&&(f=(t=(t=i.map(function(e,t){return[e.id===n.host.currentUserId?"You":e.displayName,(t===i.length-2?" and":",")+" "]}),fe.default).call(t),de.default).call(t).join("")),r in Ge?[f,u,c].filter(Boolean).join(" "):[c,u,f,l,"this",Pe[s]].filter(Boolean).join(" ")}},{key:"addCallChangeLog",value:function(e){var t=e.caller,n=e.callee.id,r=e.conversationId,o=e.createdAt,a=e.duration,i=e.group.id,s=e.id,u=e.organizationId,c=e.sortNumber,l=e.userStartTime,f=this.config.condensedReplays?r:this.getConversationKey("group",i,u),d=l?(0,ve.default)(l).format("h:mm A"):"",p=t.id===this.host.currentUser.id;this.host.models.Message.inject({body:(p?"Outgoing":"Incoming")+" Video Call "+d+" ("+(0,Ae.secondsToDurationFormat)(a)+")",conversationId:f,counterPartyId:n,counterPartyType:"group",createdAt:o,groupId:n,id:"bang:"+s,inTimeline:!0,isOutgoing:!1,messageType:_e.MessageType.CALL_CHANGE,recipient:this.host.currentUser,senderId:t?t.id:null,sortNumber:c})}},{key:"addEscalationExecutionChangeLog",value:function(e){var t,n=e.action,r=e.actionTime,o=e.actor,a=e.alwaysAddToTimeline,i=e.createdAt,s=e.escalationExecution,u=e.group,c=e.members,l=e.id,f=e.sortNumber,d=u.id,p=u.organizationId,h=this.host.currentUser,y=this.get("group",d,p),v=y?y.id:null;if(!y){if(this.config.condensedReplays)return;v=this.getConversationKey("group",d,p)}t=!!a||!!y&&y.isLive;var g=this.host.models.EscalationExecutionChange.inject({id:"escalationExecutionChange:"+l,action:n,actionTime:r,actor:o,members:c});this.host.models.Message.inject({body:this.__generateGroupEscalationChangeBody(e,s),conversationId:v,counterPartyId:d,counterPartyType:"group",createdAt:i,escalationExecutionChange:g,escalationExecutionId:s?s.id:null,groupId:d,id:"bang:"+l,inTimeline:t,isOutgoing:!1,messageType:_e.MessageType.ESCALATION_EXECUTION_CHANGE,recipient:h,senderId:o?o.id:null,sortNumber:f})}},{key:"__generateGroupEscalationChangeBody",value:function(e,t){var n=e.action,r=e.actor,o=e.members,a=Se[n],i=t&&t.displayId||"";return i.startsWith("#")&&(i=i.slice(1,i.length)),""!==i&&(i+=" "),n===_e.EscalationChangeAction.MEMBER_ADDED?a+" "+o[0].displayName+" to this escalation":n!==_e.EscalationChangeAction.INITIATED&&r&&r.displayName?"Escalation "+i+a+" by "+r.displayName:"Escalation "+i+a}},{key:"getMessageConversationKey",value:function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(e));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(e));if(e.groupId)return this.conversationHashForListEntityId(e.groupId);if(e.distributionListId)return this.conversationHashForListEntityId(e.distributionListId);var t=e.senderId===this.host.currentUserId?e.recipientId:e.senderId;return this.conversationHashForUserMessage(t,e.senderOrganizationId,e.recipientOrganizationId)}},{key:"getConversationKey",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:n;if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+H(n));if(null!=r&&"string"!=typeof r)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+H(r));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+q(n));if(null!=r&&"string"!=typeof r)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+q(r));switch(e){case"user":return this.conversationHashForUserMessage(t,n,r);case"distributionList":case"group":case"team":return this.conversationHashForListEntityId(t);default:throw new Error("type "+e+" not supported in conversation")}}},{key:"conversationHashForUserMessage",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t;if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof t)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+H(n));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));if("string"!=typeof t)throw new TypeError('Value of argument "senderOrganizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "recipientOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+q(n));var r=[e,t,n].join(":");return Ie.b64(r)}},{key:"conversationHashForListEntityId",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));return Ie.b64(e)}},{key:"conversationHashForGroupId",value:function(){return this.conversationHashForListEntityId.apply(this,arguments)}},{key:"conversationHashForDistributionListId",value:function(){return this.conversationHashForListEntityId.apply(this,arguments)}},{key:"looksLikeConversationHandle",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));return/^[a-zA-Z0-9\/+=]{24}$/.test(e)}},{key:"findConversationWithUser",value:(O=(0,K.default)(Z.default.mark(function e(t,n){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(n));e.next=8;break;case 8:return e.abrupt("return",this.get(this.host.models.User.name,t,n));case 9:case"end":return e.stop()}},e,this)})),function(e,t){return O.apply(this,arguments)})},{key:"findConversationWithGroup",value:(I=(0,K.default)(Z.default.mark(function e(t,n){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(n));e.next=8;break;case 8:return e.abrupt("return",this.get(this.host.models.Group.name,t,n));case 9:case"end":return e.stop()}},e,this)})),function(e,t){return I.apply(this,arguments)})},{key:"findAllGroupConversationsWithMembers",value:(A=(0,K.default)(Z.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},p=d.exact,h=void 0===p||p,y=d.includeCurrentUser,v=void 0===y||y,g=d.includeForums,m=void 0===g||g,b=d.includeRoles,_=void 0===b||b,w=d.localOnly,x=void 0!==w&&w,E=d.senderId,k=void 0===E?null:E;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+H(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(n));e.next=4;break;case 4:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=6;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+q(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(n));e.next=8;break;case 8:return e.next=10,this.resolveMembers((0,Ee.arrayWrap)(t));case 10:return t=(t=e.sent).map(this._resolveModelId),e.next=14,this.host.groups.findAllWithSpecificMembers(t,n,{exact:h,includeCurrentUser:v,includeForums:m,includeRoles:_,localOnly:x,senderId:k});case 14:if(r=e.sent,o=[],!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected groups to be iterable, got "+q(r));e.next=18;break;case 18:if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected groups to be iterable, got "+H(r));e.next=20;break;case 20:for(i=!(a=!0),s=void 0,e.prev=23,u=(0,X.default)(r);!(a=(c=u.next()).done);a=!0)l=c.value,(f=this.get(this.host.models.Group.name,l.id,n))&&o.push(f);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),i=!0,s=e.t0;case 31:e.prev=31,e.prev=32,!a&&u.return&&u.return();case 34:if(e.prev=34,i)throw s;e.next=37;break;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",o);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])})),function(e,t){return A.apply(this,arguments)})},{key:"findLocalRoleP2PConversation",value:function(e,t){var n=void 0,r=void 0;e=this.host.roles.__resolveRoleId(e),t=this.host.roles.__resolveRoleId(t);var o=this.host.models.User.get(e),a=this.host.models.User.get(t);if(a&&a.isRoleBot&&a.botRole)r=this.host.roles._roleP2PConversations[t];else{if(!(o&&o.isRoleBot&&o.botRole))return null;r=this.host.roles._roleP2PConversations[e]}if(r){if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected roleP2PConversations to be iterable, got "+q(r));if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected roleP2PConversations to be iterable, got "+H(r));var i=!0,s=!1,u=void 0;try{for(var c,l=(0,X.default)(r);!(i=(c=l.next()).done);i=!0){var f=c.value,d=f.$lastModified,p=f.counterParty,h=p.p2pRecipient,y=p.p2pSender;if(h&&y){var v=this.host.roles.__resolveRoleId(h.id),g=this.host.roles.__resolveRoleId(y.id);(v===e&&g===t||v===t&&g===e)&&(!n||n.$lastModified<d)&&(n=f)}}}catch(e){s=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw u}}}return n}},{key:"resolveMembers",value:(T=(0,K.default)(Z.default.mark(function e(t){var r=this;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.default.all(t.map(function(){var t=(0,K.default)(Z.default.mark(function e(t){var n;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,ke.isEmail)(t)||(0,Te.isPhone)(t))return e.prev=1,e.next=4,r.host.users.find(t);e.next=11;break;case 4:return n=e.sent,e.abrupt("return",n.id);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",t);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}},e,r,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return T.apply(this,arguments)})},{key:"selectConversation",value:(k=(0,K.default)(Z.default.mark(function e(t){var n,r,o,a,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=i.anchorPoint,u=void 0===s?_e.ConversationAnchorPoints.CONVERSATION_END:s,c=i.fetchAllItems,l=void 0!==c&&c,f=i.markAsDelivered,d=void 0===f||f,p=i.markAsRead,h=void 0===p||p,y=i.maxItemsPerBatch,v=i.minItemsToFetch,g=void 0===v?20:v;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));case 4:if(t=this._resolveModelId(t),n=this._resolveEntity(t,"conversation")){e.next=8;break}throw new be.NotFoundError(this.host.models.Conversation.name,t);case 8:if(u===_e.ConversationAnchorPoints.CONTINUATION)throw new Error("Cannot call selectConversation() with anchorPoint='CONTINUATION'");e.next=10;break;case 10:if(this.config.condensedReplays)return e.next=13,this._selectConversationCR(t,{anchorPoint:u,conversation:n,fetchAllItems:l,markAsDelivered:d,markAsRead:h,maxItemsPerBatch:y,minItemsToFetch:g});e.next=15;break;case 13:return r=e.sent,e.abrupt("return",r);case 15:return o=0,e.next=18,this.fetchTimeline(t,{anchorPoint:u,markAsDelivered:d,maxItems:g});case 18:return o+=e.sent,0<n.markableAsReadMessages.length?n.firstUnreadMessage=n.markableAsReadMessages[0]:n.firstUnreadMessage=null,a=n.firstUnreadMessage,h&&0<n.unreadCount&&this.markAsRead(t,{localOnly:!0}),e.next=24,this._fetchContinuations(t,{addedMessages:o,conversation:n,fetchAllItems:l,markAsDelivered:d,minItemsToFetch:g});case 24:return o=e.sent,h&&this.markAsRead(t),e.abrupt("return",{addedMessages:o,previousFirstUnreadMessage:a});case 27:case"end":return e.stop()}},e,this)})),function(e){return k.apply(this,arguments)})},{key:"_selectConversationCR",value:(E=(0,K.default)(Z.default.mark(function e(t,n){var r,o,a,i=n.anchorPoint,s=n.conversation,u=n.fetchAllItems,c=void 0!==u&&u,l=n.markAsDelivered,f=n.markAsRead,d=n.minItemsToFetch,p=n.maxItemsPerBatch,h=void 0===p?d:p;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=f&&0<s.unreadCount,o=0,r&&this.markAsRead(t,{localOnly:!0}),e.next=5,this.fetchTimeline(t,{anchorPoint:i,fetchAllItems:c,markAsDelivered:l,maxItems:h});case 5:return o+=e.sent,e.next=8,this._fetchContinuations(t,{addedMessages:o,conversation:s,fetchAllItems:c,markAsDelivered:l,maxItemsPerBatch:h,minItemsToFetch:d});case 8:return o=e.sent,a=s.firstUnreadMessage,r&&this.markAsRead(t),this.__ensureEntities(s,{messageCounterParties:"full"}),e.abrupt("return",{addedMessages:o,previousFirstUnreadMessage:a});case 13:case"end":return e.stop()}},e,this)})),function(e,t){return E.apply(this,arguments)})},{key:"_fetchContinuations",value:(x=(0,K.default)(Z.default.mark(function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.addedMessages,o=void 0===r?0:r,a=n.conversation,i=n.fetchAllItems,s=void 0!==i&&i,u=n.markAsDelivered,c=void 0===u||u,l=n.minItemsToFetch,f=void 0===l?20:l;return n.maxItemsPerBatch,Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===o)return e.abrupt("return",0);e.next=2;break;case 2:if((s||o<f)&&0<a.higherContinuation.itemsEstimate)return e.next=5,this.fetchTimeline(t,{anchorPoint:_e.ConversationAnchorPoints.CONTINUATION,markAsDelivered:c,continuation:a.higherContinuation.continuation,fetchAllItems:s});e.next=8;break;case 5:o+=e.sent,e.next=2;break;case 8:if((s||o<f)&&0<a.lowerContinuation.itemsEstimate)return e.next=11,this.fetchTimeline(t,{anchorPoint:_e.ConversationAnchorPoints.CONTINUATION,markAsDelivered:c,continuation:a.lowerContinuation.continuation,fetchAllItems:s});e.next=14;break;case 11:o+=e.sent,e.next=8;break;case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)})},{key:"getWithUser",value:function(e,t){var n=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).createIfNotFound,r=void 0!==n&&n;if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));var o=void 0;if(e=this._resolveModelId(e),t=this._resolveModelId(t),this.config.condensedReplays){var a=this.host.users.getById(e);if(a&&a.profileByOrganizationId&&a.profileByOrganizationId[t]){var i=a.profileByOrganizationId[t].conversationId;i&&(o=this.getById(i))}}else{var s=this.conversationHashForUserMessage(e,t);o=this.getById(s)}return!o&&r&&(o=this.ensureConversation("user",e,t)),o||null}},{key:"getWithListEntity",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{createIfNotFound:!1},r=n.createIfNotFound,o=void 0!==r&&r,a=n.organizationId,i=n.conversationId,s=void 0===i?null:i;if("string"!=typeof e)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));if("string"!=typeof e)throw new TypeError('Value of argument "entityType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));if(!("string"==typeof t||t instanceof Object))throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));var u=void 0;if(t=this._resolveModelId(t),this.config.condensedReplays)s&&(u=this.getById(s));else{var c=this.conversationHashForListEntityId(t);u=this.getById(c)}if(!u&&o){var l=this._resolveEntity(t,e);if(!l)throw new Error("Entity required when using createIfNotFound");a=l.organizationId,u=this.ensureConversation(e,t,a,{conversationId:s}),this.config.condensedReplays&&!s&&(u.$localOnly=!0)}return u}},{key:"getWithGroup",value:function(e){return this.getWithListEntity("group",e)}},{key:"getWithDistributionList",value:function(e){return this.getWithListEntity("distributionList",e)}},{key:"get",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(n));if("string"!=typeof e)throw new TypeError('Value of argument "counterPartyType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));if("string"!=typeof t)throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(t));if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(n));var r=this.getConversationKey(e,t,n);return(this.config.condensedReplays?this._convByConvHandle[r]:this.host.models.Conversation.get(r))||null}},{key:"getAll",value:function(){return this.host.models.Conversation.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));return this.host.models.Conversation.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+H(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+q(e));return this.host.models.Conversation.getMulti(e)}},{key:"getAllForOrganization",value:function(e){var t=this._resolveEntity(e,"organization");return t?t.conversations:null}},{key:"__ensureEntities",value:(w=(0,K.default)(Z.default.mark(function e(t){var n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(t));case 2:if(t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(t));case 4:if(n=[],r=$.default.resolve(),o.counterParty&&(r=this.__ensureCounterParty(t,o),n.push(r)),o.escalationExecution&&n.push(this.__ensureEscalationExecution(t,r,o)),o.messageCounterParties&&n.push(this.__ensureMessageCounterParties(t,o)),o.organization&&n.push(this.__ensureOrganization(t,o)),0===(n=n.filter(Boolean)).length)return e.abrupt("return");e.next=13;break;case 13:return e.prev=13,e.next=16,$.default.all(n);case 16:o.onLoad&&o.onLoad(),this.host.models.Conversation.inject(t),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(13),console.error(e.t0);case 23:case"end":return e.stop()}},e,this,[[13,20]])})),function(e){return w.apply(this,arguments)})},{key:"__ensureOrganization",value:(_=(0,K.default)(Z.default.mark(function e(n){var r=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(n));case 2:if(n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(n));case 4:return e.next=6,this.host.organizations._findAll();case 6:if(this.host.models.Organization.shouldEnsure(n.organization,"full"!==o.organization)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,new $.default(function(e,t){r.host.models.Organization.ensureEntity(n.organizationId,{onlyPlaceholder:"placeholder"===o.organization,onMissing:function(){r.logger.info("org "+n.organizationId+" not found, created placeholder org"),n.$loadingOrganization=!0,e()},onLoad:function(){r.logger.info("org "+n.organizationId+" loaded"),n.$loadingOrganization=!1,o.touchOnRelatedEntityLoad&&r.host.models.Conversation.inject(n)},onFinish:e})});case 10:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"__ensureCounterParty",value:(b=(0,K.default)(Z.default.mark(function e(n){var r,o,a,i=this,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(n));case 2:if(n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(n));case 4:if(s=(0,Q.default)({},s),"group"===n.counterPartyType&&n.counterParty&&n.counterParty.groupType===_e.GroupType.ROLE_P2P&&(s.counterParty="full",s.groupMembers="full"),(r=this.host.modelsByEntityType[n.counterPartyType]).shouldEnsure(n.counterParty,"full"!==s.counterParty,{groupMembersOnlyPlaceholder:"full"!==s.groupMembers})){e.next=10;break}return e.abrupt("return",null);case 10:o={},e.t0=n.counterPartyType,e.next="user"===e.t0?14:"group"===e.t0?15:"distributionList"===e.t0?15:17;break;case 14:return e.abrupt("break",18);case 15:return o.organizationId=n.organizationId,e.abrupt("break",18);case 17:throw new Error("unsupported counterPartyType",n.counterPartyType);case 18:return a=function(e){if("group"===r.name&&"placeholder"!==s.counterParty&&s.groupMembers)return i.host.groups.ensureMembers(e,{onlyPlaceholder:"placeholder"===s.groupMembers})},e.abrupt("return",new $.default(function(t,e){r.ensureEntity(n.counterPartyId,{attrs:o,onlyPlaceholder:"placeholder"===s.counterParty,onMissing:function(){i.logger.info("entry "+n.counterPartyId+" not found, created placeholder on org "+n.organizationId),n.$loadingCounterParty=!0},onLoad:function(){n.$loadingCounterParty=!1,s.touchOnRelatedEntityLoad&&i.host.models.Conversation.inject(n)},onFinish:function(e){e&&a(e),t()}})}));case 20:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"__ensureEscalationExecution",value:(m=(0,K.default)(Z.default.mark(function e(t,n){var r,o,a;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(t));case 2:if(t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(t));case 4:return e.next=6,n;case 6:if(r=t.counterPartyType,(o=t.counterParty)&&"group"===r){e.next=9;break}return e.abrupt("return");case 9:if(a=o.escalationExecution,o.groupType===_e.GroupType.ESCALATION&&a){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,this.host.escalations.ensureEscalationExecution(a);case 14:case"end":return e.stop()}},e,this)})),function(e,t){return m.apply(this,arguments)})},{key:"__ensureMessageCounterParties",value:function(t){var e,n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(t));if(!(t instanceof Object))throw new TypeError('Value of argument "conversation" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(t));var o=(e=(e=(e=t.messages,pe.default).call(e,"senderId").filter(Boolean),he.default).call(e),ye.default).call(e,this.host.currentUserId,t.counterPartyId);return $.default.all(o.map(function(e){return n.__ensureMessageCounterParty(t,e,r)}))}},{key:"__ensureMessageCounterParty",value:function(n,r){var o=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof r)throw new TypeError('Value of argument "messageOtherUserId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(r));if("string"!=typeof r)throw new TypeError('Value of argument "messageOtherUserId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(r));var e=this.host.models.User.get(r);return this.host.models.User.shouldEnsure(e,"full"!==a.messageCounterParties)?new $.default(function(e,t){o.host.models.User.ensureEntity(r,{onlyPlaceholder:"placeholder"===a.messageCounterParties,onMissing:function(){var e=n?"entry "+n.counterPartyId+" not found, created placeholder on org "+n.organizationId:"counterParty "+r+" not found";o.logger.info(e)},onLoad:function(){n&&a.touchOnRelatedEntityLoad&&o.host.models.Conversation.inject(n)},onFinish:e})}):null}},{key:"_setAllowedSenders",value:function(e){var t=e.counterParty,n=e.counterPartyType,r=e.organization,o=this.host.currentUser,a=[o];if(!r)return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.ORGANIZATION_DOES_NOT_EXIST);if(o.contactsMessagingBlocked&&r.isContacts)return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.CONTACTS_MESSAGING_BLOCKED_BY_ADMIN);if(!n)return e.allowedSenders=a,void(e.allowedSendersReason=_e.AllowedSendersReason.CONVERSATION_NOT_FULLY_LOADED);if(!t)return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.NO_COUNTER_PARTY);switch(n){case"user":return t.$placeholder?(e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.COUNTER_PARTY_NOT_FULLY_LOADED)):"TigerPage"===t.displayName?(e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.COUNTER_PARTY_IS_TIGERPAGE)):(e.allowedSenders=a,void(e.allowedSendersReason=_e.AllowedSendersReason.NONE));case"distributionList":return e.allowedSenders=a,void(e.allowedSendersReason=_e.AllowedSendersReason.NONE);case"group":var i=t.createdByRole,s=t.createdByUser,u=t.groupType,c=t.p2pRecipient,l=t.p2pSender,f=t.targetRole,d=t.targetUser,p=t.members,h=t.proxiedMembers,y=r.allowedSenders;if(u===_e.GroupType.FORUM)return e.allowedSenders=a,void(e.allowedSendersReason=_e.AllowedSendersReason.NONE);if(u===_e.GroupType.ROLE_ASSIGNMENT)return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.IS_ROLE_ASSIGNMENT_GROUP);if(u===_e.GroupType.ROLE_P2P&&c&&l){var v=[],g=i&&i.botUser,m=f&&f.botUser;!g||p&&p.includes(g)?!s||p&&p.includes(s)||v.push(s):v.push(g),!m||p&&p.includes(m)?!d||p&&p.includes(d)||v.push(d):v.push(m),0<v.length&&(p=[].concat((0,W.default)(p||[]),v))}else if(t.$placeholder)return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.COUNTER_PARTY_NOT_FULLY_LOADED);if(!p)return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.GROUP_MEMBERS_NOT_LOADED);if(0===p.length)return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.GROUP_HAS_NO_MEMBERS);var b=[];if(!y||"function"!=typeof y[J.default]&&!Array.isArray(y))throw new TypeError("Expected orgAllowedSenders to be iterable, got "+q(y));if(!y||"function"!=typeof y[J.default]&&!Array.isArray(y))throw new TypeError("Expected orgAllowedSenders to be iterable, got "+H(y));var _=!0,w=!1,x=void 0;try{for(var E,k=(0,X.default)(y);!(_=(E=k.next()).done);_=!0){var T=E.value,A="role"===T.$entityType?T.botUser:T;if(p.includes(A)){var I=A.id,O=h&&h[I];if(O){var j=!1;if(!O||"function"!=typeof O[J.default]&&!Array.isArray(O))throw new TypeError("Expected proxiedEntries to be iterable, got "+q(O));if(!O||"function"!=typeof O[J.default]&&!Array.isArray(O))throw new TypeError("Expected proxiedEntries to be iterable, got "+H(O));var S=!0,M=!1,R=void 0;try{for(var C,P=(0,X.default)(O);!(S=(C=P.next()).done);S=!0)C.value.token===I&&(j=!0)}catch(e){M=!0,R=e}finally{try{!S&&P.return&&P.return()}finally{if(M)throw R}}if(!j)continue}b.push(T)}}}catch(e){w=!0,x=e}finally{try{!_&&k.return&&k.return()}finally{if(w)throw x}}return 0===b.length?(e.allowedSenders=b,void(e.allowedSendersReason=_e.AllowedSendersReason.USER_IS_NOT_MEMBER_OF_GROUP)):u!==_e.GroupType.ROLE_P2P?(e.allowedSenders=b,void(e.allowedSendersReason=_e.AllowedSendersReason.NONE)):l&&b.includes(l)?c===o||o.roles.includes(c)?(e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.CONVERSATION_WITH_ROLE_YOU_ARE_CURRENTLY_IN)):(e.allowedSenders=[l],void(e.allowedSendersReason=_e.AllowedSendersReason.NONE)):(e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.USER_IS_NOT_IN_THIS_ROLE_CONVERSATION));default:return e.allowedSenders=[],void(e.allowedSendersReason=_e.AllowedSendersReason.COUNTER_PARTY_TYPE_NOT_SUPPORTED)}}},{key:"reactToProcessingStart",value:function(e){var t=e.data,n=t=(0,Ee.jsonCloneDeep)(t),r=n.action_type,o=n.conversation_id,a=n.entity,i=n.organization_id,s=a.token||a.id,u=_e.ProcessingActionTypes.resolve(r);if(this.host.products._addProcessingEvent({actionType:u,entity:(0,Q.default)({id:s},a)}),u===_e.ProcessingActionTypes.ROLE_OPT_OUT)this._roleConversationsProcessingEvent[s]=this.host.roles._roleConversations[s];else if(u===_e.ProcessingActionTypes.ORGANIZATION_MESSAGE_STATUS||u===_e.ProcessingActionTypes.ORGANIZATION_REPLAY){var c=this.host.organizations.getById(i);if(!c)return;c._markingAsReadConversations&&this.__clearOptimisticStatus(c._markingAsReadConversations)}else if(u===_e.ProcessingActionTypes.GROUP_REPLAY){var l=void 0;if(o&&(l=this.getById(o)),!l)return;this.__clearOptimisticStatus([l])}else if(u===_e.ProcessingActionTypes.ROLE_OPT_IN||u===_e.ProcessingActionTypes.ROLE_OPT_OUT){var f=this.host.roles._roleConversations[s];if(!f)return;this.__clearOptimisticStatus(f)}}},{key:"reactToProcessingStop",value:function(e){var t=e.data,n=t=(0,Ee.jsonCloneDeep)(t),r=n.action_type,o=n.conversation_id,a=n.entity,i=n.organization_id;!o&&a.conversation_id&&(o=a.conversation_id,delete a.conversation_id),!i&&a.organization_key&&(i=a.organization_key,delete a.organization_key);var s=a.token||a.id,u=_e.ProcessingActionTypes.resolve(r);if(u===_e.ProcessingActionTypes.GROUP_REPLAY){var c=void 0;if(o&&(c=this.getById(o)),!c)return;this.clearTimeline(c),this.__clearOptimisticStatus([c])}else if(u===_e.ProcessingActionTypes.ROLE_OPT_IN||u===_e.ProcessingActionTypes.ROLE_OPT_OUT){this.clearTimelineForAllRoleConversations(u,s);var l=this.host.roles._roleConversations[s];if(!l)return void this.host.products._removeProcessingEvent({actionType:u,entity:(0,Q.default)({id:s},a)});this.__clearOptimisticStatus(l)}else if(u===_e.ProcessingActionTypes.ORGANIZATION_MESSAGE_STATUS)this.clearMessageStatusesForOrganization(i);else if(u===_e.ProcessingActionTypes.CONVERSATION_MESSAGE_STATUS){var f=void 0;if(o&&(f=this.getById(o)),!f)return;this.clearMessageStatuses(f)}if(u===_e.ProcessingActionTypes.ORGANIZATION_MESSAGE_STATUS||u===_e.ProcessingActionTypes.ORGANIZATION_REPLAY){var d=this.host.organizations.getById(i);if(!d)return;d._markingAsReadConversations&&this.__clearOptimisticStatus(d._markingAsReadConversations)}this.host.products._removeProcessingEvent({actionType:u,entity:(0,Q.default)({id:s},a)})}},{key:"__clearOptimisticStatus",value:function(e){if(!e||"function"!=typeof e[J.default]&&!Array.isArray(e))throw new TypeError("Expected conversations to be iterable, got "+q(e));if(!e||"function"!=typeof e[J.default]&&!Array.isArray(e))throw new TypeError("Expected conversations to be iterable, got "+H(e));var t=!0,n=!1,r=void 0;try{for(var o,a=(0,X.default)(e);!(t=(o=a.next()).done);t=!0){var i=o.value;i._markingAsRead&&(i._markingAsRead=!1,i._markingAsReadSortNumber=null,i._markingAsReadExpiration=null,this.host.models.Conversation.inject(i))}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"clearTimelineForAllRoleConversations",value:function(e,t){var n;if(n=e===_e.ProcessingActionTypes.ROLE_OPT_OUT?this._roleConversationsProcessingEvent[t]:this.host.roles._roleConversations[t]){if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected conversations to be iterable, got "+q(n));if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected conversations to be iterable, got "+H(n));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,X.default)(n);!(r=(i=s.next()).done);r=!0){var u=i.value;this.clearTimeline(u)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}}}},{key:"clearMessageStatusesForOrganization",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(e));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+q(e));var t=this.host.organizations.getById(e);if(t){var n=t.conversations;if(n){if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected conversations to be iterable, got "+q(n));if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected conversations to be iterable, got "+H(n));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,X.default)(n);!(r=(i=s.next()).done);r=!0){var u=i.value;this.clearMessageStatuses(u)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}}}}},{key:"clearMessageStatuses",value:function(e){var s=this,t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).emit,n=void 0===t||t,u=e.timeline;if(!u||"function"!=typeof u[J.default]&&!Array.isArray(u))throw new TypeError("Expected timeline to be iterable, got "+q(u));if(!u||"function"!=typeof u[J.default]&&!Array.isArray(u))throw new TypeError("Expected timeline to be iterable, got "+H(u));var r=!0,o=!1,a=void 0;try{for(var i,c=(0,X.default)(u);!(r=(i=c.next()).done);r=!0){var l=i.value;l.shouldEnsureRecipientStatus=!0,this.host.models.Message.inject(l)}}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}return setTimeout(function(){if(!u||"function"!=typeof u[J.default]&&!Array.isArray(u))throw new TypeError("Expected timeline to be iterable, got "+q(u));if(!u||"function"!=typeof u[J.default]&&!Array.isArray(u))throw new TypeError("Expected timeline to be iterable, got "+H(u));var e=!0,t=!1,n=void 0;try{for(var r,o=(0,X.default)(u);!(e=(r=o.next()).done);e=!0){var a=r.value;if(!s.host.messages._pendingFindRecipientStatuses)return;var i=s.host.messages._pendingFindRecipientStatuses[a.id];i&&i()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}},0),n&&this.emit("clearMessageStatuses",u),u.length}},{key:"mute",value:(g=(0,K.default)(Z.default.mark(function e(t,n){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));case 2:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+H(n));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));case 6:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+q(n));e.next=8;break;case 8:return e.next=10,this.host.mute.muteConversation(t,n);case 10:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"unmute",value:(v=(0,K.default)(Z.default.mark(function e(t){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+H(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+q(t));case 4:return e.next=6,this.host.mute.unmuteConversation(t);case 6:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"unmuteAll",value:(y=(0,K.default)(Z.default.mark(function e(){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.mute.unmuteAll();case 2:case"end":return e.stop()}},e,this)})),function(){return y.apply(this,arguments)})}]),o((p=De).prototype,"findAll",[l],(0,L.default)(p.prototype,"findAll"),p.prototype),o(p.prototype,"add",[f],(0,L.default)(p.prototype,"add"),p.prototype),o(p.prototype,"remove",[d],(0,L.default)(p.prototype,"remove"),p.prototype),p);function De(){var e,t,C,n;(0,te.default)(this,De);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=C=(0,re.default)(this,(e=De.__proto__||(0,ee.default)(De)).call.apply(e,[this].concat(o))),C.__injectCounterParty=function(e){var t=e.conversationId,n=e.entityAttrs,r=e.entityType,o=e.groupType,a=e.hasCurrentUser,i=void 0!==a&&a,s=e.isPlaceholder,u=void 0!==s&&s,c=e.organizationId,l=n.id,f=n.metadata;if(l=l||n.token,!r&&n.type&&(r=C.host.modelNameByEntityType(n.type)),t&&(n.conversationId=t),c&&(n.organizationId=c),"group"!==r||o||(o=C.host.groups.__extractGroupTypeFromAttrs(n)),f&&l&&c&&C.host.metadata.__injectMetadata(l,c,f),"group"===r){if(f){if(f.created_by){var d=C.__injectCreatedByEntity(f,c),p=d.role,h=void 0===p?null:p,y=d.user,v=void 0===y?null:y;(h||v)&&(n.createdByRole=h,n.createdByUser=v)}else if(n.created_by){var g=C.host.models.User.injectPlaceholder({id:n.created_by});n.createdByUser=g}if(f.target_id){var m=C.__injectTargetEntity(f,c),b=m.role,_=void 0===b?null:b,w=m.user,x=void 0===w?null:w;(_||x)&&(n.targetRole=_,n.targetUser=x)}if("role_assignment"===f.meta_type){var E=n.display_name||n.name;C.host.roles.__injectRoleAssignmentEntity(E,f,c)}}o===_e.GroupType.FORUM&&i&&(n.hasCurrentUser=!0)}else if("user"===r){var k=n.dnd_auto_forward_receiver;k&&"undefined"!==k&&C.host.models.User.injectPlaceholder({id:k})}else if("distributionList"===r)n.created_by&&C.host.injectPlaceholderModel({displayName:n.created_by_display_name,id:n.created_by},"user"),n.updated_by&&C.host.injectPlaceholderModel({displayName:n.updated_by_display_name,id:n.updated_by},"user");else if("messageTemplate"===r)n.created_by&&C.host.injectPlaceholderModel({displayName:n.created_by_display_name,id:n.created_by},"user"),n.updated_by&&C.host.injectPlaceholderModel({displayName:n.updated_by_display_name,id:n.updated_by},"user");else if("scheduledMessage"===r){if(n.event_id&&(n.scheduled_message_id=n.token,n.token=n.event_id,l=n.event_id),n.recipient)if("account"===n.recipient_type){var T={},A=["feature_service","is_patient_contact","patient_display_name","patient_dob","patient_gender","patient_id","patient_mrn","phone_number","relation_name"];if("function"!=typeof A[J.default]&&!Array.isArray(A))throw new TypeError("Expected patientDataKeys to be iterable, got "+q(A));if("function"!=typeof A[J.default]&&!Array.isArray(A))throw new TypeError("Expected patientDataKeys to be iterable, got "+H(A));var I=!0,O=!1,j=void 0;try{for(var S,M=(0,X.default)(A);!(I=(S=M.next()).done);I=!0){var R=S.value;T[R]=n[R]}}catch(e){O=!0,j=e}finally{try{!I&&M.return&&M.return()}finally{if(O)throw j}}T.patient_id||T.is_patient_contact||(T.patient_id=n.recipient),C.host.metadata.__injectMetadata(n.recipient,c,T),C.host.injectPlaceholderModel((0,Q.default)({},T,{displayName:n.recipient_display_name,id:n.recipient}),"user")}else"distribution_list"!==n.recipient_type&&"list"!==n.recipient_type||C.host.injectPlaceholderModel({id:n.recipient,name:n.recipient_display_name,totalMembers:n.total_members},"distributionList");n.sender_token&&C.host.injectPlaceholderModel({displayName:n.sender_display_name,id:n.sender_token},"user"),n.template_id&&C.host.injectPlaceholderModel({title:n.template_label,id:n.template_id},"messageTemplate"),n.updated_by&&C.host.injectPlaceholderModel({displayName:n.updated_by_display_name,id:n.updated_by},"user")}return l?u?C.host.injectPlaceholderModel(n,r):C.host.injectModel(n,r):null},C.__injectCreatedByEntity=function(e,t){var n={};if(void 0!==e.created_by_tag_id)n.role=C.host.roles.__injectRoleFromMetadata({metadata:{token:e.created_by,display_name:e.created_by_display_name,tag_color:e.created_by_tag_color,tag_id:e.created_by_tag_id,tag_name:e.created_by_tag_name},organizationId:t,replaceExisting:!1});else{var r=C.host.models.User.get(e.created_by);if(r)n.user=r;else{var o={id:e.created_by};"created_by_display_name"in e&&(o.displayName=e.created_by_display_name),n.user=C.host.models.User.injectPlaceholder(o)}}return n},C.__injectTargetEntity=function(e,t){var n={};if(void 0!==e.target_tag_id)n.role=C.host.roles.__injectRoleFromMetadata({metadata:{display_name:e.target_display_name,tag_color:e.target_tag_color,tag_id:e.target_tag_id,tag_name:e.target_tag_name,token:e.target_id},organizationId:t,replaceExisting:!1});else{var r=C.host.models.User.get(e.target_id);if(r)n.user=r;else{var o={id:e.target_id};"target_display_name"in e&&(o.displayName=e.target_display_name),n.user=C.host.models.User.injectPlaceholder(o)}}return n},C.__removeFriend=function(e){var t,n=e.attrs,r=e.entityType,o=e.id,a=e.organizationId,i=C.get(r,o,a),s="group"===r?C.host.models.Group.get(o):null,u=!(!s||s.groupType!==_e.GroupType.FORUM);if(t="user"===r||C.config.condensedReplays?i&&i.content.slice():i&&i.messages.slice(),u&&(n.hasCurrentUser=!1,n.members=null,C.host.models.Group.inject(n)),C.config.keepConversationsForAllForums&&u||(i&&C.__ejectConversation(i.id),s&&C.config.condensedReplays&&C.host.models.Group.eject(s)),Array.isArray(t)){if(!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected content to be iterable, got "+q(t));if(!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected content to be iterable, got "+H(t));var c=!0,l=!1,f=void 0;try{for(var d,p=(0,X.default)(t);!(c=(d=p.next()).done);c=!0){var h=d.value;C.host.ejectModel(h,h.$entityType)}}catch(e){l=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(l)throw f}}}},C._sanitizeGroupAttrs=function(e){var t=e.members;C.host.groups.__extractGroupTypeFromAttrs(e)===_e.GroupType.FORUM&&t&&0===t.length&&delete e.members},C._onSendingMessage=function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(e));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(e));var t=void 0;if(t=C.config.condensedReplays?e.conversation:C.ensureConversation(e.counterPartyType,e.counterPartyId,e.senderOrganizationId,{ensureEntities:{counterParty:"full",organization:"placeholder",messageCounterParties:"full",groupMembers:"full",touchOnRelatedEntityLoad:!0}})){var n=!1;C.host.config.condensedReplays&&e&&e.sortNumber&&(void 0===t.highestSortNumber||t.highestSortNumber<e.sortNumber)&&(t.highestSortNumber=e.sortNumber,n=!0),void 0===t.highestSortNumber&&(t.highestSortNumber=C.host.messages.__getNextSortNumber(t.organizationId),n=!0),n&&C.host.models.Conversation.inject(t),C.__addConversationCounterPartyToServerRosterIfShould(t)}},C._onSentMessage=function(e){if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+H(e));if(!(e instanceof Object))throw new TypeError('Value of argument "message" violates contract.\n\nExpected:\nObject\n\nGot:\n'+q(e));var t=!1,n=C.ensureConversation(e.counterPartyType,e.counterPartyId,e.senderOrganizationId);n&&(C.host.config.condensedReplays&&(e&&e.sortNumber&&(void 0===n.highestSortNumber||n.highestSortNumber<e.sortNumber)?(n.highestSortNumber=e.sortNumber,t=!0):void 0===n.highestSortNumber&&(n.highestSortNumber=C.host.messages.__getNextSortNumber(n.organizationId),t=!0)),t&&C.host.models.Conversation.inject(n),n.emit("message",e))},C._onChangeMessage=function(e,t){t.conversation&&C.__queueReload(t.conversation)},C._onRemoveMessage=function(e,t){var n=t.conversation;if(n){if(C.config.condensedReplays){var r=n,o=r.firstExpiringUnreadMessage,a=r.id,i=r.lastMessage,s=r.timeline;if(!(n=C.getById(a)))return;var u=i===t,c=o===t,l=1===s.length&&u;(u||c)&&C.find(n.id),l&&(n.lastMessage=null)}C.__queueReload(n)}},C._onRemoveGroup=function(e,t){var n=t.conversationId?t.conversationId:C.getConversationKey("group",t.id,t.organizationId);C.__ejectConversation(n)},C._onRemoveTeam=function(e,t){var n=C.getConversationKey("team",t.id,t.organizationId);C.__ejectConversation(n)},C._onChangeGroup=function(e,t){t.conversationId&&C.host.models.Conversation.touch(t.conversationId)},C._onChangeOrganization=function(e,t){var n=t.conversations,r=C.__escalationEnabledOrganizations.indexOf(t),o=-1<r;if(o!==t.canEscalateMessages&&(o?C.__escalationEnabledOrganizations.splice(r,1):C.__escalationEnabledOrganizations.push(t),n)){if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected conversations to be iterable, got "+q(n));if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected conversations to be iterable, got "+H(n));var a=!0,i=!1,s=void 0;try{for(var u,c=(0,X.default)(n);!(a=(u=c.next()).done);a=!0){var l=u.value;C.__queueReload(l)}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}},C.__flushConversationsToReload=function(){if(!C.host.currentlyServingOfflineMessages&&0<C.__queuedConversationsToReload.length){var e=[];if(C.host.organizations._deferConversationChanges=!0,!(i=C.__queuedConversationsToReload)||"function"!=typeof i[J.default]&&!Array.isArray(i))throw new TypeError("Expected _queuedConversations to be iterable, got "+q(i));if(!i||"function"!=typeof i[J.default]&&!Array.isArray(i))throw new TypeError("Expected _queuedConversations to be iterable, got "+H(i));var t=!0,n=!1,r=void 0;try{for(var o,a=(0,X.default)(i);!(t=(o=a.next()).done);t=!0){var i,s=o.value,u=s.organizationId;C.__reloadConversation(s),e.includes(u)||e.push(u)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}if(C.host.organizations._deferConversationChanges=!1,!e||"function"!=typeof e[J.default]&&!Array.isArray(e))throw new TypeError("Expected changedOrganizations to be iterable, got "+q(e));if(!e||"function"!=typeof e[J.default]&&!Array.isArray(e))throw new TypeError("Expected changedOrganizations to be iterable, got "+H(e));var c=!0,l=!1,f=void 0;try{for(var d,p=(0,X.default)(e);!(c=(d=p.next()).done);c=!0){u=d.value;var h=C.host.organizations.getById(u);h&&C.host.organizations.__reloadConversations(h)}}catch(e){l=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(l)throw f}}C.__queuedConversationsToReload.length=0}},n=t,(0,re.default)(C,n)}t.default=Ne,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,T.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,k.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,E.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,T.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,k.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,E.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E=r(n(4)),k=r(n(5)),T=r(n(3)),A=r(n(11)),I=r(n(54)),O=r(n(16)),j=r(n(10)),S=r(n(9)),M=r(n(6)),R=r(n(1)),C=r(n(2)),P=r(n(8)),z=r(n(7)),V=r(n(35)),G=n(21),N=n(36),D=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),U=r(n(15)),F=["display_name"].join(","),L=["name"].join(","),B=(a=(0,G.decorator)(),u=(0,G.decorator)(),c=(0,G.decorator)(),f=U.default,(0,z.default)($,f),(0,C.default)($,[{key:"mounted",value:function(){this._fetched=!1}},{key:"dispose",value:function(){this._fetched=!1}},{key:"addMembers",value:(x=(0,S.default)(j.default.mark(function e(t){var n=t.id,r=t.members,o=t.organizationId;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}throw new D.ValidationError("id","required");case 2:if(Array.isArray(r)){e.next=4;break}throw new D.ValidationError("members","required","members must be an array");case 4:if(o){e.next=6;break}throw new D.ValidationError("organizationId","required");case 6:return e.next=8,this.host.api.distributionLists.membersBatch({id:n,members:r,operation:"add",organizationId:o});case 8:case"end":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)})},{key:"batchDelete",value:(w=(0,S.default)(j.default.mark(function e(t){var n,r=this,o=t.ids,a=t.organizationId;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(o)){e.next=2;break}throw new D.ValidationError("ids","required","ids must be an array");case 2:if(a){e.next=4;break}throw new D.ValidationError("organizationId","required");case 4:return e.next=6,this.host.api.distributionLists.batch({ids:o,operation:"destroy",organizationId:a});case 6:return n=o.map(function(e){return r.host.models.DistributionList.inject({$deleted:!0,id:e})}),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)})},{key:"create",value:(_=(0,S.default)(j.default.mark(function e(t){var n,r,o=t.adminOnly,a=t.members,i=t.name,s=t.network,u=void 0===s?"patient":s,c=t.organizationId;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._validate({adminOnly:o,members:a,name:i,organizationId:c,shouldCheckId:!1}),!1===["patient"].includes(u))throw new D.ValidationError("network","invalid",'network must be "patient"');e.next=3;break;case 3:return e.next=5,this.host.api.distributionLists.create({adminOnly:o,members:a,name:i,network:u,organizationId:c});case 5:return n=e.sent,r=this.host.models.DistributionList.inject((0,O.default)({conversationId:n.conversation_id,organizationId:n.organization_id},n.entity)),e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"delete",value:(b=(0,S.default)(j.default.mark(function e(t,n){var r;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._validate({id:t,organizationId:n,shouldCheckInvalid:!1}),e.next=3,this.host.api.distributionLists.delete(t,n);case 3:return r=this.host.models.DistributionList.inject({$deleted:!0,id:t}),e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return b.apply(this,arguments)})},{key:"find",value:(m=(0,S.default)(j.default.mark(function e(t){var n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=4;break;case 4:if(o=(0,V.default)(o,{ignoreNotFound:!1,bypassCache:!1,includeMembers:!1,includeMetadata:!1}),this.host.requireUser(),n=null,o.bypassCache){e.next=11;break}if(n=this.host.models.DistributionList.get(t))return e.abrupt("return",n);e.next=11;break;case 11:return e.next=13,this.host.api.distributionLists.find(t,{organizationId:o.organizationId});case 13:if(!(r=e.sent)){e.next=19;break}delete(n=this.config.condensedReplays||r.entity?this.host.models.DistributionList.inject((0,O.default)({conversationId:r.conversation_id,organizationId:r.organization_id},r.entity)):this.host.models.DistributionList.inject(r)).$placeholder,e.next=21;break;case 19:if(o.ignoreNotFound){e.next=21;break}throw new D.NotFoundError(this.host.models.DistributionList.name,t);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"findAll",value:(g=(0,S.default)(j.default.mark(function e(){var t,n,r,o;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._fetched)return e.abrupt("return",this.getAll());e.next=2;break;case 2:if(0===(t=this.host.models.Organization.getAll()).length)return e.next=6,this.host.organizations.findAll();e.next=7;break;case 6:t=e.sent;case 7:return e.next=9,this.host.search.query({types:["distributionList"],organizationIds:t.map(function(e){return e.id}),query:{displayName:""},followContinuations:!0});case 9:return n=e.sent,r=n.results,o=r.map(function(e){return e.entity}),this._fetched=!0,e.abrupt("return",o);case 14:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)})},{key:"getAll",value:function(){return this.host.models.DistributionList.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));return this.host.models.DistributionList.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+s(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+i(e));return this.host.models.DistributionList.getMulti(e)}},{key:"removeMembers",value:(v=(0,S.default)(j.default.mark(function e(t){var n=t.id,r=t.members,o=t.organizationId;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}throw new D.ValidationError("id","required");case 2:if(Array.isArray(r)){e.next=4;break}throw new D.ValidationError("members","required","members must be an array");case 4:if(o){e.next=6;break}throw new D.ValidationError("organizationId","required");case 6:return e.next=8,this.host.api.distributionLists.membersBatch({id:n,members:r,operation:"remove",organizationId:o});case 8:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"search",value:(y=(0,S.default)(j.default.mark(function e(t){var n,r,o=t.continuation,a=t.network,i=void 0===a?"patient":a,s=t.organizationId,u=t.query,c=void 0===u?"":u,l=t.sortBy,f=void 0===l?"name":l,d=t.sortOrder,p=void 0===d?"asc":d,h=t.types,y=void 0===h?[N.SearchType.PATIENT_DISTRIBUTION_LIST]:h;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.search.query({continuation:o,network:i,organizationId:s,query:(0,I.default)({},L,c),returnFields:[],sort:(0,I.default)({},f,p),types:y});case 2:return n=e.sent,r=this._processSearchResults(n.results),e.abrupt("return",{metadata:n.metadata,results:r});case 5:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"findMembers",value:(h=(0,S.default)(j.default.mark(function e(t){var n,r,o,a,i,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},u=s.continuation,c=s.network,l=void 0===c?"patient":c,f=s.organizationId,d=s.query,p=void 0===d?"":d,h=s.sortBy,y=void 0===h?["display_name"]:h,v=s.sortOrder,g=void 0===v?["asc"]:v;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new D.ValidationError("id","required");case 2:if(f){e.next=4;break}throw new D.ValidationError("organizationId","required");case 4:if(y.length!==g.length)throw new D.ValidationError("sortBy","invalid","sortBy and sortOrder must be the same length");e.next=6;break;case 6:for(r={},o=0;o<y.length;o++)r[y[o]]=g[o];return e.next=10,this.host.search.query({continuation:u,network:l,organizationId:f,query:(n={},(0,I.default)(n,F,p),(0,I.default)(n,"dist_list_token",t),n),returnFields:[],sort:r,types:[N.SearchType.DISTRIBUTION_LIST_MEMBER]});case 10:return a=e.sent,i=this._processSearchResults(a.results),e.abrupt("return",{metadata:a.metadata,results:i});case 13:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"findMemberIds",value:(p=(0,S.default)(j.default.mark(function e(t,n){var r,o,a,i,s,u=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).continuation;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new D.ValidationError("id","required");case 2:if(n){e.next=4;break}throw new D.ValidationError("organizationId","required");case 4:return e.next=6,this.host.api.distributionLists.findMemberIds(t,n,{continuation:u});case 6:return r=e.sent,o=r.members,a=void 0===o?[]:o,i=r.metadata,s=a.map(function(e){return e.token}),e.abrupt("return",{metadata:i,results:s});case 12:case"end":return e.stop()}},e,this)})),function(e,t){return p.apply(this,arguments)})},{key:"update",value:(d=(0,S.default)(j.default.mark(function e(t){var n,r,o=t.adminOnly,a=t.id,i=t.name,s=t.organizationId;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._validate({adminOnly:o,name:i,id:a,organizationId:s}),e.next=3,this.host.api.distributionLists.update({adminOnly:o,id:a,name:i,organizationId:s});case 3:return n=e.sent,r=this.host.models.DistributionList.inject((0,O.default)({conversationId:n.conversation_id,organizationId:n.organization_id},n.entity)),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"_processSearchResults",value:function(e){return e.map(function(e){return e.entity}).filter(function(e){return!e.$deleted})}},{key:"_validate",value:function(e){var t=e.adminOnly,n=e.id,r=(e.members,e.name),o=e.organizationId,a=e.shouldCheckId,i=void 0===a||a,s=e.shouldCheckInvalid,u=void 0===s||s;if(i&&!n)throw new D.ValidationError("id","required");if(!o)throw new D.ValidationError("organizationId","required");if(u){if(void 0!==t&&"boolean"!=typeof t)throw new D.ValidationError("adminOnly","invalid","adminOnly must be a boolean value");if(r&&(0===r.length||60<r.length))throw new D.ValidationError("name","invalid","name must be less than 60 alphanumeric characters")}}}]),o((l=$).prototype,"find",[a],(0,A.default)(l.prototype,"find"),l.prototype),o(l.prototype,"findAll",[u],(0,A.default)(l.prototype,"findAll"),l.prototype),o(l.prototype,"search",[c],(0,A.default)(l.prototype,"search"),l.prototype),l);function $(){return(0,R.default)(this,$),(0,P.default)(this,($.__proto__||(0,M.default)($)).apply(this,arguments))}t.default=B,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function H(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,v.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=H(t[0],n);return t.every(function(e){return H(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return H(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,y.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+H(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function Y(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,v.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=Y(t[0],n);return t.every(function(e){return Y(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return Y(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,y.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+Y(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,d,p,h=r(n(4)),y=r(n(5)),v=r(n(3)),g=r(n(11)),Z=r(n(10)),W=r(n(20)),K=r(n(24)),X=r(n(13)),Q=r(n(93)),J=r(n(12)),ee=r(n(19)),m=r(n(9)),b=r(n(6)),_=r(n(1)),w=r(n(2)),x=r(n(8)),E=r(n(7)),te=r(n(234)),ne=r(n(239)),k=r(n(15)),T=n(21),re=n(29),oe=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),A=(o=(0,T.decorator)(),d=k.default,(0,E.default)(I,d),(0,w.default)(I,[{key:"findMulti",value:(p=(0,m.default)(Z.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z,V,G,N,D,U,F,L,B,$,q=this;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+Y(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Y(n));e.next=4;break;case 4:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){e.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+H(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+H(n));e.next=8;break;case 8:if(n){e.next=10;break}throw new oe.ValidationError("organizationId","required");case 10:return t=(0,ne.default)((0,re.arrayWrap)(t).map(this._resolveModelId)),r=(0,te.default)(t,10),o=r.map(function(e){return q.host.api.entities.findMulti({users:e,metadata:e,organizationId:n})}),e.next=15,ee.default.all(o);case 15:if(a=e.sent,i={},!a||"function"!=typeof a[J.default]&&!Array.isArray(a))throw new TypeError("Expected allResults to be iterable, got "+H(a));e.next=19;break;case 19:if(!a||"function"!=typeof a[J.default]&&!Array.isArray(a))throw new TypeError("Expected allResults to be iterable, got "+Y(a));e.next=21;break;case 21:u=!(s=!0),c=void 0,e.prev=24,l=(0,X.default)(a);case 26:if(s=(f=l.next()).done){e.next=138;break}if(d=f.value,p=d.users,h=d.metadata,!p){e.next=82;break}if(!p||"function"!=typeof p[J.default]&&!Array.isArray(p))throw new TypeError("Expected users to be iterable, got "+H(p));e.next=32;break;case 32:if(!p||"function"!=typeof p[J.default]&&!Array.isArray(p))throw new TypeError("Expected users to be iterable, got "+Y(p));e.next=34;break;case 34:v=!(y=!0),g=void 0,e.prev=37,m=(0,X.default)(p);case 39:if(y=(b=m.next()).done){e.next=68;break}if(_=b.value,!(A=(0,K.default)(_))||"function"!=typeof A[J.default]&&!Array.isArray(A))throw new TypeError("Expected _Object$entries to be iterable, got "+H(A));e.next=44;break;case 44:if(!A||"function"!=typeof A[J.default]&&!Array.isArray(A))throw new TypeError("Expected _Object$entries to be iterable, got "+Y(A));e.next=46;break;case 46:for(x=!(w=!0),E=void 0,e.prev=49,k=(0,X.default)(A);!(w=(T=k.next()).done);w=!0)I=(0,W.default)(T.value,2),O=I[0],j=I[1],i[O]={entity:j};e.next=57;break;case 53:e.prev=53,e.t0=e.catch(49),x=!0,E=e.t0;case 57:e.prev=57,e.prev=58,!w&&k.return&&k.return();case 60:if(e.prev=60,x)throw E;e.next=63;break;case 63:return e.finish(60);case 64:return e.finish(57);case 65:y=!0,e.next=39;break;case 68:e.next=74;break;case 70:e.prev=70,e.t1=e.catch(37),v=!0,g=e.t1;case 74:e.prev=74,e.prev=75,!y&&m.return&&m.return();case 77:if(e.prev=77,v)throw g;e.next=80;break;case 80:return e.finish(77);case 81:return e.finish(74);case 82:if(!h){e.next=135;break}if(!h||"function"!=typeof h[J.default]&&!Array.isArray(h))throw new TypeError("Expected allMetadata to be iterable, got "+H(h));e.next=85;break;case 85:if(!h||"function"!=typeof h[J.default]&&!Array.isArray(h))throw new TypeError("Expected allMetadata to be iterable, got "+Y(h));e.next=87;break;case 87:M=!(S=!0),R=void 0,e.prev=90,C=(0,X.default)(h);case 92:if(S=(P=C.next()).done){e.next=121;break}if(z=P.value,!(F=(0,K.default)(z))||"function"!=typeof F[J.default]&&!Array.isArray(F))throw new TypeError("Expected _Object$entries2 to be iterable, got "+H(F));e.next=97;break;case 97:if(!F||"function"!=typeof F[J.default]&&!Array.isArray(F))throw new TypeError("Expected _Object$entries2 to be iterable, got "+Y(F));e.next=99;break;case 99:for(G=!(V=!0),N=void 0,e.prev=102,D=(0,X.default)(F);!(V=(U=D.next()).done);V=!0)L=(0,W.default)(U.value,2),O=L[0],B=L[1],($=i[O])&&($.metadata=B);e.next=110;break;case 106:e.prev=106,e.t2=e.catch(102),G=!0,N=e.t2;case 110:e.prev=110,e.prev=111,!V&&D.return&&D.return();case 113:if(e.prev=113,G)throw N;e.next=116;break;case 116:return e.finish(113);case 117:return e.finish(110);case 118:S=!0,e.next=92;break;case 121:e.next=127;break;case 123:e.prev=123,e.t3=e.catch(90),M=!0,R=e.t3;case 127:e.prev=127,e.prev=128,!S&&C.return&&C.return();case 130:if(e.prev=130,M)throw R;e.next=133;break;case 133:return e.finish(130);case 134:return e.finish(127);case 135:s=!0,e.next=26;break;case 138:e.next=144;break;case 140:e.prev=140,e.t4=e.catch(24),u=!0,c=e.t4;case 144:e.prev=144,e.prev=145,!s&&l.return&&l.return();case 147:if(e.prev=147,u)throw c;e.next=150;break;case 150:return e.finish(147);case 151:return e.finish(144);case 152:return e.abrupt("return",(0,Q.default)(i));case 153:case"end":return e.stop()}},e,this,[[24,140,144,152],[37,70,74,82],[49,53,57,65],[58,,60,64],[75,,77,81],[90,123,127,135],[102,106,110,118],[111,,113,117],[128,,130,134],[145,,147,151]])})),function(e,t){return p.apply(this,arguments)})}]),i=(a=I).prototype,s="findMulti",u=[o],c=(0,g.default)(a.prototype,"findMulti"),l=a.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(i,s,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(i,s,f),f=null),a);function I(){return(0,_.default)(this,I),(0,x.default)(this,(I.__proto__||(0,b.default)(I)).apply(this,arguments))}t.default=A,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function l(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,x.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=l(t[0],n);return t.every(function(e){return l(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return l(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,w.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,_.default)(e))+": "+l(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function f(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,x.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=f(t[0],n);return t.every(function(e){return f(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return f(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,w.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,_.default)(e))+": "+f(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,d,p,h,y,v,g,m,b,_=r(n(4)),w=r(n(5)),x=r(n(3)),E=r(n(11)),k=r(n(10)),T=r(n(9)),A=r(n(6)),I=r(n(1)),O=r(n(2)),j=r(n(8)),S=r(n(7)),M=n(21),R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),C=r(n(15)),P=(a=(0,M.decorator)(),i=(0,M.decorator)(),s=(0,M.decorator)(),u=(0,M.decorator)(),c=(0,M.decorator)(),p=C.default,(0,S.default)(z,p),(0,O.default)(z,[{key:"escalateMessage",value:(b=(0,T.default)(k.default.mark(function e(t){var n,r,o;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+l(t));case 4:if(n=this._resolveEntity(t,"message")){e.next=7;break}throw new R.NotFoundError(this.host.models.Message.name,t);case 7:return e.next=9,this.host.api.escalations.escalateMessage(n.serverId);case 9:return r=e.sent,o=(r||{}).escalation,e.abrupt("return",this._updateEscalation(o));case 12:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"acknowledge",value:(m=(0,T.default)(k.default.mark(function e(t){var n,r,o,a,i,s,u,c;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+l(t));case 4:if(n=this._resolveEntity(t,"escalationExecution")){e.next=7;break}throw new R.NotFoundError(this.host.models.EscalationExecution.name,t);case 7:return t=n.id,r=n.originalMessageId,o=this.host,a=o.currentUser,i=o.currentUserId,(s=a.roles.map(function(e){return e.botUserId})).push(i),e.next=14,this.host.api.escalations.acknowledge(t,{messageId:r,userTokens:s});case 14:return u=e.sent,c=this.host.models.EscalationExecution.inject(u),e.abrupt("return",c);case 17:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"cancel",value:(g=(0,T.default)(k.default.mark(function e(t){var n,r;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+l(t));case 4:if(n=this._resolveEntity(t,"escalationExecution")){e.next=7;break}throw new R.NotFoundError(this.host.models.EscalationExecution.name,t);case 7:return r=n.originalMessageId,e.next=10,this.host.api.escalations.cancel(r);case 10:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"ensureEscalationExecution",value:(v=(0,T.default)(k.default.mark(function e(t){var n,r,o,a;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+l(t));case 4:if(n=this._resolveEntity(t,"escalationExecution")){e.next=7;break}throw new R.NotFoundError(this.host.models.EscalationExecution.name,t);case 7:return r=n.carbonCopyMessageId,o=n.originalMessageId,a=[],r&&a.push(r),o&&a.push(o),e.next=13,this.host.messages.ensureRecipientStatusMulti(a);case 13:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"skip",value:(y=(0,T.default)(k.default.mark(function e(t){var n,r,o,a,i,s,u,c;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+l(t));case 4:if(n=this._resolveEntity(t,"escalationExecution")){e.next=7;break}throw new R.NotFoundError(this.host.models.EscalationExecution.name,t);case 7:return t=n.id,r=n.originalMessageId,o=this.host,a=o.currentUser,i=o.currentUserId,(s=a.roles.map(function(e){return e.botUserId})).push(i),e.next=14,this.host.api.escalations.skip(t,{messageId:r,userTokens:s});case 14:return u=e.sent,c=this.host.models.EscalationExecution.inject(u),e.abrupt("return",c);case 17:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"removeEscalationGroup",value:(h=(0,T.default)(k.default.mark(function e(t){var n,r;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "escalationExecutionId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+l(t));case 4:if(n=this._resolveEntity(t,"escalationExecution")){e.next=7;break}throw new R.NotFoundError(this.host.models.EscalationExecution.name,t);case 7:return r=n.groupId,e.next=10,this.host.api.groups.destroy(r);case 10:if(e.sent){e.next=13;break}throw new R.NotFoundError(this.host.models.Group.name,r);case 13:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"reactToEscalationsEvent",value:function(e){var t=e.data;this._updateEscalation(t.escalation)}},{key:"_updateEscalation",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).inGroupInject,n=void 0!==t&&t,r={};e&&e.display_name&&(r=this.host.models.EscalationExecution.inject(e));var o=r,a=o.id,i=o.carbonCopyMessage,s=o.groupId,u=o.organizationId,c=o.originalMessage;return c&&this.host.models.Message.inject({escalationExecutionId:a,id:c.id}),i&&this.host.models.Message.inject({escalationExecutionId:a,id:i.id}),s&&!n&&this.host.models.Group.inject({id:s,escalationExecutionId:a,organizationId:u}),r}},{key:"getAll",value:function(){return this.host.models.EscalationExecution.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(e));return this.host.models.EscalationExecution.get(e)}}]),o((d=z).prototype,"escalateMessage",[a],(0,E.default)(d.prototype,"escalateMessage"),d.prototype),o(d.prototype,"acknowledge",[i],(0,E.default)(d.prototype,"acknowledge"),d.prototype),o(d.prototype,"cancel",[s],(0,E.default)(d.prototype,"cancel"),d.prototype),o(d.prototype,"skip",[u],(0,E.default)(d.prototype,"skip"),d.prototype),o(d.prototype,"removeEscalationGroup",[c],(0,E.default)(d.prototype,"removeEscalationGroup"),d.prototype),d);function z(){return(0,I.default)(this,z),(0,j.default)(this,(z.__proto__||(0,A.default)(z)).apply(this,arguments))}t.default=P,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function _(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=_(t[0],n);return t.every(function(e){return _(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return _(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+_(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function w(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=w(t[0],n);return t.every(function(e){return w(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return w(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+w(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,i=r(n(4)),s=r(n(5)),u=r(n(3)),x=r(n(20)),E=r(n(13)),k=r(n(12)),T=r(n(24)),A=r(n(54)),I=r(n(10)),O=r(n(9)),j=r(n(6)),S=r(n(1)),a=r(n(2)),M=r(n(8)),c=r(n(7)),l=r(n(15)),f=(o=l.default,(0,c.default)(R,o),(0,a.default)(R,[{key:"emit",value:function(e){this.EVENTS[e.type]?this.EVENTS[e.type].call(this,e):this.logger.info("unhandled event: "+e.type,e.data)}}]),R);function R(e,t){var n;(0,S.default)(this,R);var r=(0,M.default)(this,(R.__proto__||(0,j.default)(R)).call(this,e,t));if(r.EVENTS=(n={},(0,A.default)(n,"bang",function(e){this.host.groups.reactToBangEvent(e)}),(0,A.default)(n,"client_advisory",function(e){switch(e.data.advisory.name){case"replay_start":this.host.reactToAdvisoryEvent("replayStart",{replayMessageCount:e.data.advisory.replay_message_count});break;case"replay_stop":this.host.reactToAdvisoryEvent("replayStop")}}),(0,A.default)(n,"escalations",function(e){this.host.escalations.reactToEscalationsEvent(e)}),(0,A.default)(n,"friends",function(e){this.host.conversations.reactToFriendsEvent(e)}),(0,A.default)(n,"message|group_message",function(e){this.host.conversations.reactToMessageEvent(e)}),(0,A.default)(n,"message:status|group:message:status",function(e){this.host.messages.reactToMessageStatusEvent(e)}),(0,A.default)(n,"user_preferences",function(e){this.host.users.reactToUserPreferencesEvent(e)}),(0,A.default)(n,"org_preferences",function(e){this.host.organizations.reactToOrganizationPreferencesEvent(e)}),(0,A.default)(n,"presence",function(e){this.host.presence.reactToPresenceEvent(e)}),(0,A.default)(n,"update",function(e){this.host.conversations.reactToUpdateEvent(e)}),(0,A.default)(n,"update:tag",function(e){this.host.roleTags.reactToUpdateEvent(e)}),(0,A.default)(n,"update:team_request",function(e){this.host.conversations.reactToUpdateTeamRequestEvent(e)}),(0,A.default)(n,"account:settings",function(n){var r=this;n.data.services.forEach(function(e){switch(e.xmlns){case"tigertext:iq:update:account":var t=e.account||n.data.token;r.host.users.refresh(t);break;case"tigertext:iq:update:org_settings":r.host.organizations.refreshAll();break;default:r.logger.warn("unhandled account:settings service type "+e.xmlns)}})}),(0,A.default)(n,"message:is_typing",function(e){this.host.typingStatus.reactToIsTypingEvent(e)}),(0,A.default)(n,"processing:start",function(e){this.host.conversations.reactToProcessingStart(e)}),(0,A.default)(n,"processing:stop",function(e){this.host.conversations.reactToProcessingStop(e)}),(0,A.default)(n,"remote_wipe",function(e){var t=this;return(0,O.default)(I.default.mark(function e(){return I.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.host.notifications.disconnect({source:"remote_wipe event"}),t.host.signOut({fromServer:!0});case 2:case"end":return e.stop()}},e,t)}))()}),(0,A.default)(n,"validated",function(e){this.logger.warn("validated not implemented")}),(0,A.default)(n,"msg:metadata_update",function(e){this.logger.warn("msg:metadata_update not implemented")}),(0,A.default)(n,"conversation_mute",function(e){this.host.mute.reactToMuteEvent(e)}),(0,A.default)(n,"reconnect",function(e){this.host.events.reconnect()}),(0,A.default)(n,"voip:incoming|voip:ended|voip:answered|voip:state",function(e){this.host.calls.reactToVoipSSE(e)}),(0,A.default)(n,"push:credentials",function(){return null}),(0,A.default)(n,"sse:heartbeat",function(){return null}),(0,A.default)(n,"sse:keepalive",function(){return null}),n),!(c=(0,T.default)(r.EVENTS))||"function"!=typeof c[k.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+_(c));if(!c||"function"!=typeof c[k.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+w(c));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,E.default)(c);!(o=(s=u.next()).done);o=!0){var c,l=(0,x.default)(s.value,2),f=l[0],d=l[1];if(f.includes("|")){if(!(m=f.split("|"))||"function"!=typeof m[k.default]&&!Array.isArray(m))throw new TypeError("Expected _eventName$split to be iterable, got "+_(m));if(!m||"function"!=typeof m[k.default]&&!Array.isArray(m))throw new TypeError("Expected _eventName$split to be iterable, got "+w(m));var p=!0,h=!1,y=void 0;try{for(var v,g=(0,E.default)(m);!(p=(v=g.next()).done);p=!0){var m,b=v.value;r.EVENTS[b]=d}}catch(e){h=!0,y=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw y}}delete r.EVENTS[f]}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}return r}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,g.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,v.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,y.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,g.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,v.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,y.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,u,c,l,f,d,p,h,y=r(n(4)),v=r(n(5)),g=r(n(3)),m=r(n(11)),b=r(n(10)),_=r(n(47)),w=r(n(19)),x=r(n(9)),E=r(n(6)),k=r(n(1)),T=r(n(2)),A=r(n(8)),I=r(n(7)),O=r(n(35)),j=r(n(87)),S=n(21),M=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),R=r(n(15)),C=(a=(0,S.decorator)(),u=(0,S.decorator)(),l=R.default,(0,I.default)(P,l),(0,T.default)(P,[{key:"mounted",value:function(){this._fetched=!1}},{key:"dispose",value:function(){this._fetched=!1}},{key:"create",value:(h=(0,x.default)(b.default.mark(function e(t){var n,r,o,a,i=this,s=t.avatarFile,u=t.description,c=t.memberIds,l=void 0===c?[]:c,f=t.metadata,d=t.name,p=t.organizationId,h=t.replayHistory,y=void 0===h||h,v=t.senderId,g=void 0===v?this.host.currentUserId:v;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),p){e.next=3;break}throw new M.ValidationError("organizationId","required");case 3:return e.next=5,w.default.all([g].concat((0,_.default)(l)).map(this.host.roles.__resolveRoleId).filter(Boolean).map(function(e){return i._resolveModelIdWithTypes(e,"user")}).map(function(e){return i.host.users.findOrCreate(e,{organizationId:p})}));case 5:return n=e.sent,e.t0=n,r=j.default.call(e.t0),l=r.map(function(e){return i._resolveModelIdWithTypes(e,"user")}),e.next=11,this.host.api.groups.create({avatarFile:s,description:u,excludeCreator:!1,isPublic:!0,memberIds:l,metadata:f,name:d,organizationId:p,replayHistory:y});case 11:return o=e.sent,a=this.config.condensedReplays&&o.entity?this.host.conversations.__injectCounterParty({conversationId:o.conversation_id,entityAttrs:o.entity,entityType:"group",hasCurrentUser:!0,organizationId:o.organization_id}):this.host.models.Group.inject(o),f&&this.host.metadata.__injectMetadata(a.id,p,f),e.abrupt("return",a);case 16:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"find",value:(p=(0,x.default)(b.default.mark(function e(t){var n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(t));e.next=4;break;case 4:if(o=(0,O.default)(o,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),n=null,o.bypassCache){e.next=13;break}if((n=this.host.models.Group.get(t))&&!n.$placeholder)return e.next=12,this.host.groups.__ensureEntitiesLoaded(n.id,o);e.next=13;break;case 12:return e.abrupt("return",n);case 13:return e.next=15,this.host.groups.__find(t);case 15:if(r=e.sent,n=this.host.models.Group.get(t),r){e.next=21;break}if(o.ignoreNotFound){e.next=20;break}throw new M.NotFoundError(this.host.models.Group.name,t);case 20:return e.abrupt("return",n);case 21:if(n)return e.next=24,this.host.groups.__ensureEntitiesLoaded(n.id,o);e.next=24;break;case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"findAll",value:(d=(0,x.default)(b.default.mark(function e(){var t,n,r,o,a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).bypassCache,i=void 0!==a&&a;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i&&this._fetched)return e.abrupt("return",this.getAll());e.next=2;break;case 2:if(0===(t=this.host.models.Organization.getAll()).length)return e.next=6,this.host.organizations.findAll();e.next=7;break;case 6:t=e.sent;case 7:return e.next=9,this.host.search.query({types:["forum"],organizationIds:t.map(function(e){return e.id}),query:{displayName:""},followContinuations:!0});case 9:return n=e.sent,r=n.results,o=r.map(function(e){return e.entity}),this._fetched=!0,e.abrupt("return",o);case 14:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)})},{key:"getAll",value:function(){return this.host.models.Group.getAll().filter(function(e){return e.isPublic})}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));return this.host.models.Group.get(e)}},{key:"join",value:(f=(0,x.default)(b.default.mark(function e(t){return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+s(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+i(t));case 4:return e.abrupt("return",this.host.groups.addMembers(t,[this.host.currentUserId]));case 5:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})}]),o((c=P).prototype,"find",[a],(0,m.default)(c.prototype,"find"),c.prototype),o(c.prototype,"findAll",[u],(0,m.default)(c.prototype,"findAll"),c.prototype),c);function P(){return(0,k.default)(this,P),(0,A.default)(this,(P.__proto__||(0,E.default)(P)).apply(this,arguments))}t.default=C,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function L(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,C.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=L(t[0],n);return t.every(function(e){return L(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return L(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,R.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,M.default)(e))+": "+L(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function B(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,C.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=B(t[0],n);return t.every(function(e){return B(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return B(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,R.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,M.default)(e))+": "+B(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M=r(n(4)),R=r(n(5)),C=r(n(3)),P=r(n(11)),z=r(n(20)),V=r(n(24)),G=r(n(10)),N=r(n(16)),D=r(n(47)),U=r(n(19)),F=r(n(9)),$=r(n(13)),q=r(n(12)),H=r(n(6)),Y=r(n(1)),Z=r(n(2)),W=r(n(8)),K=r(n(7)),X=r(n(880)),Q=r(n(156)),J=r(n(898)),ee=r(n(35)),te=r(n(73)),ne=r(n(115)),re=r(n(15)),oe=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),ae=n(21),ie=r(n(87)),se=n(36),ue=n(29),ce=n(67),le=n(46),fe=(a=(0,ae.decorator)(),i=(0,ae.decorator)(),s=(0,ae.decorator)(),u=(0,ae.decorator)(),c=(0,ae.decorator)(),l=(0,ae.decorator)(),d=re.default,(0,K.default)(de,d),(0,Z.default)(de,[{key:"mounted",value:function(){this._fetched=!1,this._groupMemberIds={},this._userGroups={},this._userState={},this.host.models.Conversation.on("afterInject",this._onChangeConversation),this.host.models.Conversation.on("afterEject",this._onRemoveConversation),this.host.models.Group.on("afterInject",this._onChangeGroup),this.host.models.Group.on("afterEject",this._onRemoveGroup),this.host.models.Metadata.on("afterInject",this._onChangeMetadata),this.host.models.Metadata.on("afterEject",this._onChangeMetadata),this.host.models.User.on("afterInject",this._onChangeUser),this.host.models.User.on("afterEject",this._onRemoveUser)}},{key:"dispose",value:function(){this._fetched=!1,this._groupMemberIds={},this._userGroups={},this._userState={},this.host.models.Conversation.removeListener("afterInject",this._onChangeConversation),this.host.models.Conversation.removeListener("afterEject",this._onRemoveConversation),this.host.models.Group.removeListener("afterInject",this._onChangeGroup),this.host.models.Group.removeListener("afterEject",this._onRemoveGroup),this.host.models.Metadata.removeListener("afterInject",this._onChangeMetadata),this.host.models.Metadata.removeListener("afterEject",this._onChangeMetadata),this.host.models.User.removeListener("afterInject",this._onChangeUser),this.host.models.User.removeListener("afterEject",this._onRemoveUser)}},{key:"create",value:(S=(0,F.default)(G.default.mark(function e(t){var n,r,o,a,i,s=this,u=t.avatarFile,c=t.description,l=t.isPatientGroup,f=void 0!==l&&l,d=t.isTeamActivation,p=void 0!==d&&d,h=t.memberIds,y=void 0===h?[]:h,v=t.metadata,g=t.name,m=t.organizationId,b=t.replayHistory,_=void 0!==b&&b,w=t.senderId,x=void 0===w?this.host.currentUserId:w;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),m){e.next=3;break}throw new oe.ValidationError("organizationId","required");case 3:return e.next=5,U.default.all([x].concat((0,D.default)(y)).map(this.host.roles.__resolveRoleId).filter(Boolean).map(function(e){return s._resolveModelIdWithTypes(e,["user","team"])}).map(function(e){var t=s._resolveEntity(e);return"team"===(0,te.default)(t,"$entityType")?t:s.host.users.findOrCreate(e,{organizationId:m})}));case 5:return n=e.sent,e.t0=n,r=ie.default.call(e.t0),y=r.map(function(e){return s._resolveModelIdWithTypes(e,["user","team"])}),o=this._shouldExcludeSender(m,y,x),g||f||p||(g=this._getGroupName(r)),e.next=13,this.host.api.groups.create({avatarFile:u,description:c,excludeCreator:o,memberIds:y,metadata:v,name:g,organizationId:m,replayHistory:_});case 13:if(a=e.sent,i=void 0,this.config.condensedReplays&&a.entity?(i=this.host.conversations.__injectCounterParty({conversationId:a.conversation_id,entityAttrs:a.entity,entityType:"group",organizationId:a.organization_id}),this.host.conversations.__injectConversation((0,N.default)({},a,{entity:i}))):i=this.host.models.Group.inject(a),!v){e.next=20;break}this.host.metadata.__injectMetadata(i.id,m,v),e.next=23;break;case 20:if(this.config.condensedReplays){e.next=23;break}return e.next=23,this.host.metadata.find(i.id,m);case 23:return e.abrupt("return",i);case 24:case"end":return e.stop()}},e,this)})),function(e){return S.apply(this,arguments)})},{key:"createPatientGroup",value:function(e){var t=e.metadata,n=e.name,r=e.organizationId,o=e.recipientId,a=e.senderId;return this.create({isPatientGroup:!0,metadata:t,name:n,organizationId:r,memberIds:[a].concat((0,D.default)(o))})}},{key:"_shouldExcludeSender",value:function(e,t,n){var r,o,a=this.host.models.User.get(n);return!!((r=o=a)&&"user"===r.$entityType&&o.isRoleBot&&a.botRole&&0<a.botRole.members.length)&&!t.includes(a.botRole.memberIds[0])}},{key:"_getGroupName",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return e.map(function(e){var t=e.displayName,n=e.firstName;return e.isRoleBot||"role"===e.$entityType||"team"===e.$entityType?t:n||((0,ce.isEmail)(t)||(0,le.isPhone)(t)?t:"")}).filter(Boolean).join(", ")+(t?" ####":"")||"Group"}},{key:"update",value:(j=(0,F.default)(G.default.mark(function e(t,n){var r,o,a,i=n.name,s=n.avatarFile,u=n.replayHistory,c=n.memberIds,l=n.metadata;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 4:return this.host.requireUser(),t=this._resolveModelId(t),r={},void 0!==i&&(r.name=i),void 0!==u&&(r.replayHistory=u),void 0!==c&&(r.memberIds=c.map(this.host.roles.__resolveRoleId)),e.next=12,this.host.api.groups.update(t,{name:i,avatarFile:s,replayHistory:u,memberIds:c});case 12:if(void 0!==(o=e.sent).avatarUrl&&(r.avatarUrl=o.avatarUrl),a=this.host.models.Group.inject((0,N.default)({id:t},r)),l)return e.next=18,this.host.metadata.update(t,l,a.organizationId);e.next=18;break;case 18:return e.abrupt("return",a);case 19:case"end":return e.stop()}},e,this)})),function(e,t){return j.apply(this,arguments)})},{key:"find",value:(O=(0,F.default)(G.default.mark(function e(t){var n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+B(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=4;break;case 4:if(o=(0,ee.default)(o,{bypassCache:!1,ignoreNotFound:!1,includeMembers:!1}),this.host.requireUser(),n=null,o.bypassCache){e.next=13;break}if((n=this.host.models.Group.get(t))&&!n.$placeholder)return e.next=12,this.__ensureEntitiesLoaded(n.id,o);e.next=13;break;case 12:return e.abrupt("return",n);case 13:return e.next=15,this.__find(t);case 15:if(r=e.sent,n=this.host.models.Group.get(t),r){e.next=21;break}if(o.ignoreNotFound){e.next=20;break}throw new oe.NotFoundError(this.host.models.Group.name,t);case 20:return e.abrupt("return",n);case 21:if(n)return e.next=24,this.__ensureEntitiesLoaded(n.id,o);e.next=24;break;case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}},e,this)})),function(e){return O.apply(this,arguments)})},{key:"__find",value:(I=(0,F.default)(G.default.mark(function e(t){var n,r,o,a,i;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+B(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=4;break;case 4:return n=this.host.models.Group.get(t),e.next=7,this.host.api.groups.find(t);case 7:if(r=e.sent,this.config.condensedReplays&&r&&r.entity)return o=r.entity,n=this.host.conversations.__injectCounterParty({conversationId:r.conversation_id,entityAttrs:o,entityType:"group",organizationId:r.organization_id}),this.host.models.Group.removePlaceholder({entity:n,attrs:o}),e.abrupt("return",o);e.next=15;break;case 15:return r&&(this.__removeForumMembers(r),a=r.metadata,n=this.host.models.Group.inject(r),i=n.organizationId,a&&i&&this.host.metadata.__injectMetadata(t,i,a)),this.host.models.Group.removePlaceholder({entity:n,attrs:r}),e.abrupt("return",r);case 18:case"end":return e.stop()}},e,this)})),function(e){return I.apply(this,arguments)})},{key:"__removeForumMembers",value:function(e){var t=e.members,n=this.__extractGroupTypeFromAttrs(e);n===se.GroupType.FORUM?t&&0===t.length&&delete e.members:n===se.GroupType.ROLE_ASSIGNMENT||t||(e.members=[])}},{key:"__extractGroupTypeFromAttrs",value:function(e){var t=e.id||e.token,n=e.organizationId||e.organization_key,r=n?this.host.metadata.get(t,n):null,o=e.metadata||(r?r.data:null),a=se.GroupType.GROUP;if(o&&"role_assignment"===o.meta_type)a=se.GroupType.ROLE_ASSIGNMENT;else if(o&&"role"===o.feature_service)a=se.GroupType.ROLE_P2P;else if(o&&"escalation"===o.feature_service)a=se.GroupType.ESCALATION;else if(o&&"patient_care"===o.feature_service)a=se.GroupType.PATIENT_CARE;else if(o&&"patient_messaging"===o.feature_service)a=se.GroupType.PATIENT_MESSAGING;else if(o&&"teams"===o.feature_service){var i=o.meta_type;"activated_team"===i?a=se.GroupType.ACTIVATED_TEAM:"intra_team"===i&&(a=se.GroupType.INTRA_TEAM)}else(e.isPublic||e.is_public)&&(a=se.GroupType.FORUM);return a}},{key:"__ensureEntitiesLoaded",value:(A=(0,F.default)(G.default.mark(function e(t,n){var r,o;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+B(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=4;break;case 4:return r=this.host.models.Group.get(t),o=[this.ensureMetadata(r)],n.includeMembers&&o.push(this.ensureMembers(r)),e.next=9,U.default.all(o);case 9:case"end":return e.stop()}},e,this)})),function(e,t){return A.apply(this,arguments)})},{key:"findAll",value:(T=(0,F.default)(G.default.mark(function e(){var t,n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).includeMembers,j=void 0!==O&&O;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._fetched)return e.abrupt("return",this.getAll());e.next=2;break;case 2:if(0===(t=this.host.models.Organization.getAll()).length)return e.next=6,this.host.organizations.findAll();e.next=7;break;case 6:t=e.sent;case 7:return e.next=9,this.host.search.query({types:["group"],organizationIds:t.map(function(e){return e.id}),query:{displayName:""},followContinuations:!0});case 9:if(n=e.sent,r=n.results,o=r.map(function(e){return e.entity}),!j){e.next=93;break}if(a={},!o||"function"!=typeof o[q.default]&&!Array.isArray(o))throw new TypeError("Expected groups to be iterable, got "+L(o));e.next=16;break;case 16:if(!o||"function"!=typeof o[q.default]&&!Array.isArray(o))throw new TypeError("Expected groups to be iterable, got "+B(o));e.next=18;break;case 18:s=!(i=!0),u=void 0,e.prev=21,c=(0,$.default)(o);case 23:if(i=(l=c.next()).done){e.next=52;break}if(f=l.value,d=f.organizationId,!(p=f.memberIds)||"function"!=typeof p[q.default]&&!Array.isArray(p))throw new TypeError("Expected memberIds to be iterable, got "+L(p));e.next=28;break;case 28:if(!p||"function"!=typeof p[q.default]&&!Array.isArray(p))throw new TypeError("Expected memberIds to be iterable, got "+B(p));e.next=30;break;case 30:for(y=!(h=!0),v=void 0,e.prev=33,g=(0,$.default)(p);!(h=(m=g.next()).done);h=!0)b=m.value,a[d]||(a[d]=[]),a[d].includes(b)||a[d].push(b);e.next=41;break;case 37:e.prev=37,e.t0=e.catch(33),y=!0,v=e.t0;case 41:e.prev=41,e.prev=42,!h&&g.return&&g.return();case 44:if(e.prev=44,y)throw v;e.next=47;break;case 47:return e.finish(44);case 48:return e.finish(41);case 49:i=!0,e.next=23;break;case 52:e.next=58;break;case 54:e.prev=54,e.t1=e.catch(21),s=!0,u=e.t1;case 58:e.prev=58,e.prev=59,!i&&c.return&&c.return();case 61:if(e.prev=61,s)throw u;e.next=64;break;case 64:return e.finish(61);case 65:return e.finish(58);case 66:if(_=[],!(A=(0,V.default)(a))||"function"!=typeof A[q.default]&&!Array.isArray(A))throw new TypeError("Expected _Object$entries to be iterable, got "+L(A));e.next=70;break;case 70:if(!A||"function"!=typeof A[q.default]&&!Array.isArray(A))throw new TypeError("Expected _Object$entries to be iterable, got "+B(A));e.next=72;break;case 72:for(x=!(w=!0),E=void 0,e.prev=75,k=(0,$.default)(A);!(w=(T=k.next()).done);w=!0)I=(0,z.default)(T.value,2),d=I[0],p=I[1],_.push(this.host.users.ensureUsers(p,d));e.next=83;break;case 79:e.prev=79,e.t2=e.catch(75),x=!0,E=e.t2;case 83:e.prev=83,e.prev=84,!w&&k.return&&k.return();case 86:if(e.prev=86,x)throw E;e.next=89;break;case 89:return e.finish(86);case 90:return e.finish(83);case 91:return e.next=93,U.default.all(_);case 93:return this._fetched=!0,e.abrupt("return",o);case 95:case"end":return e.stop()}},e,this,[[21,54,58,66],[33,37,41,49],[42,,44,48],[59,,61,65],[75,79,83,91],[84,,86,90]])})),function(){return T.apply(this,arguments)})},{key:"findAllWithSpecificMembers",value:(k=(0,F.default)(G.default.mark(function e(t,n,r){var o;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+B(t));case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(n));case 4:if(null==r||r instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+B(r));case 6:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+L(t));case 8:if("string"==typeof n||n instanceof Object){e.next=10;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(n));case 10:if(null==r||r instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+L(r));case 12:if(n=this._resolveModelId(n),t=(0,ue.arrayWrap)(t).map(this._resolveModelId).map(this.host.roles.__resolveRoleId),o=this.__findAllLocalWithSpecificMembers(t,n,r),r&&r.localOnly||0!==o.length){e.next=20;break}return e.next=19,this.findAll();case 19:o=this.__findAllLocalWithSpecificMembers(t,n,r);case 20:return e.abrupt("return",o);case 21:case"end":return e.stop()}},e,this)})),function(e,t,n){return k.apply(this,arguments)})},{key:"ensureMembers",value:(E=(0,F.default)(G.default.mark(function e(t){var n,r,o,a,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+B(t));case 2:if(t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+L(t));case 4:if(n=t.groupType===se.GroupType.ROLE_ASSIGNMENT,t.memberIds){e.next=18;break}if(t.groupType===se.GroupType.FORUM)return e.next=9,this.findAllMemberIds(t.id);e.next=13;break;case 9:(r=e.sent)&&this.host.models.Group.inject({id:t.id,members:r}),e.next=18;break;case 13:if(!n){e.next=16;break}e.next=18;break;case 16:return e.next=18,this.__find(t.id);case 18:return o=i.attrs?(0,N.default)({},i.attrs):{},a=n&&!t.memberIds?[]:t.memberIds,o.organizationId=t.organizationId,e.next=23,this.ensureMembersWithIds(t.id,a,(0,N.default)({},i,{attrs:o}));case 23:case"end":return e.stop()}},e,this)})),function(e){return E.apply(this,arguments)})},{key:"ensureMembersWithIds",value:(x=(0,F.default)(G.default.mark(function e(t,n){var r=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+B(t));e.next=2;break;case 2:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})){e.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+B(n));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=6;break;case 6:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})){e.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+L(n));case 8:if(this.host.requireUser(),0===(n=(0,J.default)(n,this.host.currentUserId)).length)return e.abrupt("return");e.next=12;break;case 12:return o=(0,ee.default)(o,{onlyPlaceholder:!1}),e.next=15,U.default.all(n.map(function(e){return r.__ensureMember(e,o)}).filter(Boolean));case 15:0<e.sent.length&&this.host.models.Group.touch(t);case 17:case"end":return e.stop()}},e,this)})),function(e,t){return x.apply(this,arguments)})},{key:"__ensureMember",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+B(e));if("string"!=typeof e)throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(e));if(!this.host.models.User.shouldEnsure(e,t.onlyPlaceholder))return null;var n=this.host.models.User.get(e);return n&&t.attrs&&this.host.models.User.injectPlaceholder((0,N.default)({id:n.id},t.attrs)),this.host.models.User.waitForEnsuredEntity(e,t)}},{key:"ensureMetadata",value:(w=(0,F.default)(G.default.mark(function e(t){var n,r,o;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+B(t));case 2:if(t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "group" violates contract.\n\nExpected:\nObject\n\nGot:\n'+L(t));case 4:if(n=t.groupType,r=t.id,(o=t.organizationId)&&this.host.metadata.get(r,o)){e.next=12;break}if(n!==se.GroupType.FORUM&&n!==se.GroupType.ROLE_ASSIGNMENT){e.next=10;break}e.next=12;break;case 10:return e.next=12,this.__find(r);case 12:case"end":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)})},{key:"getAll",value:function(){return this.host.models.Group.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+B(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(e));return this.host.models.Group.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+B(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+L(e));return this.host.models.Group.getMulti(e)}},{key:"__findAllLocalWithSpecificMembers",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=n.exact,o=void 0===r||r,a=n.includeCurrentUser,i=void 0===a||a,s=n.includeForums,u=void 0===s||s,c=n.includeRoles,l=void 0===c||c,f=n.senderId,d=void 0===f?null:f;if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+B(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+B(t));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+L(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));var p=this.host,h=p.currentUser,y=p.currentUserId,v=h.roles.map(function(e){return e.botUserId});d&&v.includes(d)?(e=e.slice()).push(d,y):i&&!e.includes(y)&&(e=e.slice()).push(y);var g=e.includes(y),m=e.length,b=this.host.models.Group.getAll(),_=[];if(!b||"function"!=typeof b[q.default]&&!Array.isArray(b))throw new TypeError("Expected all to be iterable, got "+L(b));if(!b||"function"!=typeof b[q.default]&&!Array.isArray(b))throw new TypeError("Expected all to be iterable, got "+B(b));var w=!0,x=!1,E=void 0;try{for(var k,T=(0,$.default)(b);!(w=(k=T.next()).done);w=!0){var A=k.value;if(u||A.groupType!==se.GroupType.FORUM){var I=A.memberIds;if(A.organizationId===t&&I){var O=!0;if(!e||"function"!=typeof e[q.default]&&!Array.isArray(e))throw new TypeError("Expected memberIds to be iterable, got "+L(e));if(!e||"function"!=typeof e[q.default]&&!Array.isArray(e))throw new TypeError("Expected memberIds to be iterable, got "+B(e));var j=!0,S=!1,M=void 0;try{for(var R,C=(0,$.default)(e);!(j=(R=C.next()).done);j=!0){var P=R.value;if(!I.includes(P)){O=!1;break}}}catch(e){S=!0,M=e}finally{try{!j&&C.return&&C.return()}finally{if(S)throw M}}if(O){if(o){if(!d&&!g)continue;var z=m;if(l){if(!v||"function"!=typeof v[q.default]&&!Array.isArray(v))throw new TypeError("Expected myBotUserIds to be iterable, got "+L(v));if(!v||"function"!=typeof v[q.default]&&!Array.isArray(v))throw new TypeError("Expected myBotUserIds to be iterable, got "+B(v));var V=!0,G=!1,N=void 0;try{for(var D,U=(0,$.default)(v);!(V=(D=U.next()).done);V=!0){var F=D.value;A.memberIds.includes(F)&&z++}}catch(e){G=!0,N=e}finally{try{!V&&U.return&&U.return()}finally{if(G)throw N}}}if(z!==A.memberIds.length)continue}_.push(A)}}}}}catch(e){x=!0,E=e}finally{try{!w&&T.return&&T.return()}finally{if(x)throw E}}return _}},{key:"destroy",value:(_=(0,F.default)(G.default.mark(function e(t){return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 4:return this.host.requireUser(),t=this._resolveModelId(t),e.next=8,this.host.api.groups.destroy(t);case 8:if(e.sent){e.next=11;break}throw new oe.NotFoundError(this.host.models.Group.name,t);case 11:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"findAllMemberIds",value:(b=(0,F.default)(G.default.mark(function e(t){return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 4:return this.host.requireUser(),t=this._resolveModelId(t),e.abrupt("return",this.host.api.groups.findAllMemberIds(t));case 7:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"addMembers",value:(m=(0,F.default)(G.default.mark(function e(t,n){var r,o,a,i;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof n||Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+B(n));case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 6:if("string"==typeof n||Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+L(n));case 8:if(this.host.requireUser(),t=this._resolveModelId(t),n=(0,ue.arrayWrap)(n).map(this._resolveModelId).map(this.host.roles.__resolveRoleId),(r=this.getById(t))&&r.groupType===se.GroupType.ROLE_P2P)throw new oe.PermissionDeniedError("role p2p group",r.id,"add users");e.next=14;break;case 14:if(!r){e.next=20;break}if("FORUM"!==r.groupType||r.memberIds){e.next=19;break}return e.next=18,this.findAllMemberIds(t);case 18:r.memberIds=e.sent;case 19:n=(0,Q.default)(n,r.memberIds);case 20:if(0===n.length)return e.abrupt("return");e.next=22;break;case 22:return e.next=24,this.host.api.groups.addMembers(t,n);case 24:if(o=e.sent,!this.config.condensedReplays){e.next=37;break}if(a=this.host.conversations.getById(o.conversation_id)){e.next=34;break}return e.next=30,this.host.api.conversations.find(o.conversation_id);case 30:if(i=e.sent){e.next=33;break}throw new oe.NotFoundError(this.host.models.Conversation.name,t);case 33:a=this.host.conversations.__injectConversation(i);case 34:o.unread_message_count&&(a.unreadCount=o.unread_message_count),o.unread_priority_message_count&&(a.unreadPriorityCount=o.unread_priority_message_count),this.host.models.Conversation.inject(a);case 37:case"end":return e.stop()}},e,this)})),function(e,t){return m.apply(this,arguments)})},{key:"removeMembers",value:(g=(0,F.default)(G.default.mark(function e(t,n){var r,o,a,i,s;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof n||Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+B(n));case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 6:if("string"==typeof n||Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=8;break}throw new TypeError('Value of argument "memberIds" violates contract.\n\nExpected:\nstring | string[] | Object[]\n\nGot:\n'+L(n));case 8:if(this.host.requireUser(),t=this._resolveModelId(t),n=(0,ue.arrayWrap)(n).map(this._resolveModelId).map(this.host.roles.__resolveRoleId),!(r=this.getById(t))){e.next=22;break}if(o=r.groupType,a=r.id,i=r.p2pSender,s=i&&"role"===i.$entityType&&i.botUserId,o===se.GroupType.ROLE_P2P&&s&&n.includes(s))throw new oe.PermissionDeniedError("role p2p group",a,"remove an on-duty user");e.next=17;break;case 17:if("FORUM"!==o||r.memberIds){e.next=21;break}return e.next=20,this.findAllMemberIds(t);case 20:r.memberIds=e.sent;case 21:n=(0,X.default)(n,r.memberIds);case 22:if(0===n.length)return e.abrupt("return");e.next=24;break;case 24:return e.next=26,this.host.api.groups.removeMembers(t,n);case 26:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"addMember",value:(v=(0,F.default)(G.default.mark(function e(t,n){return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(n));case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 6:if("string"==typeof n||n instanceof Object){e.next=8;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(n));case 8:return e.abrupt("return",this.addMembers(t,[n]));case 9:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"removeMember",value:(y=(0,F.default)(G.default.mark(function e(t,n){return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(n));case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 6:if("string"==typeof n||n instanceof Object){e.next=8;break}throw new TypeError('Value of argument "memberId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(n));case 8:return e.abrupt("return",this.removeMembers(t,[n]));case 9:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})},{key:"leave",value:(h=(0,F.default)(G.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+B(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 4:if(t=this._resolveModelId(t),n=this.getById(t)){e.next=8;break}return e.abrupt("return");case 8:if(r=this.host,o=r.currentUser,a=r.currentUserId,i=n.groupType,s=n.p2pSender,u=n.memberIds,c=o.roles.map(function(e){return e.botUserId}),l=[a],i===se.GroupType.FORUM)return e.next=16,this.findAllMemberIds(t);e.next=17;break;case 16:u=e.sent;case 17:if(i!==se.GroupType.ROLE_P2P||!s){e.next=21;break}l=["user"===s.$entityType?s.id:s.botUserId],e.next=45;break;case 21:if(!u){e.next=45;break}if(!u||"function"!=typeof u[q.default]&&!Array.isArray(u))throw new TypeError("Expected memberIds to be iterable, got "+L(u));e.next=24;break;case 24:if(!u||"function"!=typeof u[q.default]&&!Array.isArray(u))throw new TypeError("Expected memberIds to be iterable, got "+B(u));e.next=26;break;case 26:for(d=!(f=!0),p=void 0,e.prev=29,h=(0,$.default)(u);!(f=(y=h.next()).done);f=!0)v=y.value,c.includes(v)&&l.push(v);e.next=37;break;case 33:e.prev=33,e.t0=e.catch(29),d=!0,p=e.t0;case 37:e.prev=37,e.prev=38,!f&&h.return&&h.return();case 40:if(e.prev=40,d)throw p;e.next=43;break;case 43:return e.finish(40);case 44:return e.finish(37);case 45:return e.next=47,this.removeMembers(t,l);case 47:case"end":return e.stop()}},e,this,[[29,33,37,45],[38,,40,44]])})),function(e){return h.apply(this,arguments)})},{key:"reactToBangEvent",value:function(e){var t=e.data,n=(t=(0,ue.jsonCloneDeep)(t)).bang_id||""+t.sort_number;return this.__handleBang({data:t,eventId:n,alwaysAddToTimeline:!1})}},{key:"__handleBang",value:function(e){var t=e.data,n=e.eventId,r=e.alwaysAddToTimeline,o=void 0!==r&&r,a=t.event;"added"===a?this.__addedToGroup({data:t,eventId:n,alwaysAddToTimeline:o}):"removed"===a?this.__removedFromGroup({data:t,eventId:n,alwaysAddToTimeline:o}):"teams_request_accepted"===a?this.__acceptedToTeam({data:t,eventId:n,alwaysAddToTimeline:o}):"teams_request_declined"===a||"teams_request_declined_full"===a?this.__deniedToTeam({data:t,eventId:n,alwaysAddToTimeline:o}):se.EscalationChangeAction.fromServer(a)?this.__handleEscalationBang({data:t,eventId:n,alwaysAddToTimeline:o}):"ended_voip_call"===a&&this.__handleEndedCall({data:t,eventId:n,alwaysAddToTimeline:o})}},{key:"__handleEndedCall",value:(p=(0,F.default)(G.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w=t.data,x=t.eventId,E=t.alwaysAddToTimeline;return G.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=w.participants_duration,r=w.caller_entity,o=w.conversation_id,a=w.created_on,i=w.organization_id,s=w.sort_number,u=w.subject_entity,c=w.target_entity,l=void 0,e.prev=2,l=JSON.parse(n),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(2),e.abrupt("return");case 9:if(!l||(0,ne.default)(l)||(0,ne.default)(l[this.host.currentUserId]))return e.abrupt("return");e.next=11;break;case 11:if(f=l[this.host.currentUserId],d=f.duration,p=f.start_time,d){e.next=14;break}return e.abrupt("return");case 14:if((0,te.default)(r,"token")&&(0,te.default)(c,"token")){e.next=16;break}return e.abrupt("return");case 16:if(h=[r,c].map(function(e){var t=e.display_name,n=e.token,r=e.type;return{displayName:t,id:n,organizationId:i,type:r}}),y=(0,z.default)(h,2),v=y[0],g=y[1],m=void 0,!g.type.includes("group")){e.next=22;break}m=this.host.models.Group.get(g.id),e.next=28;break;case 22:if(g.type.includes("account"))return e.next=25,this.findAllWithSpecificMembers([g.id,v.id],i);e.next=28;break;case 25:b=e.sent,_=1===b.length&&2===b[0].memberCount,m=_&&b[0];case 28:if(m){e.next=30;break}return e.abrupt("return");case 30:this.host.conversations.addCallChangeLog({action:"CALL_ENDED",alwaysAddToTimeline:E,callee:g,callEntity:u,caller:v,conversationId:o,createdAt:a,duration:d,group:m,id:x,organizationId:i,sortNumber:+s,userStartTime:p});case 31:case"end":return e.stop()}},e,this,[[2,6]])})),function(e){return p.apply(this,arguments)})},{key:"__addedToGroup",value:function(e){var t=e.data,n=e.eventId,r=e.alwaysAddToTimeline,o=t.caller_entity,a=t.subject_entity,i=t.target_entity,s=t.organization_id;if(o&&o.token&&i&&i.token&&a&&a.token){a&&!a.display_name&&(r=!1);var u=this.host.models.Group.get(i.token);if(u){var c,l={displayName:o.display_name,id:o.token,organizationId:s,type:"user"},f={displayName:a.display_name,id:a.token,organizationId:s,type:"user"},d=this.host.models.User.get(l.id),p={action:c=d&&d.isRoleBot||o.metadata&&"role"===o.metadata.feature_service?"OPT_IN":f.id===l.id?"JOIN":"ADD",actionTime:t.action_time||t.created_on,actor:l,alwaysAddToTimeline:r,createdAt:t.created_on,group:u,id:n,members:[f],memberIds:[f.id],sortNumber:+t.sort_number};this.host.conversations.addMembershipChangeLog(p),"OPT_IN"!=c&&u.memberIds&&u.memberIds.includes(f.id)||(this.host.models.Group.touch(u),this.emit("membership:change",p))}}}},{key:"__removedFromGroup",value:function(e){var t=e.data,n=e.eventId,r=e.alwaysAddToTimeline,o=t.caller_entity,a=t.subject_entity,i=t.target_entity,s=t.organization_id,u=!1;if(o&&o.token&&i&&i.token&&a&&a.token){var c=this.host.models.Group.get(i.token);if(c){if(t.reason&&("leave_org"===t.reason||"delete_account"===t.reason)&&(t.reason_subject_token||t.subject_entity.token)){u=!(r=!1);var l=t.reason_subject_token||t.subject_entity.token;this.host.models.User.inject({id:l,removedFromOrg:!0})}var f,d={displayName:o.display_name,id:o.token,organizationId:s,type:"user"},p={displayName:a.display_name,id:a.token,organizationId:s,type:"user"},h=this.host.models.User.get(d.id),y={action:f=h&&h.isRoleBot||o.metadata&&"role"===o.metadata.feature_service?"OPT_OUT":p.id===d.id?"LEAVE":"REMOVE",actionTime:t.action_time||t.created_on,actor:d,alwaysAddToTimeline:r,createdAt:t.created_on,group:c,id:n,members:[p],memberIds:[p.id],removedFromGroup:u,sortNumber:+t.sort_number};this.host.conversations.addMembershipChangeLog(y),"OPT_OUT"!=f&&c.memberIds&&!c.memberIds.includes(p.id)||this.emit("membership:change",y)}}}},{key:"__acceptedToTeam",value:function(e){var t=e.data,n=e.eventId,r=e.alwaysAddToTimeline,o=t.caller_entity,a=t.subject_entity,i=t.target_entity,s=t.organization_id;if(o&&o.token&&i&&i.token&&a&&a.token){var u=this.host.models.Group.get(i.token);if(u){var c={displayName:t.action_user_name,id:t.action_user_id,organizationId:s,type:"user"},l={displayName:o.display_name,id:o.token,organizationId:s,type:"user"},f={action:"ADD",actionTime:t.action_time||t.created_on,actor:c,alwaysAddToTimeline:r,createdAt:t.created_on,group:u,id:n,members:[l],memberIds:[l.id],sortNumber:+t.sort_number};this.host.conversations.addMembershipChangeLog(f)}}}},{key:"__deniedToTeam",value:function(e){var t=e.data,n=e.eventId,r=e.alwaysAddToTimeline,o=t.caller_entity,a=t.subject_entity,i=t.target_entity,s=t.organization_id;if(o&&o.token&&i&&i.token&&a&&a.token){var u=this.host.models.Group.get(i.token);if(u){var c={displayName:t.action_user_name,id:t.action_user_id,organizationId:s,type:"user"},l={displayName:o.display_name,id:o.token,organizationId:s,type:"user"},f={action:"DENY",actionTime:t.action_time||t.created_on,actor:c,alwaysAddToTimeline:r,createdAt:t.created_on,group:u,id:n,members:[l],memberIds:[l.id],sortNumber:+t.sort_number};this.host.conversations.addMembershipChangeLog(f)}}}},{key:"__handleEscalationBang",value:function(e){var t=e.data,n=e.eventId,r=e.alwaysAddToTimeline,o=t.caller_entity,a=t.subject_entity,i=t.target_entity,s=t.organization_id;if(a.token&&i.token){var u=this.host.models.Group.get(i.token);u=u||this.host.models.Group.injectPlaceholder({id:i.token,organizationId:s});var c=this.host.models.EscalationExecution.get(a.token);c=(c=c||u.escalationExecution)||(l===se.EscalationChangeAction.MEMBER_ADDED?null:this.host.models.EscalationExecution.inject({id:a.token,organizationId:s}));var l=se.EscalationChangeAction.resolve(t.event),f=t.action_user_name,d=t.action_time||t.created_on,p=null,h=null;l===se.EscalationChangeAction.INITIATED?p={displayName:o.display_name,id:o.token,organizationId:s,type:"user"}:l===se.EscalationChangeAction.MEMBER_ADDED?h=[{displayName:t.member_name,id:t.member_id,organizationId:s,type:"user"}]:l!==se.EscalationChangeAction.NO_RESPONSE&&(p={displayName:f,id:null,organizationId:s,type:"user"});var y={action:l,actionTime:d,actor:p,alwaysAddToTimeline:r,createdAt:t.created_on,escalationExecution:c,group:u,members:h,id:n,sortNumber:+t.sort_number};this.host.conversations.addEscalationExecutionChangeLog(y)}}},{key:"_setMembership",value:function(e){var t=this.host.currentUser.roles.reduce(function(e,t){var n=t.botUserId;return n&&(e[n]=!0),e},{});if(e.hasCurrentUserOrRole=!1,e.memberIds){if(!(s=e.memberIds)||"function"!=typeof s[q.default]&&!Array.isArray(s))throw new TypeError("Expected _entity$memberIds to be iterable, got "+L(s));if(!s||"function"!=typeof s[q.default]&&!Array.isArray(s))throw new TypeError("Expected _entity$memberIds to be iterable, got "+B(s));var n=!0,r=!1,o=void 0;try{for(var a,i=(0,$.default)(s);!(n=(a=i.next()).done);n=!0){var s,u=a.value;if(u===this.host.currentUserId||t[u])return void(e.hasCurrentUserOrRole=!0)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}}}}]),o((f=de).prototype,"find",[a],(0,P.default)(f.prototype,"find"),f.prototype),o(f.prototype,"__find",[i],(0,P.default)(f.prototype,"__find"),f.prototype),o(f.prototype,"__ensureEntitiesLoaded",[s],(0,P.default)(f.prototype,"__ensureEntitiesLoaded"),f.prototype),o(f.prototype,"findAll",[u],(0,P.default)(f.prototype,"findAll"),f.prototype),o(f.prototype,"findAllWithSpecificMembers",[c],(0,P.default)(f.prototype,"findAllWithSpecificMembers"),f.prototype),o(f.prototype,"findAllMemberIds",[l],(0,P.default)(f.prototype,"findAllMemberIds"),f.prototype),f);function de(){var e,t,_,n;(0,Y.default)(this,de);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=_=(0,W.default)(this,(e=de.__proto__||(0,H.default)(de)).call.apply(e,[this].concat(o))),_._setP2PEntities=function(e){var t=e.createdByRole,n=e.createdByUser,r=e.groupType,o=e.targetUser,a=e.targetRole,i=_.host.currentUser;if(i&&r===se.GroupType.ROLE_P2P){var s=i.roles,u=[],c=[];t?c.push(t):n&&n!==i&&u.push(n),a?c.push(a):o&&o!==i&&u.push(o);var l=null,f=null;1===c.length?f=n===i||o===i?s.includes(c[0])?(l=i,c[0]):(l=c[0],i):(l=u[0],c[0]):2===c.length&&(s.includes(c[0])?(l=c[1],f=c[0]):s.includes(c[1])&&(l=c[0],f=c[1])),e.p2pRecipient=l,e.p2pSender=f}},_._onChangeConversation=function(e,t){var n=t.counterPartyId;if("group"===t.counterPartyType){var r=_.host.models.Group.get(n);r&&(r.conversation||_.host.models.Group.inject(r))}},_._onRemoveConversation=function(e,t){var n=t.counterPartyId;if("group"===t.counterPartyType){var r=_.host.models.Group.get(n);r&&r.conversation&&_.host.models.Group.inject(r)}},_._onChangeGroup=function(e,t){var n=t.id,r=t.memberIds,o=_._groupMemberIds[n];if(o){if(!o||"function"!=typeof o[q.default]&&!Array.isArray(o))throw new TypeError("Expected lastGroupMemberIds to be iterable, got "+L(o));if(!o||"function"!=typeof o[q.default]&&!Array.isArray(o))throw new TypeError("Expected lastGroupMemberIds to be iterable, got "+B(o));var a=!0,i=!1,s=void 0;try{for(var u,c=(0,$.default)(o);!(a=(u=c.next()).done);a=!0){var l=u.value,f=_._userGroups[l],d=f?f.indexOf(t):-1;-1<d&&r&&!r.includes(l)&&f.splice(d,1)}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}if(r){if(!(_._groupMemberIds[n]=r)||"function"!=typeof r[q.default]&&!Array.isArray(r))throw new TypeError("Expected memberIds to be iterable, got "+L(r));if(!r||"function"!=typeof r[q.default]&&!Array.isArray(r))throw new TypeError("Expected memberIds to be iterable, got "+B(r));var p=!0,h=!1,y=void 0;try{for(var v,g=(0,$.default)(r);!(p=(v=g.next()).done);p=!0){var m=v.value,b=_._userGroups[m]||[];b.includes(t)||b.push(t),_._userGroups[m]=b}}catch(e){h=!0,y=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw y}}}},_._onRemoveGroup=function(e,t){var n=t.id,r=t.memberIds;if(delete _._groupMemberIds[n],r){if(!r||"function"!=typeof r[q.default]&&!Array.isArray(r))throw new TypeError("Expected memberIds to be iterable, got "+L(r));if(!r||"function"!=typeof r[q.default]&&!Array.isArray(r))throw new TypeError("Expected memberIds to be iterable, got "+B(r));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,$.default)(r);!(o=(s=u.next()).done);o=!0){var c=s.value,l=_._userGroups[c],f=l?l.indexOf(t):-1;-1<f&&l.splice(f,1)}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}}},_._onChangeMetadata=function(e,t){var n=t.entityId,r=_.host.models.Group.get(n);r&&_.host.models.Group.inject(r)},_._onChangeUser=function(e,t){var n=t.botRole,r=t.id,o=t.isRoleBot,a=_._userGroups[r],i=_._userState[r],s=i&&(i.botRole!==n||i.isRoleBot!==o);if(i&&!s||(_._userState[r]={botRole:n,isRoleBot:o}),a){if(!a||"function"!=typeof a[q.default]&&!Array.isArray(a))throw new TypeError("Expected groups to be iterable, got "+L(a));if(!a||"function"!=typeof a[q.default]&&!Array.isArray(a))throw new TypeError("Expected groups to be iterable, got "+B(a));var u=!0,c=!1,l=void 0;try{for(var f,d=(0,$.default)(a);!(u=(f=d.next()).done);u=!0){var p=f.value,h=p.conversation,y=p.groupType,v=p.members;y!==se.GroupType.ROLE_P2P&&!s&&v&&v.includes(t)||(_.host.models.Group.inject(p),h&&_.host.models.Conversation.inject(h))}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}}},_._onRemoveUser=function(e,t){var n=t.id,r=_._userGroups[n];if(r&&0<r.length){if(!r||"function"!=typeof r[q.default]&&!Array.isArray(r))throw new TypeError("Expected groups to be iterable, got "+L(r));if(!r||"function"!=typeof r[q.default]&&!Array.isArray(r))throw new TypeError("Expected groups to be iterable, got "+B(r));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,$.default)(r);!(o=(s=u.next()).done);o=!0){var c=s.value,l=c.members;l&&l.includes(t)&&_.host.models.Group.inject(c)}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}}delete _._userGroups[n],delete _._userState[n]},n=t,(0,W.default)(_,n)}t.default=fe,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g=r(n(4)),m=r(n(5)),b=r(n(3)),_=r(n(11)),w=r(n(54)),x=r(n(10)),E=r(n(9)),k=r(n(6)),T=r(n(1)),A=r(n(2)),I=r(n(8)),O=r(n(7)),j=n(21),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),M=n(175),R=r(n(15)),C=["template_label"].join(","),P=(a=(0,j.decorator)(),i=(0,j.decorator)(),s=(0,j.decorator)(),c=R.default,(0,O.default)(z,c),(0,A.default)(z,[{key:"batchDelete",value:(v=(0,E.default)(x.default.mark(function e(t){var n,r=this,o=t.ids,a=t.organizationId;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(o)){e.next=2;break}throw new S.ValidationError("ids","required","ids must be an array");case 2:if(a){e.next=4;break}throw new S.ValidationError("organizationId","required");case 4:return e.next=6,this.host.api.messageTemplates.batch({ids:o,operation:"destroy",organizationId:a});case 6:return n=o.map(function(e){return r.host.models.MessageTemplate.inject({$deleted:!0,id:e})}),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"create",value:(y=(0,E.default)(x.default.mark(function e(t){var n,r,o,a,i=t.attachment,s=t.body,u=t.network,c=void 0===u?"patient":u,l=t.organizationId,f=t.repository,d=void 0===f?"personal":f,p=t.title;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p?p.trim():"",r=s?s.trim():"",this._validate({body:r,organizationId:l,repository:d,shouldCheckId:!1,title:n}),!1===["patient"].includes(c))throw new S.ValidationError("network","invalid",'network must be "patient"');e.next=5;break;case 5:return e.next=7,this.host.api.messageTemplates.create({attachment:i,body:r,network:c,organizationId:l,repository:d,title:n});case 7:return o=e.sent,a=this.host.models.MessageTemplate.inject(o),e.abrupt("return",a);case 10:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"delete",value:(h=(0,E.default)(x.default.mark(function e(t,n){var r;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._validate({id:t,organizationId:n,shouldCheckInvalid:!1}),e.next=3,this.host.api.messageTemplates.delete(t,n);case 3:return r=this.host.models.MessageTemplate.inject({$deleted:!0,id:t}),e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return h.apply(this,arguments)})},{key:"downloadTemplateFile",value:(p=(0,E.default)(x.default.mark(function e(t){var n,r=t.templateId,o=t.fileName,a=t.organizationId;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.messageTemplates.downloadTemplateFile({templateId:r,fileName:o,organizationId:a});case 2:return n=e.sent,e.next=5,(0,M.downloadFile)({attachmentContentType:n.type,blob:n,fileName:o});case 5:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"find",value:(d=(0,E.default)(x.default.mark(function e(t,n){var r,o;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._validate({id:t,organizationId:n,shouldCheckInvalid:!1}),e.next=3,this.host.api.messageTemplates.find(t,n);case 3:return r=e.sent,o=this.host.models.MessageTemplate.inject(r),e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)})},{key:"getAll",value:function(){return this.host.models.MessageTemplate.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,b.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,b.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(e));return this.host.models.MessageTemplate.get(e)}},{key:"search",value:(f=(0,E.default)(x.default.mark(function e(t){var n,r,o,a=t.continuation,i=t.network,s=void 0===i?"patient":i,u=t.organizationId,c=t.query,l=void 0===c?"":c,f=t.repository,d=void 0===f?"personal":f,p=t.sortBy,h=void 0===p?"title":p,y=t.sortOrder,v=void 0===y?"asc":y;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.search.query({continuation:a,network:s,organizationId:u,query:(n={},(0,w.default)(n,C,l),(0,w.default)(n,"repository",d),n),returnFields:[],sort:(0,w.default)({},h,v),types:["messageTemplate"]});case 2:return r=e.sent,o=this._processSearchResults(r.results),e.abrupt("return",{metadata:r.metadata,results:o});case 5:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"update",value:(l=(0,E.default)(x.default.mark(function e(t){var n,r,o,a,i=t.attachment,s=t.body,u=t.id,c=t.organizationId,l=t.repository,f=t.title;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=f?f.trim():"",r=s?s.trim():"",this._validate({body:r,id:u,organizationId:c,repository:l,title:n}),e.next=5,this.host.api.messageTemplates.update({attachment:i,body:r,id:u,organizationId:c,repository:l,title:n});case 5:return o=e.sent,a=this.host.models.MessageTemplate.inject(o),e.abrupt("return",a);case 8:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"_processSearchResults",value:function(e){return e.map(function(e){return e.entity}).filter(function(e){return!e.$deleted})}},{key:"_validate",value:function(e){var t=e.body,n=e.id,r=(e.network,e.organizationId),o=e.repository,a=e.shouldCheckId,i=void 0===a||a,s=e.shouldCheckInvalid,u=void 0===s||s,c=e.title;if(i&&!n)throw new S.ValidationError("id","required");if(!r)throw new S.ValidationError("organizationId","required");if(u){if(!t||0===t.trim().length)throw new S.ValidationError("body","invalid","body must be at least 1 character");if(!o||!["general","personal"].includes(o))throw new S.ValidationError("repository","invalid",'repository must be either "general" or "personal"');if(!c||0===c.trim().length||60<c.trim().length)throw new S.ValidationError("title","invalid","title must be between 1 and 60 characters")}}}]),o((u=z).prototype,"downloadTemplateFile",[a],(0,_.default)(u.prototype,"downloadTemplateFile"),u.prototype),o(u.prototype,"find",[i],(0,_.default)(u.prototype,"find"),u.prototype),o(u.prototype,"search",[s],(0,_.default)(u.prototype,"search"),u.prototype),u);function z(){return(0,T.default)(this,z),(0,I.default)(this,(z.__proto__||(0,k.default)(z)).apply(this,arguments))}t.default=P,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function Se(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,we.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=Se(t[0],n);return t.every(function(e){return Se(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return Se(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,Ce.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,se.default)(e))+": "+Se(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function Me(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,we.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=Me(t[0],n);return t.every(function(e){return Me(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return Me(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,Ce.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,se.default)(e))+": "+Me(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z,V,G,N,D,U,F,L,B,$,q,H,Y,Z,W,K,X,Q,J,ee,te,ne,re,oe,ae,ie,se=r(n(4)),ue=r(n(11)),Re=r(n(93)),Ce=r(n(5)),ce=r(n(20)),le=r(n(24)),fe=r(n(77)),de=r(n(16)),pe=r(n(47)),Pe=r(n(13)),ze=r(n(12)),Ve=r(n(10)),he=r(n(19)),ye=r(n(9)),ve=r(n(6)),ge=r(n(1)),me=r(n(2)),be=r(n(8)),_e=r(n(7)),we=r(n(3)),Ge=r(n(234)),xe=r(n(156)),Ee=r(n(377)),ke=r(n(873)),Te=r(n(35)),Ae=r(n(73)),Ie=r(n(115)),Oe=r(n(371)),je=r(n(869)),Ne=r(n(116)),De=r(n(87)),Ue=r(n(340)),Fe=r(n(240)),Le=n(21),Be=r(n(255)),$e=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),qe=n(36),He=n(121),Ye=n(29),Ze=n(175),We=n(174),Ke=r(n(15)),Xe=["escalationExecutionId","id","serverId"],Qe=["distributionList","group","user"],Je=(a=(0,Le.decorator)(),i=(0,Le.decorator)(),s=(0,Le.decorator)({serializeArguments:function(e){return e[0]}}),u=(0,Le.decorator)({memoize:!0}),c=(0,Le.decorator)(),l=(0,Le.decorator)({memoize:!0}),f=(0,Le.decorator)({serializeArguments:function(e){return"object"===(0,we.default)(e[0])?e[0].id:e[0]}}),d=(0,Le.decorator)({serializeArguments:function(e){return e[0].map(function(e){return"object"===(void 0===e?"undefined":(0,we.default)(e))?e.id:e}).join(":")}}),h=Ke.default,(0,_e.default)(et,h),(0,me.default)(et,[{key:"mounted",value:function(){this._throttled_flushFindRecipientStatusesQueue=this.config.flushFindRecipientStatusInterval?(0,Ue.default)(this.__flushFindRecipientStatusesQueue,this.config.flushFindRecipientStatusInterval,{leading:!1}):this.__flushFindRecipientStatusesQueue,this._throttled_flushSetMessageStatusesQueue=this.config.flushSetMessageStatusInterval?(0,Ue.default)(this.__flushSetMessageStatusesQueue,this.config.flushSetMessageStatusInterval,{leading:!1}):this.__flushSetMessageStatusesQueue,this._attachmentTokens=[],this._pendingFindRecipientStatuses={},this._queuedFindRecipientStatuses=[],this._queuedSetMessageStatuses={deliveredIds:[],readIds:[]},this.host.on("tick",this._onTick),this.host.models.MessageStatusPerRecipient.on("afterInject",this._onChangeMessageStatus),this.host.models.MessageStatusPerRecipient.on("afterEject",this._onChangeMessageStatus)}},{key:"dispose",value:function(){this._attachmentTokens=null,this._pendingFindRecipientStatuses=null,this._queuedFindRecipientStatuses=null,this._queuedSetMessageStatuses=null,this._downloadAttachmentBlobAndUrl&&Le.decorator.clear(this._downloadAttachmentBlobAndUrl),this.downloadAttachmentUrl&&Le.decorator.clear(this.downloadAttachmentUrl),this.downloadAttachment&&Le.decorator.clear(this.downloadAttachment),this._throttled_flushFindRecipientStatusesQueue.cancel&&this._throttled_flushFindRecipientStatusesQueue.cancel(),this._throttled_flushSetMessageStatusesQueue.cancel&&this._throttled_flushSetMessageStatusesQueue.cancel(),this.host.removeListener("tick",this._onTick),this.host.models.MessageStatusPerRecipient.removeListener("afterInject",this._onChangeMessageStatus),this.host.models.MessageStatusPerRecipient.removeListener("afterEject",this._onChangeMessageStatus)}},{key:"send",value:(ie=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||t instanceof Object||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | string[] | Object | Object[]\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(null==f||f instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(f));case 6:if("string"==typeof t||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||t instanceof Object||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | string[] | Object | Object[]\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if(null==f||f instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(f));case 12:if(this.config.condensedReplays)throw new Error("the send() method has been deprecated in favor of sendToUser(), sendToGroup(), etc.");e.next=14;break;case 14:if(Array.isArray(t))return e.next=17,this.__resolveSender(f);e.next=18;break;case 17:return e.abrupt("return",this.sendToGroupOfUsers(t,n,f));case 18:return e.next=20,this.__resolveCounterPartyEntityAndOrganizationId(t,f.senderOrganizationId||f.organizationId);case 20:return r=e.sent,o=r.counterParty,a=r.organizationId,Ye.Validator.notEmpty("counterPartyId",o,"counterPartyId not found"),a?f=(0,de.default)({},(0,Ne.default)(f,"organizationId","senderOrganizationId","recipientOrganizationId"),{organizationId:a}):a=f.organizationId,e.next=27,this.__resolveSender(f);case 27:if(i=e.sent,s=function(e){return e&&"user"===e.$entityType},(u=function(e){return s(e)&&e.isRoleBot})(o)||s(o)&&u(i))return e.abrupt("return",this.sendToRole(t,n,f));e.next=32;break;case 32:if(c=o.groupType,l=o.memberIds,c!==qe.GroupType.FORUM||l&&l.includes(this.host.currentUserId)){e.next=36;break}return e.next=36,this.host.forums.join(o);case 36:return e.abrupt("return",this.__sendToCounterParty(o,n,f));case 37:case"end":return e.stop()}},e,this)})),function(e,t){return ie.apply(this,arguments)})},{key:"__resolveSender",value:(ae=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.__resolveSenderId(t),r=t.senderOrganizationId||t.organizationId,n===this.host.currentUserId)return e.abrupt("return",this.host.currentUser);e.next=4;break;case 4:return r||Ye.Validator.raise("senderOrganizationId","missing","When senderId is provided, senderOrganizationId or organizationId must also be provided"),e.next=7,this.host.users.find(n,{organizationId:r});case 7:return(o=e.sent)||Ye.Validator.raise("senderId","invalid","The provided senderId was not found"),o.isRoleBot||Ye.Validator.raise("senderId","invalid","senderId must be either the current user or a role"),e.next=12,this.host.roles.find(n,r);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e,this)})),function(e){return ae.apply(this,arguments)})},{key:"__resolveSenderId",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.senderId;return t=t?(t=this._resolveModelId(t),this.host.roles.__resolveRoleId(t)):this.host.currentUserId,e.senderId=t}},{key:"__resolveCounterPartyEntityAndOrganizationId",value:(oe=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if(null!=a&&"string"!=typeof a)throw new TypeError('Value of argument "providedOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+Me(a));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 6:if(null!=a&&"string"!=typeof a)throw new TypeError('Value of argument "providedOrganizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+Se(a));e.next=8;break;case 8:if("string"==typeof t&&(t=this.host.roles.__resolveRoleId(t)),n=this._resolveEntity(t,[].concat(Qe,["conversation"])),r=a,n){e.next=17;break}if(this.host.conversations.looksLikeConversationHandle(t))return e.next=15,this.host.conversations.find(t);e.next=17;break;case 15:(o=e.sent)&&(n=o.counterParty,r=o.organizationId);case 17:if(n){e.next=21;break}return e.next=20,this.__resolveRemoteCounterPartyEntity(t,r);case 20:n=e.sent;case 21:return n&&(n.organizationId&&"user"!==n.$entityType&&(r=n.organizationId),"conversation"===n.$entityType&&(n=n.counterParty)),e.abrupt("return",{counterParty:n,organizationId:r});case 23:case"end":return e.stop()}},e,this)})),function(e){return oe.apply(this,arguments)})},{key:"__resolveRemoteCounterPartyEntity",value:(re=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f=this;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));e.next=2;break;case 2:if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));e.next=6;break;case 6:if(null!=n&&"string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+Se(n));e.next=8;break;case 8:if(r=null,t=this.host.roles.__resolveRoleId(t),!(o=(0,je.default)([(0,ye.default)(Ve.default.mark(function e(){return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.host.users.findOrCreate(t,{organizationId:n}));case 1:case"end":return e.stop()}},e,f)})),(0,ye.default)(Ve.default.mark(function e(){return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.host.groups.find(t));case 1:case"end":return e.stop()}},e,f)})),(0,ye.default)(Ve.default.mark(function e(){return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.host.distributionLists.find(t));case 1:case"end":return e.stop()}},e,f)}))]))||"function"!=typeof o[ze.default]&&!Array.isArray(o))throw new TypeError("Expected resolvers to be iterable, got "+Se(o));e.next=13;break;case 13:if(!o||"function"!=typeof o[ze.default]&&!Array.isArray(o))throw new TypeError("Expected resolvers to be iterable, got "+Me(o));e.next=15;break;case 15:i=!(a=!0),s=void 0,e.prev=18,u=(0,Pe.default)(o);case 20:if(a=(c=u.next()).done){e.next=37;break}return l=c.value,e.prev=22,e.next=25,l();case 25:if(r=e.sent)return e.abrupt("break",37);e.next=28;break;case 28:e.next=34;break;case 30:if(e.prev=30,e.t0=e.catch(22),e.t0.code!==$e.NotFoundError.CODE)throw e.t0;e.next=34;break;case 34:a=!0,e.next=20;break;case 37:e.next=43;break;case 39:e.prev=39,e.t1=e.catch(18),i=!0,s=e.t1;case 43:e.prev=43,e.prev=44,!a&&u.return&&u.return();case 46:if(e.prev=46,i)throw s;e.next=49;break;case 49:return e.finish(46);case 50:return e.finish(43);case 51:return e.abrupt("return",r);case 52:case"end":return e.stop()}},e,this,[[18,39,43,51],[22,30],[44,,46,50]])})),function(e,t){return re.apply(this,arguments)})},{key:"__sendToCounterParty",value:(ne=(0,ye.default)(Ve.default.mark(function e(t,n,r){var o,a,i,s,u,c,l,f,d,p,h,y=r.organizationId,v=r.senderOrganizationId,g=void 0===v?y:v,m=r.recipientOrganizationId,b=void 0===m?g:m,_=(0,fe.default)(r,["organizationId","senderOrganizationId","recipientOrganizationId"]);return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+Se(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=8;break;case 8:return o=t.$entityType,a=t.serverId,this.host.requireUser(),Ye.Validator.oneOf("counterPartyType",o,["user","group","distributionList"]),Ye.Validator.notEmpty("counterPartyId",a),g=this.__ensureOrganization(g),b=b||g,_=this.__normalizeSendOptions(_,{counterParty:t,senderOrganizationId:g}),i=this.__createNewMessage(t,n,(0,de.default)({organizationId:y,senderOrganizationId:g,recipientOrganizationId:b},_)),this.host.events.deferEventQueue(),this.host.models.Message.inject(i),this.host.emit("message:sending",i),u=(s=_).attachmentFiles,c=s.deleteOnRead,l=s.escalate,f=s.metadata,d=s.priority,p=s.ttl,e.prev=20,e.next=23,this.host.api.messages.send({attachment:(0,Oe.default)(u),body:n,counterPartyId:a,deleteOnRead:c,escalate:l,localId:i?i.id:Be.default.v4(),metadata:f,priority:qe.MessagePriority.toServer(d),recipientOrganizationId:b,senderOrganizationId:g,ttl:p});case 23:return h=e.sent,e.next=26,this.__retrieveSentMessage(h,{instance:i});case 26:i=e.sent,this.host.emit("message:sent",i),e.next=35;break;case 30:e.prev=30,e.t0=e.catch(20),this.logger.error("error while sending message",e.t0),i.senderStatus=qe.MessageSenderStatus.FAILED,this.host.models.Message.inject(i);case 35:return this.host.events.resumeEventQueue(),e.abrupt("return",i);case 37:case"end":return e.stop()}},e,this,[[20,30]])})),function(e,t,n){return ne.apply(this,arguments)})},{key:"__createNewMessage",value:function(e,t,n){var r=n.conversationId,o=n.isForwarded,a=void 0!==o&&o,i=n.organizationId,s=n.recipientOrganizationId,u=void 0===s?l:s,c=n.senderOrganizationId,l=void 0===c?i:c,f=(0,fe.default)(n,["conversationId","isForwarded","organizationId","recipientOrganizationId","senderOrganizationId"]);if(!(e instanceof Object))throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+Me(e));if("string"!=typeof t)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));if(!(e instanceof Object))throw new TypeError('Value of argument "counterParty" violates contract.\n\nExpected:\nObject\n\nGot:\n'+Se(e));if("string"!=typeof t)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));var d=f.attachmentFiles,p=f.deleteOnRead,h=f.escalate,y=f.metadata,v=f.originalMetadata,g=f.priority,m=f.senderId,b=f.ttl,_=e.$entityType,w=e.serverId;this.host.requireUser(),Ye.Validator.oneOf("counterPartyType",_,["user","group","distributionList"]),Ye.Validator.notEmpty("counterPartyId",w);var x=void 0;r&&(x=this.host.conversations.getById(r));var E=(x=x||this.host.conversations.ensureConversation(_,w,l)).isLive,k=this.__getNextSortNumber(l,{conversation:x}),T=m&&m!==this.host.currentUserId?m:void 0,A=t;"distributionList"===_&&(t="["+e.displayName+"]: "+t);var I=this.host.models.Message.createInstance({$synced:!1,body:t,conversationId:x.id,counterPartyId:w,counterPartyType:_,createdAt:new Date,currentSenderRoleId:T,deleteOnRead:p,id:Be.default.v4(),inTimeline:E,isForwarded:a,isOutgoing:!0,messageType:qe.MessageType.USER_SENT,metadata:y,originalMetadata:v,priority:g,recipientOrganizationId:u,senderId:this.host.currentUserId,senderOrganizationId:l,senderStatus:qe.MessageSenderStatus.SENDING,shouldEscalate:h,sortNumber:k,ttl:b});return I._originalBody=A,d&&(I.attachments=d.map(this.__generateAttachmentDescriptor)),"group"===_?I.groupId=w:"user"===_?I.recipientId=w:"distributionList"===_&&(I.distributionListId=w),this.config.condensedReplays||(I.markedRecipientStatus=qe.MessageRecipientStatus.READ),I}},{key:"__normalizeSendOptions",value:function(e,t){var n=e.attachmentFile,r=e.attachmentFiles,o=e.deleteOnRead,a=e.escalate,i=e.metadata,s=e.originalMetadata,u=e.priority,c=e.senderId,l=e.ttl,f=t.counterParty,d=t.senderOrganizationId;if(null==e||!(void 0===e.attachmentFiles||null==e.attachmentFiles||Array.isArray(e.attachmentFiles)&&e.attachmentFiles.every(function(e){return"string"==typeof e||e instanceof Object}))||void 0!==e.deleteOnRead&&null!=e.deleteOnRead&&"boolean"!=typeof e.deleteOnRead||void 0!==e.escalate&&null!=e.escalate&&"boolean"!=typeof e.escalate||!(void 0===e.metadata||null==e.metadata||Array.isArray(e.metadata)&&e.metadata.every(function(e){return e instanceof Object})||null==e.metadata||e.metadata instanceof Object)||!(void 0===e.originalMetadata||null==e.originalMetadata||Array.isArray(e.originalMetadata)&&e.originalMetadata.every(function(e){return e instanceof Object})||null==e.originalMetadata||e.originalMetadata instanceof Object)||void 0!==e.priority&&null!=e.priority&&"string"!=typeof e.priority||void 0!==e.senderId&&null!=e.senderId&&"string"!=typeof e.senderId||void 0!==e.ttl&&null!=e.ttl&&"number"!=typeof e.ttl)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachmentFiles?: ?Array<string | Object>;\n  deleteOnRead?: ?boolean;\n  escalate?: ?boolean;\n  metadata?: ?Array<Object> | ?Object;\n  originalMetadata?: ?Array<Object> | ?Object;\n  priority?: ?string;\n  senderId?: ?string;\n  ttl?: ?number;\n}\n\nGot:\n"+Me(e));if(null==e||!(void 0===e.attachmentFiles||null==e.attachmentFiles||Array.isArray(e.attachmentFiles)&&e.attachmentFiles.every(function(e){return"string"==typeof e||e instanceof Object}))||void 0!==e.deleteOnRead&&null!=e.deleteOnRead&&"boolean"!=typeof e.deleteOnRead||void 0!==e.escalate&&null!=e.escalate&&"boolean"!=typeof e.escalate||!(void 0===e.metadata||null==e.metadata||Array.isArray(e.metadata)&&e.metadata.every(function(e){return e instanceof Object})||null==e.metadata||e.metadata instanceof Object)||!(void 0===e.originalMetadata||null==e.originalMetadata||Array.isArray(e.originalMetadata)&&e.originalMetadata.every(function(e){return e instanceof Object})||null==e.originalMetadata||e.originalMetadata instanceof Object)||void 0!==e.priority&&null!=e.priority&&"string"!=typeof e.priority||void 0!==e.senderId&&null!=e.senderId&&"string"!=typeof e.senderId||void 0!==e.ttl&&null!=e.ttl&&"number"!=typeof e.ttl)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  attachmentFiles?: ?Array<string | Object>;\n  deleteOnRead?: ?boolean;\n  escalate?: ?boolean;\n  metadata?: ?Array<Object> | ?Object;\n  originalMetadata?: ?Array<Object> | ?Object;\n  priority?: ?string;\n  senderId?: ?string;\n  ttl?: ?number;\n}\n\nGot:\n"+Se(e));i=this.__normalizeMetadata({metadata:i,organizationId:d,senderId:c}),r=(0,Ye.arrayWrap)(r||n),!(0,Ie.default)(r)&&1<r.length&&Ye.Validator.raise("attachmentFiles","invalid","currently only a single attachment is supported");var p=this.host.models.Organization.get(d);void 0===l&&(l=p?p.messageTimeToLive:-1),!o&&p&&(o=p.deleteOnRead);var h=f.groupType,y=f.p2pRecipient;return h===qe.GroupType.ROLE_P2P&&y&&y.escalationPolicy&&y.escalationPolicy.alwaysEscalate&&(a=!0,u=qe.MessagePriority.NORMAL),{attachmentFiles:r,deleteOnRead:o,escalate:a,metadata:i,originalMetadata:s,priority:u,senderId:c,ttl:l}}},{key:"__ensureOrganization",value:function(e){if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+Me(e));if(null!=e&&"string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\n?string\n\nGot:\n'+Se(e));return e||(this.host.config.defaultOrganizationId?this.host.config.defaultOrganizationId:void Ye.Validator.raise("organizationId","required","Message is sent in the context of an organization. Provide `organizationId` or set a default one with client.setDefaultOrganization(...)"))}},{key:"__normalizeMetadata",value:function(e){var t=e.metadata,n=(e.organizationId,e.senderId);if(t=t||[],t=(0,Ye.arrayWrap)(t),n!==this.host.currentUserId){var r=this.host.roles.getById(n),o=r.roleTag;t.push({namespace:"tigertext:message:role:sender",payload:{token:n,display_name:r.displayName,tag_id:o?o.tagId:"",tag_color:o?o.color.replace("#","0x"):"",tag_name:o?o.name:""}})}return 0<t.length?t.map(function(e){return(0,de.default)({mimetype:"application/json"},e)}):void 0}},{key:"__getNextSortNumber",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).conversation,n=this.host.models.Organization.get(e);n&&!t&&(t=n.conversations[0]);var r=n&&n.highestSortNumber||0,o=t&&t.lastBangMessageSortNumber||0;return Math.max(r,o)+1}},{key:"previewMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if(!(null==t||t instanceof Object))throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));if(!(null==t||t instanceof Object))throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(t));var n=this._resolveMessage(e),r={};if(!(c=(0,le.default)(n))||"function"!=typeof c[ze.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+Se(c));if(!c||"function"!=typeof c[ze.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+Me(c));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,Pe.default)(c);!(o=(s=u.next()).done);o=!0){var c,l=(0,ce.default)(s.value,2),f=l[0],d=l[1];(0,Ye.isConfigurableProperty)(n,f)&&!Xe.includes(f)&&(r[f]=d)}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}r=(0,de.default)({},r,{id:Be.default.v4(),conversationId:null},t),this.__setForwardedMessageProperties({origMessage:n,organizationId:n.__organizationId,message:r});var p=this.host.models.Message.inject(r);if(!(b=n.statusesPerRecipient)||"function"!=typeof b[ze.default]&&!Array.isArray(b))throw new TypeError("Expected _message$statusesPerR to be iterable, got "+Se(b));if(!b||"function"!=typeof b[ze.default]&&!Array.isArray(b))throw new TypeError("Expected _message$statusesPerR to be iterable, got "+Me(b));var h=!0,y=!1,v=void 0;try{for(var g,m=(0,Pe.default)(b);!(h=(g=m.next()).done);h=!0){var b,_=g.value,w=_.userId||_.distributionListId,x=p.id+":"+w;this.host.models.MessageStatusPerRecipient.inject((0,de.default)({},_,{id:x,messageId:p.id}))}}catch(e){y=!0,v=e}finally{try{!h&&m.return&&m.return()}finally{if(y)throw v}}return p}},{key:"endPreviewMessage",value:function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));var t=this._resolveMessage(e);if(t){if(!(s=t.statusesPerRecipient)||"function"!=typeof s[ze.default]&&!Array.isArray(s))throw new TypeError("Expected _message$statusesPerR2 to be iterable, got "+Se(s));if(!s||"function"!=typeof s[ze.default]&&!Array.isArray(s))throw new TypeError("Expected _message$statusesPerR2 to be iterable, got "+Me(s));var n=!0,r=!1,o=void 0;try{for(var a,i=(0,Pe.default)(s);!(n=(a=i.next()).done);n=!0){var s,u=a.value;this.host.models.MessageStatusPerRecipient.eject(u)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}this.host.models.Message.eject(t)}}},{key:"sendToUser",value:(te=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(null==y||y instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(y));case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if(null==y||y instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(y));case 12:if(this.host.config.condensedReplays){e.next=14;break}return e.abrupt("return",this.send(t,n,y));case 14:if(r=y.organizationId,o=y.senderId,a=void 0===o?this.host.currentUserId:o,i=y.groupName,s=y.groupMetadata,r){e.next=17;break}throw new Error("organizationId is required");case 17:if(t=this._resolveModelIdWithTypes(t,"user"),(u=this._resolveEntity(t,"user"))&&u.profileByOrganizationId&&u.profileByOrganizationId[r]){e.next=23;break}return e.next=22,this.host.users.findOrCreate(t,{organizationId:r});case 22:u=e.sent;case 23:return e.next=25,this.__resolveRoleBotId(a,r);case 25:if(c=e.sent,l=c.isRole,f=c.roleBotId,l)return e.next=31,this.__prepareRoleP2PGroup(r,t,f,i,{groupMetadata:s});e.next=33;break;case 31:return d=e.sent,e.abrupt("return",this.sendToGroup(d,n,(0,de.default)({},y,{organizationId:r,senderId:a})));case 33:if(p=u&&u.profileByOrganizationId[r],h=p&&p.conversationId){e.next=37;break}throw new Error("conversationId not found for p2p message");case 37:return this.host.conversations.getById(h)||this.host.models.Conversation.inject({counterPartyId:u.id,counterPartyType:u.$entityType,id:h,organizationId:r}),e.abrupt("return",this.sendToConversation(h,n,y));case 40:case"end":return e.stop()}},e,this)})),function(e,t){return te.apply(this,arguments)})},{key:"sendToGroup",value:(ee=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(null==o||o instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(o));case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if(null==o||o instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(o));case 12:if(this.config.condensedReplays){e.next=14;break}return e.abrupt("return",this.send(t,n,o));case 14:if(t=this._resolveModelId(t),r=this._resolveEntity(t,"group")){e.next=20;break}return e.next=19,this.host.groups.find(t);case 19:r=e.sent;case 20:if(r&&r.conversationId){e.next=22;break}throw new Error("group conversationId not found");case 22:return this.host.conversations.getById(r.conversationId)||this.host.models.Conversation.inject({counterPartyId:r.id,counterPartyType:r.$entityType,id:r.conversationId,organizationId:r.organizationId}),e.abrupt("return",this.sendToConversation(r.conversationId,n,o));case 25:case"end":return e.stop()}},e,this)})),function(e,t){return ee.apply(this,arguments)})},{key:"sendToRole",value:(J=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(null==d||d instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(d));case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if(null==d||d instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(d));case 12:if(r=d.organizationId,o=d.senderId,a=void 0===o?this.host.currentUserId:o,i=d.groupMetadata,s=d.groupName,!this.host.config.condensedReplays){e.next=24;break}if(r){e.next=16;break}throw new Error("organizationId is required");case 16:return e.next=18,this.__resolveRoleBotId(t,r);case 18:if(u=e.sent,c=u.isRole,l=u.roleBotId,c){e.next=23;break}throw new Error("recipient must be a role");case 23:t=l;case 24:return e.next=26,this.__prepareRoleP2PGroup(r,t,a,s,{groupMetadata:i});case 26:return f=e.sent,e.abrupt("return",this.sendToGroup(f,n,(0,de.default)({},d,{organizationId:r,senderId:a})));case 28:case"end":return e.stop()}},e,this)})),function(e,t){return J.apply(this,arguments)})},{key:"sendToPatient",value:(Q=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(null==d||d instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(d));case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "recipientId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if(null==d||d instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(d));case 12:if((r=d).groupMetadata,o=r.organizationId,a=r.senderId,i=void 0===a?this.host.currentUserId:a,s=(0,fe.default)(r,["groupMetadata","organizationId","senderId"]),d=(0,de.default)({},s,{organizationId:o,senderId:i}),!this.host.config.condensedReplays){e.next=17;break}if(o){e.next=17;break}throw new Error("organizationId is required");case 17:if(c=void 0,u=t&&1===t.length?t[0]:t,l=this._resolveEntity(u,"user")){e.next=22;break}throw new Error("user could not be resolved");case 22:return c=l.isPatientContact?this.host.patients._createPatientContactGroupMetadata(l):this.host.patients._createPatientGroupMetadata(l),e.next=25,this.host.groups.createPatientGroup({organizationId:o,recipientId:t,senderId:i,metadata:c});case 25:return f=e.sent,this.host.metadata.__injectMetadata(f.id,o,c),e.abrupt("return",this.sendToGroup(f,n,(0,de.default)({},d,{organizationId:o,senderId:i})));case 28:case"end":return e.stop()}},e,this)})),function(e,t){return Q.apply(this,arguments)})},{key:"__resolveRoleBotId",value:(X=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.host.roles.__resolveRoleId(t),r=void 0;try{o=this._resolveModelIdWithTypes(t,"role"),r=!!this._resolveEntity(o,"role")}catch(e){r=!1}if(r){e.next=10;break}if((a=this._resolveEntity(t,"user"))&&a.profileByOrganizationId&&a.profileByOrganizationId[n]){e.next=9;break}return e.next=8,this.host.users.find(t,{organizationId:n});case 8:a=e.sent;case 9:a&&a.isRoleBot&&(r=!0);case 10:return e.abrupt("return",{isRole:r,roleBotId:t});case 11:case"end":return e.stop()}},e,this)})),function(e,t){return X.apply(this,arguments)})},{key:"sendToConversation",value:(K=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(null==E||E instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(E));case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if(null==E||E instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(E));case 12:if(this.host.config.condensedReplays){e.next=14;break}return e.abrupt("return",this.send(t,n,E));case 14:if(t=this._resolveModelIdWithTypes(t,"conversation"),r=this.host.conversations.getById(t)){e.next=18;break}throw new $e.NotFoundError(this.host.models.Conversation.name,t);case 18:return e.next=20,this.__resolveSender(E);case 20:if(o=e.sent,a=r.counterPartyId,i=r.counterPartyType,s=r.organizationId,u=this._resolveEntity(a,i),this.host.requireUser(),c=u.groupType,l=u.memberIds,c!==qe.GroupType.FORUM||l&&l.includes(this.host.currentUserId)){e.next=28;break}return e.next=28,this.host.forums.join(u);case 28:return d=f=s,E=this.__normalizeSendOptions(E,{counterParty:u,senderOrganizationId:f,senderId:o.id}),p=this.__createNewMessage(u,n,(0,de.default)({conversationId:t,organizationId:s,senderOrganizationId:f,recipientOrganizationId:d},E)),this.host.events.deferEventQueue(),this.host.models.Message.inject(p),this.host.emit("message:sending",p),y=(h=E).attachmentFiles,v=h.deleteOnRead,g=h.escalate,m=h.metadata,b=h.priority,_=h.ttl,e.prev=36,e.next=39,this.host.api.messages.send({attachment:(0,Oe.default)(y),body:n,conversationId:r.id,deleteOnRead:v,escalate:g,localId:p?p.id:Be.default.v4(),metadata:m,priority:qe.MessagePriority.toServer(b),senderOrganizationId:f,ttl:_});case 39:return w=e.sent,x=w.last_message?w.last_message:w,e.next=44,this.__retrieveSentMessage(x,{instance:p});case 44:(p=e.sent).unreadMessageCount&&(r.unreadCount=p.unreadMessageCount),p.unreadPriorityMessageCount&&(r.unreadPriorityCount=p.unreadPriorityMessageCount),r.lastMessage=p,r.highestSortNumber=p.sortNumber?p.sortNumber:this.__getNextSortNumber(f,{conversation:r}),r.isLive=!0,r.timeline.push(p),this.host.models.Conversation.inject(r),p.inTimeline=!0,this.host.models.Message.inject(p),this.host.emit("message:sent",p),e.next=62;break;case 57:e.prev=57,e.t0=e.catch(36),this.logger.error("error while sending message",e.t0),p.senderStatus=qe.MessageSenderStatus.FAILED,this.host.models.Message.inject(p);case 62:return this.host.events.resumeEventQueue(),e.abrupt("return",p);case 64:case"end":return e.stop()}},e,this,[[36,57]])})),function(e,t){return K.apply(this,arguments)})},{key:"sendToDistributionList",value:(W=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(null==a||a instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Me(a));case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if(null==a||a instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?Object\n\nGot:\n'+Se(a));case 12:if(this.config.condensedReplays){e.next=14;break}return e.abrupt("return",this.send(t,n,a));case 14:if(t=this._resolveModelIdWithTypes(t,"distributionList"),r=this._resolveEntity(t,"distributionList")){e.next=20;break}return e.next=19,this.host.distributionLists.find(t);case 19:r=e.sent;case 20:if(r&&r.conversationId){e.next=22;break}throw new Error("distributionList conversationId not found");case 22:return o=(o=this.host.conversations.getById(r.conversationId))||this.host.models.Conversation.inject({counterPartyId:r.id,counterPartyType:r.$entityType,id:r.conversationId,organizationId:r.organizationId}),e.abrupt("return",this.sendToConversation(o.id,n,a));case 25:case"end":return e.stop()}},e,this)})),function(e,t){return W.apply(this,arguments)})},{key:"sendToGroupOfUsers",value:(Z=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=a.groupMetadata,s=a.groupName,u=a.isTeamActivation,c=a.organizationId,l=a.senderId,f=(0,fe.default)(a,["groupMetadata","groupName","isTeamActivation","organizationId","senderId"]);return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=6;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+Se(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "body" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=8;break;case 8:return e.next=10,this.__prepareGroupForUsers(c,t,l,s,u,{groupMetadata:i});case 10:if(r=e.sent,this.config.condensedReplays)return o=r.conversationId,e.next=15,this.host.conversations.find(o);e.next=18;break;case 15:return e.abrupt("return",this.sendToConversation(o,n,(0,de.default)({},f,{organizationId:c,senderId:l})));case 18:return e.abrupt("return",this.sendToGroup(r,n,(0,de.default)({},f,{organizationId:c,senderId:l})));case 19:case"end":return e.stop()}},e,this)})),function(e,t){return Z.apply(this,arguments)})},{key:"__prepareGroupForUsers",value:function(e,t,n,r,o){var a=(5<arguments.length&&void 0!==arguments[5]?arguments[5]:{}).groupMetadata;return 0===t.length&&Ye.Validator.raise("memberIds","required"),this.host.groups.create({isTeamActivation:o,memberIds:t,metadata:a,name:r,organizationId:e,senderId:n})}},{key:"__prepareRoleP2PGroup",value:(Y=(0,ye.default)(Ve.default.mark(function e(t,n,r,o){var a,i,s=(4<arguments.length&&void 0!==arguments[4]?arguments[4]:{}).groupMetadata;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.host.conversations.findLocalRoleP2PConversation(n,r))return e.abrupt("return",a.counterParty);e.next=3;break;case 3:return e.next=5,this.host.roles.createP2PGroup({metadata:s,name:o,organizationId:t,recipientId:n,senderId:r});case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}},e,this)})),function(e,t,n,r){return Y.apply(this,arguments)})},{key:"recall",value:(H=(0,ye.default)(Ve.default.mark(function e(t){var n,r;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e})||Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+Se(t));case 4:return this.host.requireUser(),n=(0,Ye.arrayWrap)(t).filter(Boolean),r=n.map(this.__recallSingle.bind(this)),e.next=9,he.default.all(r);case 9:case"end":return e.stop()}},e,this)})),function(e){return H.apply(this,arguments)})},{key:"__recallSingle",value:(q=(0,ye.default)(Ve.default.mark(function e(t){var n;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(!(n=this._resolveMessage(t))){e.next=17;break}if(n.senderId!==this.host.currentUserId)throw new $e.PermissionDeniedError(n,n.serverId,"recall");e.next=8;break;case 8:if(!1!==n.$synced&&n.serverId){e.next=12;break}this.host.models.Message.eject(n),e.next=15;break;case 12:return e.next=14,this.host.api.messages.destroy(n.serverId);case 14:this.host.models.Message.eject(n);case 15:e.next=19;break;case 17:return e.next=19,this.host.api.messages.destroy(t);case 19:case"end":return e.stop()}},e,this)})),function(e){return q.apply(this,arguments)})},{key:"retrySend",value:($=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(this.host.requireUser(),n=this._resolveMessage(t)){e.next=8;break}throw new $e.NotFoundError(this.host.models.Message.name,t);case 8:if(o=(r=n).isForwarded,r.senderStatus!==qe.MessageSenderStatus.FAILED&&Ye.Validator.raise("message","invalid","Message to retry must be in a FAILED senderStatus and sent from current user"),this.host.events.deferEventQueue(),n.senderStatus=qe.MessageSenderStatus.RETRYING,this.host.models.Message.inject(n),this.host.emit("message:sending",n),o)return e.next=17,this.__retryApiForward(n);e.next=20;break;case 17:n=e.sent,e.next=23;break;case 20:return e.next=22,this.__retryApiSend(n);case 22:n=e.sent;case 23:return this.config.condensedReplays&&(a=this.host.conversations.getById(n.conversationId),n.unreadMessageCount&&(a.unreadCount=n.unreadMessageCount),n.unreadPriorityMessageCount&&(a.unreadPriorityCount=n.unreadPriorityMessageCount),a.lastMessage=n,a.highestSortNumber=n.sortNumber,this.host.models.Conversation.inject(a)),this.host.events.resumeEventQueue(),e.abrupt("return",n);case 26:case"end":return e.stop()}},e,this)})),function(e){return $.apply(this,arguments)})},{key:"resend",value:(B=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},E=x.priority,k=x.retrieveMessage,T=void 0!==k&&k,A=x.senderId;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(n=this._resolveMessage(t),void 0===E&&(E=n.priority),void 0===A&&(A=n.senderId),r=n.attachments,o=n.body,a=n.conversationId,i=n.counterParty,s=n.counterPartyId,u=n.deleteOnRead,c=n.isForwarded,l=n.metadata,f=n.originalMessageId,d=n.recipientOrganizationId,p=n.ttl,!c){e.next=14;break}if(this.config.condensedReplays)return e.abrupt("return",this.forwardToConversation(f,a,{organizationId:d,priority:E}));e.next=11;break;case 11:return e.abrupt("return",this.forward(f,s,{organizationId:d,priority:E,retrieveMessage:T,senderId:A}));case 14:if(h=[],l=l.filter(function(e){return"tigertext:message:role:sender"!==e.namespace}),!r){e.next=50;break}if(!r||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected attachments to be iterable, got "+Se(r));e.next=19;break;case 19:if(!r||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected attachments to be iterable, got "+Me(r));e.next=21;break;case 21:v=!(y=!0),g=void 0,e.prev=24,m=(0,Pe.default)(r);case 26:if(y=(b=m.next()).done){e.next=36;break}return _=b.value,e.next=30,this._downloadAttachmentBlobAndUrl(t,_.id);case 30:(w=e.sent.blob).name=_.name,h.push(w);case 33:y=!0,e.next=26;break;case 36:e.next=42;break;case 38:e.prev=38,e.t0=e.catch(24),v=!0,g=e.t0;case 42:e.prev=42,e.prev=43,!y&&m.return&&m.return();case 45:if(e.prev=45,v)throw g;e.next=48;break;case 48:return e.finish(45);case 49:return e.finish(42);case 50:if(this.config.condensedReplays)return e.abrupt("return",this.sendToConversation(a,o,{attachmentFiles:h,deleteOnRead:u,organizationId:d,priority:E,metadata:l,senderId:A,ttl:p}));e.next=52;break;case 52:return e.abrupt("return",this.__sendToCounterParty(i,o,{attachmentFiles:h,deleteOnRead:u,organizationId:d,priority:E,senderId:A,metadata:l,ttl:p}));case 53:case"end":return e.stop()}},e,this,[[24,38,42,50],[43,,45,49]])})),function(e){return B.apply(this,arguments)})},{key:"forwardToConversation",value:(L=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(this.config.condensedReplays){e.next=6;break}return e.abrupt("return",this.forward(t,n,E));case 6:if(r=E.metadata,o=void 0===r?[]:r,a=E.priority,i=E.senderId,s=void 0===i?this.host.currentUserId:i,u=this.host.conversations.getById(n)){e.next=10;break}throw new Error("conversation not found");case 10:if(this.host.requireUser(),c=this._resolveMessage(t)){e.next=14;break}throw new $e.NotFoundError(this.host.models.Message.name,id);case 14:if(l=c.attachments,f=c.body,d=c.serverId){e.next=17;break}throw new Error("original message was not sent");case 17:return s=this.__resolveSenderId({senderId:s}),void 0===a&&(a=c.priority),p=u.counterPartyId,h=u.counterPartyType,y=u.organizationId,v=this._resolveEntity(p,h),g=y,m=(0,Ae.default)(c,"originalMetadata"),b={metadata:o,priority:a,senderId:s,originalMetadata:m},b=this.__normalizeSendOptions(b,{counterParty:v,senderOrganizationId:g}),o=b.metadata,(_=this.__createNewMessage(v,f,(0,de.default)({conversationId:n,organizationId:y,isForwarded:!0},b))).attachments=l,this.__setForwardedMessageProperties({origMessage:c,organizationId:y,message:_}),this.host.events.deferEventQueue(),this.host.models.Message.inject(_),this.host.emit("message:sending",_),e.prev=32,e.next=35,this.host.api.messages.forward(d,null,{conversationId:n,localId:_.id,metadata:o,priority:qe.MessagePriority.toServer(a)});case 35:return w=e.sent,e.next=38,this.__retrieveSentMessage(w.message,{instance:_});case 38:(x=e.sent).unreadMessageCount&&(u.unreadCount=x.unreadMessageCount),x.unreadPriorityMessageCount&&(u.unreadPriorityCount=x.unreadPriorityMessageCount),this.host.models.Conversation.inject(u),this.host.emit("message:sent",x),e.next=50;break;case 45:e.prev=45,e.t0=e.catch(32),this.logger.error("error while forwarding message",e.t0),_.senderStatus=qe.MessageSenderStatus.FAILED,this.host.models.Message.inject(_);case 50:return this.host.events.resumeEventQueue(),e.abrupt("return",_);case 52:case"end":return e.stop()}},e,this,[[32,45]])})),function(e,t){return L.apply(this,arguments)})},{key:"forwardToUser",value:(F=(0,ye.default)(Ve.default.mark(function e(t,n){for(var r=arguments.length,o=Array(2<r?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var i,s,u,c,l,f,d,p,h,y,v,g,m,b;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(this.config.condensedReplays){e.next=6;break}return e.abrupt("return",this.forward.apply(this,[t,n].concat(o)));case 6:if(i=o[0],u=(s=void 0===i?{}:i).organizationId,c=s.senderId,l=void 0===c?this.host.currentUserId:c,f=s.groupName,d=s.groupMetadata,u){e.next=10;break}throw new Error("organizationId is required");case 10:if(n=this._resolveModelIdWithTypes(n,"user"),(p=this._resolveEntity(n,"user"))&&p.profileByOrganizationId&&p.profileByOrganizationId[u]){e.next=16;break}return e.next=15,this.host.users.find(n,{organizationId:u});case 15:p=e.sent;case 16:return e.next=18,this.__resolveRoleBotId(l,u);case 18:if(h=e.sent,y=h.isRole,v=h.roleBotId,y)return e.next=24,this.__prepareRoleP2PGroup(u,n,v,f,{groupMetadata:d});e.next=26;break;case 24:return g=e.sent,e.abrupt("return",this.forwardToGroup(t,g,(0,de.default)({},s,{organizationId:u,senderId:l})));case 26:if(m=p&&p.profileByOrganizationId[u],b=m&&m.conversationId){e.next=30;break}throw new Error("conversationId not found for p2p message");case 30:return this.host.conversations.getById(b)||this.host.models.Conversation.inject({counterPartyId:p.id,counterPartyType:p.$entityType,id:b,organizationId:u}),e.abrupt("return",this.forwardToConversation.apply(this,[t,b].concat(o)));case 33:case"end":return e.stop()}},e,this)})),function(e,t){return F.apply(this,arguments)})},{key:"forwardToGroup",value:(U=(0,ye.default)(Ve.default.mark(function e(t,n){for(var r=arguments.length,o=Array(2<r?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var i;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(this.config.condensedReplays){e.next=6;break}return e.abrupt("return",this.forward.apply(this,[t,n].concat(o)));case 6:if(n=this._resolveModelId(n),i=this._resolveEntity(n,"group")){e.next=12;break}return e.next=11,this.host.groups.find(n);case 11:i=e.sent;case 12:if(i&&i.conversationId){e.next=14;break}throw new Error("group "+n+" not found");case 14:return this.host.conversations.getById(i.conversationId)||this.host.models.Conversation.inject({counterPartyId:i.id,counterPartyType:i.$entityType,id:i.conversationId,organizationId:i.organizationId}),e.abrupt("return",this.forwardToConversation.apply(this,[t,i.conversationId].concat(o)));case 17:case"end":return e.stop()}},e,this)})),function(e,t){return U.apply(this,arguments)})},{key:"forwardToDistributionList",value:(D=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(n));case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 6:if("string"==typeof n||n instanceof Object){e.next=8;break}throw new TypeError('Value of argument "distributionListId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(n));case 8:if(this.config.condensedReplays){e.next=10;break}return e.abrupt("return",this.forward(t,n,o));case 10:if(n=this._resolveModelId(n),r=this._resolveEntity(n,"distributionList")){e.next=16;break}return e.next=15,this.host.distributionLists.find(n);case 15:r=e.sent;case 16:if(r&&r.conversationId){e.next=18;break}throw new Error("distributionList "+n+" not found");case 18:return this.host.conversations.getById(r.conversationId)||this.host.models.Conversation.inject({counterPartyId:r.id,counterPartyType:r.$entityType,id:r.conversationId,organizationId:r.organizationId}),e.abrupt("return",this.forwardToConversation(t,r.conversationId,o));case 21:case"end":return e.stop()}},e,this)})),function(e,t){return D.apply(this,arguments)})},{key:"forwardToGroupOfUsers",value:(N=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=a.groupMetadata,s=a.groupName,u=a.organizationId,c=a.senderId,l=(0,fe.default)(a,["groupMetadata","groupName","organizationId","senderId"]);return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));e.next=2;break;case 2:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+Me(n));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));e.next=6;break;case 6:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=8;break}throw new TypeError('Value of argument "userIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+Se(n));case 8:return e.next=10,this.__prepareGroupForUsers(u,n,c,s,!1,{groupMetadata:i});case 10:if(r=e.sent,this.config.condensedReplays)return o=r.conversationId,e.next=15,this.host.conversations.find(o);e.next=16;break;case 15:return e.abrupt("return",this.forwardToConversation(t,o,(0,de.default)({},l,{organizationId:u,senderId:c})));case 16:return e.abrupt("return",this.forwardToGroup(t,r,(0,de.default)({},l,{organizationId:u,senderId:c})));case 17:case"end":return e.stop()}},e,this)})),function(e,t){return N.apply(this,arguments)})},{key:"forwardToRole",value:(G=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.organizationId,o=d.senderId,a=void 0===o?this.host.currentUserId:o,i=d.groupMetadata,s=d.groupName,!this.host.config.condensedReplays){e.next=12;break}if(r){e.next=4;break}throw new Error("organizationId is required");case 4:return e.next=6,this.__resolveRoleBotId(n,r);case 6:if(u=e.sent,c=u.isRole,l=u.roleBotId,c){e.next=11;break}throw new Error("recipient must be a role");case 11:n=l;case 12:return e.next=14,this.__prepareRoleP2PGroup(r,n,a,s,{groupMetadata:i});case 14:return f=e.sent,e.abrupt("return",this.forwardToGroup(t,f.id,(0,de.default)({},d,{organizationId:r,senderId:a})));case 16:case"end":return e.stop()}},e,this)})),function(e,t){return G.apply(this,arguments)})},{key:"forward",value:(V=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w=this,x=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},E=x.organizationId,k=x.senderOrganizationId,T=void 0===k?E:k,A=x.recipientOrganizationId,I=void 0===A?T:A,O=x.groupMetadata,j=x.groupName,S=x.metadata,M=void 0===S?[]:S,R=(x.preferExistingGroup,x.priority),C=x.retrieveMessage,P=void 0!==C&&C,z=x.senderId,V=void 0===z?this.host.currentUserId:z;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof n||n instanceof Object||Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+Me(n));case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 6:if("string"==typeof n||n instanceof Object||Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=8;break}throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring | Object | string[] | Object[]\n\nGot:\n'+Se(n));case 8:if(this.config.condensedReplays)throw new Error("the forward() method has been deprecated in favor of forwardToUser(), forwardToGroup(), etc.");e.next=10;break;case 10:if(this.host.requireUser(),r=this._resolveMessage(t)){e.next=14;break}throw new $e.NotFoundError(this.host.models.Message.name,t);case 14:if(o=r.attachments,a=r.body,i=r.serverId){e.next=17;break}throw new Error("original message was not sent");case 17:if(V=this.__resolveSenderId({senderId:V}),Array.isArray(n))return s=n.map(function(e){return w._resolveModelIdWithTypes(e,["user","role"])}),e.next=22,this.__prepareGroupForUsers(E,s,V,j,!1,{groupMetadata:O});e.next=24;break;case 22:u=e.sent,n=u.id;case 24:return void 0===R&&(R=r.priority),e.next=27,this.__resolveCounterPartyEntityAndOrganizationId(n,T);case 27:return c=e.sent,l=c.counterParty,(f=c.organizationId)&&(T=I=f),I=I||T,l&&(n=l.serverId),e.next=35,this.__resolveSender({organizationId:E,senderId:V,senderOrganizationId:T});case 35:if(d=e.sent,p=function(e){return e&&"user"===e.$entityType},h=function(e){return p(e)&&e.isRoleBot},y=(0,Ae.default)(r,"originalMetadata"),h(l)||p(l)&&h(d))return e.next=42,this.__prepareRoleP2PGroup(E,l.id,V,j,{groupMetadata:O});e.next=45;break;case 42:v=e.sent,n=(l=v).id;case 45:return Ye.Validator.notEmpty("entityId",n,"entityId not found"),g={metadata:M,priority:R,senderId:V,originalMetadata:y},g=this.__normalizeSendOptions(g,{counterParty:l,senderOrganizationId:T}),M=g.metadata,(m=this.__createNewMessage(l,a,(0,de.default)({organizationId:E,senderOrganizationId:T,recipientOrganizationId:I,isForwarded:!0},g))).attachments=o,this.__setForwardedMessageProperties({origMessage:r,organizationId:E,message:m}),this.host.events.deferEventQueue(),this.host.models.Message.inject(m),this.host.emit("message:sending",m),e.prev=55,e.next=58,this.host.api.messages.forward(i,n,{localId:m.id,metadata:M,priority:qe.MessagePriority.toServer(R),recipientOrganizationId:I,senderOrganizationId:T});case 58:if(b=e.sent,_=b.message_id,P)return e.next=63,this.find(_,{instance:m,replace:!0});e.next=66;break;case 63:m=e.sent,e.next=70;break;case 66:m.senderStatus=qe.MessageSenderStatus.SENT,m.serverId=_,m.$synced=void 0,this.host.models.Message.inject(m);case 70:this.host.emit("message:sent",m),e.next=78;break;case 73:e.prev=73,e.t0=e.catch(55),this.logger.error("error while forwarding message",e.t0),m.senderStatus=qe.MessageSenderStatus.FAILED,this.host.models.Message.inject(m);case 78:return this.host.events.resumeEventQueue(),e.abrupt("return",m);case 80:case"end":return e.stop()}},e,this,[[55,73]])})),function(e,t){return V.apply(this,arguments)})},{key:"__setForwardedMessageProperties",value:function(e){var t=e.origMessage,n=e.organizationId,r=e.message,o=t.createdAt,a=t.currentSenderRole,i=t.originalForwardedMessageCreatedAt,s=t.originalMessageId,u=t.originalSender,c=t.originalSenderRole,l=t.sender,f=t.senderRole,d=t.serverId,p=t.subType;return r.originalForwardedMessageCreatedAt||(r.originalForwardedMessageCreatedAt=i||o),r.originalMessageId||(r.originalMessageId=s||d),r.originalSender?r.originalSender=u:l&&(r.originalSender={displayName:l.displayName,id:l.id,organizationId:n}),r.originalSenderRole||(p===qe.MessageSubType.ROLE_AWAY_NOTIFICATION&&a?r.originalSenderRole={$entityType:"role",botUserId:a.botUserId,displayName:a.displayName,id:a.id,organizationId:n}:c?r.originalSenderRole=(0,de.default)({},c):f&&(r.originalSenderRole=(0,de.default)({},f))),r.subType||(r.subType=p),r}},{key:"reactToMessageStatusEvent",value:function(e){var t=e.data;if(this.config.condensedReplays)this.reactToMessageStatusEventCR({data:t});else{var n=(t=(0,Ye.jsonCloneDeep)(t)).client_id,r=t.is_recalled,o=this.host.models.Message.get(n);if(o){if(r)return void this.host.models.Message.eject(o);this.__injectMessageStatus(o,t),He.MESSAGE_STATUS_ORDER[o.markedRecipientStatus]<He.MESSAGE_STATUS_ORDER[qe.MessageRecipientStatus.DELIVERED]&&this.markAsReceived(o)}}}},{key:"reactToMessageStatusEventCR",value:function(e){var t=e.data,n=(t=(0,Ye.jsonCloneDeep)(t)).client_id,r=t.is_recalled,o=t.is_unread,a=this.host.models.Message.get(n);if(a){t.conversation_id||(t.conversation_id=a.conversationId);var i=this.host.conversations.getById(t.conversation_id);i&&(r?this.host.models.Message.eject(a):(a.shouldEnsureRecipientStatus=!0,void 0!==o&&(a.isUnread=o),this.host.models.Message.inject(a),i._markingAsReadSortNumber&&a.sortNumber>=i._markingAsReadSortNumber&&this.host.conversations.__clearOptimisticStatus([i])),this.host.conversations.__injectConversation(t))}}},{key:"__injectMessageStatus",value:function(e,t){if(e){var n=t.account_id||t.accountId,r={createdAt:t.timestamp||t.createdAt,id:e.id+":"+n,messageId:e.id,status:qe.MessageRecipientStatus.resolve(t.status)};return"distributionList"===e.counterPartyType?r.distributionListId=n:(r.userId=n,this.host.models.User.ensureEntity(n,{onlyPlaceholder:!0})),this.host.models.MessageStatusPerRecipient.inject(r)}}},{key:"_findCR",value:(z=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=u.includeCounterParty,l=void 0===c||c,f=u.includeStatuses,d=void 0===f||f,p=u.instance,h=u.replace,y=void 0!==h&&h;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));e.next=4;break;case 4:return this.host.requireUser(),e.next=7,this.host.api.messages.find(t);case 7:if(n=e.sent){e.next=10;break}return e.abrupt("return",null);case 10:if(r=n.message){e.next=13;break}return e.abrupt("return",null);case 13:if(r.conversationId=n.conversation_id,p&&y&&this.__setDefaultAttributes(r,{instance:p}),l)return o=r.recipient_token,a=r.sender_organization,e.next=20,this.__lookupCounterParty(o,{organizationId:a});e.next=27;break;case 20:if(!(i=e.sent)){e.next=26;break}r.counterParty=i,r.conversationHandle||(r.conversationHandle=this.host.conversations.getConversationKey(i.$entityType,i.serverId,a)),e.next=27;break;case 26:return e.abrupt("return",null);case 27:if((s=y?this.host.models.Message.replaceExisting(r,{instance:p}):this.host.models.Message.inject(r)).$synced=void 0,d)return e.next=32,this.findRecipientStatus(s,{queue:!1});e.next=32;break;case 32:return e.abrupt("return",s);case 33:case"end":return e.stop()}},e,this)})),function(e){return z.apply(this,arguments)})},{key:"find",value:(P=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=u.includeCounterParty,l=void 0===c||c,f=u.includeStatuses,d=void 0===f||f,p=u.instance,h=u.replace,y=void 0!==h&&h;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "serverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));e.next=4;break;case 4:if(this.config.condensedReplays)return e.next=7,this._findCR(t,{includeCounterParty:l,includeStatuses:d,instance:p,replace:y});e.next=9;break;case 7:return n=e.sent,e.abrupt("return",n);case 9:return this.host.requireUser(),e.next=12,this.host.api.messages.find(t);case 12:if(r=e.sent){e.next=15;break}return e.abrupt("return",null);case 15:if(p&&y&&this.__setDefaultAttributes(r,{instance:p}),l)return o=r.recipient_token,a=r.sender_organization,e.next=21,this.__lookupCounterParty(o,{organizationId:a});e.next=28;break;case 21:if(!(i=e.sent)){e.next=27;break}r.counterParty=i,this.config.condensedReplays||r.conversationId||(r.conversationId=this.host.conversations.getConversationKey(i.$entityType,i.serverId,a)),e.next=28;break;case 27:return e.abrupt("return",null);case 28:if((s=y?this.host.models.Message.replaceExisting(r,{instance:p}):this.host.models.Message.inject(r)).$synced=void 0,d)return e.next=33,this.findRecipientStatus(s,{queue:!1});e.next=33;break;case 33:return e.abrupt("return",s);case 34:case"end":return e.stop()}},e,this)})),function(e){return P.apply(this,arguments)})},{key:"findAttachment",value:(C=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=8;break;case 8:if(r=this._resolveMessage(t),o=!1,r){e.next=15;break}return o=!0,e.next=14,this.find(t,{includeStatuses:!1,includeCounterParty:!1});case 14:r=e.sent;case 15:if(r){e.next=17;break}return e.abrupt("return",null);case 17:if(!(a=this.__getMessageAttachment(r,n))||a.isLocal||o||"name"in a){e.next=24;break}return e.next=21,this.find(t,{includeStatuses:!1,includeCounterParty:!1});case 21:r=e.sent,(a=this.__getMessageAttachment(r,n)).name||(a.name=null);case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}},e,this)})),function(e,t){return C.apply(this,arguments)})},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(e));return this.host.models.Message.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+Me(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+Se(e));return this.host.models.Message.getMulti(e)}},{key:"__lookupCounterParty",value:(R=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b=this,_=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).organizationId;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));e.next=4;break;case 4:if("function"!=typeof(n=[{model:this.host.models.User,finder:function(){return b.host.users.find(t,{organizationId:_})}},{model:this.host.models.Group,finder:function(){return b.host.groups.find(t)}},{model:this.host.models.DistributionList,finder:function(){return b.host.distributionLists.find(t)}}])[ze.default]&&!Array.isArray(n))throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+Se(n));e.next=7;break;case 7:if(!n||"function"!=typeof n[ze.default]&&!Array.isArray(n))throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+Me(n));e.next=9;break;case 9:o=!(r=!0),a=void 0,e.prev=12,i=(0,Pe.default)(n);case 14:if(r=(s=i.next()).done){e.next=23;break}if(u=s.value,c=u.model,l=c.get(t))return e.abrupt("return",l);e.next=20;break;case 20:r=!0,e.next=14;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(12),o=!0,a=e.t0;case 29:e.prev=29,e.prev=30,!r&&i.return&&i.return();case 32:if(e.prev=32,o)throw a;e.next=35;break;case 35:return e.finish(32);case 36:return e.finish(29);case 37:if(!n||"function"!=typeof n[ze.default]&&!Array.isArray(n))throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+Se(n));e.next=39;break;case 39:if(!n||"function"!=typeof n[ze.default]&&!Array.isArray(n))throw new TypeError("Expected counterPartyTypesAndFinders to be iterable, got "+Me(n));e.next=41;break;case 41:d=!(f=!0),p=void 0,e.prev=44,h=(0,Pe.default)(n);case 46:if(f=(y=h.next()).done){e.next=64;break}return v=y.value,g=v.finder,e.prev=49,e.next=52,g();case 52:if(m=e.sent)return e.abrupt("return",m);e.next=55;break;case 55:e.next=61;break;case 57:if(e.prev=57,e.t1=e.catch(49),e.t1.code!==$e.NotFoundError.CODE)throw e.t1;e.next=61;break;case 61:f=!0,e.next=46;break;case 64:e.next=70;break;case 66:e.prev=66,e.t2=e.catch(44),d=!0,p=e.t2;case 70:e.prev=70,e.prev=71,!f&&h.return&&h.return();case 73:if(e.prev=73,d)throw p;e.next=76;break;case 76:return e.finish(73);case 77:return e.finish(70);case 78:return e.abrupt("return",null);case 79:case"end":return e.stop()}},e,this,[[12,25,29,37],[30,,32,36],[44,66,70,78],[49,57],[71,,73,77]])})),function(e){return R.apply(this,arguments)})},{key:"_isMessageOutgoing",value:function(e){var t=e.counterParty,n=e.counterPartyType,r=e.currentSenderRole,o=e.senderId;if(!o)return!1;var a=this.host,i=a.currentUser,s=a.currentUserId,u=t||{},c=u.groupType,l=u.members,f=u.p2pRecipient,d=u.p2pSender,p="group"===n&&c===qe.GroupType.ROLE_P2P,h=i.roles,y=[s],v=[],g=0;if(!h||"function"!=typeof h[ze.default]&&!Array.isArray(h))throw new TypeError("Expected myRoles to be iterable, got "+Se(h));if(!h||"function"!=typeof h[ze.default]&&!Array.isArray(h))throw new TypeError("Expected myRoles to be iterable, got "+Me(h));var m=!0,b=!1,_=void 0;try{for(var w,x=(0,Pe.default)(h);!(m=(w=x.next()).done);m=!0){var E=w.value.botUserId;y.push(E)}}catch(e){b=!0,_=e}finally{try{!m&&x.return&&x.return()}finally{if(b)throw _}}if(l){if(!l||"function"!=typeof l[ze.default]&&!Array.isArray(l))throw new TypeError("Expected members to be iterable, got "+Se(l));if(!l||"function"!=typeof l[ze.default]&&!Array.isArray(l))throw new TypeError("Expected members to be iterable, got "+Me(l));var k=!0,T=!1,A=void 0;try{for(var I,O=(0,Pe.default)(l);!(k=(I=O.next()).done);k=!0){var j=I.value,S=j.botRole;j.isRoleBot&&S&&!v.includes(S)&&v.push(S)}}catch(e){T=!0,A=e}finally{try{!k&&O.return&&O.return()}finally{if(T)throw A}}if(p){if(d){var M=d.botRole;d.isRoleBot&&M&&!v.includes(M)&&v.push(M)}if(f){var R=f.botRole;f.isRoleBot&&R&&!v.includes(R)&&v.push(R)}}if(!v||"function"!=typeof v[ze.default]&&!Array.isArray(v))throw new TypeError("Expected roleMembers to be iterable, got "+Se(v));if(!v||"function"!=typeof v[ze.default]&&!Array.isArray(v))throw new TypeError("Expected roleMembers to be iterable, got "+Me(v));var C=!0,P=!1,z=void 0;try{for(var V,G=(0,Pe.default)(v);!(C=(V=G.next()).done);C=!0){var N=V.value;h.includes(N)&&g++}}catch(e){P=!0,z=e}finally{try{!C&&G.return&&G.return()}finally{if(P)throw z}}}return p?!(f===i&&o===s&&!r)&&(!(!d||o!==d.id&&o!==d.botUserId)||h.includes(r)&&(1===g||r===d)):"distributionList"===n||h.includes(r)||y.includes(o)}},{key:"_setRecipientStatus",value:function(e){var t=e.__organizationId,n=e._markingAsStatus,r=e.conversation,o=e.counterParty,a=e.counterPartyType,i=e.createdAt,s=e.deleteOnRead,u=e.expiresAt,c=e.isOutgoing,l=e.messageType,f=e.senderId,d=e.statusesPerRecipient,p=e.ttl,h=this.host,y=h.currentUser,v=h.currentUserId,g=o||{},m=g.groupType,b=g.p2pRecipient,_=[],w=[],x=[v],E=void 0,k=void 0;if(!(S=y.roles)||"function"!=typeof S[ze.default]&&!Array.isArray(S))throw new TypeError("Expected _currentUser$roles to be iterable, got "+Se(S));if(!S||"function"!=typeof S[ze.default]&&!Array.isArray(S))throw new TypeError("Expected _currentUser$roles to be iterable, got "+Me(S));var T=!0,A=!1,I=void 0;try{for(var O,j=(0,Pe.default)(S);!(T=(O=j.next()).done);T=!0){var S,M=O.value;M.organizationId===t&&x.push(M.botUserId)}}catch(e){A=!0,I=e}finally{try{!T&&j.return&&j.return()}finally{if(A)throw I}}var R=f&&x.includes(f),C=[],P=qe.MessageRecipientStatus.READ,z=qe.MessageRecipientStatus.NEW,V=m===qe.GroupType.ROLE_P2P&&b===y;if(!d||"function"!=typeof d[ze.default]&&!Array.isArray(d))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Se(d));if(!d||"function"!=typeof d[ze.default]&&!Array.isArray(d))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Me(d));var G=!0,N=!1,D=void 0;try{for(var U,F=(0,Pe.default)(d);!(G=(U=F.next()).done);G=!0){var L=U.value.userId;x.includes(L)&&C.push(L)}}catch(e){N=!0,D=e}finally{try{!G&&F.return&&F.return()}finally{if(N)throw D}}var B=1<C.length;if(!d||"function"!=typeof d[ze.default]&&!Array.isArray(d))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Se(d));if(!d||"function"!=typeof d[ze.default]&&!Array.isArray(d))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Me(d));var $=!0,q=!1,H=void 0;try{for(var Y,Z=(0,Pe.default)(d);!($=(Y=Z.next()).done);$=!0){var W=Y.value,K=W.distributionListId,X=(L=W.userId,W.status),Q=x.includes(L);V||!(!c&&Q)&&!(c&&(K||!Q))||B&&L===v||w.push(X),(V||R&&x.includes(f))&&(He.MESSAGE_STATUS_ORDER[z]<He.MESSAGE_STATUS_ORDER[X]&&(z=X),He.MESSAGE_STATUS_ORDER[z]<He.MESSAGE_STATUS_ORDER[qe.MessageRecipientStatus.READ]&&(z=qe.MessageRecipientStatus.READ)),!Q||V||R&&f===L||_.push(X)}}catch(e){q=!0,H=e}finally{try{!$&&Z.return&&Z.return()}finally{if(q)throw H}}if(0<w.length){k=w[0];for(var J=1;J<w.length;J++){var ee=w[J];0===C.length?He.MESSAGE_STATUS_ORDER[k]<He.MESSAGE_STATUS_ORDER[ee]&&(k=ee):He.MESSAGE_STATUS_ORDER[k]>He.MESSAGE_STATUS_ORDER[ee]&&(k=ee)}}else k=z;if(E=P,0<_.length){if(!_||"function"!=typeof _[ze.default]&&!Array.isArray(_))throw new TypeError("Expected applicableLeastStatuses to be iterable, got "+Se(_));if(!_||"function"!=typeof _[ze.default]&&!Array.isArray(_))throw new TypeError("Expected applicableLeastStatuses to be iterable, got "+Me(_));var te=!0,ne=!1,re=void 0;try{for(var oe,ae=(0,Pe.default)(_);!(te=(oe=ae.next()).done);te=!0){var ie=oe.value;He.MESSAGE_STATUS_ORDER[E]>He.MESSAGE_STATUS_ORDER[ie]&&(E=ie)}}catch(e){ne=!0,re=e}finally{try{!te&&ae.return&&ae.return()}finally{if(ne)throw re}}}if(this.config.condensedReplays&&r&&r._markingAsRead&&r._markingAsReadSortNumber>=e.sortNumber&&(k=qe.MessageRecipientStatus.READ),n){var se=!1;He.MESSAGE_STATUS_ORDER[k]<He.MESSAGE_STATUS_ORDER[n]&&(k=n,se=!0),!this.config.condensedReplays&&c&&He.MESSAGE_STATUS_ORDER[E]<He.MESSAGE_STATUS_ORDER[n]&&(E=n,se=!0),se||this.config.condensedReplays||(e._markingAsStatus=void 0)}if(s&&"user"===a&&k===qe.MessageRecipientStatus.READ){var ue=Date.now()+6e4;(!u||ue<u)&&(u=ue)}else u||void 0===p||(u=i.getTime()+60*p*1e3);e.expiresAt=u,this.config.condensedReplays?e.isUnread=!e.isEphemeral&&e.isUnread:(e.isUnread=!e.isEphemeral&&l===qe.MessageType.USER_SENT&&!c&&-1===this.compareRecipientStatus(k,qe.MessageRecipientStatus.READ),e.markedRecipientStatus=E),e.ttl=p}},{key:"compareRecipientStatus",value:function(e,t){return qe.MessageRecipientStatus.isValid(e)&&(e=He.MESSAGE_STATUS_ORDER[e]),qe.MessageRecipientStatus.isValid(t)&&(t=He.MESSAGE_STATUS_ORDER[t]),t<e?1:e===t?0:e<t?-1:void 0}},{key:"__getMessageAttachment",value:function(e,t){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(t));var n=this._resolveMessage(e);return n?(t=t.toString(),n.attachments?(0,ke.default)(n.attachments,{id:t}):null):null}},{key:"__getAttachmentPath",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(t));if("string"!=typeof e)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(t));return"/"+this.host.api.messages.getVersion().version+"/message/"+e+"/attachment/"+t}},{key:"downloadAttachmentUrl",value:function(e,t){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(t));return this._downloadAttachmentBlobAndUrl(e,t).then(function(e){return e.url})}},{key:"downloadAttachmentUrlWithToken",value:function(e,t){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));if("string"!=typeof t&&"number"!=typeof t)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(t));return this._downloadAttachmentBlobAndUrlWithToken(e,t).then(function(e){return e.url})}},{key:"downloadAttachment",value:(M=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).fileName;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 6:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(n));e.next=8;break;case 8:if(r=this._resolveMessage(t),o=void 0,!(a=this.__getMessageAttachment(t,n))||!a.isLocal){e.next=16;break}o=a.localFile,e.next=19;break;case 16:return e.next=18,this._downloadAttachmentBlobAndUrl(r.serverId,n);case 18:o=e.sent.blob;case 19:return(s=s||a.name)||(s="Attachment",r.sender.$placeholder||(s+=" from "+r.sender.displayName),s+=" at "+(0,Fe.default)(r.createdAt).format("YYYY-MM-DD h-mma"),(i=(0,We.getMimeType)({mime:a.contentType}))&&(s+=i.ext)),e.next=23,(0,Ze.downloadFile)({attachmentContentType:a.contentType,blob:o,fileName:s});case 23:e.next=26;break;case 25:$e.TargetNotSupportedError.raise();case 26:case"end":return e.stop()}},e,this)})),function(e,t){return M.apply(this,arguments)})},{key:"_downloadAttachmentBlobAndUrl",value:(S=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 6:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(n));e.next=8;break;case 8:return n=n.toString(),r=this._resolveMessage(t),e.next=13,this.findAttachment(t,n);case 13:if(o=e.sent){e.next=16;break}throw new $e.NotFoundError("MessageAttachment",r.serverId+":"+n);case 16:if(o.isLocal&&o.localFile instanceof Blob)return e.next=19,o.localPathPromise;e.next=23;break;case 19:return a=e.sent,e.abrupt("return",{blob:o.localFile,url:a});case 23:return i=this.__getAttachmentPath(r.serverId,n),e.abrupt("return",this.httpClient.downloadFileBlobAndUrl(i));case 25:e.next=28;break;case 27:$e.TargetNotSupportedError.raise();case 28:case"end":return e.stop()}},e,this)})),function(e,t){return S.apply(this,arguments)})},{key:"_downloadAttachmentBlobAndUrlWithToken",value:(j=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 6:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(n));e.next=8;break;case 8:return n=n.toString(),r=this._resolveMessage(t),e.next=13,this.findAttachment(t,n);case 13:if(o=e.sent){e.next=16;break}throw new $e.NotFoundError("MessageAttachment",r.serverId+":"+n);case 16:if(o.isLocal&&o.localFile instanceof Blob)return e.next=19,o.localPathPromise;e.next=23;break;case 19:return a=e.sent,e.abrupt("return",{blob:o.localFile,url:a});case 23:return e.next=25,this.getAttachmentUrlWithToken(r.serverId,n);case 25:return i=e.sent,e.abrupt("return",this.httpClient.downloadFileBlobAndUrl(i));case 27:e.next=30;break;case 29:$e.TargetNotSupportedError.raise();case 30:case"end":return e.stop()}},e,this)})),function(e,t){return j.apply(this,arguments)})},{key:"downloadAttachmentToFile",value:(O=(0,ye.default)(Ve.default.mark(function e(t,n,r){var o,a;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "dest" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(r));e.next=6;break;case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 8:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "dest" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(r));e.next=12;break;case 12:e.next=30;break;case 17:if(o=e.sent){e.next=20;break}throw new $e.NotFoundError("MessageAttachment",(void 0).serverId+":"+n);case 20:if(!/(\/|\\)$/.test(r)){e.next=26;break}if(!o.name){e.next=25;break}r+=o.name,e.next=26;break;case 25:throw new Error("missing file name in downloadAttachmentToFile(..., dest)");case 26:return a=this.__getAttachmentPath((void 0).serverId,n),e.abrupt("return",this.httpClient.downloadToFile(a,r));case 30:$e.TargetNotSupportedError.raise();case 31:case"end":return e.stop()}},e,this)})),function(e,t,n){return O.apply(this,arguments)})},{key:"getMessageCount",value:function(){return this.host.models.Message.getAll().length}},{key:"getTotalUnreadCount",value:function(){var e=this.host.models.Product.getAll()[0];return e?e.unreadCount:0}},{key:"getTotalUnreadPriorityCount",value:function(){var e=this.host.models.Product.getAll()[0];return e?e.unreadPriorityCount:0}},{key:"markAsRead",value:(I=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},f=l.localOnly,d=void 0!==f&&f,p=l.queue,h=void 0===p?this.host.currentlyServingOfflineMessages:p;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+Se(t));case 4:if(0===(t=(n=(n=t,Ye.arrayWrapBound).call(n).map(this._resolveModelId),De.default).call(n)).length)return e.abrupt("return");e.next=7;break;case 7:if(this.config.condensedReplays||!d){e.next=34;break}if(!(r=this.host.models.Message.getMulti(t))||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected readMessages to be iterable, got "+Se(r));e.next=11;break;case 11:if(!r||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected readMessages to be iterable, got "+Me(r));e.next=13;break;case 13:for(a=!(o=!0),i=void 0,e.prev=16,s=(0,Pe.default)(r);!(o=(u=s.next()).done);o=!0)(c=u.value)&&(c._markingAsStatus=qe.MessageRecipientStatus.READ,this.host.models.Message.inject(c));e.next=24;break;case 20:e.prev=20,e.t0=e.catch(16),a=!0,i=e.t0;case 24:e.prev=24,e.prev=25,!o&&s.return&&s.return();case 27:if(e.prev=27,a)throw i;e.next=30;break;case 30:return e.finish(27);case 31:return e.finish(24);case 32:e.next=39;break;case 34:if(h)return e.abrupt("return",this.__queueSetMessageStatuses({readIds:t}));e.next=38;break;case 38:return e.abrupt("return",this.__setMessagesStatus({readIds:t}));case 39:case"end":return e.stop()}},e,this,[[16,20,24,32],[25,,27,31]])})),function(e){return I.apply(this,arguments)})},{key:"markAsDelivered",value:(A=(0,ye.default)(Ve.default.mark(function e(t){var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object||Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring | Object | Array<string | Object>\n\nGot:\n'+Se(t));case 4:if(r=(0,Te.default)(r,{queue:this.host.currentlyServingOfflineMessages}),0===(t=(n=(n=t,Ye.arrayWrapBound).call(n).map(this._resolveModelId),De.default).call(n)).length)return e.abrupt("return");e.next=8;break;case 8:if(r.queue)return e.abrupt("return",this.__queueSetMessageStatuses({deliveredIds:t}));e.next=12;break;case 12:return e.abrupt("return",this.__setMessagesStatus({deliveredIds:t}));case 13:case"end":return e.stop()}},e,this)})),function(e){return A.apply(this,arguments)})},{key:"markAsReceived",value:(T=(0,ye.default)(Ve.default.mark(function e(){var t=arguments;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.markAsDelivered.apply(this,t));case 1:case"end":return e.stop()}},e,this)})),function(){return T.apply(this,arguments)})},{key:"__queueSetMessageStatuses",value:(k=(0,ye.default)(Ve.default.mark(function e(t){var n,r=t.deliveredIds,o=t.readIds,a=arguments;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=a[0]&&(void 0===a[0].deliveredIds||null==a[0].deliveredIds||Array.isArray(a[0].deliveredIds)&&a[0].deliveredIds.every(function(e){return"string"==typeof e}))&&(void 0===a[0].readIds||null==a[0].readIds||Array.isArray(a[0].readIds)&&a[0].readIds.every(function(e){return"string"==typeof e}))){e.next=2;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  deliveredIds?: ?Array<string>;\n  readIds?: ?Array<string>;\n}\n\nGot:\n"+Me(a[0]));case 2:if(null!=a[0]&&(void 0===a[0].deliveredIds||null==a[0].deliveredIds||Array.isArray(a[0].deliveredIds)&&a[0].deliveredIds.every(function(e){return"string"==typeof e}))&&(void 0===a[0].readIds||null==a[0].readIds||Array.isArray(a[0].readIds)&&a[0].readIds.every(function(e){return"string"==typeof e}))){e.next=4;break}throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  deliveredIds?: ?Array<string>;\n  readIds?: ?Array<string>;\n}\n\nGot:\n"+Se(a[0]));case 4:if(n=this._queuedSetMessageStatuses,r&&(n.deliveredIds=(0,Ee.default)(n.deliveredIds,r)),o&&(n.readIds=(0,Ee.default)(n.readIds,o)),n.deliveredIds.length+n.readIds.length>=this.config.flushSetMessageStatusMaxCount)return this.logger.log("reached "+this.config.flushSetMessageStatusMaxCount+" -- flushing"),e.abrupt("return",this.__flushSetMessageStatusesQueue());e.next=13;break;case 13:this._throttled_flushSetMessageStatusesQueue();case 14:case"end":return e.stop()}},e,this)})),function(e){return k.apply(this,arguments)})},{key:"__setMessagesStatus",value:(E=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z=t.deliveredIds,V=void 0===z?[]:z,G=t.readIds,N=void 0===G?[]:G;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),V=(n=V.map(this._resolveModelId),De.default).call(n),N=(n=N.map(this._resolveModelId),De.default).call(n),V=this.config.condensedReplays?(0,xe.default)(V,N):(r=this.host.models.Message.getMulti(V).filter(function(e){return e&&He.MESSAGE_STATUS_ORDER[e.markedRecipientStatus]>=He.MESSAGE_STATUS_ORDER[qe.MessageRecipientStatus.DELIVERED]}),o=r.map(function(e){return e.id}),a=this.host.models.Message.getMulti(N).filter(function(e){return e&&He.MESSAGE_STATUS_ORDER[e.markedRecipientStatus]>=He.MESSAGE_STATUS_ORDER[qe.MessageRecipientStatus.READ]}),i=a.map(function(e){return e.id}),N=(0,xe.default)(N,i),(0,xe.default)(V,N,o)),s={},0<V.length&&(s.delivered=V),!(0<N.length)){e.next=32;break}if(s.read=N,!(u=this.host.models.Message.getMulti(N))||"function"!=typeof u[ze.default]&&!Array.isArray(u))throw new TypeError("Expected readMessages to be iterable, got "+Se(u));e.next=11;break;case 11:if(!u||"function"!=typeof u[ze.default]&&!Array.isArray(u))throw new TypeError("Expected readMessages to be iterable, got "+Me(u));e.next=13;break;case 13:for(l=!(c=!0),f=void 0,e.prev=16,d=(0,Pe.default)(u);!(c=(p=d.next()).done);c=!0)(h=p.value)&&(h._markingAsStatus=qe.MessageRecipientStatus.READ,this.host.models.Message.inject(h));e.next=24;break;case 20:e.prev=20,e.t0=e.catch(16),l=!0,f=e.t0;case 24:e.prev=24,e.prev=25,!c&&d.return&&d.return();case 27:if(e.prev=27,l)throw f;e.next=30;break;case 30:return e.finish(27);case 31:return e.finish(24);case 32:if(0===(0,Ce.default)(s).length)return e.abrupt("return",!1);e.next=34;break;case 34:return e.prev=34,e.next=37,this.host.api.messages.updateRecipientStatusMulti(s);case 37:if(y=e.sent,!this.config.condensedReplays){e.next=63;break}if(!(w=(0,le.default)(y))||"function"!=typeof w[ze.default]&&!Array.isArray(w))throw new TypeError("Expected _Object$entries2 to be iterable, got "+Se(w));e.next=42;break;case 42:if(!w||"function"!=typeof w[ze.default]&&!Array.isArray(w))throw new TypeError("Expected _Object$entries2 to be iterable, got "+Me(w));e.next=44;break;case 44:for(g=!(v=!0),m=void 0,e.prev=47,b=(0,Pe.default)(w);!(v=(_=b.next()).done);v=!0)x=(0,ce.default)(_.value,2),E=x[0],k=x[1],T=k.unread_message_count,A=k.unread_priority_message_count,(I=this.host.models.Conversation.get(E))&&(I.unreadMessageCount=T,I.unreadPriorityMessageCount=A,this.host.models.Conversation.inject(I));e.next=55;break;case 51:e.prev=51,e.t1=e.catch(47),g=!0,m=e.t1;case 55:e.prev=55,e.prev=56,!v&&b.return&&b.return();case 58:if(e.prev=58,g)throw m;e.next=61;break;case 61:return e.finish(58);case 62:return e.finish(55);case 63:e.next=92;break;case 65:if(e.prev=65,e.t2=e.catch(34),!(O=this.host.models.Message.getMulti(N))||"function"!=typeof O[ze.default]&&!Array.isArray(O))throw new TypeError("Expected readMessages to be iterable, got "+Se(O));e.next=70;break;case 70:if(!O||"function"!=typeof O[ze.default]&&!Array.isArray(O))throw new TypeError("Expected readMessages to be iterable, got "+Me(O));e.next=72;break;case 72:for(S=!(j=!0),M=void 0,e.prev=75,R=(0,Pe.default)(O);!(j=(C=R.next()).done);j=!0)(P=C.value)&&P._markingAsStatus&&(P._markingAsStatus=void 0,this.host.models.Message.inject(P));e.next=83;break;case 79:e.prev=79,e.t3=e.catch(75),S=!0,M=e.t3;case 83:e.prev=83,e.prev=84,!j&&R.return&&R.return();case 86:if(e.prev=86,S)throw M;e.next=89;break;case 89:return e.finish(86);case 90:return e.finish(83);case 91:return e.abrupt("return",he.default.reject(e.t2));case 92:return e.abrupt("return",!0);case 93:case"end":return e.stop()}},e,this,[[16,20,24,32],[25,,27,31],[34,65],[47,51,55,63],[56,,58,62],[75,79,83,91],[84,,86,90]])})),function(e){return E.apply(this,arguments)})},{key:"setMessageTTLInMinutes",value:function(e,t){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if("number"!=typeof t)throw new TypeError('Value of argument "ttl" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Me(t));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));if("number"!=typeof t)throw new TypeError('Value of argument "ttl" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Se(t));var n=this._resolveMessage(e);if(n){var r=(0,Fe.default)().add(t,"minute").toDate().getTime();this.host.models.Message.inject({id:n.id,ttl:t,expiresAt:r})}}},{key:"_clearOptimisticMarkAsReadState",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Date.now();if(e.getTime&&(e=e.getTime()),!(i=this.host.organizations.getAll())||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected _host$organizations$g to be iterable, got "+Se(i));if(!i||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected _host$organizations$g to be iterable, got "+Me(i));var t=!0,n=!1,r=void 0;try{for(var o,a=(0,Pe.default)(i);!(t=(o=a.next()).done);t=!0)for(var i,s=o.value.__markingAsReadConversations,u=!1;!u&&0<s.length;){var c=s[0],l=this.host.conversations.getById(c.id);if(!l)return;l._markingAsReadExpiration<e?(l._markingAsRead=!1,l._markingAsReadSortNumber=null,l._markingAsReadExpiration=null,this.host.models.Conversation.inject(l),this.host.conversations.find(l.id,{ensureEntities:!1})):u=!0}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"ensureRecipientStatus",value:(x=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},v=y.includeUsers,g=void 0===v||v,m=y.queue,b=void 0===m||m;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(this.host.requireUser(),t=this._resolveModelId(t),n=this._resolveMessage(t)){e.next=9;break}return e.abrupt("return",null);case 9:if(r=n.counterPartyType,o=n.senderStatus,a=n.shouldEnsureRecipientStatus,i=n.statusesPerRecipient,o===qe.MessageSenderStatus.SENDING)return e.abrupt("return",null);e.next=12;break;case 12:if("distributionList"===r)return e.abrupt("return",null);e.next=14;break;case 14:if(a||!(0<i.length)){e.next=42;break}if(s=!1,!g){e.next=40;break}if(!i||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Se(i));e.next=19;break;case 19:if(!i||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Me(i));e.next=21;break;case 21:for(c=!(u=!0),l=void 0,e.prev=24,f=(0,Pe.default)(i);!(u=(d=f.next()).done);u=!0)d.value.user||(s=!0);e.next=32;break;case 28:e.prev=28,e.t0=e.catch(24),c=!0,l=e.t0;case 32:e.prev=32,e.prev=33,!u&&f.return&&f.return();case 35:if(e.prev=35,c)throw l;e.next=38;break;case 38:return e.finish(35);case 39:return e.finish(32);case 40:if(s){e.next=42;break}return e.abrupt("return",i);case 42:if(p=void 0,b)return e.next=46,this.__queueFindRecipientStatuses([{id:t,includeUsers:g}]);e.next=50;break;case 46:h=e.sent,p=h[0],e.next=53;break;case 50:return e.next=52,this.__findRecipientStatus(t,{includeUsers:g});case 52:p=e.sent;case 53:return e.abrupt("return",p);case 54:case"end":return e.stop()}},e,this,[[24,28,32,40],[33,,35,39]])})),function(e){return x.apply(this,arguments)})},{key:"findRecipientStatus",value:(w=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=a.includeUsers,s=void 0!==i&&i,u=a.queue,c=void 0===u||u;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(t));case 4:if(this.host.requireUser(),n=this._resolveMessage(t)){e.next=8;break}return e.abrupt("return",null);case 8:if(n.senderStatus===qe.MessageSenderStatus.SENDING)return e.abrupt("return",null);e.next=10;break;case 10:if("distributionList"===n.counterPartyType)return e.abrupt("return",null);e.next=12;break;case 12:if(t=this._resolveModelId(t),r=void 0,c)return e.next=17,this.__queueFindRecipientStatuses([{id:t,includeUsers:s}]);e.next=21;break;case 17:o=e.sent,r=o[0],e.next=24;break;case 21:return e.next=23,this.__findRecipientStatus(t,{includeUsers:s});case 23:r=e.sent;case 24:return e.abrupt("return",r);case 25:case"end":return e.stop()}},e,this)})),function(e){return w.apply(this,arguments)})},{key:"ensureRecipientStatusMulti",value:(_=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},C=R.includeUsers,P=void 0===C||C,z=R.queue,V=void 0===z||z;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+Me(t));case 2:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+Se(t));case 4:if(t=(n=(n=t,Ye.arrayWrapBound).call(n).map(this._resolveModelId),De.default).call(n),r=[],o={},!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+Se(t));e.next=9;break;case 9:if(!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+Me(t));e.next=11;break;case 11:i=!(a=!0),s=void 0,e.prev=14,u=(0,Pe.default)(t);case 16:if(a=(c=u.next()).done){e.next=53;break}if(l=c.value,f={id:l,includeUsers:P},d=this._resolveMessage(l),p=!0,!d){e.next=49;break}if(h=d.shouldEnsureRecipientStatus,y=d.statusesPerRecipient,h||!(0<y.length)){e.next=49;break}if(p=!1,!P){e.next=49;break}if(!y||"function"!=typeof y[ze.default]&&!Array.isArray(y))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Se(y));e.next=28;break;case 28:if(!y||"function"!=typeof y[ze.default]&&!Array.isArray(y))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Me(y));e.next=30;break;case 30:for(g=!(v=!0),m=void 0,e.prev=33,b=(0,Pe.default)(y);!(v=(_=b.next()).done);v=!0)_.value.user||(p=!0);e.next=41;break;case 37:e.prev=37,e.t0=e.catch(33),g=!0,m=e.t0;case 41:e.prev=41,e.prev=42,!v&&b.return&&b.return();case 44:if(e.prev=44,g)throw m;e.next=47;break;case 47:return e.finish(44);case 48:return e.finish(41);case 49:p?r.push(f):o[f.id]=d.statusesPerRecipient;case 50:a=!0,e.next=16;break;case 53:e.next=59;break;case 55:e.prev=55,e.t1=e.catch(14),i=!0,s=e.t1;case 59:e.prev=59,e.prev=60,!a&&u.return&&u.return();case 62:if(e.prev=62,i)throw s;e.next=65;break;case 65:return e.finish(62);case 66:return e.finish(59);case 67:if(0===r.length)return e.abrupt("return");e.next=69;break;case 69:if(w=void 0,V)return e.next=73,this.__queueFindRecipientStatuses(r);e.next=76;break;case 73:w=e.sent,e.next=79;break;case 76:return e.next=78,this.__findRecipientStatusMulti(r);case 78:w=e.sent;case 79:if(w)for(x=0;x<r.length;x++)w.length>x&&(E=r[x],k=w[x],o[E.id]=k);if(T=[],!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+Se(t));e.next=83;break;case 83:if(!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+Me(t));e.next=85;break;case 85:for(I=!(A=!0),O=void 0,e.prev=88,j=(0,Pe.default)(t);!(A=(S=j.next()).done);A=!0)M=S.value,T.push(o[M]);e.next=96;break;case 92:e.prev=92,e.t2=e.catch(88),I=!0,O=e.t2;case 96:e.prev=96,e.prev=97,!A&&j.return&&j.return();case 99:if(e.prev=99,I)throw O;e.next=102;break;case 102:return e.finish(99);case 103:return e.finish(96);case 104:return e.abrupt("return",T);case 105:case"end":return e.stop()}},e,this,[[14,55,59,67],[33,37,41,49],[42,,44,48],[60,,62,66],[88,92,96,104],[97,,99,103]])})),function(e){return _.apply(this,arguments)})},{key:"findRecipientStatusMulti",value:(b=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=f.includeUsers,p=void 0!==d&&d,h=f.queue,y=void 0!==h&&h;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+Me(t));case 2:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+Se(t));case 4:if(t=(n=(n=t,Ye.arrayWrapBound).call(n).map(this._resolveModelId),De.default).call(n),r=[],!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+Se(t));e.next=8;break;case 8:if(!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+Me(t));e.next=10;break;case 10:for(a=!(o=!0),i=void 0,e.prev=13,s=(0,Pe.default)(t);!(o=(u=s.next()).done);o=!0)c=u.value,l={id:c,includeUsers:p},r.push(l);e.next=21;break;case 17:e.prev=17,e.t0=e.catch(13),a=!0,i=e.t0;case 21:e.prev=21,e.prev=22,!o&&s.return&&s.return();case 24:if(e.prev=24,a)throw i;e.next=27;break;case 27:return e.finish(24);case 28:return e.finish(21);case 29:if(0===r.length)return e.abrupt("return");e.next=31;break;case 31:if(y)return e.abrupt("return",this.__queueFindRecipientStatuses(r));e.next=35;break;case 35:return e.abrupt("return",this.__findRecipientStatusMulti(r));case 36:case"end":return e.stop()}},e,this,[[13,17,21,29],[22,,24,28]])})),function(e){return b.apply(this,arguments)})},{key:"__queueFindRecipientStatuses",value:(m=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "statusRequests" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+Me(t));case 2:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "statusRequests" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+Se(t));case 4:if(n=[],!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected statusRequests to be iterable, got "+Se(t));e.next=7;break;case 7:if(!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected statusRequests to be iterable, got "+Me(t));e.next=9;break;case 9:o=!(r=!0),a=void 0,e.prev=12,i=(0,Pe.default)(t);case 14:if(r=(s=i.next()).done){e.next=59;break}if(u=s.value,c=u.id,l=u.includeUsers,p=!(d=f=void 0),n.push(new he.default(function(e,t){f=e,d=t})),!(b=this._queuedFindRecipientStatuses)||"function"!=typeof b[ze.default]&&!Array.isArray(b))throw new TypeError("Expected _queuedFindRecipientS to be iterable, got "+Se(b));e.next=23;break;case 23:if(!b||"function"!=typeof b[ze.default]&&!Array.isArray(b))throw new TypeError("Expected _queuedFindRecipientS to be iterable, got "+Me(b));e.next=25;break;case 25:y=!(h=!0),v=void 0,e.prev=28,g=(0,Pe.default)(b);case 30:if(h=(m=g.next()).done){e.next=41;break}if(_=m.value,c===_.id)return _.includeUsers=_.includeUsers||l,_.onCompletes.push(f),_.onErrors.push(d),p=!1,e.abrupt("break",41);e.next=38;break;case 38:h=!0,e.next=30;break;case 41:e.next=47;break;case 43:e.prev=43,e.t0=e.catch(28),y=!0,v=e.t0;case 47:e.prev=47,e.prev=48,!h&&g.return&&g.return();case 50:if(e.prev=50,y)throw v;e.next=53;break;case 53:return e.finish(50);case 54:return e.finish(47);case 55:p&&this._queuedFindRecipientStatuses.push({id:c,includeUsers:l,onCompletes:[f],onErrors:[d]});case 56:r=!0,e.next=14;break;case 59:e.next=65;break;case 61:e.prev=61,e.t1=e.catch(12),o=!0,a=e.t1;case 65:e.prev=65,e.prev=66,!r&&i.return&&i.return();case 68:if(e.prev=68,o)throw a;e.next=71;break;case 71:return e.finish(68);case 72:return e.finish(65);case 73:return this._queuedFindRecipientStatuses.length>=this.config.flushFindRecipientStatusMaxCount?(this.logger.log("reached "+this.config.flushFindRecipientStatusMaxCount+" -- flushing"),this.__flushFindRecipientStatusesQueue()):0<this._queuedFindRecipientStatuses.length&&this._throttled_flushFindRecipientStatusesQueue(),e.next=76,he.default.all(n);case 76:return w=e.sent,e.abrupt("return",w);case 78:case"end":return e.stop()}},e,this,[[12,61,65,73],[28,43,47,55],[48,,50,54],[66,,68,72]])})),function(e){return m.apply(this,arguments)})},{key:"__flushFindRecipientStatusesQueue",value:(g=(0,ye.default)(Ve.default.mark(function e(){var g,m,b,t,n;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this._queuedFindRecipientStatuses.length)return e.abrupt("return");e.next=2;break;case 2:return g=this._queuedFindRecipientStatuses,this._queuedFindRecipientStatuses=[],b=m=void 0,e.prev=5,e.next=8,this.__findRecipientStatusMulti(g);case 8:b=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),m=e.t0;case 14:for(e.prev=14,t=function(e){var t=void 0;b&&b.length>e&&(t=b[e]);var n=g[e],r=n.onCompletes,o=n.onErrors;if(m){if(!o||"function"!=typeof o[ze.default]&&!Array.isArray(o))throw new TypeError("Expected onErrors to be iterable, got "+Se(o));if(!o||"function"!=typeof o[ze.default]&&!Array.isArray(o))throw new TypeError("Expected onErrors to be iterable, got "+Me(o));var a=!0,i=!1,s=void 0;try{for(var u,c=function(){var e=u.value;setTimeout(function(){return e(m)},0)},l=(0,Pe.default)(o);!(a=(u=l.next()).done);a=!0)c()}catch(e){i=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw s}}}else{if(!r||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected onCompletes to be iterable, got "+Se(r));if(!r||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected onCompletes to be iterable, got "+Me(r));var f=!0,d=!1,p=void 0;try{for(var h,y=function(){var e=h.value;setTimeout(function(){return e(t)},0)},v=(0,Pe.default)(r);!(f=(h=v.next()).done);f=!0)y()}catch(e){d=!0,p=e}finally{try{!f&&v.return&&v.return()}finally{if(d)throw p}}}},n=0;n<g.length;n++)t(n);return e.finish(14);case 18:case"end":return e.stop()}},e,this,[[5,11,14,18]])})),function(){return g.apply(this,arguments)})},{key:"__findRecipientStatus",value:(v=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k=this,T=n.includeUsers;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),r=this._resolveMessage(t),o=!1,this._pendingFindRecipientStatuses[r.id])return e.abrupt("return",null);e.next=5;break;case 5:return a=void 0,e.prev=6,i=new he.default(function(e,t){k._pendingFindRecipientStatuses[r.id]=function(){return e(null)}}),e.next=10,he.default.race([i,this.host.api.messages.findRecipientStatus(r.serverId)]);case 10:a=e.sent;case 11:return e.prev=11,delete this._pendingFindRecipientStatuses[r.id],e.finish(11);case 14:if(a){e.next=16;break}return e.abrupt("return",null);case 16:if(a.is_recalled)return this.host.models.Message.eject(r),e.abrupt("return",null);e.next=19;break;case 19:if(!(d=a.statuses)||"function"!=typeof d[ze.default]&&!Array.isArray(d))throw new TypeError("Expected _data$statuses to be iterable, got "+Se(d));e.next=22;break;case 22:if(!d||"function"!=typeof d[ze.default]&&!Array.isArray(d))throw new TypeError("Expected _data$statuses to be iterable, got "+Me(d));e.next=24;break;case 24:for(u=!(s=!0),c=void 0,e.prev=27,l=(0,Pe.default)(d);!(s=(f=l.next()).done);s=!0)p=f.value,this.__injectMessageStatus(r,p);e.next=35;break;case 31:e.prev=31,e.t0=e.catch(27),u=!0,c=e.t0;case 35:e.prev=35,e.prev=36,!s&&l.return&&l.return();case 38:if(e.prev=38,u)throw c;e.next=41;break;case 41:return e.finish(38);case 42:return e.finish(35);case 43:if(!T){e.next=72;break}if(h=r.recipientOrganizationId,y=r.statusesPerRecipient,v=[],!y||"function"!=typeof y[ze.default]&&!Array.isArray(y))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Se(y));e.next=48;break;case 48:if(!y||"function"!=typeof y[ze.default]&&!Array.isArray(y))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Me(y));e.next=50;break;case 50:for(m=!(g=!0),b=void 0,e.prev=53,_=(0,Pe.default)(y);!(g=(w=_.next()).done);g=!0)x=w.value,(E=x.userId)&&usersIds.push(E);e.next=61;break;case 57:e.prev=57,e.t1=e.catch(53),m=!0,b=e.t1;case 61:e.prev=61,e.prev=62,!g&&_.return&&_.return();case 64:if(e.prev=64,m)throw b;e.next=67;break;case 67:return e.finish(64);case 68:return e.finish(61);case 69:return e.next=71,this.host.users.ensureUsers(v,h);case 71:o=!0;case 72:return r.shouldEnsureRecipientStatus&&(r.shouldEnsureRecipientStatus=!1,o=!0),o&&this.host.models.Message.inject(r),!this.config.condensedReplays&&He.MESSAGE_STATUS_ORDER[r.markedRecipientStatus]<He.MESSAGE_STATUS_ORDER[qe.MessageRecipientStatus.DELIVERED]&&this.markAsReceived(r),e.abrupt("return",r.statusesPerRecipient);case 77:case"end":return e.stop()}},e,this,[[6,,11,14],[27,31,35,43],[36,,38,42],[53,57,61,69],[62,,64,68]])})),function(e,t){return v.apply(this,arguments)})},{key:"__findRecipientStatusMulti",value:(y=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z,V,G,N,D,U,F,L,B,$,q,H,Y,Z,W,K,X,Q,J,ee,te,ne,re,oe,ae,ie,se,ue,ce,le,fe,de,pe,he,ye,ve,ge,me,be,_e,we,xe,Ee,ke,Te,Ae,Ie,Oe,je=this;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "requests" violates contract.\n\nExpected:\nArray<Object>\n\nGot:\n'+Me(t));case 2:if(Array.isArray(t)&&t.every(function(e){return e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "requests" violates contract.\n\nExpected:\nArray<Object>\n\nGot:\n'+Se(t));case 4:if(this.host.requireUser(),n={},r=t,t=[],!r||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected inRequests to be iterable, got "+Se(r));e.next=10;break;case 10:if(!r||"function"!=typeof r[ze.default]&&!Array.isArray(r))throw new TypeError("Expected inRequests to be iterable, got "+Me(r));e.next=12;break;case 12:a=!(o=!0),i=void 0,e.prev=15,s=(0,Pe.default)(r);case 17:if(o=(u=s.next()).done){e.next=35;break}if(c=u.value,l=c.id,f=c.includeUsers,d=this._resolveMessage(l),h=(p=d||{}).counterParty,y=p.serverId,v={id:l,includeUsers:f,message:d},t.push(v),y){e.next=26;break}return e.abrupt("continue",32);case 26:if(this._pendingFindRecipientStatuses[y])return e.abrupt("continue",32);e.next=28;break;case 28:if(h&&"distributionList"===h.$entityType)return e.abrupt("continue",32);e.next=30;break;case 30:v.id=y,n[y]=!0;case 32:o=!0,e.next=17;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(15),a=!0,i=e.t0;case 41:e.prev=41,e.prev=42,!o&&s.return&&s.return();case 44:if(e.prev=44,a)throw i;e.next=47;break;case 47:return e.finish(44);case 48:return e.finish(41);case 49:if(g=(0,Ge.default)((0,Ce.default)(n),20),m={},b={},!g||"function"!=typeof g[ze.default]&&!Array.isArray(g))throw new TypeError("Expected idGroupChunks to be iterable, got "+Se(g));e.next=54;break;case 54:if(!g||"function"!=typeof g[ze.default]&&!Array.isArray(g))throw new TypeError("Expected idGroupChunks to be iterable, got "+Me(g));e.next=56;break;case 56:w=!(_=!0),x=void 0,e.prev=59,E=(0,Pe.default)(g);case 61:if(_=(k=E.next()).done){e.next=156;break}return T=k.value,A=void 0,e.prev=64,e.delegateYield(Ve.default.mark(function e(){var t,n,r,o,a,i,s,u,c,l,f,d,p,h,y;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},!T||"function"!=typeof T[ze.default]&&!Array.isArray(T))throw new TypeError("Expected idsInGroup to be iterable, got "+Se(T));e.next=3;break;case 3:if(!T||"function"!=typeof T[ze.default]&&!Array.isArray(T))throw new TypeError("Expected idsInGroup to be iterable, got "+Me(T));e.next=5;break;case 5:for(r=!(n=!0),o=void 0,e.prev=8,a=function(){var e=s.value;je._pendingFindRecipientStatuses[e]=function(){t[e]=!0}},i=(0,Pe.default)(T);!(n=(s=i.next()).done);n=!0)a();e.next=17;break;case 13:e.prev=13,e.t0=e.catch(8),r=!0,o=e.t0;case 17:e.prev=17,e.prev=18,!n&&i.return&&i.return();case 20:if(e.prev=20,r)throw o;e.next=23;break;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return e.next=27,je.host.api.messages.findRecipientStatusMulti(T);case 27:if(u=e.sent,A=[],!u||"function"!=typeof u[ze.default]&&!Array.isArray(u))throw new TypeError("Expected rawResults to be iterable, got "+Se(u));e.next=31;break;case 31:if(!u||"function"!=typeof u[ze.default]&&!Array.isArray(u))throw new TypeError("Expected rawResults to be iterable, got "+Me(u));e.next=33;break;case 33:for(l=!(c=!0),f=void 0,e.prev=36,d=(0,Pe.default)(u);!(c=(p=d.next()).done);c=!0)h=p.value,y=h.client_id,t[y]||A.push(h);e.next=44;break;case 40:e.prev=40,e.t1=e.catch(36),l=!0,f=e.t1;case 44:e.prev=44,e.prev=45,!c&&d.return&&d.return();case 47:if(e.prev=47,l)throw f;e.next=50;break;case 50:return e.finish(47);case 51:return e.finish(44);case 52:case"end":return e.stop()}},e,je,[[8,13,17,25],[18,,20,24],[36,40,44,52],[45,,47,51]])})(),"t1",66);case 66:if(e.prev=66,!T||"function"!=typeof T[ze.default]&&!Array.isArray(T))throw new TypeError("Expected idsInGroup to be iterable, got "+Se(T));e.next=69;break;case 69:if(!T||"function"!=typeof T[ze.default]&&!Array.isArray(T))throw new TypeError("Expected idsInGroup to be iterable, got "+Me(T));e.next=71;break;case 71:for(O=!(I=!0),j=void 0,e.prev=74,S=(0,Pe.default)(T);!(I=(M=S.next()).done);I=!0)R=M.value,delete this._pendingFindRecipientStatuses[R];e.next=82;break;case 78:e.prev=78,e.t2=e.catch(74),O=!0,j=e.t2;case 82:e.prev=82,e.prev=83,!I&&S.return&&S.return();case 85:if(e.prev=85,O)throw j;e.next=88;break;case 88:return e.finish(85);case 89:return e.finish(82);case 90:return e.finish(66);case 91:if(A){e.next=93;break}return e.abrupt("return",[]);case 93:if(!A||"function"!=typeof A[ze.default]&&!Array.isArray(A))throw new TypeError("Expected results to be iterable, got "+Se(A));e.next=95;break;case 95:if(!A||"function"!=typeof A[ze.default]&&!Array.isArray(A))throw new TypeError("Expected results to be iterable, got "+Me(A));e.next=97;break;case 97:P=!(C=!0),z=void 0,e.prev=100,V=(0,Pe.default)(A);case 102:if(C=(G=V.next()).done){e.next=139;break}if(N=G.value,D=N.client_id,U=N.statuses,F=this.host.models.Message.get(D),N.is_recalled)return this.host.models.Message.eject(F),b[D]=!0,e.abrupt("continue",136);e.next=111;break;case 111:if(!(U&&0<U.length)){e.next=136;break}if(!U||"function"!=typeof U[ze.default]&&!Array.isArray(U))throw new TypeError("Expected statuses to be iterable, got "+Se(U));e.next=114;break;case 114:if(!U||"function"!=typeof U[ze.default]&&!Array.isArray(U))throw new TypeError("Expected statuses to be iterable, got "+Me(U));e.next=116;break;case 116:for(B=!(L=!0),$=void 0,e.prev=119,q=(0,Pe.default)(U);!(L=(H=q.next()).done);L=!0)Y=H.value,this.__injectMessageStatus(F,Y);e.next=127;break;case 123:e.prev=123,e.t3=e.catch(119),B=!0,$=e.t3;case 127:e.prev=127,e.prev=128,!L&&q.return&&q.return();case 130:if(e.prev=130,B)throw $;e.next=133;break;case 133:return e.finish(130);case 134:return e.finish(127);case 135:m[D]=F;case 136:C=!0,e.next=102;break;case 139:e.next=145;break;case 141:e.prev=141,e.t4=e.catch(100),P=!0,z=e.t4;case 145:e.prev=145,e.prev=146,!C&&V.return&&V.return();case 148:if(e.prev=148,P)throw z;e.next=151;break;case 151:return e.finish(148);case 152:return e.finish(145);case 153:_=!0,e.next=61;break;case 156:e.next=162;break;case 158:e.prev=158,e.t5=e.catch(59),w=!0,x=e.t5;case 162:e.prev=162,e.prev=163,!_&&E.return&&E.return();case 165:if(e.prev=165,w)throw x;e.next=168;break;case 168:return e.finish(165);case 169:return e.finish(162);case 170:if(!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected requests to be iterable, got "+Se(t));e.next=172;break;case 172:if(!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected requests to be iterable, got "+Me(t));e.next=174;break;case 174:W=!(Z=!0),K=void 0,e.prev=177,X=(0,Pe.default)(t);case 179:if(Z=(Q=X.next()).done){e.next=219;break}if(J=Q.value,f=J.includeUsers,ee=J.message,te=!1,!ee||b[ee.serverId])return e.abrupt("continue",216);e.next=185;break;case 185:if(ne=ee.recipientOrganizationId,re=ee.shouldEnsureRecipientStatus,oe=ee.statusesPerRecipient,!f){e.next=214;break}if(ae=[],!oe||"function"!=typeof oe[ze.default]&&!Array.isArray(oe))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Se(oe));e.next=190;break;case 190:if(!oe||"function"!=typeof oe[ze.default]&&!Array.isArray(oe))throw new TypeError("Expected statusesPerRecipient to be iterable, got "+Me(oe));e.next=192;break;case 192:for(se=!(ie=!0),ue=void 0,e.prev=195,ce=(0,Pe.default)(oe);!(ie=(le=ce.next()).done);ie=!0)fe=le.value,(de=fe.userId)&&ae.push(de);e.next=203;break;case 199:e.prev=199,e.t6=e.catch(195),se=!0,ue=e.t6;case 203:e.prev=203,e.prev=204,!ie&&ce.return&&ce.return();case 206:if(e.prev=206,se)throw ue;e.next=209;break;case 209:return e.finish(206);case 210:return e.finish(203);case 211:return e.next=213,this.host.users.ensureUsers(ae,ne);case 213:te=!0;case 214:re&&(ee.shouldEnsureRecipientStatus=!1,te=!0),te&&this.host.models.Message.inject(ee);case 216:Z=!0,e.next=179;break;case 219:e.next=225;break;case 221:e.prev=221,e.t7=e.catch(177),W=!0,K=e.t7;case 225:e.prev=225,e.prev=226,!Z&&X.return&&X.return();case 228:if(e.prev=228,W)throw K;e.next=231;break;case 231:return e.finish(228);case 232:return e.finish(225);case 233:if(this.config.condensedReplays){e.next=258;break}if(!(me=(0,Re.default)(m))||"function"!=typeof me[ze.default]&&!Array.isArray(me))throw new TypeError("Expected _Object$values to be iterable, got "+Se(me));e.next=237;break;case 237:if(!me||"function"!=typeof me[ze.default]&&!Array.isArray(me))throw new TypeError("Expected _Object$values to be iterable, got "+Me(me));e.next=239;break;case 239:for(he=!(pe=!0),ye=void 0,e.prev=242,ve=(0,Pe.default)(me);!(pe=(ge=ve.next()).done);pe=!0)be=ge.value,He.MESSAGE_STATUS_ORDER[be.markedRecipientStatus]<He.MESSAGE_STATUS_ORDER[qe.MessageRecipientStatus.DELIVERED]&&this.markAsReceived(be);e.next=250;break;case 246:e.prev=246,e.t8=e.catch(242),he=!0,ye=e.t8;case 250:e.prev=250,e.prev=251,!pe&&ve.return&&ve.return();case 253:if(e.prev=253,he)throw ye;e.next=256;break;case 256:return e.finish(253);case 257:return e.finish(250);case 258:if(_e=[],!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected requests to be iterable, got "+Se(t));e.next=261;break;case 261:if(!t||"function"!=typeof t[ze.default]&&!Array.isArray(t))throw new TypeError("Expected requests to be iterable, got "+Me(t));e.next=263;break;case 263:for(xe=!(we=!0),Ee=void 0,e.prev=266,ke=(0,Pe.default)(t);!(we=(Te=ke.next()).done);we=!0)Ae=Te.value,Ie=Ae.id,Oe=m[Ie],_e.push(Oe?Oe.statusesPerRecipient:null);e.next=274;break;case 270:e.prev=270,e.t9=e.catch(266),xe=!0,Ee=e.t9;case 274:e.prev=274,e.prev=275,!we&&ke.return&&ke.return();case 277:if(e.prev=277,xe)throw Ee;e.next=280;break;case 280:return e.finish(277);case 281:return e.finish(274);case 282:return e.abrupt("return",_e);case 283:case"end":return e.stop()}},e,this,[[15,37,41,49],[42,,44,48],[59,158,162,170],[64,,66,91],[74,78,82,90],[83,,85,89],[100,141,145,153],[119,123,127,135],[128,,130,134],[146,,148,152],[163,,165,169],[177,221,225,233],[195,199,203,211],[204,,206,210],[226,,228,232],[242,246,250,258],[251,,253,257],[266,270,274,282],[275,,277,281]])})),function(e){return y.apply(this,arguments)})}]),o((p=et).prototype,"__prepareGroupForUsers",[a],(0,ue.default)(p.prototype,"__prepareGroupForUsers"),p.prototype),o(p.prototype,"__prepareRoleP2PGroup",[i],(0,ue.default)(p.prototype,"__prepareRoleP2PGroup"),p.prototype),o(p.prototype,"find",[s],(0,ue.default)(p.prototype,"find"),p.prototype),o(p.prototype,"downloadAttachmentUrl",[u],(0,ue.default)(p.prototype,"downloadAttachmentUrl"),p.prototype),o(p.prototype,"downloadAttachment",[c],(0,ue.default)(p.prototype,"downloadAttachment"),p.prototype),o(p.prototype,"_downloadAttachmentBlobAndUrl",[l],(0,ue.default)(p.prototype,"_downloadAttachmentBlobAndUrl"),p.prototype),o(p.prototype,"findRecipientStatus",[f],(0,ue.default)(p.prototype,"findRecipientStatus"),p.prototype),o(p.prototype,"findRecipientStatusMulti",[d],(0,ue.default)(p.prototype,"findRecipientStatusMulti"),p.prototype),p);function et(){var e,t,v,n,r,o,a,i,s,u,g=this;(0,ge.default)(this,et);for(var c=arguments.length,l=Array(c),f=0;f<c;f++)l[f]=arguments[f];return t=v=(0,be.default)(this,(e=et.__proto__||(0,ve.default)(et)).call.apply(e,[this].concat(l))),v.DELETE_ON_READ_MS=6e4,v.__retrieveSentMessage=(u=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y=n.instance;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.message_id){e.next=3;break}throw new Error("Missing message_id from /message response");case 3:if(t.sort_number){e.next=16;break}return e.next=6,v.find(r,{instance:y,replace:!0});case 6:if(o=e.sent){e.next=13;break}return e.next=10,new he.default(function(e){return setTimeout(e,1e3)});case 10:return e.next=12,v.find(r,{instance:y,replace:!0});case 12:o=e.sent;case 13:o&&(y=o),e.next=32;break;case 16:if(void 0===t.is_forwarded&&(t.is_forwarded=!1),a=t.status||"New",v.__setDefaultAttributes(t,{instance:y}),(y=v.host.models.Message.replaceExisting(t,{instance:y})).$synced=void 0,s=(i=y).counterPartyType,u=i.createdAt,c=i.group,l=i.recipientId,d=(f=c||{}).groupType,p=f.p2pRecipient,h=void 0,d===qe.GroupType.ROLE_P2P&&p?h="role"===p.$entityType?p.botUserId:p.id:"user"===s&&(h=l),!h){e.next=29;break}v.__injectMessageStatus(y,{accountId:h,createdAt:u,status:a}),e.next=32;break;case 29:if(d===qe.GroupType.GROUP)return e.next=32,v.findRecipientStatus(y,{queue:!1});e.next=32;break;case 32:return e.abrupt("return",y);case 33:case"end":return e.stop()}},e,g)})),function(e,t){return u.apply(this,arguments)}),v.__generateAttachmentDescriptor=function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "attachment" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "attachment" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));var t="local:"+Be.default.v4();e instanceof File||e instanceof Blob||Ye.Validator.raise("attachment","invalid","attachment (File or Blob) is invalid"),e.name||(e.name="attachment");var n={id:t,localFile:e,name:e.name,size:e.size,contentType:e.type,isLoading:!0,isLocal:!0};if(e.preview)n.localPath=e.preview,n.localPathPromise=function(){return he.default.resolve(n.localPath)},n.isLoading=!1;else{var r=(0,Ze.loadLocalFilePathWithFileReader)(e);(n.localPathPromise=r).then(function(e){n.localPath=e,n.isLoading=!1})}return n},v.__retryApiSend=(s=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=t)._originalBody,o=n.attachments,a=n.conversationId,i=n.counterPartyId,s=n.deleteOnRead,u=n.id,c=n.metadata,l=n.priority,f=n.recipientOrganizationId,d=n.senderOrganizationId,p=n.shouldEscalate,h=n.ttl,e.prev=1,e.next=4,v.host.api.messages.send({attachment:(0,Ae.default)(o,"0.localFile"),body:r,conversationId:a,counterPartyId:i,deleteOnRead:s,escalate:p,localId:u,metadata:c,priority:qe.MessagePriority.toServer(l),recipientOrganizationId:f,senderOrganizationId:d,ttl:h});case 4:return y=e.sent,v.host.config.condensedReplays&&y.last_message&&(y=y.last_message),e.next=8,v.__retrieveSentMessage(y,{instance:t});case 8:t=e.sent,v.host.emit("message:sent",t),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),v.logger.warn("error while sending message",e.t0),t.senderStatus=qe.MessageSenderStatus.FAILED,v.host.models.Message.inject(t);case 17:return e.abrupt("return",t);case 18:case"end":return e.stop()}},e,g,[[1,12]])})),function(e){return s.apply(this,arguments)}),v.__retryApiForward=(i=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=t).conversationId,o=n.counterPartyId,a=n.id,i=n.metadata,s=n.originalMessageId,u=n.priority,c=n.recipientOrganizationId,l=n.senderOrganizationId,e.prev=1,e.next=4,v.host.api.messages.forward(s,o,{conversationId:r,localId:a,metadata:i,priority:qe.MessagePriority.toServer(u),recipientOrganizationId:c,senderOrganizationId:l});case 4:return f=e.sent,d=f.message_id,e.next=8,v.find(d,{instance:t,replace:!0});case 8:t=e.sent,v.host.emit("message:sent",t),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),v.logger.error("error while forwarding message",e.t0),t.senderStatus=qe.MessageSenderStatus.FAILED,v.host.models.Message.inject(t);case 17:return e.abrupt("return",t);case 18:case"end":return e.stop()}},e,g,[[1,12]])})),function(e){return i.apply(this,arguments)}),v._resolveMessage=function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Me(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+Se(e));return v.host.models.Message.is(e)?e:"string"==typeof e?v.host.models.Message.get(e):null},v._looksLikeDistributionListMessage=function(e){var t=e.body;if(!t)return!1;var n=t.match(/^\[(.+?)\]: /);return!!n&&n[1]},v.__setDefaultAttributes=function(e,t){var n=t.instance,r={is_forwarded:n.isForwarded,attachments:n.attachments,conversationId:n.conversationId,counterParty:n.counterParty,senderStatus:qe.MessageSenderStatus.SENT,shouldEscalate:!1};return n.isForwarded&&(r.originalForwardedMessageCreatedAt=n.originalForwardedMessageCreatedAt,r.originalMessageId=n.originalMessageId,n.originalSender&&(r.originalSender=n.originalSender)),(0,Te.default)(e,r),e},v.__flushSetMessageStatusesQueue=function(){if(0<v._queuedSetMessageStatuses.deliveredIds.length+v._queuedSetMessageStatuses.readIds.length){var e=v._queuedSetMessageStatuses;v._queuedSetMessageStatuses={deliveredIds:[],readIds:[]},v.__setMessagesStatus(e)}},v._onTick=function(){v._deleteExpiredMessages(),v._deleteExpiredMutes(),v.config.condensedReplays&&v._clearOptimisticMarkAsReadState()},v._deleteExpiredMessages=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Date.now();if(e.getTime&&(e=e.getTime()),!(i=v.host.organizations.getAll())||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected _host$organizations$g2 to be iterable, got "+Se(i));if(!i||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected _host$organizations$g2 to be iterable, got "+Me(i));var t=!0,n=!1,r=void 0;try{for(var o,a=(0,Pe.default)(i);!(t=(o=a.next()).done);t=!0)for(var i,s=o.value.__expirableMessages,u=!1;!u&&0<s.length;){var c=s[0];c.expiresAt<e?v.host.models.Message.eject(c):u=!0}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}},v._deleteExpiredMutes=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Date.now();if(e.getTime&&(e=e.getTime()),!(i=v.host.organizations.getAll())||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected _host$organizations$g3 to be iterable, got "+Se(i));if(!i||"function"!=typeof i[ze.default]&&!Array.isArray(i))throw new TypeError("Expected _host$organizations$g3 to be iterable, got "+Me(i));var t=!0,n=!1,r=void 0;try{for(var o,a=(0,Pe.default)(i);!(t=(o=a.next()).done);t=!0)for(var i,s=o.value.__expirableMutes,u=!1;!u&&0<s.length;){var c=s[0];if(c.expiresAt<e){v.host.models.Mute.eject(c);var l=v.host.models.Conversation.get(c.conversationId);if(!l)continue;l.muted=null,v.host.models.Conversation.inject(l)}else u=!0}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}},v._onChangeMessageStatus=function(e,t){var n=t.messageId,r=v.host.models.Message.get(n);r&&v.host.models.Message.inject(r)},v._fetchAttachmentTokens=function(){var t,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:20;if(void 0!==a&&"number"!=typeof a)throw new TypeError('Value of optional argument "count" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Me(a));if(void 0!==a&&"number"!=typeof a)throw new TypeError('Value of optional argument "count" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Se(a));return v._fetchingAttachmentTokens||(v._fetchingAttachmentTokens=new he.default((t=(0,ye.default)(Ve.default.mark(function e(t){var n,r,o;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.host.api.messages.createAttachmentTokens(a);case 3:r=e.sent,o=r.attachment_tokens,(n=v._attachmentTokens).push.apply(n,(0,pe.default)(o)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),v.logger.error("error while requesting attachment tokens",e.t0);case 11:v._fetchingAttachmentTokens=null,t();case 13:case"end":return e.stop()}},e,g,[[0,8]])})),function(e){return t.apply(this,arguments)}))),v._fetchingAttachmentTokens},v._useAttachmentToken=(a=(0,ye.default)(Ve.default.mark(function e(){var t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:20,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n&&"number"!=typeof n)throw new TypeError('Value of optional argument "count" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Me(n));e.next=2;break;case 2:if(void 0!==r&&"number"!=typeof r)throw new TypeError('Value of optional argument "retries" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Me(r));e.next=4;break;case 4:if(void 0!==n&&"number"!=typeof n)throw new TypeError('Value of optional argument "count" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Se(n));e.next=6;break;case 6:if(void 0!==r&&"number"!=typeof r)throw new TypeError('Value of optional argument "retries" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+Se(r));e.next=8;break;case 8:if(3<r)throw new Error("Attachment tokens can not be fetched at this time.");e.next=10;break;case 10:if(v._attachmentTokens.length<n)return e.next=13,v._fetchAttachmentTokens(n);e.next=13;break;case 13:if(t=v._attachmentTokens.shift()){e.next=18;break}return e.next=17,v._useAttachmentToken(n,++r);case 17:return e.abrupt("return",e.sent);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,g)})),function(){return a.apply(this,arguments)}),v.getAttachmentUrlWithToken=(o=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("boolean"!=typeof i)throw new TypeError('Value of argument "includeBaseUrl" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+Me(i));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(n));e.next=10;break;case 10:if("boolean"!=typeof i)throw new TypeError('Value of argument "includeBaseUrl" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+Se(i));e.next=12;break;case 12:return r=v._resolveMessage(t),e.next=15,v.findAttachment(r.serverId,n);case 15:return o=e.sent,e.next=18,v._useAttachmentToken();case 18:return a=e.sent,e.abrupt("return",""+(i?v.host.config.baseUrl:"")+v.__getAttachmentPath(r.serverId,o.id)+"?token="+a);case 20:case"end":return e.stop()}},e,g)})),function(e,t){return o.apply(this,arguments)}),v.openAttachmentWithToken=(r=(0,ye.default)(Ve.default.mark(function e(t,n){var r,o,a;return Ve.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Me(t));e.next=2;break;case 2:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Me(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "messageId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+Se(t));e.next=6;break;case 6:if("string"!=typeof n&&"number"!=typeof n)throw new TypeError('Value of argument "attachmentId" violates contract.\n\nExpected:\nstring | number\n\nGot:\n'+Se(n));e.next=8;break;case 8:return r=n.toString(),o=v._resolveMessage(t),e.next=12,v.findAttachment(t,r);case 12:if(e.sent){e.next=15;break}throw new $e.NotFoundError("MessageAttachment",o.serverId+":"+r);case 15:return e.next=17,v.getAttachmentUrlWithToken(o.serverId,r);case 17:a=e.sent,window.open(v.host.config.baseUrl+a,"_blank");case 19:case"end":return e.stop()}},e,g)})),function(e,t){return r.apply(this,arguments)}),n=t,(0,be.default)(v,n)}t.default=Je,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function x(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,y.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=x(t[0],n);return t.every(function(e){return x(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return x(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+x(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function E(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,y.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=E(t[0],n);return t.every(function(e){return E(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return E(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,_.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+E(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h=r(n(4)),y=r(n(3)),v=r(n(11)),g=r(n(47)),m=r(n(38)),k=r(n(10)),T=r(n(20)),A=r(n(13)),b=r(n(19)),I=r(n(12)),O=r(n(24)),_=r(n(5)),w=r(n(9)),j=r(n(16)),S=r(n(6)),M=r(n(1)),R=r(n(2)),C=r(n(8)),P=r(n(7)),z=r(n(865)),V=r(n(234)),G=r(n(239)),N=r(n(35)),D=r(n(15)),U=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),F=n(21),L=n(29),B=(a=(0,F.decorator)(),i=(0,F.decorator)(),u=D.default,(0,P.default)($,u),(0,R.default)($,[{key:"fullUpdate",value:(p=(0,w.default)(k.default.mark(function e(t,n,r){var o,a,i,s,u,c,l,f;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+E(t));case 2:if(n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "entireData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+E(n));case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(r));e.next=6;break;case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+x(t));case 8:if(n instanceof Object){e.next=10;break}throw new TypeError('Value of argument "entireData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+x(n));case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(r));e.next=12;break;case 12:if(r){e.next=14;break}throw new U.ValidationError("organizationId","required");case 14:if(0<this.host.config.maxMetadataKeyCount&&(0,_.default)(n).length>this.host.config.maxMetadataKeyCount)throw new U.ValidationError("entireData","invalid","Total number of metadata keys is "+(0,_.default)(n)+" and should not exceed "+this.host.config.maxMetadataKeyCount);e.next=16;break;case 16:if(!(c=(0,O.default)(n))||"function"!=typeof c[I.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+x(c));e.next=19;break;case 19:if(!c||"function"!=typeof c[I.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+E(c));e.next=21;break;case 21:a=!(o=!0),i=void 0,e.prev=24,s=(0,A.default)(c);case 26:if(o=(u=s.next()).done){e.next=33;break}if(l=(0,T.default)(u.value,2),f=l[0],"string"!=typeof l[1])throw new U.ValidationError("value","invalid","Value for metadata key "+f+" must be a string");e.next=30;break;case 30:o=!0,e.next=26;break;case 33:e.next=39;break;case 35:e.prev=35,e.t0=e.catch(24),a=!0,i=e.t0;case 39:e.prev=39,e.prev=40,!o&&s.return&&s.return();case 42:if(e.prev=42,a)throw i;e.next=45;break;case 45:return e.finish(42);case 46:return e.finish(39);case 47:return this.host.requireUser(),t=this._resolveModelId(t),e.prev=49,e.next=52,this.host.api.metadata.update(t,n,r);case 52:return this.__injectMetadata(t,r,n),e.abrupt("return",n);case 56:if(e.prev=56,e.t1=e.catch(49),e.t1.response&&404===e.t1.response.status)throw new U.NotFoundError("metadata",t);e.next=62;break;case 62:return e.abrupt("return",b.default.reject(e.t1));case 63:case"end":return e.stop()}},e,this,[[24,35,39,47],[40,,42,46],[49,56]])})),function(e,t,n){return p.apply(this,arguments)})},{key:"update",value:(d=(0,w.default)(k.default.mark(function e(t,n,r){var o,a;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+E(t));case 2:if(n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "partialData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+E(n));case 4:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(r));e.next=6;break;case 6:if("string"==typeof t||t instanceof Object){e.next=8;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+x(t));case 8:if(n instanceof Object){e.next=10;break}throw new TypeError('Value of argument "partialData" violates contract.\n\nExpected:\nObject\n\nGot:\n'+x(n));case 10:if("string"!=typeof r)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(r));e.next=12;break;case 12:if(r){e.next=14;break}throw new U.ValidationError("organizationId","required");case 14:return e.next=16,this.find(t,r,{bypassCache:!0});case 16:return o=e.sent,a=(0,m.default)({},o,n),e.abrupt("return",this.fullUpdate(t,a,r));case 19:case"end":return e.stop()}},e,this)})),function(e,t,n){return d.apply(this,arguments)})},{key:"find",value:(f=(0,w.default)(k.default.mark(function e(t,n){var r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+E(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+x(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=8;break;case 8:if(n){e.next=10;break}throw new U.ValidationError("organizationId","required");case 10:if(o=(0,N.default)(o,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),t=this._resolveModelId(t),r=void 0,o.bypassCache){e.next=18;break}if(r=this.get(t,n))return e.abrupt("return",r);e.next=18;break;case 18:return e.prev=18,e.next=21,this.host.api.metadata.find(t,n);case 21:return r=e.sent,this.__injectMetadata(t,n,r),e.abrupt("return",r);case 26:if(e.prev=26,e.t0=e.catch(18),!e.t0.response||404!==e.t0.response.status){e.next=33;break}if(o.ignoreNotFound){e.next=31;break}throw new U.NotFoundError("metadata",t);case 31:e.next=34;break;case 33:return e.abrupt("return",b.default.reject(e.t0));case 34:case"end":return e.stop()}},e,this,[[18,26]])})),function(e,t){return f.apply(this,arguments)})},{key:"findMulti",value:(l=(0,w.default)(k.default.mark(function e(t,n){var r,o,a,i,s=this,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+E(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+x(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=8;break;case 8:if(n){e.next=10;break}throw new U.ValidationError("organizationId","required");case 10:return this.host.requireUser(),t=(0,G.default)((0,L.arrayWrap)(t).map(this._resolveModelId)),r=(0,V.default)(t,20),o=r.map(function(e){return s.__findMultiPaged(e,n,u)}),e.next=16,b.default.all(o);case 16:return a=e.sent,i=z.default.apply(void 0,[{}].concat((0,g.default)(a))),e.abrupt("return",i);case 19:case"end":return e.stop()}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"__findMultiPaged",value:(c=(0,w.default)(k.default.mark(function e(t,n){var r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w;return k.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+E(t));case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(n));e.next=4;break;case 4:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e})){e.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nstring[]\n\nGot:\n'+x(t));case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(n));e.next=8;break;case 8:return e.next=10,this.host.api.entities.findMulti({users:[],metadata:t,organizationId:n});case 10:if(r=e.sent,o=r.metadata,a={},!o||"function"!=typeof o[I.default]&&!Array.isArray(o))throw new TypeError("Expected allMetadata to be iterable, got "+x(o));e.next=15;break;case 15:if(!o||"function"!=typeof o[I.default]&&!Array.isArray(o))throw new TypeError("Expected allMetadata to be iterable, got "+E(o));e.next=17;break;case 17:s=!(i=!0),u=void 0,e.prev=20,c=(0,A.default)(o);case 22:if(i=(l=c.next()).done){e.next=60;break}if(f=l.value,!(g=(0,O.default)(f))||"function"!=typeof g[I.default]&&!Array.isArray(g))throw new TypeError("Expected _Object$entries2 to be iterable, got "+x(g));e.next=27;break;case 27:if(!g||"function"!=typeof g[I.default]&&!Array.isArray(g))throw new TypeError("Expected _Object$entries2 to be iterable, got "+E(g));e.next=29;break;case 29:p=!(d=!0),h=void 0,e.prev=32,y=(0,A.default)(g);case 34:if(d=(v=y.next()).done){e.next=43;break}if(m=(0,T.default)(v.value,2),b=m[0],_=m[1]){e.next=38;break}return e.abrupt("continue",40);case 38:w=this.__injectMetadata(b,n,_),a[b]=w;case 40:d=!0,e.next=34;break;case 43:e.next=49;break;case 45:e.prev=45,e.t0=e.catch(32),p=!0,h=e.t0;case 49:e.prev=49,e.prev=50,!d&&y.return&&y.return();case 52:if(e.prev=52,p)throw h;e.next=55;break;case 55:return e.finish(52);case 56:return e.finish(49);case 57:i=!0,e.next=22;break;case 60:e.next=66;break;case 62:e.prev=62,e.t1=e.catch(20),s=!0,u=e.t1;case 66:e.prev=66,e.prev=67,!i&&c.return&&c.return();case 69:if(e.prev=69,s)throw u;e.next=72;break;case 72:return e.finish(69);case 73:return e.finish(66);case 74:return e.abrupt("return",a);case 75:case"end":return e.stop()}},e,this,[[20,62,66,74],[32,45,49,57],[50,,52,56],[67,,69,73]])})),function(e,t){return c.apply(this,arguments)})},{key:"get",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));var n="metadata:"+e+":"+t;return this.host.models.Metadata.get(n)||null}},{key:"__injectMetadata",value:function(e,t,n){if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+E(t));if(!(n instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+E(n));if("string"!=typeof e)throw new TypeError('Value of argument "entityId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(e));if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+x(t));if(!(n instanceof Object))throw new TypeError('Value of argument "data" violates contract.\n\nExpected:\nObject\n\nGot:\n'+x(n));var r="metadata:"+e+":"+t;return this.host.models.Metadata.inject({id:r,data:n,entityId:e,organizationId:t})}}]),o((s=$).prototype,"find",[a],(0,v.default)(s.prototype,"find"),s.prototype),o(s.prototype,"findMulti",[i],(0,v.default)(s.prototype,"findMulti"),s.prototype),s);function $(){var e,t,n,r;(0,M.default)(this,$);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=n=(0,C.default)(this,(e=$.__proto__||(0,S.default)($)).call.apply(e,[this].concat(a))),n.__parseMessageMetadata=function(e){var t=e.mimetype,n=e.payload,r=t.indexOf(";");if(-1<r&&(t=t.slice(0,r)),"application/json"!==t||"string"!=typeof n)return e;var o=void 0;try{o=JSON.parse(n)}catch(t){return console.warn("Invalid metadata payload",e),null}return(0,j.default)({},e,{payload:o})},r=t,(0,C.default)(n,r)}t.default=B,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function h(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,_.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=h(t[0],n);return t.every(function(e){return h(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return h(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,R.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+h(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function y(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,_.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=y(t[0],n);return t.every(function(e){return y(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return y(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,R.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,b.default)(e))+": "+y(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,d,p,v,g,m,b=r(n(4)),_=r(n(3)),w=r(n(11)),x=r(n(10)),E=r(n(93)),k=r(n(13)),T=r(n(12)),A=r(n(9)),I=r(n(6)),O=r(n(1)),j=r(n(2)),S=r(n(8)),M=r(n(7)),R=r(n(5)),C=r(n(540)),P=n(21),z=n(29),V=r(n(15)),G={account:"user",group:"group"},N=new C.default((0,R.default)(G)),D=(o=(0,P.decorator)(),d=V.default,(0,M.default)(U,d),(0,j.default)(U,[{key:"mounted",value:function(){this._fetched=!1,this._muteEntriesByConversationHandle={}}},{key:"dispose",value:function(){this._fetched=!1,this._muteEntriesByConversationHandle=null}},{key:"findAll",value:(m=(0,A.default)(x.default.mark(function e(){var t,n,r,o,a,i,s,u,c,l;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._fetched){e.next=37;break}return e.next=3,this.host.api.mute.findAll();case 3:if(!(t=e.sent)||"function"!=typeof t[T.default]&&!Array.isArray(t))throw new TypeError("Expected muteEntries to be iterable, got "+h(t));e.next=6;break;case 6:if(!t||"function"!=typeof t[T.default]&&!Array.isArray(t))throw new TypeError("Expected muteEntries to be iterable, got "+y(t));e.next=8;break;case 8:r=!(n=!0),o=void 0,e.prev=11,a=(0,k.default)(t);case 13:if(n=(i=a.next()).done){e.next=22;break}if(s=i.value,N.has(s.sender_type)){e.next=17;break}return e.abrupt("continue",19);case 17:u=this._parseMuteEntry(s),c=u.conversationId,l=u.entry,this._addEntry(c,l);case 19:n=!0,e.next=13;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(11),r=!0,o=e.t0;case 28:e.prev=28,e.prev=29,!n&&a.return&&a.return();case 31:if(e.prev=31,r)throw o;e.next=34;break;case 34:return e.finish(31);case 35:return e.finish(28);case 36:this._fetched=!0;case 37:return e.abrupt("return",(0,E.default)(this._muteEntriesByConversationHandle));case 38:case"end":return e.stop()}},e,this,[[11,24,28,36],[29,,31,35]])})),function(){return m.apply(this,arguments)})},{key:"_removeAllEntries",value:function(){if(this.config.condensedReplays){if(!(a=this.host.conversations.getAll())||"function"!=typeof a[T.default]&&!Array.isArray(a))throw new TypeError("Expected _host$conversations$g to be iterable, got "+h(a));if(!a||"function"!=typeof a[T.default]&&!Array.isArray(a))throw new TypeError("Expected _host$conversations$g to be iterable, got "+y(a));var e=!0,t=!1,n=void 0;try{for(var r,o=(0,k.default)(a);!(e=(r=o.next()).done);e=!0){var a,i=r.value;i.muted&&this._removeEntry(i.id)}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}else{if(!(d=(0,R.default)(this._muteEntriesByConversationHandle))||"function"!=typeof d[T.default]&&!Array.isArray(d))throw new TypeError("Expected _Object$keys to be iterable, got "+h(d));if(!d||"function"!=typeof d[T.default]&&!Array.isArray(d))throw new TypeError("Expected _Object$keys to be iterable, got "+y(d));var s=!0,u=!1,c=void 0;try{for(var l,f=(0,k.default)(d);!(s=(l=f.next()).done);s=!0){var d,p=l.value;this._removeEntry(p)}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}}},{key:"_getByConversationHandle",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "conversationHandle" violates contract.\n\nExpected:\nstring\n\nGot:\n'+y(e));if("string"!=typeof e)throw new TypeError('Value of argument "conversationHandle" violates contract.\n\nExpected:\nstring\n\nGot:\n'+h(e));var t=this._muteEntriesByConversationHandle[e];return t?t.expiresAt<Date.now()?(delete this._muteEntriesByConversationHandle[e],null):t:null}},{key:"unmuteAll",value:(g=(0,A.default)(x.default.mark(function e(){return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.mute.unmuteAll();case 2:this._removeAllEntries();case 3:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)})},{key:"muteConversation",value:(v=(0,A.default)(x.default.mark(function e(t,n){var r,o,a,i;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+y(t));case 2:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+y(n));e.next=4;break;case 4:if("string"==typeof t||t instanceof Object){e.next=6;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+h(t));case 6:if("number"!=typeof n)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+h(n));e.next=8;break;case 8:if(this.__validateDurationInMinutes(n),t=this._resolveModelId(t),r=this._resolveEntity(t,"conversation")){e.next=13;break}throw new Error("conversation "+t+" not found");case 13:if(t=r.id,o=r.counterPartyId,a=r.counterPartyType,i=r.organizationId,"user"===a)return e.next=18,this.host.api.mute.muteUser(o,n,i,{recipientOrganizationId:i});e.next=21;break;case 18:this._addEntry(t,{durationInMinutes:n,organizationId:i}),e.next=25;break;case 21:if("group"===a)return e.next=24,this.host.api.mute.muteGroup(o,n,i);e.next=25;break;case 24:this._addEntry(t,{durationInMinutes:n,organizationId:i});case 25:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"unmuteConversation",value:(p=(0,A.default)(x.default.mark(function e(t){var n,r,o,a;return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+y(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "conversationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+h(t));case 4:if(n=this._resolveEntity(t,"conversation")){e.next=7;break}throw new Error("conversation "+t+" not found");case 7:if(t=n.id,r=n.counterPartyId,o=n.counterPartyType,a=n.organizationId,"user"===o)return e.next=12,this.host.api.mute.unmuteUser(r,a,{recipientOrganizationId:a});e.next=15;break;case 12:this._removeEntry(t),e.next=19;break;case 15:if("group"===o)return e.next=18,this.host.api.mute.unmuteGroup(r,a);e.next=19;break;case 18:this._removeEntry(t);case 19:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"reactToMuteEvent",value:function(e){var t=e.data;if((t=(0,z.jsonCloneDeep)(t)).token===this.host.currentUser.id){var n=t.action;if("clear"===n)return void this._removeAllEntries();var r=this._parseMuteEntry(t),o=r.conversationId,a=r.entry;"add"===n?this._addEntry(o,a):this._removeEntry(o)}}},{key:"getById",value:function(e){return e.startsWith("mute:")||(e="mute:"+e),this.host.models.Mute.get(e)}},{key:"__validateDurationInMinutes",value:function(e){if("number"!=typeof e)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+y(e));if("number"!=typeof e)throw new TypeError('Value of argument "durationInMinutes" violates contract.\n\nExpected:\nnumber\n\nGot:\n'+h(e));(e<0||525600<e||e%1!=0)&&z.Validator.raise("durationInMinutes","invalid","should be a positive integer from 1 to 525600 (1 year)")}}]),i=(a=U).prototype,s="findAll",u=[o],c=(0,w.default)(a.prototype,"findAll"),l=a.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(i,s,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(i,s,f),f=null),a);function U(){var e,t,c,n;(0,O.default)(this,U);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=c=(0,S.default)(this,(e=U.__proto__||(0,I.default)(U)).call.apply(e,[this].concat(o))),c._parseMuteEntry=function(e){var t=+e.mute_duration,n=e.mute_start,r=e.caller_organization||e.organization_id;n=n&&1e3*+n;var o=void 0;if(c.config.condensedReplays)o=e.conversation_id;else{var a=G[e.sender_type],i=e.sender_token;o=c.host.conversations.getConversationKey(a,i,r)}return{conversationId:o,entry:{durationInMinutes:t,organizationId:r,startedAt:n}}},c._addEntry=function(e,t){var n=t.durationInMinutes,r=t.organizationId,o=t.startedAt,a=void 0===o?Date.now():o,i=+a+60*n*1e3;if(!(i<Date.now())){var s=c.host.models.Mute.inject({id:"mute:"+e,conversationId:e,durationInMinutes:n,expiresAt:i,organizationId:r,startedAt:a});if(c.config.condensedReplays){var u=c.host.conversations.getById(e);if(!u)return s;u.muted=s,c.host.models.Conversation.inject(u)}else c._muteEntriesByConversationHandle[e]=s,c.host.models.Conversation.touch(e);return s}},c._removeEntry=function(e){c.config.condensedReplays||delete c._muteEntriesByConversationHandle[e];var t=c.host.conversations.getById(e);t&&t.muted&&(c.host.models.Mute.eject(t.muted),t.muted=null,c.host.models.Conversation.inject(t))},n=t,(0,S.default)(c,n)}t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function _(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=_(t[0],n);return t.every(function(e){return _(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return _(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+_(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function w(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,u.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=w(t[0],n);return t.every(function(e){return w(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return w(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,s.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+w(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,i=r(n(4)),s=r(n(5)),u=r(n(3)),x=r(n(20)),E=r(n(13)),k=r(n(12)),T=r(n(24)),A=r(n(54)),I=r(n(6)),O=r(n(1)),a=r(n(2)),j=r(n(8)),c=r(n(7)),l=r(n(15)),f=(o=l.default,(0,c.default)(S,o),(0,a.default)(S,[{key:"emit",value:function(e){this.EVENTS[e.type]?this.EVENTS[e.type].call(this,e):this.logger.info("unhandled event: "+e.type,e.data)}}]),S);function S(e,t){var n;(0,O.default)(this,S);var r=(0,j.default)(this,(S.__proto__||(0,I.default)(S)).call(this,e,t));if(r.EVENTS=(n={},(0,A.default)(n,"message|group_message",function(e){this.host.notifications.reactToMessageEvent(e)}),(0,A.default)(n,"message:status|group:message:status",function(e){this.host.notifications.reactToMessageStatusEvent(e)}),(0,A.default)(n,"remote_wipe",function(e){this.host.notifications.disconnect({source:"Notifications remote_wipe"}),this.host.notifications.signOut({fromServer:!0})}),(0,A.default)(n,"sse:heartbeat",function(){return null}),n),!(c=(0,T.default)(r.EVENTS))||"function"!=typeof c[k.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+_(c));if(!c||"function"!=typeof c[k.default]&&!Array.isArray(c))throw new TypeError("Expected _Object$entries to be iterable, got "+w(c));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,E.default)(c);!(o=(s=u.next()).done);o=!0){var c,l=(0,x.default)(s.value,2),f=l[0],d=l[1];if(f.includes("|")){if(!(m=f.split("|"))||"function"!=typeof m[k.default]&&!Array.isArray(m))throw new TypeError("Expected _eventName$split to be iterable, got "+_(m));if(!m||"function"!=typeof m[k.default]&&!Array.isArray(m))throw new TypeError("Expected _eventName$split to be iterable, got "+w(m));var p=!0,h=!1,y=void 0;try{for(var v,g=(0,E.default)(m);!(p=(v=g.next()).done);p=!0){var m,b=v.value;r.EVENTS[b]=d}}catch(e){h=!0,y=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw y}}delete r.EVENTS[f]}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}return r}t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o,a,i,s,u,c,l,f,d,p,h,y,v,g,m=r(n(11)),b=r(n(19)),_=r(n(10)),w=r(n(9)),x=r(n(16)),E=r(n(6)),k=r(n(1)),T=r(n(2)),A=r(n(8)),I=r(n(7)),O=n(21),j=r(n(255)),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),M=r(n(274)),R=r(n(15)),C=r(n(271)),P=(o=(0,O.decorator)({serializeArguments:function(e){return""}}),h=R.default,(0,I.default)(z,h),(0,T.default)(z,[{key:"mounted",value:function(){this.events.mounted(),this.events.on("connected",this._emitConnected),this.events.on("disconnected",this._emitDisconnected),this.events.on("event",this._emitEvent)}},{key:"dispose",value:function(){this.events.removeListener("connected",this._emitConnected),this.events.removeListener("disconnected",this._emitDisconnected),this.events.removeListener("event",this._emitEvent),this.events.dispose()}},{key:"signIn",value:(g=(0,w.default)(_.default.mark(function e(){var t,n,r;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.host.getAuth())&&t.key&&t.secret){e.next=3;break}throw new S.RequiresBasicAuthError;case 3:if(this.emit("signingIn"),this.events.isSignedIn){e.next=9;break}return e.next=7,this.host.api.notifications.signIn(t.key,t.secret);case 7:n=e.sent,this.events.setAuth(n);case 9:return r=this.events.getAuth(),this.emit("signedIn",r),e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)})},{key:"signOut",value:(v=(0,w.default)(_.default.mark(function e(){var t,n,r=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).fromServer,o=void 0!==r&&r;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.events.getAuth()){e.next=3;break}return e.abrupt("return",!1);case 3:return this.emit("signingOut",{fromServer:o}),n=void 0,e.prev=5,e.next=8,this.host.api.notifications.signOut(t.key,t.secret);case 8:n=!0,e.next=22;break;case 11:if(e.prev=11,e.t0=e.catch(5),!this.httpClient.isUnauthorizedError(e.t0)){e.next=17;break}n=!0,e.next=22;break;case 17:if(!o){e.next=21;break}this.logger.error("error while logging out of desktop notifications",e.t0,e.t0.stack),e.next=22;break;case 21:return e.abrupt("return",b.default.reject(e.t0));case 22:return n&&this.events.removeAuth(),this.emit("signedOut",{fromServer:o,signedOut:n}),e.abrupt("return",n);case 25:case"end":return e.stop()}},e,this,[[5,11]])})),function(){return v.apply(this,arguments)})},{key:"authenticate",value:(y=(0,w.default)(_.default.mark(function e(t,n){return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.events.setAuth({key:t,secret:n});case 1:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})},{key:"connect",value:function(){return this.events.connect()}},{key:"disconnect",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).source;return this.events.disconnect({source:e})}},{key:"reconnect",value:function(){return this.events.reconnect()}},{key:"reactToMessageEvent",value:function(e){var t=e.data;t=(0,M.default)(t);var n=this.host.models.Message.createInstance((0,x.default)({},t,{id:j.default.v4()}));this.emit("unread:change",n.unreadMessageCount),this.emit("message",n)}},{key:"reactToMessageStatusEvent",value:function(e){this.emit("unread:change",e.unread_message_count)}},{key:"isSignedIn",get:function(){return this.events.isSignedIn}},{key:"hasConnection",get:function(){return this.events.hasConnection}},{key:"isConnected",get:function(){return this.events.isConnected}},{key:"isOpen",get:function(){return this.events.isOpen}}]),i=z,s=function(){var t=this;this._emitConnected=function(){t.emit("connected")},this._emitDisconnected=function(e){t.emit("disconnected",e)},this._emitEvent=function(e){t.emit("event",e)}},u=(a=i).prototype,c="signOut",l=[o],f=(0,m.default)(a.prototype,"signOut"),d=a.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(u,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(u,c,p),p=null),a);function z(e,t){(0,k.default)(this,z);var n=(0,A.default)(this,(z.__proto__||(0,E.default)(z)).call(this,e,t));return s.call(n),n.events=new C.default(e,(0,x.default)({},t,{endpointType:"simpleNotifications"})),n}t.default=P,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function b(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,E.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=b(t[0],n);return t.every(function(e){return b(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return b(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,x.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,w.default)(e))+": "+b(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function _(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,E.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=_(t[0],n);return t.every(function(e){return _(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return _(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,x.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,w.default)(e))+": "+_(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m,w=r(n(4)),x=r(n(5)),E=r(n(3)),k=r(n(11)),T=r(n(20)),A=r(n(24)),I=r(n(16)),O=r(n(10)),j=r(n(9)),S=r(n(13)),M=r(n(47)),R=r(n(12)),C=r(n(6)),P=r(n(1)),z=r(n(2)),V=r(n(8)),G=r(n(7)),N=r(n(35)),D=r(n(894)),U=r(n(872)),F=r(n(15)),L=n(21),B=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),$=r(n(395)),q=r(n(45)),H=(a=(0,L.decorator)(),i=(0,L.decorator)(),s=(0,L.decorator)({memoize:!0}),u=(0,L.decorator)(),l=F.default,(0,G.default)(Y,l),(0,z.default)(Y,[{key:"mounted",value:function(){this._deferConversationChanges=!1,this._lastMyRoles=[],this.host.models.Conversation.on("afterInject",this._onChangeConversation),this.host.models.Conversation.on("afterEject",this._onChangeConversation),this.host.models.User.on("afterInject",this._onChangeUser)}},{key:"dispose",value:function(){this._deferConversationChanges=!1,this._lastMyRoles=[],this.host.models.Conversation.removeListener("afterInject",this._onChangeConversation),this.host.models.Conversation.removeListener("afterEject",this._onChangeConversation),this.host.models.User.removeListener("afterInject",this._onChangeUser),L.decorator.clear(this._findAll)}},{key:"create",value:(m=(0,j.default)(O.default.mark(function e(){var n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{allowPublicGroups:void 0,autologoutTime:void 0,deleteOnRead:void 0,groupLifespan:void 0,lifecycleCallback:void 0,name:void 0,pinLock:void 0,settingsRestricted:void 0,ttl:void 0,welcomeEmailSettings:void 0};return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.requireUser(),e.abrupt("return",this.httpClient.post("/v2/organization",{data:r}).then(function(e){var t=e.getHeader("TT-X-Organization-Key");return n.host.models.Organization.inject({id:t,name:r.name})}));case 2:case"end":return e.stop()}},e,this)})),function(){return m.apply(this,arguments)})},{key:"update",value:(g=(0,j.default)(O.default.mark(function e(){var t,n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{allowPublicGroups:void 0,autologoutTime:void 0,autoSendWelcomeEmail:void 0,deleteOnRead:void 0,groupLifespan:void 0,id:void 0,lifecycleCallback:void 0,name:void 0,pinLock:void 0,settingsRestricted:void 0,ttl:void 0,welcomeEmailLogo:void 0,welcomeEmailSettings:void 0};return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.requireUser(),t=q.default.underscoreObject({allowPublicGroups:r.allowPublicGroups,autologoutTime:r.autologoutTime,autoSendWelcomeEmail:r.autoSendWelcomeEmail,dor:r.deleteOnRead,groupLifespan:r.groupLifespan,lifecycleCallback:r.lifecycleCallback,name:r.name,pinLock:r.pinLock,settingsRestricted:r.settingsRestricted,ttl:r.ttl,welcomeEmailLogo:r.welcomeEmailLogo,welcomeEmailSettings:r.welcomeEmailSettings}),e.abrupt("return",this.httpClient.post("/v2/organization/:id",{urlParams:{id:r.id},data:t}).then(function(e){return n.host.models.Organization.inject((0,I.default)({id:r.id},t))}));case 3:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)})},{key:"findAll",value:(v=(0,j.default)(O.default.mark(function e(){var t,n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=r.filter,a=void 0===o?{onlyApproved:!1}:o,i=r.findRoles,s=void 0===i||i;return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.requireUser(),e.next=3,this._findAll();case 3:if(t=e.sent,s)return e.next=7,this.host.userRoles.findAll();e.next=7;break;case 7:return a.onlyApproved&&(t=(0,U.default)(t,{pending:!1})),(t=(0,D.default)(t,function(e){return e.name.toLowerCase()})).forEach(function(e){return n.__reloadConversations(e)}),e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)})),function(){return v.apply(this,arguments)})},{key:"refreshAll",value:(y=(0,j.default)(O.default.mark(function e(){var t;return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return L.decorator.clear(this._findAll),e.next=3,this._findAll();case 3:return t=e.sent,e.next=6,this.host.userRoles.refreshAll();case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)})),function(){return y.apply(this,arguments)})},{key:"_findAll",value:(h=(0,j.default)(O.default.mark(function e(){var t,n,r,o,a,i,s,u,c;return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.organizations.findAllOfUser(this.host.currentUserId);case 2:if(t=e.sent,n=[],!t||"function"!=typeof t[R.default]&&!Array.isArray(t))throw new TypeError("Expected items to be iterable, got "+b(t));e.next=6;break;case 6:if(!t||"function"!=typeof t[R.default]&&!Array.isArray(t))throw new TypeError("Expected items to be iterable, got "+_(t));e.next=8;break;case 8:for(o=!(r=!0),a=void 0,e.prev=11,i=(0,S.default)(t);!(r=(s=i.next()).done);r=!0)u=s.value,c=this.host.models.Organization.inject(u),this.host.models.Organization.removePlaceholder({entity:c,attrs:u}),n.push(c);e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),o=!0,a=e.t0;case 19:e.prev=19,e.prev=20,!r&&i.return&&i.return();case 22:if(e.prev=22,o)throw a;e.next=25;break;case 25:return e.finish(22);case 26:return e.finish(19);case 27:return e.abrupt("return",n);case 28:case"end":return e.stop()}},e,this,[[11,15,19,27],[20,,22,26]])})),function(){return h.apply(this,arguments)})},{key:"find",value:(p=(0,j.default)(O.default.mark(function e(t){var n,r,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e.next=4;break;case 4:if(o=(0,N.default)(o,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),n=void 0,o.bypassCache){e.next=11;break}if((n=this.host.models.Organization.get(t))&&!n.$placeholder)return e.abrupt("return",n);e.next=11;break;case 11:return e.next=13,this.host.api.organizations.find(this.host.currentUserId,t);case 13:return r=e.sent,e.next=16,this.host.userRoles.findAll({organizationId:t});case 16:if(!r){e.next=21;break}n=this.host.models.Organization.inject(r),this.__reloadConversations(n),e.next=23;break;case 21:if(o.ignoreNotFound){e.next=23;break}throw new B.NotFoundError(this.host.models.Organization.name,t);case 23:return e.abrupt("return",n);case 24:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"_getAllowedSenders",value:function(e){var t=e.id,n=[],r=this.host.currentUser;if(r){var o=r.roles;if(!o||"function"!=typeof o[R.default]&&!Array.isArray(o))throw new TypeError("Expected currentRoles to be iterable, got "+b(o));if(!o||"function"!=typeof o[R.default]&&!Array.isArray(o))throw new TypeError("Expected currentRoles to be iterable, got "+_(o));var a=!0,i=!1,s=void 0;try{for(var u,c=(0,S.default)(o);!(a=(u=c.next()).done);a=!0){var l=u.value;l.organizationId===t&&n.push(l)}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}n.push(r)}return n}},{key:"getPendingEulas",value:(d=(0,j.default)(O.default.mark(function e(){var t,n;return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._findAll();case 2:return t=e.sent,n=t.filter(function(e){return e.eulaEnabled&&!e.isEulaAccepted}).reduce(function(e,t){var n=t.id,r=t.eulaUrl;return e[r]?e[r].push(n):e[r]=[n],e},{}),e.abrupt("return",(0,A.default)(n).map(function(e){var t=(0,T.default)(e,2);return{url:t[0],organizationIds:t[1]}}));case 5:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)})},{key:"findEulaContent",value:(f=(0,j.default)(O.default.mark(function e(t){var n;return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=t.replace("http://","https://"),e.next=3,this.httpClient.get(t,{withCredentials:!1,withHeaders:!1,resFormat:"text"});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"getSettingValue",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(e));if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(t));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(e));if("string"!=typeof t)throw new TypeError('Value of argument "key" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(t));e=this._resolveModelId(e);var n=this.getById(e);return n?n.getSettingValue(t):null}},{key:"getAll",value:function(){return this.host.models.Organization.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+_(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+b(e));return this.host.models.Organization.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+_(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+b(e));return this.host.models.Organization.getMulti(e)}},{key:"__reloadConversations",value:function(e){if(e){var t=e.conversations,n=0,r=0,o=0,a=0,i=0;if(!t||"function"!=typeof t[R.default]&&!Array.isArray(t))throw new TypeError("Expected conversations to be iterable, got "+b(t));if(!t||"function"!=typeof t[R.default]&&!Array.isArray(t))throw new TypeError("Expected conversations to be iterable, got "+_(t));var s=!0,u=!1,c=void 0;try{for(var l,f=(0,S.default)(t);!(s=(l=f.next()).done);s=!0){var d=l.value,p=d.highestSortNumber,h=d.unreadCount,y=d.unreadPriorityCount,v=d.lastIncomingMessageSortNumber,g=d.shouldDisplay,m=d.metadata;g&&(n=Math.max(n,p),m&&"patient_messaging"===m.feature_service?(r+=h,a+=y):(o+=h,i+=y),!this.config.condensedReplays&&v&&(!e.lastIncomingMessageSortNumber||e.lastIncomingMessageSortNumber<v)&&(e.lastIncomingMessageSortNumber=v))}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}e.highestSortNumber=n,e.unreadCount=o+r,e.unreadPriorityCount=i+a,e.networks.provider.unreadCount=o,e.networks.provider.unreadPriorityCount=i,e.networks.patient.unreadCount=r,e.networks.patient.unreadPriorityCount=a,this.host.models.Organization.inject(e),e.emit("change")}}},{key:"reactToOrganizationPreferencesEvent",value:function(e){this.emit("preferences:change",q.default.camelizeObject(e))}}]),o((c=Y).prototype,"findAll",[a],(0,k.default)(c.prototype,"findAll"),c.prototype),o(c.prototype,"refreshAll",[i],(0,k.default)(c.prototype,"refreshAll"),c.prototype),o(c.prototype,"_findAll",[s],(0,k.default)(c.prototype,"_findAll"),c.prototype),o(c.prototype,"find",[u],(0,k.default)(c.prototype,"find"),c.prototype),c);function Y(){var e,t,g,n,r,o,a=this;(0,P.default)(this,Y);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return t=g=(0,V.default)(this,(e=Y.__proto__||(0,C.default)(Y)).call.apply(e,[this].concat(s))),g._onChangeConversation=function(e,t){var n=t.organization;n&&(g.host.currentlyServingOfflineMessages||g._deferConversationChanges||g.__reloadConversations(n))},g._onChangeUser=function(e,t){var n=t.id,r=g.host.models.Organization.getAll();if(!r||"function"!=typeof r[R.default]&&!Array.isArray(r))throw new TypeError("Expected allOrganizations to be iterable, got "+b(r));if(!r||"function"!=typeof r[R.default]&&!Array.isArray(r))throw new TypeError("Expected allOrganizations to be iterable, got "+_(r));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,S.default)(r);!(o=(s=u.next()).done);o=!0){var c=s.value;c.autoForwardReceiverId===n&&c.autoForwardReceiver!==t&&g.host.models.Organization.inject(c)}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}if(t===g.host.currentUser&&!g.host.currentlyServingOfflineMessages&&!g._deferConversationChanges){var l=g.host.currentUser.roles;if(!(0,$.default)(l,g._lastMyRoles)){if(g._lastMyRoles=[].concat((0,M.default)(l)),!r||"function"!=typeof r[R.default]&&!Array.isArray(r))throw new TypeError("Expected allOrganizations to be iterable, got "+b(r));if(!r||"function"!=typeof r[R.default]&&!Array.isArray(r))throw new TypeError("Expected allOrganizations to be iterable, got "+_(r));var f=!0,d=!1,p=void 0;try{for(var h,y=(0,S.default)(r);!(f=(h=y.next()).done);f=!0){var v=h.value;(0,$.default)(v.allowedSenders,g._getAllowedSenders(v))||g.host.models.Organization.inject(v)}}catch(e){d=!0,p=e}finally{try{!f&&y.return&&y.return()}finally{if(d)throw p}}}}},g.getPreferences=(o=(0,j.default)(O.default.mark(function e(t){return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new B.ValidationError("organizationId","required");case 2:return e.next=4,g.host.api.organizations.getPreferences(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,a)})),function(e){return o.apply(this,arguments)}),g.editPreferences=(r=(0,j.default)(O.default.mark(function e(t){var n=t.quickReplies,r=void 0===n?[]:n,o=t.organizationId;return O.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new B.ValidationError("quickReplies","required");case 2:if(o){e.next=4;break}throw new B.ValidationError("organizationId","required");case 4:return e.next=6,g.host.api.organizations.editPreferences({organizationId:o,quickReplies:r});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e,a)})),function(e){return r.apply(this,arguments)}),n=t,(0,V.default)(g,n)}t.default=H,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function f(e){if(2<e.length)throw new V.ValidationError("contacts count","larger than 2");for(var t=0;t<e.length;t++){var n=e[t],r=n.firstName,o=n.lastName,a=n.phoneNumber,i=n.relation;if(!r)throw new V.ValidationError("contact firstName","required");if(!o)throw new V.ValidationError("contact lastName","required");if(!a)throw new V.ValidationError("contact phoneNumber","required");if(!i)throw new V.ValidationError("contact relation","required")}if(2===e.length&&(0,w.default)(e[0],e[1]))throw new V.ValidationError("contacts being unique","required")}function d(e){if(null==e)throw new V.ValidationError("version","of type string or number");return"string"==typeof e?parseInt(e)+1:e+1}function p(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){var t=e.phoneNumber,n=(0,o.default)(e,["phoneNumber"]);return(0,h.default)({},n,{phoneNumber:(0,G.normalizePhone)(t)})})}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,l.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function u(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,l.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=u(t[0],n);return t.every(function(e){return u(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return u(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+u(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(4)),c=r(n(5)),l=r(n(3)),o=r(n(77)),h=r(n(16)),y=r(n(10)),a=r(n(9)),v=r(n(6)),g=r(n(1)),m=r(n(2)),b=r(n(8)),_=r(n(7)),w=r(n(882));t.checkContactsAreValid=f,t.updateEditVersion=d,t.validateContactPhoneNumbers=p;var x,E,k,T,A,I,O,j,S,M,R,C,P,z=r(n(15)),V=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),G=n(46),N=["patient","user"],D=(x=z.default,(0,_.default)(U,x),(0,m.default)(U,[{key:"create",value:(P=(0,a.default)(y.default.mark(function e(t){var n,r=t.contacts,o=t.dob,a=t.firstName,i=t.lastName,s=t.mrn,u=t.organizationId,c=t.phoneNumber,l=t.gender;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}throw new V.ValidationError("mrn","required");case 2:if(a){e.next=4;break}throw new V.ValidationError("firstName","required");case 4:if(i){e.next=6;break}throw new V.ValidationError("lastName","required");case 6:if(c){e.next=8;break}throw new V.ValidationError("phoneNumber","required");case 8:if((0,G.isPhone)(c)){e.next=10;break}throw new V.ValidationError("phoneNumber","not a valid format");case 10:if(o){e.next=12;break}throw new V.ValidationError("dob","required");case 12:if(/^(19|20)\d\d[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])$/.test(o)){e.next=14;break}throw new V.ValidationError("dob","not a valid format of YYYY-MM-DD");case 14:if(l){e.next=16;break}throw new V.ValidationError("gender","required");case 16:if(u){e.next=18;break}throw new V.ValidationError("organizationId","required");case 18:return r&&r.length&&f(r),e.next=21,this.host.api.patients.create({contacts:p(r),dob:o,firstName:a,gender:l,lastName:i,mrn:s,organizationId:u,phoneNumber:(0,G.normalizePhone)(c)});case 21:return n=e.sent,e.abrupt("return",this.host.models.User.inject(n.entity));case 23:case"end":return e.stop()}},e,this)})),function(e){return P.apply(this,arguments)})},{key:"update",value:(C=(0,a.default)(y.default.mark(function e(t){var n,r=t.currentEditVersion,o=t.dob,a=t.firstName,i=t.patientId,s=t.lastName,u=t.organizationId,c=t.phoneNumber,l=t.gender;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new V.ValidationError("currentEditVersion","required");case 2:if(u){e.next=4;break}throw new V.ValidationError("organizationId","required");case 4:if(i){e.next=6;break}throw new V.ValidationError("patientId","required");case 6:return e.next=8,this.host.api.patients.update({dob:o,editVersion:d(r),firstName:a,gender:l,patientId:i,lastName:s,organizationId:u,phoneNumber:(0,G.normalizePhone)(c)});case 8:return n=e.sent,e.abrupt("return",this.host.models.User.inject(n.entity));case 10:case"end":return e.stop()}},e,this)})),function(e){return C.apply(this,arguments)})},{key:"delete",value:(R=(0,a.default)(y.default.mark(function e(t,n){var r;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(n));e.next=8;break;case 8:if(n){e.next=10;break}throw new V.ValidationError("organizationId","required");case 10:return(r=this.host.models.Patient.get(t))&&this.host.models.Patient.eject(r),e.next=14,this.host.api.patients.delete(t,n);case 14:case"end":return e.stop()}},e,this)})),function(e,t){return R.apply(this,arguments)})},{key:"createContact",value:(M=(0,a.default)(y.default.mark(function e(t){var n,r=t.firstName,o=t.lastName,a=t.organizationId,i=t.patientId,s=t.phoneNumber,u=t.relation;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}throw new V.ValidationError("patientId","required");case 2:if(r){e.next=4;break}throw new V.ValidationError("firstName","required");case 4:if(o){e.next=6;break}throw new V.ValidationError("lastName","required");case 6:if(s){e.next=8;break}throw new V.ValidationError("phoneNumber","required");case 8:if((0,G.isPhone)(s)){e.next=10;break}throw new V.ValidationError("phoneNumber","not a valid format");case 10:if(u){e.next=12;break}throw new V.ValidationError("relation","required");case 12:if(a){e.next=14;break}throw new V.ValidationError("organizationId","required");case 14:return e.next=16,this.host.api.patients.createContact({firstName:r,lastName:o,organizationId:a,patientId:i,phoneNumber:(0,G.normalizePhone)(s),relation:u});case 16:return n=e.sent,e.abrupt("return",this.host.models.User.inject(n.entity));case 18:case"end":return e.stop()}},e,this)})),function(e){return M.apply(this,arguments)})},{key:"updateContact",value:(S=(0,a.default)(y.default.mark(function e(t){var n,r=t.contactId,o=t.currentEditVersion,a=t.firstName,i=t.lastName,s=t.organizationId,u=t.patientId,c=t.phoneNumber,l=t.relation;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}throw new V.ValidationError("currentEditVersion","required");case 2:if(s){e.next=4;break}throw new V.ValidationError("organizationId","required");case 4:if(u){e.next=6;break}throw new V.ValidationError("patientId","required");case 6:if(r){e.next=8;break}throw new V.ValidationError("contactId","required");case 8:if(a){e.next=10;break}throw new V.ValidationError("firstName","required");case 10:if(i){e.next=12;break}throw new V.ValidationError("lastName","required");case 12:if(c){e.next=14;break}throw new V.ValidationError("phoneNumber","required");case 14:if((0,G.isPhone)(c)){e.next=16;break}throw new V.ValidationError("phoneNumber","not a valid format");case 16:if(l){e.next=18;break}throw new V.ValidationError("relation","required");case 18:return e.next=20,this.host.api.patients.updateContact({contactId:r,editVersion:d(o),firstName:a,lastName:i,organizationId:s,patientId:u,phoneNumber:(0,G.normalizePhone)(c),relation:l});case 20:return n=e.sent,e.abrupt("return",this.host.models.User.inject(n.entity));case 22:case"end":return e.stop()}},e,this)})),function(e){return S.apply(this,arguments)})},{key:"deleteContact",value:(j=(0,a.default)(y.default.mark(function e(t){var n,r=t.contactId,o=t.organizationId,a=t.patientId;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new V.ValidationError("contactId","required");case 2:if(o){e.next=4;break}throw new V.ValidationError("organizationId","required");case 4:if(a){e.next=6;break}throw new V.ValidationError("patientId","required");case 6:return e.next=8,this.host.api.patients.deleteContact({contactId:r,patientId:a,organizationId:o});case 8:(n=this.host.models.PatientContact.get("patientContact:"+r))&&this.host.models.PatientContact.eject(n);case 10:case"end":return e.stop()}},e,this)})),function(e){return j.apply(this,arguments)})},{key:"login",value:(O=(0,a.default)(y.default.mark(function e(t){var n,r,o,a,i,s,u=t.accessToken,c=t.dateOfBirth,l=t.linkToken,f=t.sessions;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.emit("signingIn"),e.next=3,this.host.api.patients.login(l,u,c,f);case 3:return n=e.sent,r=n.api_key,o=n.api_secret,a=n.group_id,i=n.organization_id,this.host.configure({events:(0,h.default)({},this.host.config.events,{singleConversation:a})}),this.host._setAuth({key:r,secret:o}),this.host.setDefaultOrganization(i),e.next=10,this.host.users.findMe({ignoreNotFound:!0});case 10:return s=e.sent,this.host._setCurrentUser(s),this.host.emit("signedIn",s,this.host.getAuth()),this.host.messages._fetchAttachmentTokens(),e.abrupt("return",n);case 15:case"end":return e.stop()}},e,this)})),function(e){return O.apply(this,arguments)})},{key:"loginCheck",value:(I=(0,a.default)(y.default.mark(function e(t){var n=t.linkToken,r=t.sessions;return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.host.api.patients.loginCheck(n,r));case 1:case"end":return e.stop()}},e,this)})),function(e){return I.apply(this,arguments)})},{key:"requestAccessToken",value:(A=(0,a.default)(y.default.mark(function e(t){return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.host.api.patients.requestAccessToken(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return A.apply(this,arguments)})},{key:"csvUpload",value:(T=(0,a.default)(y.default.mark(function e(t,n){return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.host.api.patients.csvUpload(t,n));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return T.apply(this,arguments)})},{key:"getWhiteLabel",value:(k=(0,a.default)(y.default.mark(function e(t){return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.host.api.patients.getWhiteLabel(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return k.apply(this,arguments)})},{key:"setWhiteLabel",value:(E=(0,a.default)(y.default.mark(function e(t,n){return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.host.api.patients.setWhiteLabel(t,n));case 1:case"end":return e.stop()}},e,this)})),function(e,t){return E.apply(this,arguments)})},{key:"_createPatientGroupMetadata",value:function(e){var t=e.displayName,n=e.patient,r=e.id;return{feature_service:"patient_messaging",is_patient_contact:"false",patient_dob:n.dob,patient_gender:n.gender,patient_id:r,patient_mrn:n.mrn,patient_name:t,phone_number:n.phoneNumber,sms_opted_out:n.smsOptedOut}}},{key:"_createPatientContactGroupMetadata",value:function(e){var t=e.patient,n=e.patientContact,r=e.id,o=t.dob,a=t.gender,i=t.mrn,s=t.user,u=n.phoneNumber,c=n.relation,l=n.smsOptedOut;return{feature_service:"patient_messaging",is_patient_contact:"true",patient_contact_id:r,patient_dob:o,patient_gender:a,patient_id:s.id,patient_mrn:i,patient_name:s.displayName,phone_number:u,relation_name:c,sms_opted_out:l}}},{key:"getAll",value:function(){return this.host.models.Patient.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(e));return e=this.__resolvePatientId(e),this.host.models.Patient.get("patient:"+e)}}]),U);function U(){var e,t,n,r;(0,g.default)(this,U);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=n=(0,b.default)(this,(e=U.__proto__||(0,v.default)(U)).call.apply(e,[this].concat(a))),n.__resolvePatientId=function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "patientId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+u(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "patientId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+s(e));if("string"!=typeof e){if(!N.includes(e.$entityType))return e;e=n._resolveModelId(e)}return e.replace("patient:","")},r=t,(0,b.default)(n,r)}t.default=D},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a=r(n(6)),i=r(n(1)),s=r(n(2)),u=r(n(8)),c=r(n(7)),l=r(n(15)),f=n(36),d=(o=l.default,(0,c.default)(p,o),(0,s.default)(p,[{key:"mounted",value:function(){this._data={}}},{key:"dispose",value:function(){this._data=null}},{key:"reactToPresenceEvent",value:function(e){var t=e.data;this.set(t.from,f.PresenceStatus.resolve(t.type))}},{key:"set",value:function(e,t){if(this._data[e]!==t){this._data[e]=t;var n=this.host.models.User.inject({id:e,presence:t});this.emit("change",{presence:t,user:n,userId:e})}}},{key:"get",value:function(e){return e===this.host.currentUserId?f.PresenceStatus.AVAILABLE:this._data[e]||f.PresenceStatus.UNKNOWN}}]),p);function p(e,t){return(0,i.default)(this,p),(0,u.default)(this,(p.__proto__||(0,a.default)(p)).call(this,e,t))}t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function T(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=T(t[0],n);return t.every(function(e){return T(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return T(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+T(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function A(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,p.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=A(t[0],n);return t.every(function(e){return A(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return A(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+A(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f=r(n(4)),d=r(n(5)),p=r(n(3)),h=r(n(11)),y=r(n(10)),v=r(n(9)),I=r(n(20)),O=r(n(13)),j=r(n(24)),S=r(n(12)),g=r(n(6)),m=r(n(1)),b=r(n(2)),_=r(n(8)),w=r(n(7)),x=n(21),M=r(n(395)),E=r(n(172)),k=r(n(15)),R=(a=(0,x.decorator)(),i=(0,x.decorator)(),u=k.default,(0,w.default)(C,u),(0,b.default)(C,[{key:"mounted",value:function(){this.host.models.Organization.on("afterInject",this._onChangeOrganization),this.host.models.Organization.on("afterEject",this._onChangeOrganization)}},{key:"dispose",value:function(){this.host.models.Organization.removeListener("afterInject",this._onChangeOrganization),this.host.models.Organization.removeListener("afterEject",this._onChangeOrganization)}},{key:"findAll",value:(l=(0,v.default)(y.default.mark(function e(){return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.organizations.findAll();case 2:return e.abrupt("return",this.getAll());case 3:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)})},{key:"refreshAll",value:(c=(0,v.default)(y.default.mark(function e(){return y.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.organizations.refreshAll();case 2:return e.abrupt("return",this.getAll());case 3:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})},{key:"getAll",value:function(){return this.host.models.Product.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+A(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+T(e));return this.host.models.Product.get(e)}}]),o((s=C).prototype,"findAll",[a],(0,h.default)(s.prototype,"findAll"),s.prototype),o(s.prototype,"refreshAll",[i],(0,h.default)(s.prototype,"refreshAll"),s.prototype),s);function C(){var e,t,k,n;(0,m.default)(this,C);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=k=(0,_.default)(this,(e=C.__proto__||(0,g.default)(C)).call.apply(e,[this].concat(o))),k._addProcessingEvent=function(e){var t=k.host.models.Product.getAll()[0];if(t){var n=e.actionType,r=e.entity;n===E.default.ROLE_OPT_IN&&t.rolesOptingIn.push(r.id),t.activeProcessingEvents.push(e),k.host.models.Product.inject(t),k.emit("processing:start",e)}},k._removeProcessingEvent=function(e){var t=k.host.models.Product.getAll()[0];if(t){for(var n=t.activeProcessingEvents,r=t.rolesOptingIn,o=e.actionType,a=e.entity,i=n.length-1;0<=i;i--){var s=n[i];if(o===s.actionType&&a.id===s.entity.id&&(n.splice(i,1),o===E.default.ROLE_OPT_IN&&r.includes(a.id)&&r.splice(r.indexOf(a.id),1),o!==E.default.MESSAGE_REPLAY))break}k.host.models.Product.inject(t),k.emit("processing:stop",e)}},k._onChangeOrganization=function(e,t){var n=k.host.models.Product.getAll()[0];if(n){var r=k.host.models.Organization.getAll();if(0!==r.length){var o={organizations:r},a=0,i=0,s=0;if(!r||"function"!=typeof r[S.default]&&!Array.isArray(r))throw new TypeError("Expected organizations to be iterable, got "+T(r));if(!r||"function"!=typeof r[S.default]&&!Array.isArray(r))throw new TypeError("Expected organizations to be iterable, got "+A(r));var u=!0,c=!1,l=void 0;try{for(var f,d=(0,O.default)(r);!(u=(f=d.next()).done);u=!0){var p=f.value;p.$placeholder||(a+=p.conversations.length,i+=p.unreadCount,s+=p.unreadPriorityCount)}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}o.conversationCount=a,o.unreadCount=i,o.unreadPriorityCount=s;var h=!1;if(!(_=(0,j.default)(o))||"function"!=typeof _[S.default]&&!Array.isArray(_))throw new TypeError("Expected _Object$entries to be iterable, got "+T(_));if(!_||"function"!=typeof _[S.default]&&!Array.isArray(_))throw new TypeError("Expected _Object$entries to be iterable, got "+A(_));var y=!0,v=!1,g=void 0;try{for(var m,b=(0,O.default)(_);!(y=(m=b.next()).done);y=!0){var _,w=(0,I.default)(m.value,2),x=w[0],E=w[1];(0,M.default)(n[x],E)||(n[x]=E,h=!0)}}catch(e){v=!0,g=e}finally{try{!y&&b.return&&b.return()}finally{if(v)throw g}}h&&k.host.models.Product.inject(n)}}},n=t,(0,_.default)(k,n)}t.default=R,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,b.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function u(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,b.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=u(t[0],n);return t.every(function(e){return u(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return u(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,m.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,g.default)(e))+": "+u(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,c,l,f,d,p,h,y,v,g=r(n(4)),m=r(n(5)),b=r(n(3)),_=r(n(11)),w=r(n(16)),x=r(n(10)),E=r(n(19)),k=r(n(9)),T=r(n(6)),A=r(n(1)),I=r(n(2)),O=r(n(8)),j=r(n(7)),S=r(n(369)),M=r(n(35)),R=n(21),C=n(29),P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),z=r(n(15)),V=(o=(0,R.decorator)(),h=z.default,(0,j.default)(G,h),(0,I.default)(G,[{key:"findAll",value:(v=(0,k.default)(x.default.mark(function e(){var t,n,r=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(0,M.default)(o,{ignoreNotFound:!0,bypassCache:!1}),0===(t=this.host.models.Organization.getAll()).length)return e.next=5,this.host.organizations.findAll();e.next=6;break;case 5:t=e.sent;case 6:return e.next=8,E.default.all(t.map(function(e){return r.findAllForOrganization(e.id,o)}));case 8:return n=e.sent,e.abrupt("return",(0,S.default)(n));case 10:case"end":return e.stop()}},e,this)})),function(){return v.apply(this,arguments)})},{key:"findAllForOrganization",value:(y=(0,k.default)(x.default.mark(function e(n){var t,r,o,a=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return x.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof n||n instanceof Object){e.next=2;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+u(n));case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+s(n));case 4:if(i=(0,M.default)(i,{ignoreNotFound:!0,bypassCache:!1}),n=this._resolveModelId(n),(t=this._resolveEntity(n)).rolesEnabled&&t.canAdminRoles){e.next=9;break}return e.abrupt("return",[]);case 9:return e.next=11,this.host.api.roleTags.findAll(n);case 11:if(r=e.sent){e.next=16;break}if(i.ignoreNotFound)return e.abrupt("return",[]);e.next=15;break;case 15:throw new P.NotFoundError("roleTags",n);case 16:return o=r.map(function(e){var t=n+":"+e.tag_id;return a.host.models.RoleTag.inject((0,w.default)({},e,{id:t,organizationId:n}))}),this.host.models.Organization.touch(n),e.abrupt("return",o);case 19:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"reactToUpdateEventCR",value:function(e){var t=e.data,n=t=(0,C.jsonCloneDeep)(t),r=n.entity,o=n.organization_id,a=r.color,i=r.display_name,s=r.id||r.token,u=a.color_id,c=a.color_value;return this.host.models.RoleTag.inject({color:u,colorValue:c,id:o+":"+s,name:i,organizationId:o,tagId:s})}},{key:"reactToUpdateEvent",value:function(e){var t=e.data;if(!this.config.condensedReplays||!t.entity){var n=t=(0,C.jsonCloneDeep)(t),r=n.color,o=n.display_name,a=n.organization_key,i=n.token,s=r.color_id,u=r.color_value;return this.host.models.RoleTag.inject({color:s,colorValue:u,id:a+":"+i,name:o,organizationId:a,tagId:i})}this.reactToUpdateEventCR({data:t})}},{key:"getAll",value:function(){return this.host.models.RoleTag.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+u(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(e));return this.host.models.RoleTag.get(e)}}]),i=(a=G).prototype,c="findAllForOrganization",l=[o],f=(0,_.default)(a.prototype,"findAllForOrganization"),d=a.prototype,p={},Object.keys(f).forEach(function(e){p[e]=f[e]}),p.enumerable=!!p.enumerable,p.configurable=!!p.configurable,("value"in p||p.initializer)&&(p.writable=!0),p=l.slice().reverse().reduce(function(e,t){return t(i,c,e)||e},p),d&&void 0!==p.initializer&&(p.value=p.initializer?p.initializer.call(d):void 0,p.initializer=void 0),void 0===p.initializer&&(Object.defineProperty(i,c,p),p=null),a);function G(){return(0,A.default)(this,G),(0,O.default)(this,(G.__proto__||(0,T.default)(G)).apply(this,arguments))}t.default=V,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function F(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,A.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=F(t[0],n);return t.every(function(e){return F(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return F(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,S.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,M.default)(e))+": "+F(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function L(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,A.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=L(t[0],n);return t.every(function(e){return L(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return L(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,S.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,M.default)(e))+": "+L(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A=r(n(3)),I=r(n(11)),O=r(n(20)),j=r(n(77)),S=r(n(5)),M=r(n(4)),B=r(n(10)),$=r(n(19)),R=r(n(9)),q=r(n(13)),H=r(n(12)),C=r(n(16)),P=r(n(6)),z=r(n(1)),V=r(n(2)),G=r(n(8)),N=r(n(7)),D=r(n(162)),U=r(n(35)),Y=n(21),Z=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),W=r(n(171)),K=r(n(15)),X=["role","user"],Q=(a=(0,Y.decorator)(),i=(0,Y.decorator)(),s=(0,Y.decorator)(),u=(0,Y.decorator)(),c=(0,Y.decorator)(),l=(0,Y.decorator)(),f=(0,Y.decorator)(),d=(0,Y.decorator)(),h=K.default,(0,N.default)(J,h),(0,V.default)(J,[{key:"mounted",value:function(){this._previouslyInRoles={},this._roleConversations={},this._roleP2PConversations={},this.host.models.Conversation.on("afterInject",this._onChangeConversation),this.host.models.Conversation.on("afterEject",this._onRemoveConversation)}},{key:"dispose",value:function(){this._previouslyInRoles={},this._roleConversations={},this._roleP2PConversations={},this.host.models.Conversation.removeListener("afterInject",this._onChangeConversation),this.host.models.Conversation.removeListener("afterEject",this._onRemoveConversation)}},{key:"createP2PGroup",value:(T=(0,R.default)(B.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R=this,C=t.metadata,P=t.name,z=t.organizationId,V=t.recipientId,G=t.replayHistory,N=void 0===G||G,D=t.senderId,U=void 0===D?this.host.currentUserId:D;return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),V){e.next=3;break}throw new Z.ValidationError("recipientId","required");case 3:if(z){e.next=5;break}throw new Z.ValidationError("organizationId","required");case 5:if(n=this.host.currentUserId,o=[],"function"!=typeof(r=[U,V])[H.default]&&!Array.isArray(r))throw new TypeError("Expected initialUserIds to be iterable, got "+F(r));e.next=10;break;case 10:if(!r||"function"!=typeof r[H.default]&&!Array.isArray(r))throw new TypeError("Expected initialUserIds to be iterable, got "+L(r));e.next=12;break;case 12:for(i=!(a=!0),s=void 0,e.prev=15,u=(0,q.default)(r);!(a=(c=u.next()).done);a=!0)l=c.value,l=this.host.roles.__resolveRoleId(l),l=this._resolveModelIdWithTypes(l,"user"),o.includes(l)||o.push(l);e.next=23;break;case 19:e.prev=19,e.t0=e.catch(15),i=!0,s=e.t0;case 23:e.prev=23,e.prev=24,!a&&u.return&&u.return();case 26:if(e.prev=26,i)throw s;e.next=29;break;case 29:return e.finish(26);case 30:return e.finish(23);case 31:if(2!==o.length)throw new Z.ValidationError("recipientId","same user as senderId");e.next=33;break;case 33:return e.next=35,$.default.all(o.map(function(e){return R.host.users.find(e,{organizationId:z})}));case 35:return f=e.sent,P=P||f.map(function(e){return e.isRoleBot?e.displayName:e.firstName}).filter(Boolean).join(", ")||"Group",e.next=39,this.host.api.roles.createP2PGroup({createdByUserId:U,memberIds:o,name:P,organizationId:z,replayHistory:N});case 39:if(d=e.sent,h=p=void 0,this.config.condensedReplays?(h=d.entity||d,p=d.conversation_id):h=d,!f||"function"!=typeof f[H.default]&&!Array.isArray(f))throw new TypeError("Expected users to be iterable, got "+F(f));e.next=44;break;case 44:if(!f||"function"!=typeof f[H.default]&&!Array.isArray(f))throw new TypeError("Expected users to be iterable, got "+L(f));e.next=46;break;case 46:v=!(y=!0),g=void 0,e.prev=49,m=(0,q.default)(f);case 51:if(y=(b=m.next()).done){e.next=85;break}if(_=b.value,w=_.botRole,_.isRoleBot&&w){e.next=56;break}return e.abrupt("continue",82);case 56:if(x=w.memberIds){e.next=59;break}return e.abrupt("continue",82);case 59:if(!x||"function"!=typeof x[H.default]&&!Array.isArray(x))throw new TypeError("Expected botMemberIds to be iterable, got "+F(x));e.next=61;break;case 61:if(!x||"function"!=typeof x[H.default]&&!Array.isArray(x))throw new TypeError("Expected botMemberIds to be iterable, got "+L(x));e.next=63;break;case 63:for(k=!(E=!0),T=void 0,e.prev=66,A=(0,q.default)(x);!(E=(I=A.next()).done);E=!0)O=I.value,o.includes(O)||o.push(O);e.next=74;break;case 70:e.prev=70,e.t1=e.catch(66),k=!0,T=e.t1;case 74:e.prev=74,e.prev=75,!E&&A.return&&A.return();case 77:if(e.prev=77,k)throw T;e.next=80;break;case 80:return e.finish(77);case 81:return e.finish(74);case 82:y=!0,e.next=51;break;case 85:e.next=91;break;case 87:e.prev=87,e.t2=e.catch(49),v=!0,g=e.t2;case 91:e.prev=91,e.prev=92,!y&&m.return&&m.return();case 94:if(e.prev=94,v)throw g;e.next=97;break;case 97:return e.finish(94);case 98:return e.finish(91);case 99:if(j=h.id||h.token,S=this.host.models.Group.get(j),M=void 0,M=S&&S.memberIds?S.memberIds:h.members=o,S=this.host.conversations.__injectCounterParty({conversationId:p,entityAttrs:h,entityType:"group",groupType:W.default.ROLE_P2P,hasCurrentUser:M.includes(n),isPlaceholder:!0,organizationId:z}),C)return e.next=107,this.host.metadata.update(S.id,C,z);e.next=107;break;case 107:return e.abrupt("return",S);case 108:case"end":return e.stop()}},e,this,[[15,19,23,31],[24,,26,30],[49,87,91,99],[66,70,74,82],[75,,77,81],[92,,94,98]])})),function(e){return T.apply(this,arguments)})},{key:"findAll",value:(k=(0,R.default)(B.default.mark(function e(){var t,n,r,o,a=this;return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===(t=this.host.models.Organization.getAll()).length)return e.next=4,this.host.organizations.findAll();e.next=5;break;case 4:t=e.sent;case 5:if(0===(t=t.filter(function(e){return e.rolesEnabled})).length)return e.abrupt("return",[]);e.next=8;break;case 8:return e.next=10,this.host.search.query({types:["user"],organizationIds:t.map(function(e){return e.id}),query:{displayName:"",featureService:"role"},followContinuations:!0});case 10:return n=e.sent,r=n.results,o=r.map(function(e){return e.entity}),t.map(function(e){var t=e.id;return a.host.models.Organization.touch(t)}),e.abrupt("return",o);case 15:case"end":return e.stop()}},e,this)})),function(){return k.apply(this,arguments)})},{key:"findByOrganizationId",value:(E=(0,R.default)(B.default.mark(function e(t){var n,r,o,a;return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+F(t));case 4:return t=this._resolveModelId(t),e.next=7,this.host.organizations.find(t);case 7:if((n=e.sent).rolesEnabled){e.next=10;break}return e.abrupt("return",[]);case 10:return e.next=12,this.host.search.query({types:["user"],organizationIds:n.id,query:{displayName:"",featureService:"role"},followContinuations:!0});case 12:return r=e.sent,o=r.results,a=o.map(function(e){return e.entity}),this.host.models.Organization.touch(t),e.abrupt("return",a);case 17:case"end":return e.stop()}},e,this)})),function(e){return E.apply(this,arguments)})},{key:"find",value:(x=(0,R.default)(B.default.mark(function e(t,n){var r,o,a,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=2;break;case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(n));case 4:if(i instanceof Object){e.next=6;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\nObject\n\nGot:\n'+L(i));case 6:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(t));e.next=8;break;case 8:if("string"==typeof n||n instanceof Object){e.next=10;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+F(n));case 10:if(i instanceof Object){e.next=12;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\nObject\n\nGot:\n'+F(i));case 12:if(this.host.requireUser(),i=(0,U.default)(i,{bypassCache:!1,ignoreNotFound:!1}),t=this.__resolveRoleId(t),n=this._resolveModelId(n),i.bypassCache){e.next=20;break}if(r=this.getById(t))return e.abrupt("return",r);e.next=20;break;case 20:return e.next=22,this.host.api.roles.find(t,n);case 22:if(o=e.sent){e.next=27;break}if(i.ignoreNotFound)return e.abrupt("return");e.next=26;break;case 26:throw new Z.NotFoundError(this.host.models.Role.name,t);case 27:return a=this.__injectSearchResult({entity:{id:t,displayName:o.display_name},metadata:o,organizationId:n}),this.host.models.Organization.touch(n),e.abrupt("return",a);case 30:case"end":return e.stop()}},e,this)})),function(e,t){return x.apply(this,arguments)})},{key:"saveRole",value:(w=(0,R.default)(B.default.mark(function e(t,n){return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(n));e.next=8;break;case 8:return this.host.requireUser(),n=this._resolveModelId(n),t=this.__resolveRoleId(t),e.next=13,this.host.api.roles.saveRole(t,this.host.currentUserId,n);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return w.apply(this,arguments)})},{key:"removeSavedRole",value:(_=(0,R.default)(B.default.mark(function e(t,n){return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(n));e.next=8;break;case 8:return this.host.requireUser(),n=this._resolveModelId(n),t=this.__resolveRoleId(t),e.next=13,this.host.api.roles.removeSavedRole(t,this.host.currentUserId,n);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return _.apply(this,arguments)})},{key:"findSavedRoles",value:(b=(0,R.default)(B.default.mark(function e(t){var n,r,o=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=2;break;case 2:if(a instanceof Object){e.next=4;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\nObject\n\nGot:\n'+L(a));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(t));e.next=6;break;case 6:if(a instanceof Object){e.next=8;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\nObject\n\nGot:\n'+F(a));case 8:return a=(0,U.default)(a,{ignoreNotFound:!1}),this.host.requireUser(),t=this._resolveModelId(t),e.next=13,this.host.api.roles.findSavedRoles(this.host.currentUserId,t);case 13:if(n=e.sent){e.next=18;break}if(a.ignoreNotFound)return e.abrupt("return");e.next=17;break;case 17:throw new Z.NotFoundError("saved roles",t);case 18:return r=n.map(function(e){return o.__injectSearchResult({entity:{id:e.token,displayName:e.display_name},metadata:e,organizationId:t})}).filter(Boolean),this.host.models.Organization.touch(t),e.abrupt("return",r);case 21:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"reactToUpdateEventCR",value:function(e){var t,n=e.entity,r=n.display_name,o=n.metadata,a=n.organizationId;return t="group"===n.type?o.id:n.id,o=(0,C.default)({},o,{display_name:r,token:this.__resolveRoleId(t)}),this.__injectRoleFromMetadata({metadata:o,organizationId:a})}},{key:"reactToUpdateEvent",value:function(e){var t,n=e.data,r=n.display_name,o=n.metadata,a=n.organization_key;return t="tigertext:entity:group"===n.type?o.id:n.token,o=(0,C.default)({},o,{display_name:r,token:this.__resolveRoleId(t)}),this.__injectRoleFromMetadata({metadata:o,organizationId:a})}},{key:"__injectRoleFromMetadata",value:function(e){var t=e.metadata,n=void 0===t?{}:t,r=e.organizationId,o=e.replaceExisting,a=void 0===o||o,i=n.escalation_policy,s=n.token;if(!s)return null;var u="role:"+s;if(!a){var c=this.host.models.Role.get(u);if(c)return c}var l=this.host.models.Organization.get(r);this.host.metadata.__injectMetadata(s,r,(0,C.default)({feature_service:"role"},n)),this.host.models.User.injectPlaceholder({id:s,organizationId:r,displayName:n.display_name});var f={botUserId:s,displayName:n.display_name,id:u,organizationId:r};if(n.description&&(f.description=n.description),i&&i.escalation_path){var d=JSON.parse((0,M.default)(i));d.id="escalationPolicy:"+s,d.targetId=s;var p=this.host.models.EscalationPolicy.inject(d);f.escalationPolicyId=p.id}else f.escalationPolicyId=null;if(n.room_assignment_id&&(f.assignmentGroupId=n.room_assignment_id),n.owners)if("string"==typeof n.owners)f.memberIds=n.owners.split(","),this.host.models.User.injectPlaceholder({id:n.owners});else{if(f.memberIds=n.owners.map(function(e){return e.token}),!(b=n.owners)||"function"!=typeof b[H.default]&&!Array.isArray(b))throw new TypeError("Expected _metadata$owners to be iterable, got "+F(b));if(!b||"function"!=typeof b[H.default]&&!Array.isArray(b))throw new TypeError("Expected _metadata$owners to be iterable, got "+L(b));var h=!0,y=!1,v=void 0;try{for(var g,m=(0,q.default)(b);!(h=(g=m.next()).done);h=!0){var b,_=g.value;this.host.models.User.injectPlaceholder(_)}}catch(e){y=!0,v=e}finally{try{!h&&m.return&&m.return()}finally{if(y)throw v}}}return n.tag_id?(f.roleTagId=r+":"+n.tag_id,this.host.models.RoleTag.inject((0,C.default)({},(0,D.default)(n,"tag_id","tag_color","tag_name"),{id:f.roleTagId,organizationId:r}))):l&&(f.roleTagId=null),this.host.models.Role.inject(f)}},{key:"__parseRoleFromMetadata",value:function(e){var t=e.metadata,n=void 0===t?{}:t,r=e.organizationId,o=n.token;if(!o)return null;var a={$entityType:"role",botUserId:o,displayName:n.display_name,id:"role:"+o,organizationId:r},i=null;return n.tag_id&&(i={id:r+":"+n.tag_id,organizationId:r,color:n.tag_color,tagId:n.tag_id,name:n.tag_name,displayName:n.tag_name}).color&&(i.color=i.color.replace("0x","#")),a.roleTag=i,a}},{key:"getAll",value:function(){return this.host.models.Role.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(e));return e=this.__resolveRoleId(e),this.host.models.Role.get("role:"+e)}},{key:"refresh",value:(m=(0,R.default)(B.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f;return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(t));e.next=4;break;case 4:if(0===(n=(0,S.default)(this._roleConversations)).length)return e.abrupt("return");e.next=7;break;case 7:return e.next=9,this.host.entities.findMulti(n,t);case 9:if(!(r=e.sent)||"function"!=typeof r[H.default]&&!Array.isArray(r))throw new TypeError("Expected entities to be iterable, got "+F(r));e.next=12;break;case 12:if(!r||"function"!=typeof r[H.default]&&!Array.isArray(r))throw new TypeError("Expected entities to be iterable, got "+L(r));e.next=14;break;case 14:for(a=!(o=!0),i=void 0,e.prev=17,s=(0,q.default)(r);!(o=(u=s.next()).done);o=!0)c=u.value,l=c.entity,f=c.metadata,l&&f&&(f.owners||(f.owners=[]),this.__injectSearchResult({entity:{id:l.token,displayName:l.display_name},metadata:f,organizationId:t}));e.next=25;break;case 21:e.prev=21,e.t0=e.catch(17),a=!0,i=e.t0;case 25:e.prev=25,e.prev=26,!o&&s.return&&s.return();case 28:if(e.prev=28,a)throw i;e.next=31;break;case 31:return e.finish(28);case 32:return e.finish(25);case 33:case"end":return e.stop()}},e,this,[[17,21,25,33],[26,,28,32]])})),function(e){return m.apply(this,arguments)})},{key:"reactToFriendsEventCR",value:(g=(0,R.default)(B.default.mark(function e(t){var n,r,o,a,i,s;return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.action,r=t.attrs,o=r.id,a=r.metadata,i=void 0===a?{}:a,s=r.organizationId,r.action=n,r.token=o,e.next=6,this.__reactToRoleChange(i.id,s,i.triggered_id,r);case 6:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"reactToFriendsEvent",value:(v=(0,R.default)(B.default.mark(function e(t){var n,r,o,a,i;return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data.friend,r=n.metadata,o=void 0===r?{}:r,a=n.organization_id,i=(0,j.default)(n,["metadata","organization_id"]),e.next=3,this.__reactToRoleChange(o.id,a,o.triggered_id,i);case 3:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"__reactToRoleChange",value:(y=(0,R.default)(B.default.mark(function e(t,n,r,o){var a,i,s,u,c,l,f,d,p,h,y,v,g,m;return B.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(n));e.next=4;break;case 4:if("string"!=typeof r)throw new TypeError('Value of argument "triggeredId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+L(r));e.next=6;break;case 6:if("string"!=typeof t)throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(t));e.next=8;break;case 8:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(n));e.next=10;break;case 10:if("string"!=typeof r)throw new TypeError('Value of argument "triggeredId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+F(r));e.next=12;break;case 12:if(n=this._resolveModelId(n),t=this.__resolveRoleId(t),r=this._resolveModelId(r),a=this.host.currentUser,i=o.action,s=o.token,u=function(){return a.roles.some(function(e){return e.botUserId===t})},c=this._previouslyInRoles[t]||u(),l=o.event_status,"del"!==i){e.next=27;break}if(l&&"end"!==l)return this._previouslyInRoles[t]=c,e.abrupt("return");e.next=26;break;case 26:delete this._previouslyInRoles[t];case 27:return f=this.getById(t),e.next=30,$.default.all([this.find(t,n,{bypassCache:!0,ignoreNotFound:!0}),this.host.users.find(r,{organizationId:n,ignoreNotFound:!0})]);case 30:if(d=e.sent,p=(0,O.default)(d,2),h=p[0],y=p[1],f||h){e.next=36;break}return e.abrupt("return");case 36:(v="del"===i&&f&&!h)&&(h=f,g="role:"+t,this.host.models.Role.inject({id:g,memberIds:[]}),this.host.models.Role.eject(h)),(m=u())&&!c?this.emit("change",{type:"OPT_IN",role:h,target:a,triggeredBy:y}):!m&&c&&(this.host.models.Group.eject(s),this.host.models.User.touch(this.host.currentUserId),this.emit("change",{type:"OPT_OUT",isRoleDeleted:v,role:h,target:a,triggeredBy:y}));case 40:case"end":return e.stop()}},e,this)})),function(e,t,n,r){return y.apply(this,arguments)})}]),o((p=J).prototype,"findAll",[a],(0,I.default)(p.prototype,"findAll"),p.prototype),o(p.prototype,"findByOrganizationId",[i],(0,I.default)(p.prototype,"findByOrganizationId"),p.prototype),o(p.prototype,"find",[s],(0,I.default)(p.prototype,"find"),p.prototype),o(p.prototype,"saveRole",[u],(0,I.default)(p.prototype,"saveRole"),p.prototype),o(p.prototype,"removeSavedRole",[c],(0,I.default)(p.prototype,"removeSavedRole"),p.prototype),o(p.prototype,"findSavedRoles",[l],(0,I.default)(p.prototype,"findSavedRoles"),p.prototype),o(p.prototype,"refresh",[f],(0,I.default)(p.prototype,"refresh"),p.prototype),o(p.prototype,"__reactToRoleChange",[d],(0,I.default)(p.prototype,"__reactToRoleChange"),p.prototype),p);function J(){var e,t,v,n;(0,z.default)(this,J);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=v=(0,G.default)(this,(e=J.__proto__||(0,P.default)(J)).call.apply(e,[this].concat(o))),v.__injectSearchResult=function(e){var t=e.entity,n=e.metadata,r=void 0===n?{}:n,o=e.organizationId;return r=(0,C.default)({},r,{display_name:t.displayName,token:v.__resolveRoleId(t.id)}),v.__injectRoleFromMetadata({metadata:r,organizationId:o})},v.__injectRoleAssignmentEntity=function(e,t,n){return v.__injectRoleFromMetadata({metadata:{display_name:e,meta_type:t.meta_type,owners:t.owner_id,tag_color:t.tag_color,tag_id:t.tag_id,tag_name:t.tag_name,token:t.id},organizationId:n,replaceExisting:!1})},v.__resolveRoleId=function(e){if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+L(e));if(!("string"==typeof e||e instanceof Object))throw new TypeError('Value of argument "roleId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+F(e));if("string"!=typeof e){if(!X.includes(e.$entityType))return e;e=v._resolveModelId(e)}return e.replace("role:","")},v._onChangeConversation=function(e,t){var n=t.counterParty,r=t.counterPartyType,o=n&&n.members&&0<n.members.length;if("group"===r&&o){if(!(l=n.members)||"function"!=typeof l[H.default]&&!Array.isArray(l))throw new TypeError("Expected _counterParty$members to be iterable, got "+F(l));if(!l||"function"!=typeof l[H.default]&&!Array.isArray(l))throw new TypeError("Expected _counterParty$members to be iterable, got "+L(l));var a=!0,i=!1,s=void 0;try{for(var u,c=(0,q.default)(l);!(a=(u=c.next()).done);a=!0){var l,f=u.value;if(f.isRoleBot){var d=v._roleConversations[f.id]||[];if(d.includes(t)||d.push(t),v._roleConversations[f.id]=d,"ROLE_P2P"===n.groupType){var p=v._roleP2PConversations[f.id]||[];p.includes(t)||p.push(t),v._roleP2PConversations[f.id]=p}}}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}},v._onRemoveConversation=function(e,t){var n=t.counterParty,r=t.counterPartyType,o=n&&n.members&&0<n.members.length;if("group"===r&&o){var a=n.memberIds;if(!a||"function"!=typeof a[H.default]&&!Array.isArray(a))throw new TypeError("Expected memberIds to be iterable, got "+F(a));if(!a||"function"!=typeof a[H.default]&&!Array.isArray(a))throw new TypeError("Expected memberIds to be iterable, got "+L(a));var i=!0,s=!1,u=void 0;try{for(var c,l=(0,q.default)(a);!(i=(c=l.next()).done);i=!0){var f=c.value,d=v._roleConversations[f],p=d?d.indexOf(t):-1;if(-1<p&&d.splice(p,1),d&&0===d.length&&delete v._roleConversations[f],"ROLE_P2P"===n.groupType){var h=v._roleP2PConversations[f],y=h?h.indexOf(t):-1;-1<y&&h.splice(y,1),h&&0===h.length&&delete v._roleP2PConversations[f]}}}catch(e){s=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw u}}}},n=t,(0,G.default)(v,n)}t.default=Q,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w=r(n(4)),x=r(n(5)),E=r(n(3)),k=r(n(11)),T=r(n(54)),A=r(n(16)),I=r(n(19)),O=r(n(20)),j=r(n(10)),S=r(n(9)),M=r(n(6)),R=r(n(1)),C=r(n(2)),P=r(n(8)),z=r(n(7)),V=n(21),G=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),N=n(175),D=r(n(15)),U=(a=(0,V.decorator)(),i=(0,V.decorator)(),s=(0,V.decorator)(),u=(0,V.decorator)(),c=(0,V.decorator)(),f=D.default,(0,z.default)(F,f),(0,C.default)(F,[{key:"batchDelete",value:(_=(0,S.default)(j.default.mark(function e(t){var n,r=this,o=t.ids,a=t.organizationId;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(o)){e.next=2;break}throw new G.ValidationError("ids","required","ids must be an array");case 2:if(a){e.next=4;break}throw new G.ValidationError("organizationId","required");case 4:return e.next=6,this.host.api.scheduledMessages.batch({ids:o,operation:"destroy",organizationId:a});case 6:return n=o.map(function(e){return r.host.models.ScheduledMessage.inject({$deleted:!0,id:e})}),e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"create",value:(b=(0,S.default)(j.default.mark(function e(t){var n,r=this,o=t.attachment,a=t.body,i=t.endDate,s=t.network,u=void 0===s?"patient":s,c=t.noReply,l=void 0!==c&&c,f=t.organizationId,d=t.recipients,p=t.repeating,h=t.sendNow,y=void 0!==h&&h,v=t.startDate,g=t.startTime,m=t.templateId,b=t.timezoneName;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._validate({body:a,endDate:i,organizationId:f,recipients:d,repeating:p,sendNow:y,shouldCheckId:!1,startDate:v,startTime:g}),!1===["patient"].includes(u))throw new G.ValidationError("network","invalid",'network must be "patient"');e.next=3;break;case 3:return e.next=5,this.host.api.scheduledMessages.create({attachment:o,body:a,end_date:i,network:u,no_reply:l,organizationId:f,recipients:d,repeating:p,send_now:y,start_date:v,start_time:g,template_id:m,timezone_name:b});case 5:return n=e.sent,e.abrupt("return",n.map(function(e){e.sender_id=r.host.currentUserId,r.host.conversations.__injectCounterParty({entityAttrs:e,entityType:"scheduledMessage",organizationId:f})}));case 7:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"delete",value:(m=(0,S.default)(j.default.mark(function e(t,n){var r;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._validate({id:t,organizationId:n,shouldCheckInvalid:!1}),e.next=3,this.host.api.scheduledMessages.delete(t,n);case 3:return r=this.host.models.ScheduledMessage.inject({$deleted:!0,id:t}),e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return m.apply(this,arguments)})},{key:"downloadScheduledMessageFile",value:(g=(0,S.default)(j.default.mark(function e(t){var n,r=t.scheduleId,o=t.fileName,a=t.organizationId;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.scheduledMessages.downloadScheduledMessageFile({scheduleId:r,fileName:o,organizationId:a});case 2:return n=e.sent,e.next=5,(0,N.downloadFile)({attachmentContentType:n.type,blob:n,fileName:o});case 5:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"fetchHits",value:(v=(0,S.default)(j.default.mark(function e(t,n){var r,o,a,i,s,u=this;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=["history","queue"].map(function(e){return u.search({category:e,feed:t,organizationId:n,pageSize:0})}),e.next=3,I.default.all(r);case 3:return o=e.sent,a=(0,O.default)(o,2),i=a[0],s=a[1],e.abrupt("return",{history:i.metadata.totalHits,queue:s.metadata.totalHits});case 8:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"find",value:(y=(0,S.default)(j.default.mark(function e(t,n){var r,o;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._validate({id:t,organizationId:n,shouldCheckInvalid:!1}),e.next=3,this.host.api.scheduledMessages.find(t,n);case 3:return r=e.sent,o=this.host.models.ScheduledMessage.inject(r),e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})},{key:"findCoarseTimezone",value:(h=(0,S.default)(j.default.mark(function e(t,n){var r,o,a;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.scheduledMessages.findCoarseTimezone(t,n);case 2:return r=e.sent,o=r.abbr,a=r.name,e.abrupt("return",{abbr:o,name:a});case 6:case"end":return e.stop()}},e,this)})),function(e,t){return h.apply(this,arguments)})},{key:"getAll",value:function(){return this.host.models.ScheduledMessage.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,E.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,x.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,w.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,E.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,x.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,w.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(e));return this.host.models.ScheduledMessage.get(e)}},{key:"search",value:(p=(0,S.default)(j.default.mark(function e(t){var n,r,o=t.category,a=t.continuation,i=t.feed,s=t.network,u=void 0===s?"patient":s,c=t.organizationId,l=t.pageSize,f=t.range,d=t.sortBy,p=void 0===d?"scheduled_time":d,h=t.sortOrder,y=void 0===h?"asc":h;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.search.query({query:(0,A.default)({},f?{range:f}:null,{schedule_message_category:o}),continuation:a,feedLevel:i,network:u,organizationId:c,pageSize:l,returnFields:[],sort:(0,T.default)({},p,y),types:["scheduledMessage"]});case 2:return n=e.sent,r=this._processSearchResults(n.results),e.abrupt("return",{metadata:n.metadata,results:r});case 5:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)})},{key:"update",value:(d=(0,S.default)(j.default.mark(function e(t){var n,r,o=t.attachment,a=t.body,i=t.endDate,s=t.id,u=t.organizationId,c=t.repeating,l=t.startDate,f=t.startTime,d=t.templateId,p=t.timezoneName;return j.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._validate({body:a,endDate:i,id:s,organizationId:u,repeating:c,startDate:l,startTime:f}),e.next=3,this.host.api.scheduledMessages.update({attachment:o,body:a,end_date:i,id:s,organizationId:u,repeating:c,start_date:l,start_time:f,template_id:d,timezone_name:p});case 3:return n=e.sent,r=this.host.models.ScheduledMessage.inject(n),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"_processSearchResults",value:function(e){return e.map(function(e){return e.entity}).filter(function(e){return!e.$deleted})}},{key:"_validate",value:function(e){var t=e.body,n=e.endDate,r=e.id,o=e.organizationId,a=e.recipients,i=e.repeating,s=e.sendNow,u=e.shouldCheckId,c=void 0===u||u,l=e.shouldCheckInvalid,f=void 0===l||l,d=e.startDate,p=e.startTime;if(c&&!r)throw new G.ValidationError("id","required");if(!o)throw new G.ValidationError("organizationId","required");if(f){if(!t||0===t.trim().length)throw new G.ValidationError("body","invalid","body must be at least 1 character");if(!(c||Array.isArray(a)&&0<a.length&&a.length<=5))throw new G.ValidationError("recipients","invalid","recipients must be an array of ids between 1 and 5 elements");if(!s){var h=Date.parse(d+"T"+p);if(isNaN(h))throw new G.ValidationError("startDate","invalid","start date and time must be the correct format");if(Date.now()>=h)throw new G.ValidationError("startDate","invalid","start date and time must be in the future");if(i){if(!1===["daily","weekly","biweekly","monthly"].includes(i))throw new G.ValidationError("repeating","invalid",'repeating must be either "daily", "weekly", "biweekly", or "monthly"');var y=Date.parse(n+"T"+p);if(isNaN(y))throw new G.ValidationError("endDate","invalid","endDate must be the correct format");if(y<=h)throw new G.ValidationError("endDate","invalid","endDate must be after startDate")}}}}}]),o((l=F).prototype,"downloadScheduledMessageFile",[a],(0,k.default)(l.prototype,"downloadScheduledMessageFile"),l.prototype),o(l.prototype,"fetchHits",[i],(0,k.default)(l.prototype,"fetchHits"),l.prototype),o(l.prototype,"find",[s],(0,k.default)(l.prototype,"find"),l.prototype),o(l.prototype,"findCoarseTimezone",[u],(0,k.default)(l.prototype,"findCoarseTimezone"),l.prototype),o(l.prototype,"search",[c],(0,k.default)(l.prototype,"search"),l.prototype),l);function F(){return(0,R.default)(this,F),(0,P.default)(this,(F.__proto__||(0,M.default)(F)).apply(this,arguments))}t.default=U,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function de(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,ye.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=de(t[0],n);return t.every(function(e){return de(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return de(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,be.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+de(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function pe(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,ye.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=pe(t[0],n);return t.every(function(e){return pe(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return pe(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,be.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,h.default)(e))+": "+pe(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a,i,s,u,c,l,f,d,p,h=r(n(4)),y=r(n(11)),he=r(n(38)),ye=r(n(3)),ve=r(n(20)),ge=r(n(24)),me=r(n(10)),be=r(n(5)),_e=r(n(19)),we=r(n(13)),xe=r(n(12)),Ee=r(n(16)),v=r(n(9)),g=r(n(6)),m=r(n(1)),b=r(n(2)),_=r(n(8)),w=r(n(7)),x=r(n(93)),ke=r(n(896)),Te=r(n(156)),Ae=r(n(239)),E=n(21),Ie=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),Oe=n(36),se=r(n(464)),G=n(170),je=n(29),k=n(67),T=n(46),A=r(n(15)),Se=["avatar","conversation_id","department","description","display_name","dnd_auto_forward_receiver","dnd","first_name","group_token","is_public","last_login_time","last_name","members","name","network","num_members","organization_key","pagers","status","title","token","total_members"],Me={distributionList:Oe.SearchType.toServer(Oe.SearchType.DISTRIBUTION_LIST),distributionListMember:Oe.SearchType.toServer(Oe.SearchType.DISTRIBUTION_LIST_MEMBER),forum:Oe.SearchType.toServer(Oe.SearchType.FORUM),group:Oe.SearchType.toServer(Oe.SearchType.GROUP),messageTemplate:Oe.SearchType.toServer(Oe.SearchType.MESSAGE_TEMPLATE),organization:Oe.SearchType.toServer(Oe.SearchType.ORGANIZATION),patient_account:Oe.SearchType.toServer(Oe.SearchType.PATIENT),patientDistributionList:Oe.SearchType.toServer(Oe.SearchType.PATIENT_DISTRIBUTION_LIST),scheduledMessage:Oe.SearchType.toServer(Oe.SearchType.SCHEDULED_MESSAGE),tag:Oe.SearchType.toServer(Oe.SearchType.TAG),team:Oe.SearchType.toServer(Oe.SearchType.TEAM),user:Oe.SearchType.toServer(Oe.SearchType.USER)},Re=(0,x.default)(Me),I=(o=(0,E.decorator)(),d=A.default,(0,w.default)(O,d),(0,b.default)(O,[{key:"query",value:(p=(0,v.default)(me.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z,V,G,N,D,U,F,L,B,$,q,H,Y,Z,W,K,X,Q,J,ee,te,ne,re,oe,ae,ie,se,ue,ce,le,fe;return me.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.continuation,r=void 0===n?null:n,o=t.enabledCapabilities,a=void 0===o?[]:o,i=t.excludeEmptyLists,s=void 0!==i&&i,u=t.excludeIds,c=void 0===u?[]:u,l=t.excludeSelf,f=void 0!==l&&l,d=t.followContinuations,p=void 0!==d&&d,h=t.includeDisabled,y=void 0!==h&&h,v=t.network,g=void 0===v?"provider":v,m=t.organizationId,b=void 0===m?null:m,_=t.organizationIds,w=void 0===_?[]:_,x=t.pageSize,E=t.query,k=void 0===E?{}:E,T=t.resultsFormat,A=void 0===T?"entities":T,I=t.returnFields,O=void 0===I?Se:I,j=t.sort,S=void 0===j?[]:j,M=t.types,0===(R=void 0===M?[]:M).length)throw new Ie.ValidationError("types","required","no types specified");e.next=3;break;case 3:if(R=(0,Ae.default)(R.map(function(e){return Oe.SearchType.isValid(e)?Oe.SearchType.toServer(e):Me[e]})),0<(C=(0,Te.default)(R,Re)).length)throw new Ie.ValidationError("types","invalid","invalid types: "+C.join(", "));e.next=7;break;case 7:if(b&&(w=[b]),0===w.length)throw new Ie.ValidationError("organizationIds","invalid","search must be done in a context of an organization");e.next=10;break;case 10:if(1!==w.length){e.next=15;break}if((P=this.host.models.Organization.get(b))&&P.isContacts)return z=this._queryLocalOrganization({organization:P,query:k,types:R}),V=z.results,G=z.metadata,e.abrupt("return",{results:V,metadata:G});e.next=15;break;case 15:if("ids"===A&&(A="tokens"),c=(0,je.arrayWrap)(c),N={directory:w,include_disabled:y,render_metadata:!0,results_format:A,return_fields:O,type:R},a.length&&(N.enabled_capabilities=a),S&&S.length?N.sort=S.map(function(e){return je.Camelizer.underscoreKey(e)}):"object"===(void 0===S?"undefined":(0,ye.default)(S))&&(N.sort=S),N.type.includes("schedule_message")&&t.feedLevel&&(N.feed_level=t.feedLevel),isNaN(parseInt(x))||(N.page_size=x),D={},!(k&&0<(0,be.default)(k).length)){e.next=50;break}if(!(q=(0,ge.default)(k))||"function"!=typeof q[xe.default]&&!Array.isArray(q))throw new TypeError("Expected _Object$entries to be iterable, got "+de(q));e.next=27;break;case 27:if(!q||"function"!=typeof q[xe.default]&&!Array.isArray(q))throw new TypeError("Expected _Object$entries to be iterable, got "+pe(q));e.next=29;break;case 29:for(F=!(U=!0),L=void 0,e.prev=32,B=(0,we.default)(q);!(U=($=B.next()).done);U=!0)H=(0,ve.default)($.value,2),Y=H[0],Z=H[1],Y.includes(",")&&(W=Y.split(",").map(je.Camelizer.underscoreKey).join(","),D[W]=Z,delete k[Y]);e.next=40;break;case 36:e.prev=36,e.t0=e.catch(32),F=!0,L=e.t0;case 40:e.prev=40,e.prev=41,!U&&B.return&&B.return();case 43:if(e.prev=43,F)throw L;e.next=46;break;case 46:return e.finish(43);case 47:return e.finish(40);case 48:D=(0,Ee.default)({},D,je.Camelizer.underscoreObject(k)),N.bool={must:D};case 50:return s&&(R.includes("distribution_list")||R.includes("patient_distribution_list"))&&(N.bool=(0,he.default)({},N.bool,{must_not:{total_members:"0"}})),K=[{continuation:r,excludeIds:c,excludeSelf:f,followContinuations:p,network:g,params:N}],e.next=55,_e.default.all(K.map(this._query));case 55:if(X=e.sent,Q=[],!X||"function"!=typeof X[xe.default]&&!Array.isArray(X))throw new TypeError("Expected allResults to be iterable, got "+de(X));e.next=59;break;case 59:if(!X||"function"!=typeof X[xe.default]&&!Array.isArray(X))throw new TypeError("Expected allResults to be iterable, got "+pe(X));e.next=61;break;case 61:ee=!(J=!0),te=void 0,e.prev=64,ne=(0,we.default)(X);case 66:if(J=(re=ne.next()).done){e.next=95;break}if(oe=re.value,!(ae=oe.results)||"function"!=typeof ae[xe.default]&&!Array.isArray(ae))throw new TypeError("Expected results to be iterable, got "+de(ae));e.next=71;break;case 71:if(!ae||"function"!=typeof ae[xe.default]&&!Array.isArray(ae))throw new TypeError("Expected results to be iterable, got "+pe(ae));e.next=73;break;case 73:for(se=!(ie=!0),ue=void 0,e.prev=76,ce=(0,we.default)(ae);!(ie=(le=ce.next()).done);ie=!0)fe=le.value,Q.push(fe);e.next=84;break;case 80:e.prev=80,e.t1=e.catch(76),se=!0,ue=e.t1;case 84:e.prev=84,e.prev=85,!ie&&ce.return&&ce.return();case 87:if(e.prev=87,se)throw ue;e.next=90;break;case 90:return e.finish(87);case 91:return e.finish(84);case 92:J=!0,e.next=66;break;case 95:e.next=101;break;case 97:e.prev=97,e.t2=e.catch(64),ee=!0,te=e.t2;case 101:e.prev=101,e.prev=102,!J&&ne.return&&ne.return();case 104:if(e.prev=104,ee)throw te;e.next=107;break;case 107:return e.finish(104);case 108:return e.finish(101);case 109:return Q=(0,ke.default)(Q,"entity"),e.abrupt("return",{results:Q,metadata:X[0].metadata});case 111:case"end":return e.stop()}},e,this,[[32,36,40,48],[41,,43,47],[64,97,101,109],[76,80,84,92],[85,,87,91],[102,,104,108]])})),function(e){return p.apply(this,arguments)})},{key:"_queryLocalOrganization",value:function(e){var t=e.organization,n=e.query,r=e.types,o=t.id,a=this._searchLocalOrganization({organization:t,query:n,types:r}),i={firstHit:1,totalHits:a.length},s=(0,be.default)(n);if(0===a.length&&0<s.length){var u=s.find(function(e){return e.includes("displayName")}),c=u?n[u]:n[s[0]];if((0,k.isEmail)(c)||(0,T.isPhone)(c)){var l=(0,k.isEmail)(c)?c:(0,T.normalizePhoneUS)(c),f=this.host.models.User.createInstance({displayName:(0,T.isPhone)(c)?(0,T.formatPhone)(c):c,id:l,messageAnyoneRecipient:!0,organizationId:o});return{results:[new se.default(f,o,i)],metadata:i}}}return{results:a,metadata:i}}}]),i=(a=O).prototype,s="query",u=[o],c=(0,y.default)(a.prototype,"query"),l=a.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(i,s,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(i,s,f),f=null),a);function O(){var e,t,ae,n,r,ie=this;(0,m.default)(this,O);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=ae=(0,_.default)(this,(e=O.__proto__||(0,g.default)(O)).call.apply(e,[this].concat(a))),ae._query=(r=(0,v.default)(me.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,P,z,V,G,N,D,U,F,L,B,$,q,H,Y,Z,W,K,X,Q,J,ee,te,ne,re,oe;return me.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.continuation,r=void 0===n?null:n,o=t.excludeIds,a=void 0===o?[]:o,i=t.excludeSelf,s=void 0!==i&&i,u=t.followContinuations,c=void 0!==u&&u,l=t.network,f=void 0===l?"provider":l,d=t.params,r&&(d=(0,Ee.default)({},d,{continuation:r})),p=void 0,h=[],"patient"===f||d.type.includes("patient_account"))return e.next=7,ae.host.api.search.patientQuery(d);e.next=11;break;case 7:(p=e.sent).metadata.continuation||(p.metadata.continuation=null),e.next=14;break;case 11:return e.next=13,ae.host.api.search.query(d);case 13:p=e.sent;case 14:if(h=p.results,y=[],!h||"function"!=typeof h[xe.default]&&!Array.isArray(h))throw new TypeError("Expected entries to be iterable, got "+de(h));e.next=18;break;case 18:if(!h||"function"!=typeof h[xe.default]&&!Array.isArray(h))throw new TypeError("Expected entries to be iterable, got "+pe(h));e.next=20;break;case 20:g=!(v=!0),m=void 0,e.prev=23,b=(0,we.default)(h);case 25:if(v=(_=b.next()).done){e.next=41;break}if(w=_.value,x=w.type,E=w.entity,k=w.organization_id,T={entityAttrs:E,organizationId:k,type:x},ae.config.condensedReplays?E.conversation_id?(T.conversationId=E.conversation_id,delete E.conversation_id):T.conversationId=w.conversation_id:delete E.conversation_id,0===(0,be.default)(E).length)return e.abrupt("continue",38);e.next=34;break;case 34:"tigertext:entity:account"===x?(0,je.replaceKey)(E,"status","account_status"):"tigertext:entity:tag"===x&&(E.token=k+":"+E.token),(A=E.metadata)&&ae.host.metadata.__injectMetadata(E.token,k,A),y.push(T);case 38:v=!0,e.next=25;break;case 41:e.next=47;break;case 43:e.prev=43,e.t0=e.catch(23),g=!0,m=e.t0;case 47:e.prev=47,e.prev=48,!v&&b.return&&b.return();case 50:if(e.prev=50,g)throw m;e.next=53;break;case 53:return e.finish(50);case 54:return e.finish(47);case 55:return I=p.metadata,O=I.continuation,j=I.first_hit,S=I.total_hits,M={firstHit:j,totalHits:S},O&&(c?M.firstHit=1:M.continuation=O),R=[],C=[],P=function(e){var t=e.results;if(!t||"function"!=typeof t[xe.default]&&!Array.isArray(t))throw new TypeError("Expected results to be iterable, got "+de(t));if(!t||"function"!=typeof t[xe.default]&&!Array.isArray(t))throw new TypeError("Expected results to be iterable, got "+pe(t));var n=!0,r=!1,o=void 0;try{for(var a,i=(0,we.default)(t);!(n=(a=i.next()).done);n=!0){var s=a.value;R.push(s)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}},c&&O&&C.push(ae._query((0,Ee.default)({},t,{continuation:O})).then(P)),e.next=64,_e.default.all(C);case 64:if(z=[],!y||"function"!=typeof y[xe.default]&&!Array.isArray(y))throw new TypeError("Expected candidates to be iterable, got "+de(y));e.next=67;break;case 67:if(!y||"function"!=typeof y[xe.default]&&!Array.isArray(y))throw new TypeError("Expected candidates to be iterable, got "+pe(y));e.next=69;break;case 69:G=!(V=!0),N=void 0,e.prev=72,D=(0,we.default)(y);case 74:if(V=(U=D.next()).done){e.next=98;break}if(F=U.value,L=F.conversationId,B=F.entityAttrs,$=F.organizationId,q=F.type,H=ae.host.modelNameByTypeNS(q),(Y="group"===H&&ae.host.groups.__extractGroupTypeFromAttrs(B))===Oe.GroupType.FORUM&&delete B.members,Z=ae.host.metadata.get(B.token,$),W=Z?Z.data:null,"user"===(K=ae.host.conversations.__injectCounterParty({conversationId:L,entityAttrs:B,entityType:H,groupType:Y,hasCurrentUser:!1,organizationId:$})).$entityType&&W&&"role"===W.feature_service&&ae.host.roles.__injectSearchResult({entity:K,metadata:W,organizationId:$}),a.length&&a.includes(K.id))return e.abrupt("continue",95);e.next=86;break;case 86:if(X=ae.host.currentUserId,s&&K.id===X)return e.abrupt("continue",95);e.next=89;break;case 89:if(K){e.next=92;break}return ae.logger.warn("no entity for ",F),e.abrupt("continue",95);case 92:K.isRoleBot&&K.botRole&&(K=K.botRole),Q=new se.default(K,$,L,W),z.unshift(Q);case 95:V=!0,e.next=74;break;case 98:e.next=104;break;case 100:e.prev=100,e.t1=e.catch(72),G=!0,N=e.t1;case 104:e.prev=104,e.prev=105,!V&&D.return&&D.return();case 107:if(e.prev=107,G)throw N;e.next=110;break;case 110:return e.finish(107);case 111:return e.finish(104);case 112:if(!z||"function"!=typeof z[xe.default]&&!Array.isArray(z))throw new TypeError("Expected immediateResults to be iterable, got "+de(z));e.next=114;break;case 114:if(!z||"function"!=typeof z[xe.default]&&!Array.isArray(z))throw new TypeError("Expected immediateResults to be iterable, got "+pe(z));e.next=116;break;case 116:for(ee=!(J=!0),te=void 0,e.prev=119,ne=(0,we.default)(z);!(J=(re=ne.next()).done);J=!0)oe=re.value,R.unshift(oe);e.next=127;break;case 123:e.prev=123,e.t2=e.catch(119),ee=!0,te=e.t2;case 127:e.prev=127,e.prev=128,!J&&ne.return&&ne.return();case 130:if(e.prev=130,ee)throw te;e.next=133;break;case 133:return e.finish(130);case 134:return e.finish(127);case 135:return e.abrupt("return",{results:R,metadata:M});case 136:case"end":return e.stop()}},e,ie,[[23,43,47,55],[48,,50,54],[72,100,104,112],[105,,107,111],[119,123,127,135],[128,,130,134]])})),function(e){return r.apply(this,arguments)}),ae._searchLocalOrganization=function(e){var t=e.organization,n=e.query,r=e.types,o=void 0===r?[]:r,a=t.conversations,i=t.id,s=[];if(!a||"function"!=typeof a[xe.default]&&!Array.isArray(a))throw new TypeError("Expected conversations to be iterable, got "+de(a));if(!a||"function"!=typeof a[xe.default]&&!Array.isArray(a))throw new TypeError("Expected conversations to be iterable, got "+pe(a));var u=!0,c=!1,l=void 0;try{for(var f,d=(0,we.default)(a);!(u=(f=d.next()).done);u=!0){var p=f.value,h=p.counterParty,y=p.counterPartyType,v=p.metadata,g=Me[y];if(o.includes(g))if(n&&0!==(0,be.default)(n).length){var m=!0;if(!(k=(0,ge.default)(n))||"function"!=typeof k[xe.default]&&!Array.isArray(k))throw new TypeError("Expected _Object$entries2 to be iterable, got "+de(k));if(!k||"function"!=typeof k[xe.default]&&!Array.isArray(k))throw new TypeError("Expected _Object$entries2 to be iterable, got "+pe(k));var b=!0,_=!1,w=void 0;try{for(var x,E=(0,we.default)(k);!(b=(x=E.next()).done);b=!0){var k,T=(0,ve.default)(x.value,2),A=T[0],I=T[1];A=A.split(","),I=I.toLowerCase();var O=!1;if(!A||"function"!=typeof A[xe.default]&&!Array.isArray(A))throw new TypeError("Expected fields to be iterable, got "+de(A));if(!A||"function"!=typeof A[xe.default]&&!Array.isArray(A))throw new TypeError("Expected fields to be iterable, got "+pe(A));var j=!0,S=!1,M=void 0;try{for(var R,C=(0,we.default)(A);!(j=(R=C.next()).done);j=!0){var P=R.value,z="user"===y&&G.PROFILE_ATTRIBUTES_PER_ORG.includes(P)?h.profileByOrganizationId[i]:h;if(z){var V=z[P];if(void 0!==V&&V.toLowerCase().includes(I)){O=!0;break}}}}catch(e){S=!0,M=e}finally{try{!j&&C.return&&C.return()}finally{if(S)throw M}}if(!O){m=!1;break}}}catch(e){_=!0,w=e}finally{try{!b&&E.return&&E.return()}finally{if(_)throw w}}m&&s.push(new se.default(h,i,v))}else s.push(new se.default(h,i,v))}}catch(e){c=!0,l=e}finally{try{!u&&d.return&&d.return()}finally{if(c)throw l}}return s},n=t,(0,_.default)(ae,n)}t.default=I,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,O.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,I.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,A.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function u(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,O.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=u(t[0],n);return t.every(function(e){return u(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return u(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,I.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,A.default)(e))+": "+u(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A=r(n(4)),I=r(n(5)),O=r(n(3)),j=r(n(11)),S=r(n(38)),M=r(n(13)),R=r(n(12)),C=r(n(19)),P=r(n(10)),z=r(n(9)),V=r(n(6)),G=r(n(1)),N=r(n(2)),D=r(n(8)),U=r(n(7)),F=r(n(87)),L=n(21),B=r(n(15)),$=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),q=(a=(0,L.decorator)(),i=(0,L.decorator)(),c=(0,L.decorator)(),l=(0,L.decorator)(),f=(0,L.decorator)(),p=B.default,(0,U.default)(H,p),(0,N.default)(H,[{key:"mounted",value:function(){this._fetched=!1}},{key:"dispose",value:function(){this._fetched=!1}},{key:"find",value:(T=(0,z.default)(P.default.mark(function e(t){var n,r,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=a.organizationId,s=a.bypassCache,u=void 0!==s&&s;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),t){e.next=3;break}throw new $.ValidationError("id","required");case 3:if(i){e.next=5;break}throw new $.ValidationError("organizationId","required");case 5:if(n=void 0,u){e.next=10;break}if((n=this.host.models.Team.get(t))&&!n.$placeholder)return e.abrupt("return",n);e.next=10;break;case 10:return e.next=12,this.host.api.teams.find(t,{organizationId:i});case 12:return r=e.sent,o=r.team,n=this.host.models.Team.inject(o),e.abrupt("return",n);case 16:case"end":return e.stop()}},e,this)})),function(e){return T.apply(this,arguments)})},{key:"refresh",value:(k=(0,z.default)(P.default.mark(function e(t){var n,r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).organizationId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find(t,{organizationId:r,bypassCache:!0});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)})),function(e){return k.apply(this,arguments)})},{key:"findAll",value:(E=(0,z.default)(P.default.mark(function e(){var t,n,r,o,a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).bypassCache,i=void 0!==a&&a;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i&&this._fetched)return e.abrupt("return",this.getAll());e.next=2;break;case 2:if(0===(t=this.host.models.Organization.getAll()).length)return e.next=6,this.host.organizations.findAll();e.next=7;break;case 6:t=e.sent;case 7:return e.next=9,this.host.search.query({types:["team"],organizationIds:t.map(function(e){return e.id}),query:{displayName:""},followContinuations:!0});case 9:return n=e.sent,r=n.results,o=r.map(function(e){return e.entity}),this._fetched=!0,e.abrupt("return",o);case 14:case"end":return e.stop()}},e,this)})),function(){return E.apply(this,arguments)})},{key:"findByOrganizationId",value:(x=(0,z.default)(P.default.mark(function e(t){var n,r,o,a;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object){e.next=2;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+u(t));case 2:if("string"==typeof t||t instanceof Object){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+s(t));case 4:return t=this._resolveModelId(t),e.next=7,this.host.organizations.find(t);case 7:return n=e.sent,e.next=10,this.host.search.query({types:["team"],organizationIds:n.id,query:{displayName:""},followContinuations:!0});case 10:return r=e.sent,o=r.results,a=o.map(function(e){return e.entity}),e.abrupt("return",a);case 14:case"end":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)})},{key:"refreshAll",value:(w=(0,z.default)(P.default.mark(function e(){var t;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findAll({bypassCache:!0});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)})),function(){return w.apply(this,arguments)})},{key:"getAll",value:function(){return this.host.models.Team.getAll()}},{key:"create",value:(_=(0,z.default)(P.default.mark(function e(t){var n,r,o,a,i=this,s=t.avatar,u=t.canMembersLeave,c=void 0===u||u,l=t.canRequestToJoin,f=void 0===l||l,d=t.description,p=t.displayName,h=t.memberIds,y=void 0===h?[]:h,v=t.organizationId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),v){e.next=3;break}throw new $.ValidationError("organizationId","required");case 3:if(y.length<2)throw new $.ValidationError("memberIds","required to have 2 or more IDs");e.next=5;break;case 5:return e.next=7,C.default.all(y.map(this.host.roles.__resolveRoleId).filter(Boolean).map(function(e){return i._resolveModelIdWithTypes(e,"user")}).map(function(e){return i.host.users.find(e,{organizationId:v})}));case 7:return n=e.sent,e.t0=n,r=F.default.call(e.t0),y=r.map(function(e){return i._resolveModelIdWithTypes(e,"user")}),e.next=13,this.host.api.teams.create({avatar:s,canMembersLeave:c,canRequestToJoin:f,description:d,displayName:p,memberIds:y,organizationId:v});case 13:return o=e.sent,a=this.host.models.Team.inject(o.team),e.abrupt("return",a);case 16:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)})},{key:"update",value:(b=(0,z.default)(P.default.mark(function e(t){var n,r,o=t.avatar,a=t.canMembersLeave,i=void 0===a||a,s=t.canRequestToJoin,u=void 0===s||s,c=t.description,l=t.displayName,f=t.id,d=t.memberIds,p=void 0===d?[]:d,h=t.organizationId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.requireUser(),f){e.next=3;break}throw new $.ValidationError("id","required");case 3:if(h){e.next=5;break}throw new $.ValidationError("organizationId","required");case 5:if(p.length<2)throw new $.ValidationError("memberIds","required to have 2 or more IDs");e.next=7;break;case 7:return p=p.map(this.host.roles.__resolveRoleId),e.next=10,this.host.api.teams.update({avatar:o,canMembersLeave:i,canRequestToJoin:u,description:c,displayName:l,id:f,memberIds:p,organizationId:h});case 10:return n=e.sent,r=this.host.models.Team.inject(n.team),e.abrupt("return",r);case 13:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"delete",value:(m=(0,z.default)(P.default.mark(function e(t,n){var r,o,a=n.organizationId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}throw new $.ValidationError("organizationId","required");case 2:if(t){e.next=4;break}throw new $.ValidationError("teamId","required");case 4:return e.next=6,this.host.api.teams.delete(t,{organizationId:a});case 6:return 204===(r=e.sent)&&(o=this.host.models.Team.get(t))&&this.host.models.Team.eject(o),e.abrupt("return",r);case 9:case"end":return e.stop()}},e,this)})),function(e,t){return m.apply(this,arguments)})},{key:"requestToJoin",value:(g=(0,z.default)(P.default.mark(function e(t,n){var r,o=n.requestedById,a=n.organizationId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}throw new $.ValidationError("organizationId","required");case 2:if(t){e.next=4;break}throw new $.ValidationError("teamId","required");case 4:if(o){e.next=6;break}throw new $.ValidationError("requestedById","required");case 6:return e.next=8,this.host.api.teams.requestToJoin(t,{requestedById:o,organizationId:a});case 8:return 204===(r=e.sent)&&this.host.models.Team.inject({id:t,hasCurrentUserPending:!0}),e.abrupt("return",r);case 11:case"end":return e.stop()}},e,this)})),function(e,t){return g.apply(this,arguments)})},{key:"acceptJoinRequest",value:(v=(0,z.default)(P.default.mark(function e(t,n){var r,o=n.teamId,a=n.organizationId,i=n.handledAsId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}throw new $.ValidationError("organizationId","required");case 2:if(o){e.next=4;break}throw new $.ValidationError("teamId","required");case 4:if(t){e.next=6;break}throw new $.ValidationError("requestId","required");case 6:if(i){e.next=8;break}throw new $.ValidationError("handledAsId","required");case 8:return e.next=10,this.host.api.teams.updateJoinRequest(t,{teamId:o,organizationId:a,handledAsId:i,status:"accepted"});case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return v.apply(this,arguments)})},{key:"declineJoinRequest",value:(y=(0,z.default)(P.default.mark(function e(t,n){var r,o=n.teamId,a=n.organizationId,i=n.handledAsId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}throw new $.ValidationError("organizationId","required");case 2:if(o){e.next=4;break}throw new $.ValidationError("teamId","required");case 4:if(t){e.next=6;break}throw new $.ValidationError("requestId","required");case 6:if(i){e.next=8;break}throw new $.ValidationError("handledAsId","required");case 8:return e.next=10,this.host.api.teams.updateJoinRequest(t,{teamId:o,organizationId:a,handledAsId:i,status:"declined"});case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this)})),function(e,t){return y.apply(this,arguments)})},{key:"leave",value:(h=(0,z.default)(P.default.mark(function e(t){var n,r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).organizationId;return P.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new $.ValidationError("teamId","required");case 2:if(r){e.next=4;break}throw new $.ValidationError("organizationId","required");case 4:return e.next=6,this.host.api.teams.leave(t,{organizationId:r});case 6:return 204===(n=e.sent)&&this.refresh(t,{organizationId:r}),e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"_setHasUserPending",value:function(e){if(e.pendingRequestUserIds){if(!(i=e.pendingRequestUserIds)||"function"!=typeof i[R.default]&&!Array.isArray(i))throw new TypeError("Expected _entity$pendingReques to be iterable, got "+s(i));if(!i||"function"!=typeof i[R.default]&&!Array.isArray(i))throw new TypeError("Expected _entity$pendingReques to be iterable, got "+u(i));var t=!0,n=!1,r=void 0;try{for(var o,a=(0,M.default)(i);!(t=(o=a.next()).done);t=!0){var i;if(o.value===this.host.currentUserId)return void(e.hasCurrentUserPending=!0)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}}},{key:"__injectTeamRequest",value:function(e){if(!e.id)return null;var t=void 0;if(e.created_by&&e.created_by.token&&(t=this.host.models.User.inject(e.created_by)),e.team&&e.team.id){var n=e.status,r=(0,S.default)({},e.team);t&&t.id===this.host.currentUserId&&("accepted"===n?(r.hasCurrentUserBeenDeclined=!1,r.hasCurrentUserPending=!1):"declined"===n&&(r.hasCurrentUserBeenDeclined=!0,r.hasCurrentUserPending=!1)),this.host.models.Team.inject(r)}return this.host.models.TeamRequest.inject(e)}},{key:"resetDeclinedUserOnTeam",value:function(e){this.host.models.Team.inject({id:e,hasCurrentUserBeenDeclined:!1})}}]),o((d=H).prototype,"find",[a],(0,j.default)(d.prototype,"find"),d.prototype),o(d.prototype,"refresh",[i],(0,j.default)(d.prototype,"refresh"),d.prototype),o(d.prototype,"findAll",[c],(0,j.default)(d.prototype,"findAll"),d.prototype),o(d.prototype,"findByOrganizationId",[l],(0,j.default)(d.prototype,"findByOrganizationId"),d.prototype),o(d.prototype,"refreshAll",[f],(0,j.default)(d.prototype,"refreshAll"),d.prototype),d);function H(){return(0,G.default)(this,H),(0,D.default)(this,(H.__proto__||(0,V.default)(H)).apply(this,arguments))}t.default=q,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function l(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,g.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=l(t[0],n);return t.every(function(e){return l(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return l(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,v.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,y.default)(e))+": "+l(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function f(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,g.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=f(t[0],n);return t.every(function(e){return f(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return f(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,v.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,y.default)(e))+": "+f(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,d,p,h,y=r(n(4)),v=r(n(5)),g=r(n(3)),m=r(n(11)),b=r(n(10)),_=r(n(9)),w=r(n(6)),x=r(n(1)),E=r(n(2)),k=r(n(8)),T=r(n(7)),A=r(n(163)),I=r(n(338)),O=r(n(211)),j=r(n(212)),S=r(n(240)),M=n(21),R=r(n(15)),C=r(n(263)),P=C.default.GLOBAL,z=(a=(0,M.decorator)(),i=(0,M.decorator)(),u=R.default,(0,T.default)(V,u),(0,E.default)(V,[{key:"mounted",value:function(){this._lastStartTypingAPICalls={},this._lastStopTypingAPICalls={},this._typers={},this._currentUserTyping={},this.host.on("message:sending",this._onMessageSending)}},{key:"dispose",value:function(){var e;(e=(e=(e=(e=this._typers,I.default).call(e),j.default).call(e,A.default),O.default).call(e),j.default).call(e,"timer").forEach(function(e){return null!==e&&clearTimeout(e)}),(e=(e=this._currentUserTyping,I.default).call(e),j.default).call(e,"timer").forEach(function(e){return null!==e&&clearTimeout(e)}),this._lastStartTypingAPICalls=null,this._lastStopTypingAPICalls=null,this._typers=null,this.host.removeListener("message:sending",this._onMessageSending)}},{key:"reactToIsTypingEvent",value:function(e){var t,n=e.data;if(this.host.requireUser(),(t=n.proxy_token?n.proxy_token:n.sender_token)!==this.host.currentUserId){var r=n.group_token,o=n.org_token,a=r||o||null,i=r?C.default.GROUP:o?C.default.ORGANIZATION:P,s="typing"===n.status;this.host.models.User.ensureEntity(t,{onlyPlaceholder:!1}),this._setTypingStatusOfUser(a,i,t,s)}}},{key:"startTyping",value:(h=(0,_.default)(b.default.mark(function e(t){var n,r,o=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=a.autoStopAfterTimeout,s=a.senderId,u=a.organizationId;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object||null==t){e.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object | void\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object||null==t){e.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object | void\n\nGot:\n'+l(t));case 4:if(void 0===t)return e.abrupt("return");e.next=6;break;case 6:return t=this._resolveModelId(t),s=this._resolveModelId(s),this.host.requireUser(),e.next=11,this._sendStartTyping(t,s,u);case 11:(n=this._currentUserTyping[t])?(clearTimeout(this._currentUserTyping[t].timer),n.timer=null):(n={},this._currentUserTyping[t]=n),r="number"==typeof i?i:this.host.config.clearTypingStatusTimeout,n.timer=setTimeout(function(){o.logger.info("auto stop typing for current user",t),o.stopTyping(t,{senderId:s})},r);case 15:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"_sendStartTyping",value:(p=(0,_.default)(b.default.mark(function e(t,n,r){var o,a,i,s,u,c;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._lastStartTypingAPICalls[t]){e.next=7;break}if(o=this._lastStartTypingAPICalls[t],a=o.expiresAt,i=o.retVal,s=o.lastSenderId,n!==s)return e.next=5,this.stopTyping(t,{senderId:s});e.next=5;break;case 5:if((0,S.default)().isBefore(a))return e.abrupt("return",i);e.next=7;break;case 7:return e.next=9,this.host.api.typingStatus.startTyping(t,n,r);case 9:return u=e.sent,c=(0,S.default)().add(this.config.clearTypingStatusThrottleDelay,"ms"),this._lastStartTypingAPICalls[t]={expiresAt:c,retVal:u,lastSenderId:n},e.abrupt("return",u);case 13:case"end":return e.stop()}},e,this)})),function(e,t,n){return p.apply(this,arguments)})},{key:"stopTyping",value:(d=(0,_.default)(b.default.mark(function e(t){var n,r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).senderId;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t||t instanceof Object||null==t){e.next=2;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object | void\n\nGot:\n'+f(t));case 2:if("string"==typeof t||t instanceof Object||null==t){e.next=4;break}throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nstring | Object | void\n\nGot:\n'+l(t));case 4:if(void 0===t)return e.abrupt("return");e.next=6;break;case 6:return t=this._resolveModelId(t),r=this._resolveModelId(r),this.host.requireUser(),(n=this._currentUserTyping[t])&&null!==n.timer&&(clearTimeout(n.timer),n.timer=null),e.next=13,this._sendStopTyping(t,r);case 13:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"_sendStopTyping",value:(c=(0,_.default)(b.default.mark(function e(t,n){var r,o,a,i,s;return b.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this._lastStopTypingAPICalls[t])){e.next=5;break}if(o=r.expiresAt,a=r.retVal,(0,S.default)().isBefore(o))return e.abrupt("return",a);e.next=5;break;case 5:return e.next=7,this.host.api.typingStatus.stopTyping(t,n);case 7:return i=e.sent,s=(0,S.default)().add(this.config.clearTypingStatusThrottleDelay,"ms"),this._lastStopTypingAPICalls[t]={expiresAt:s,retVal:i,senderId:n},e.abrupt("return",i);case 11:case"end":return e.stop()}},e,this)})),function(e,t){return c.apply(this,arguments)})},{key:"_setTypingStatusOfUser",value:function(e,t,n,r){var o=this,a=4<arguments.length&&void 0!==arguments[4]&&arguments[4];if("string"!=typeof e&&null!=e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring | null\n\nGot:\n'+f(e));if("string"!=typeof t)throw new TypeError('Value of argument "contextType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(n));if("boolean"!=typeof r)throw new TypeError('Value of argument "isTyping" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+f(r));if(null!=a&&"boolean"!=typeof a)throw new TypeError('Value of argument "timedOut" violates contract.\n\nExpected:\n?boolean\n\nGot:\n'+f(a));if("string"!=typeof e&&null!=e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring | null\n\nGot:\n'+l(e));if("string"!=typeof t)throw new TypeError('Value of argument "contextType" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));if("string"!=typeof n)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(n));if("boolean"!=typeof r)throw new TypeError('Value of argument "isTyping" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+l(r));if(null!=a&&"boolean"!=typeof a)throw new TypeError('Value of argument "timedOut" violates contract.\n\nExpected:\n?boolean\n\nGot:\n'+l(a));e=e||C.default.GLOBAL;var i=this._typers[e];if(r){i||(i={},this._typers[e]=i);var s=i[n],u=s&&null!==s.timer;if(s?clearTimeout(s.timer):(s={},i[n]=s),s.timer=setTimeout(function(){o.logger.info("auto stop typing for other typer",e,n),o._setTypingStatusOfUser(e,t,n,!1,!0)},this.host.config.clearTypingStatusTimeout),u)return}else{var c=i&&i[n];if(!c||null===c.timer)return;clearTimeout(c.timer),c.timer=null}this.emit("change",{userId:n,contextId:e,contextType:t,isTyping:r,timedOut:a})}},{key:"isUserTyping",value:function(e){if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+f(e));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+l(e));return e=this._resolveModelId(e),this._isUserTypingInContext(P,e)}},{key:"isCurrentUserTyping",value:function(e){if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+f(e));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "counterPartyId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+l(e));e=this._resolveModelId(e);var t=this._currentUserTyping[e];return!!t&&null!==t.timer}},{key:"isUserTypingInGroup",value:function(e,t){if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+f(e));if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+f(t));if(!(e instanceof Object||"string"==typeof e))throw new TypeError('Value of argument "groupId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+l(e));if(!(t instanceof Object||"string"==typeof t))throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nObject | string\n\nGot:\n'+l(t));return t=this._resolveModelId(t),e=this._resolveModelId(e),this._isUserTypingInContext(e,t)}},{key:"_isUserTypingInContext",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+f(t));if("string"!=typeof e)throw new TypeError('Value of argument "contextId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(e));if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+l(t));var n=this._typers[e],r=n&&n[t];return!!r&&null!==r.timer}}]),o((s=V).prototype,"_sendStartTyping",[a],(0,m.default)(s.prototype,"_sendStartTyping"),s.prototype),o(s.prototype,"_sendStopTyping",[i],(0,m.default)(s.prototype,"_sendStopTyping"),s.prototype),s);function V(){var e,t,n,r;(0,x.default)(this,V);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=n=(0,k.default)(this,(e=V.__proto__||(0,w.default)(V)).call.apply(e,[this].concat(a))),n._onMessageSending=function(e){n.stopTyping(e.counterPartyId,{senderId:e.senderId})},r=t,(0,k.default)(n,r)}t.default=z,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function i(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,g.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=i(t[0],n);return t.every(function(e){return i(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return i(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,v.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,y.default)(e))+": "+i(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function s(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,g.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=s(t[0],n);return t.every(function(e){return s(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return s(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,v.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,y.default)(e))+": "+s(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,u,c,l,f,d,p,h,y=r(n(4)),v=r(n(5)),g=r(n(3)),m=r(n(11)),b=r(n(16)),_=r(n(10)),w=r(n(9)),x=r(n(6)),E=r(n(1)),k=r(n(2)),T=r(n(8)),A=r(n(7)),I=r(n(15)),O=n(21),j=(a=(0,O.decorator)(),u=(0,O.decorator)(),c=(0,O.decorator)({memoize:!0,serializeArguments:function(e){return e[0]}}),f=I.default,(0,A.default)(S,f),(0,k.default)(S,[{key:"dispose",value:function(){O.decorator.clear(this._findAll)}},{key:"findAll",value:(h=(0,w.default)(_.default.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.userId,r=void 0===n?this.host.currentUserId:n,o=t.organizationId;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.requireUser(),e.abrupt("return",this._findAll(r,o));case 2:case"end":return e.stop()}},e,this)})),function(){return h.apply(this,arguments)})},{key:"refreshAll",value:(p=(0,w.default)(_.default.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.userId,r=void 0===n?this.host.currentUserId:n,o=t.organizationId;return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.host.requireUser(),O.decorator.clear(this._findAll),e.abrupt("return",this._findAll(r,o));case 3:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)})},{key:"_findAll",value:(d=(0,w.default)(_.default.mark(function e(u){var t,c,l=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this._pickOrganizationId();return _.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof u)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(u));e.next=2;break;case 2:if("string"!=typeof u)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(u));e.next=4;break;case 4:return e.next=6,this.host.api.userRoles.findAll(u,n);case 6:return t=e.sent,c={userRoles:[],productRoles:[]},t.forEach(function(e){var t=e.organization,n=e.product;if(t){var r=t.organization_id,o=l.host.organizations.getById(r),a=l.host.models.UserRoles.inject((0,b.default)({id:l._getOrganizationKey({organizationId:r,userId:u}),userId:u},t));o&&l.host.models.Organization.touch(o),c.userRoles.push(a)}else if(n){var i=n.product_id,s=l.host.models.ProductRoles.inject((0,b.default)({id:l._getProductKey({productId:i,userId:u}),userId:u},n));l.host.models.Product.inject({id:i}),c.productRoles.push(s)}}),e.abrupt("return",c);case 10:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"_pickOrganizationId",value:function(){var e=this.host.organizations.getAll();return 0===e.length?"placeholder":e[0].id}},{key:"getAllUserRoles",value:function(){return this.host.models.UserRoles.getAll()}},{key:"getByOrganizationId",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).userId,n=void 0===t?this.host.currentUserId:t;if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(e));if("string"!=typeof e)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));var r=this._getOrganizationKey({organizationId:e,userId:n});return this.host.models.UserRoles.get(r)}},{key:"_getOrganizationKey",value:function(e){var t=e.organizationId,n=e.userId,r=void 0===n?this.host.currentUserId:n;if(null==e||"string"!=typeof e.organizationId||void 0!==e.userId&&null!=e.userId&&"string"!=typeof e.userId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  organizationId: string;\n  userId?: ?string;\n}\n\nGot:\n"+s(e));if(null==e||"string"!=typeof e.organizationId||void 0!==e.userId&&null!=e.userId&&"string"!=typeof e.userId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  organizationId: string;\n  userId?: ?string;\n}\n\nGot:\n"+i(e));return"userRoles:"+r+":"+t}},{key:"getAllProductRoles",value:function(){return this.host.models.ProductRoles.getAll()}},{key:"getByProductId",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).userId,n=void 0===t?this.host.currentUserId:t;if("string"!=typeof e)throw new TypeError('Value of argument "productId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+s(e));if("string"!=typeof e)throw new TypeError('Value of argument "productId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+i(e));var r=this._getProductKey({productId:e,userId:n});return this.host.models.ProductRoles.get(r)}},{key:"_getProductKey",value:function(e){var t=e.productId,n=e.userId,r=void 0===n?this.host.currentUserId:n;if(null==e||"string"!=typeof e.productId||void 0!==e.userId&&null!=e.userId&&"string"!=typeof e.userId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  productId: string;\n  userId?: ?string;\n}\n\nGot:\n"+s(e));if(null==e||"string"!=typeof e.productId||void 0!==e.userId&&null!=e.userId&&"string"!=typeof e.userId)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  productId: string;\n  userId?: ?string;\n}\n\nGot:\n"+i(e));return"productRoles:"+r+":"+t}}]),o((l=S).prototype,"findAll",[a],(0,m.default)(l.prototype,"findAll"),l.prototype),o(l.prototype,"refreshAll",[u],(0,m.default)(l.prototype,"refreshAll"),l.prototype),o(l.prototype,"_findAll",[c],(0,m.default)(l.prototype,"_findAll"),l.prototype),l);function S(){return(0,E.default)(this,S),(0,T.default)(this,(S.__proto__||(0,x.default)(S)).apply(this,arguments))}t.default=j,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(n,r,e,t,o){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(n,r,a),a=null),a}function P(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,B.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=P(t[0],n);return t.every(function(e){return P(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return P(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,L.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,F.default)(e))+": "+P(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function z(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,B.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=z(t[0],n);return t.every(function(e){return z(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return z(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,L.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,F.default)(e))+": "+z(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,s,u,c,l,f,d,p,h,y,v,g,m,b,_,w,x,E,k,T,A,I,O,j,S,M,R,C,V,G,N,D,U,F=r(n(4)),L=r(n(5)),B=r(n(3)),$=r(n(11)),q=r(n(16)),H=r(n(47)),Y=r(n(19)),Z=r(n(10)),W=r(n(9)),K=r(n(20)),X=r(n(24)),Q=r(n(13)),J=r(n(12)),ee=r(n(6)),te=r(n(1)),ne=r(n(2)),re=r(n(8)),oe=r(n(7)),ae=r(n(116)),ie=r(n(156)),se=r(n(35)),ue=r(n(337)),ce=n(21),le=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(18)),fe=n(170),de=n(67),pe=n(46),he=r(n(45)),ye=r(n(15)),ve=(a=(0,ce.decorator)({serializeArguments:function(e){return""}}),i=(0,ce.decorator)(),s=(0,ce.decorator)(),u=(0,ce.decorator)(),c=(0,ce.decorator)(),l=(0,ce.decorator)(),f=(0,ce.decorator)(),d=(0,ce.decorator)(),v=ye.default,(0,oe.default)(ge,v),(0,ne.default)(ge,[{key:"mounted",value:function(){this._defaultOrganizationId=null,this._roleMemberIds={},this.host.models.Metadata.on("afterInject",this._onChangeMetadata),this.host.models.Metadata.on("afterEject",this._onChangeMetadata),this.host.models.Role.on("afterInject",this._onChangeRole),this.host.models.Role.on("afterEject",this._onRemoveRole)}},{key:"dispose",value:function(){this._defaultOrganizationId=null,this._roleMemberIds={},this.host.models.Metadata.removeListener("afterInject",this._onChangeMetadata),this.host.models.Metadata.removeListener("afterEject",this._onChangeMetadata),this.host.models.Role.removeListener("afterInject",this._onChangeRole),this.host.models.Role.removeListener("afterEject",this._onRemoveRole)}},{key:"signInWithMagicToken",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)throw new TypeError('Value of argument "magicToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(e));if("string"!=typeof e)throw new TypeError('Value of argument "magicToken" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(e));var n={Authorization:"magic-token "+e};return this._signInWithHeaders(n,t)}},{key:"signInWithApiKeyAndSecret",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof e)throw new TypeError('Value of argument "apiKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(e));if("string"!=typeof t)throw new TypeError('Value of argument "apiSecret" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));if("string"!=typeof e)throw new TypeError('Value of argument "apiKey" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(e));if("string"!=typeof t)throw new TypeError('Value of argument "apiSecret" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));var r=this.httpClient.getAuthHeaders({key:e,secret:t});return this._signInWithHeaders(r,n)}},{key:"signIn",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(e));if("string"!=typeof t)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(e));if("string"!=typeof t)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));(0,pe.isPhone)(e)&&(e=(0,pe.normalizePhoneUS)(e));var r={Authorization:this.getSignInAuthHeader(e,t)};return this._signInWithHeaders(r,n)}},{key:"_checkPartnerName",value:function(){if(!this.config.partnerName)throw new Error("`partnerName` must be supplied as a config option for `new TigerConnect.Client()`")}},{key:"_signInWithHeaders",value:(U=(0,W.default)(Z.default.mark(function e(t){var n,r,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkPartnerName(),e.next=3,this.host.api.users.signIn(t,a);case 3:return n=e.sent,r=this.host.models.User.inject(n.data.user),o=n.data.auth,e.abrupt("return",{auth:o,user:r});case 7:case"end":return e.stop()}},e,this)})),function(e){return U.apply(this,arguments)})},{key:"checkLogin",value:(D=(0,W.default)(Z.default.mark(function e(t){var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{udid:void 0};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=4;break;case 4:return this._checkPartnerName(),e.next=7,this.host.api.users.checkLogin(t,r);case 7:return n=e.sent,e.abrupt("return",n.data);case 9:case"end":return e.stop()}},e,this)})),function(e){return D.apply(this,arguments)})},{key:"signUp",value:(N=(0,W.default)(Z.default.mark(function e(){var t,n,r,o,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{udid:void 0,email:void 0,password:void 0,countryCode:void 0,version:void 0};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.users.signUp(a);case 2:return t=e.sent,n=this.host.models.User.inject(t.data.user),r=t.data.auth,o={user:n,auth:r},this.host.emit("signUp",o),e.abrupt("return",o);case 8:case"end":return e.stop()}},e,this)})),function(){return N.apply(this,arguments)})},{key:"signOut",value:(G=(0,W.default)(Z.default.mark(function e(){var t,n,r,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=o.fromServer,i=void 0!==a&&a,s=o.resetClient,u=void 0===s||s;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.host.isSignedIn){e.next=2;break}return e.abrupt("return",!1);case 2:return n=t=!1,this.host.emit("signingOut",{fromServer:i,resetClient:u}),r=void 0,e.prev=6,e.next=9,this.host.api.users.signOut();case 9:r=e.sent,t=!0,e.next=25;break;case 13:if(e.prev=13,e.t0=e.catch(6),n=!0,!this.httpClient.isUnauthorizedError(e.t0)){e.next=20;break}t=!0,e.next=25;break;case 20:if(!i){e.next=24;break}this.logger.error("error while logging out",e.t0,e.t0.stack),e.next=25;break;case 24:return e.abrupt("return",Y.default.reject(e.t0));case 25:return t&&(this.host._setCurrentUser(null),this.host._removeAuth()),this.host.emit("signedOut",{externalLogoutUrl:n?null:r.data.external_logout_url,fromServer:i,resetClient:u&&t,signedOut:t}),e.abrupt("return",t);case 28:case"end":return e.stop()}},e,this,[[6,13]])})),function(){return G.apply(this,arguments)})},{key:"createQRCode",value:(V=(0,W.default)(Z.default.mark(function e(){var t;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.qrCode.create();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)})),function(){return V.apply(this,arguments)})},{key:"findOrCreate",value:(C=(0,W.default)(Z.default.mark(function e(t){var n,r,o,a,i,s,u,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if(null!=c&&(null==c||void 0!==c.organizationId&&null!=c.organizationId&&"string"!=typeof c.organizationId))throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?{\n  organizationId?: ?string\n}\n\nGot:\n'+z(c));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if(null!=c&&(null==c||void 0!==c.organizationId&&null!=c.organizationId&&"string"!=typeof c.organizationId))throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?{\n  organizationId?: ?string\n}\n\nGot:\n'+P(c));e.next=8;break;case 8:if(n=c.organizationId,r=!1,n)return e.next=13,this.host.organizations._findAll();e.next=15;break;case 13:o=this.host.models.Organization.get(n),r=!!o&&o.isContacts;case 15:if(a=r&&((0,de.isEmail)(t)||(0,pe.isPhone)(t)),i=void 0,!a||t===this.host.currentUserId||this.getById(t))return e.next=20,this.find(t,{organizationId:n,ignoreNotFound:!0});e.next=21;break;case 20:i=e.sent;case 21:if(!i&&a)return e.next=24,this.host.api.users.lookup(t);e.next=37;break;case 24:if(s=e.sent){e.next=27;break}return e.abrupt("return",null);case 27:if(this.config.condensedReplays){e.next=33;break}return e.next=30,this.find(s.token,{organizationId:n});case 30:i=e.sent,e.next=37;break;case 33:(u=s.entity).conversationId=s.conversation_id,u.organizationId=s.organization_id,i=this.host.models.User.inject(u);case 37:return e.abrupt("return",i);case 38:case"end":return e.stop()}},e,this)})),function(e){return C.apply(this,arguments)})},{key:"signOutAllDevices",value:(R=(0,W.default)(Z.default.mark(function e(){var t;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.api.users.wipe(this.host.currentUserId);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e,this)})),function(){return R.apply(this,arguments)})},{key:"findMe",value:(M=(0,W.default)(Z.default.mark(function e(){var t,n,r,o,a,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,se.default)(i,{ignoreNotFound:!1}),this.host.requireUser(),e.next=4,this.host.api.users.findMe();case 4:if(t=e.sent)return t.entity&&(t.entity.organization_token=t.organization_id,t=t.entity),r=(n=t).metadata,o=n.organization_token,this._defaultOrganizationId=o,a=this.host.models.User.inject(t),r&&this.host.metadata.__injectMetadata(a.id,o,r),e.abrupt("return",a);e.next=14;break;case 14:if(i.ignoreNotFound){e.next=16;break}throw new le.NotFoundError(this.host.models.User.name,"me");case 16:case"end":return e.stop()}},e,this)})),function(){return M.apply(this,arguments)})},{key:"findDefaultOrganizationId",value:(S=(0,W.default)(Z.default.mark(function e(){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._defaultOrganizationId){e.next=3;break}return e.next=3,this.findMe();case 3:return e.abrupt("return",this._defaultOrganizationId);case 4:case"end":return e.stop()}},e,this)})),function(){return S.apply(this,arguments)})},{key:"findMyProfilesForAllOrganizations",value:(j=(0,W.default)(Z.default.mark(function e(){var t;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.host.organizations.findAll();case 2:return e.t0=function(e){return e.id},t=e.sent.map(e.t0),e.abrupt("return",this.findProfileForOrganizations(this.host.currentUserId,t));case 5:case"end":return e.stop()}},e,this)})),function(){return j.apply(this,arguments)})},{key:"find",value:(O=(0,W.default)(Z.default.mark(function e(t){var n,r,o,a,i,s,u,c,l,f,d,p,h,y,v,g,m=this,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if(null==b||null!=b&&(void 0===b.organizationId||null==b.organizationId||"string"==typeof b.organizationId)&&(void 0===b.organizationIds||null==b.organizationIds||Array.isArray(b.organizationIds)&&b.organizationIds.every(function(e){return"string"==typeof e}))){e.next=4;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?{\n  organizationId?: ?string;\n  organizationIds?: ?string[];\n}\n\nGot:\n'+z(b));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if(null==b||null!=b&&(void 0===b.organizationId||null==b.organizationId||"string"==typeof b.organizationId)&&(void 0===b.organizationIds||null==b.organizationIds||Array.isArray(b.organizationIds)&&b.organizationIds.every(function(e){return"string"==typeof e}))){e.next=8;break}throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?{\n  organizationId?: ?string;\n  organizationIds?: ?string[];\n}\n\nGot:\n'+P(b));case 8:if(b=(0,se.default)(b,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),n=this.host.models.User.get(t),o=!(r=void 0),!b.organizationIds){e.next=17;break}r=b.organizationIds,e.next=27;break;case 17:if(!b.organizationId){e.next=21;break}r=[b.organizationId],e.next=27;break;case 21:return o=!1,r=n?[].concat((0,H.default)(n.organizationIds)):[],e.next=25,this.findDefaultOrganizationId();case 25:a=e.sent,r.includes(a)||r.push(a);case 27:if(i=(0,q.default)({},b,{ignoreNotFound:!0}),s=[],!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected organizationIds to be iterable, got "+P(r));e.next=31;break;case 31:if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected organizationIds to be iterable, got "+z(r));e.next=33;break;case 33:for(c=!(u=!0),l=void 0,e.prev=36,f=(0,Q.default)(r);!(u=(d=f.next()).done);u=!0)p=d.value,s.push(this.__find(t,p,i));e.next=44;break;case 40:e.prev=40,e.t0=e.catch(36),c=!0,l=e.t0;case 44:e.prev=44,e.prev=45,!u&&f.return&&f.return();case 47:if(e.prev=47,c)throw l;e.next=50;break;case 50:return e.finish(47);case 51:return e.finish(44);case 52:return e.next=54,Y.default.all(s);case 54:if(h=e.sent,y=h.map(function(e){return e.data}).find(Boolean),v=!!h.find(function(e){return!e.cached}),y&&y.id&&(n=this.host.models.User.get(y.id)),!y||t===y.id||o){e.next=63;break}if(0<(g=(0,ie.default)(n.organizationIds,r)).length)return e.next=63,Y.default.all(g.map(function(e){return m.__find(t,e,i)}));e.next=63;break;case 63:if(this.host.models.User.removePlaceholder({entity:n,attrs:y}),!v||b.ignoreNotFound||y){e.next=66;break}throw new le.NotFoundError(this.host.models.User.name,t);case 66:return e.abrupt("return",n);case 67:case"end":return e.stop()}},e,this,[[36,40,44,52],[45,,47,51]])})),function(e){return O.apply(this,arguments)})},{key:"__find",value:(I=(0,W.default)(Z.default.mark(function e(t,n){var r,o,a,i,s,u,c=this,l=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(n));e.next=8;break;case 8:if(l=(0,se.default)(l,{bypassCache:!1,ignoreNotFound:!1}),r=this.host.models.User.get(t),l.bypassCache){e.next=16;break}if(r&&!r.$placeholder&&r.profileByOrganizationId&&r.profileByOrganizationId[n])return e.next=14,this.host.metadata.find(t,n,l);e.next=16;break;case 14:return this.host.models.User.touch(t),e.abrupt("return",{cached:!0,user:r});case 16:return e.next=18,this.host.api.users.find(t,{organizationId:n});case 18:if((o=e.sent)&&(o.entity&&(o.entity.organization_token=o.organization_id,o.entity.conversation_id=o.conversation_id,o=o.entity),o.token&&(o.id=o.token,delete o.token),i=(a=o).dnd_auto_forward_receivers,s=void 0===i?[]:i,u=a.metadata,s.forEach(function(e){return c.host.models.User.injectPlaceholder(e)}),o.dnd_auto_forward_receivers=s,r=this.host.models.User.inject(o),u&&("role"===u.feature_service?this.host.roles.__injectSearchResult({entity:r,metadata:u,organizationId:n}):this.host.metadata.__injectMetadata(r.id,n,u))),l.ignoreNotFound||o){e.next=22;break}throw new le.NotFoundError(this.host.models.User.name,t);case 22:return e.abrupt("return",{cached:!1,data:o,user:r});case 23:case"end":return e.stop()}},e,this)})),function(e,t){return I.apply(this,arguments)})},{key:"findProfileForOrganizations",value:(A=(0,W.default)(Z.default.mark(function e(t,n){var r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=4;break}throw new TypeError('Value of argument "organizationIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+z(n));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if(Array.isArray(n)&&n.every(function(e){return"string"==typeof e})||Array.isArray(n)&&n.every(function(e){return e instanceof Object})){e.next=8;break}throw new TypeError('Value of argument "organizationIds" violates contract.\n\nExpected:\nstring[] | Object[]\n\nGot:\n'+P(n));case 8:return o=(0,se.default)(o,{bypassCache:!1,ignoreNotFound:!1}),e.next=11,this.find(t,(0,q.default)({},o,{organizationIds:n}));case 11:return r=e.sent,e.abrupt("return",r?r.profileByOrganizationId:r);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return A.apply(this,arguments)})},{key:"findProfileForOrganization",value:(T=(0,W.default)(Z.default.mark(function e(t,n){var r,o,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+z(n));case 4:if("string"!=typeof t)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if("string"==typeof n||n instanceof Object){e.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+P(n));case 8:return a=(0,se.default)(a,{bypassCache:!1,ignoreNotFound:!0}),"string"!=typeof n&&(n=n.id),e.next=12,this.find(t,(0,q.default)({},a,{organizationId:n}));case 12:return r=e.sent,o=r&&r.profileByOrganizationId&&r.profileByOrganizationId[n],e.abrupt("return",o||null);case 15:case"end":return e.stop()}},e,this)})),function(e,t){return T.apply(this,arguments)})},{key:"ensureUsers",value:(k=(0,W.default)(Z.default.mark(function e(t,n){var r,o,a,i,s,u,c,l;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=2;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+z(t));case 2:if("string"==typeof n||n instanceof Object){e.next=4;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+z(n));case 4:if(Array.isArray(t)&&t.every(function(e){return"string"==typeof e||e instanceof Object})){e.next=6;break}throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string | Object>\n\nGot:\n'+P(t));case 6:if("string"==typeof n||n instanceof Object){e.next=8;break}throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring | Object\n\nGot:\n'+P(n));case 8:if(this.host.requireUser(),"string"!=typeof n&&(n=n.id),r=[],!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+P(t));e.next=13;break;case 13:if(!t||"function"!=typeof t[J.default]&&!Array.isArray(t))throw new TypeError("Expected ids to be iterable, got "+z(t));e.next=15;break;case 15:for(a=!(o=!0),i=void 0,e.prev=18,s=(0,Q.default)(t);!(o=(u=s.next()).done);o=!0)c=u.value,r.push(this.find(c,{organizationId:n,ignoreNotFound:!0}));e.next=26;break;case 22:e.prev=22,e.t0=e.catch(18),a=!0,i=e.t0;case 26:e.prev=26,e.prev=27,!o&&s.return&&s.return();case 29:if(e.prev=29,a)throw i;e.next=32;break;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.next=36,Y.default.all(r);case 36:return l=e.sent,e.abrupt("return",l);case 38:case"end":return e.stop()}},e,this,[[18,22,26,34],[27,,29,33]])})),function(e,t){return k.apply(this,arguments)})},{key:"refresh",value:(E=(0,W.default)(Z.default.mark(function e(t){var n;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.find(t,{ignoreNotFound:!0,bypassCache:!0});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)})),function(e){return E.apply(this,arguments)})},{key:"update",value:(x=(0,W.default)(Z.default.mark(function e(t){var n,r,o,a,i,s=t.firstName,u=t.lastName,c=t.displayName,l=t.status,f=t.dnd,d=t.dndText,p=t.avatarFile,h=t.removeAvatar,y=arguments;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==y[0]||void 0!==y[0].firstName&&null!=y[0].firstName&&"string"!=typeof y[0].firstName||void 0!==y[0].lastName&&null!=y[0].lastName&&"string"!=typeof y[0].lastName||void 0!==y[0].displayName&&null!=y[0].displayName&&"string"!=typeof y[0].displayName||void 0!==y[0].status&&null!=y[0].status&&"string"!=typeof y[0].status||void 0!==y[0].dnd&&null!=y[0].dnd&&"boolean"!=typeof y[0].dnd||void 0!==y[0].dndText&&null!=y[0].dndText&&"string"!=typeof y[0].dndText||!(void 0===y[0].avatarFile||null==y[0].avatarFile||y[0].avatarFile instanceof Object)||void 0!==y[0].removeAvatar&&null!=y[0].removeAvatar&&"boolean"!=typeof y[0].removeAvatar)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  firstName?: ?string;\n  lastName?: ?string;\n  displayName?: ?string;\n  status?: ?string;\n  dnd?: ?boolean;\n  dndText?: ?string;\n  avatarFile?: ?Object;\n  removeAvatar?: ?boolean;\n}\n\nGot:\n"+z(y[0]));e.next=2;break;case 2:if(null==y[0]||void 0!==y[0].firstName&&null!=y[0].firstName&&"string"!=typeof y[0].firstName||void 0!==y[0].lastName&&null!=y[0].lastName&&"string"!=typeof y[0].lastName||void 0!==y[0].displayName&&null!=y[0].displayName&&"string"!=typeof y[0].displayName||void 0!==y[0].status&&null!=y[0].status&&"string"!=typeof y[0].status||void 0!==y[0].dnd&&null!=y[0].dnd&&"boolean"!=typeof y[0].dnd||void 0!==y[0].dndText&&null!=y[0].dndText&&"string"!=typeof y[0].dndText||!(void 0===y[0].avatarFile||null==y[0].avatarFile||y[0].avatarFile instanceof Object)||void 0!==y[0].removeAvatar&&null!=y[0].removeAvatar&&"boolean"!=typeof y[0].removeAvatar)throw new TypeError("Value of argument 0 violates contract.\n\nExpected:\n{\n  firstName?: ?string;\n  lastName?: ?string;\n  displayName?: ?string;\n  status?: ?string;\n  dnd?: ?boolean;\n  dndText?: ?string;\n  avatarFile?: ?Object;\n  removeAvatar?: ?boolean;\n}\n\nGot:\n"+P(y[0]));e.next=4;break;case 4:return this.host.requireUser(),r=(n={firstName:s,lastName:u,displayName:c,status:l,dnd:f,dndText:d,avatarFile:p,removeAvatar:h},ue.default).call(n,function(e,t){return void 0===e}),e.next=8,this.host.api.users.update(this.host.currentUserId,r);case 8:return o=e.sent,a=(0,ae.default)(r,"removeAvatar","avatarFile"),h?a.avatarUrl=null:void 0!==o.avatarUrl&&(a.avatarUrl=o.avatarUrl),i=this.host.models.User.inject((0,q.default)({id:this.host.currentUserId},a)),e.abrupt("return",i);case 13:case"end":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)})},{key:"updatePassword",value:(w=(0,W.default)(Z.default.mark(function e(t,n){var r;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "currentPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "newPassword" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(n));e.next=8;break;case 8:return this.host.requireUser(),r=this.host.api.users.updatePassword(this.host.currentUserId,t,n,this.config.productKey),e.abrupt("return",r);case 11:case"end":return e.stop()}},e,this)})),function(e,t){return w.apply(this,arguments)})},{key:"setAutoForward",value:(_=(0,W.default)(Z.default.mark(function e(t,n){var r;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if("string"!=typeof n)throw new TypeError('Value of argument "receiverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if("string"!=typeof n)throw new TypeError('Value of argument "receiverId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(n));e.next=8;break;case 8:return this.host.requireUser(),r=this.host.currentUser.dnd,e.next=12,this.host.api.users.setAutoForward(this.host.currentUserId,t,{dnd:r,receiverId:n});case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return _.apply(this,arguments)})},{key:"removeAutoForward",value:(b=(0,W.default)(Z.default.mark(function e(t){return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=4;break;case 4:return this.host.requireUser(),e.next=7,this.host.api.users.removeAutoForward(this.host.currentUserId,t);case 7:return e.abrupt("return",!0);case 8:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"setEulaAccepted",value:(m=(0,W.default)(Z.default.mark(function e(t,n){var r;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if("boolean"!=typeof n)throw new TypeError('Value of argument "accept" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+z(n));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if("boolean"!=typeof n)throw new TypeError('Value of argument "accept" violates contract.\n\nExpected:\nboolean\n\nGot:\n'+P(n));e.next=8;break;case 8:return this.host.requireUser(),e.next=11,this.host.api.users.setEulaAccepted(this.host.currentUserId,t,n);case 11:return r=e.sent,e.abrupt("return",r);case 13:case"end":return e.stop()}},e,this)})),function(e,t){return m.apply(this,arguments)})},{key:"setAwayMessage",value:(g=(0,W.default)(Z.default.mark(function e(t){var n,r,o,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));e.next=2;break;case 2:if(null!=a&&(null==a||"boolean"!=typeof a.dnd||void 0!==a.dndText&&null!=a.dndText&&"string"!=typeof a.dndText))throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?{\n  dnd: boolean;\n  dndText?: ?string;\n}\n\nGot:\n'+z(a));e.next=4;break;case 4:if("string"!=typeof t)throw new TypeError('Value of argument "organizationId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));e.next=6;break;case 6:if(null!=a&&(null==a||"boolean"!=typeof a.dnd||void 0!==a.dndText&&null!=a.dndText&&"string"!=typeof a.dndText))throw new TypeError('Value of argument "options" violates contract.\n\nExpected:\n?{\n  dnd: boolean;\n  dndText?: ?string;\n}\n\nGot:\n'+P(a));e.next=8;break;case 8:return n=a.dnd,r=a.dndText,o=void 0===r?"":r,this.host.requireUser(),e.next=12,this.host.api.users.setAwayMessage(this.host.currentUserId,t,{dnd:n,dndText:o});case 12:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"getSignInAuthHeader",value:function(e,t){if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(e));if("string"!=typeof t)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(t));if("string"!=typeof e)throw new TypeError('Value of argument "userId" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(e));if("string"!=typeof t)throw new TypeError('Value of argument "password" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(t));return this.host.api.users.getSignInAuthHeader(this.config.productKey,e,t)}},{key:"getAll",value:function(){return this.host.models.User.getAll()}},{key:"getById",value:function(e){if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+z(e));if("string"!=typeof e)throw new TypeError('Value of argument "id" violates contract.\n\nExpected:\nstring\n\nGot:\n'+P(e));return this.host.models.User.get(e)}},{key:"getMultiById",value:function(e){if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+z(e));if(!Array.isArray(e)||!e.every(function(e){return"string"==typeof e}))throw new TypeError('Value of argument "ids" violates contract.\n\nExpected:\nArray<string>\n\nGot:\n'+P(e));return this.host.models.User.getMulti(e)}},{key:"_onChangeCurrentUserRole",value:function(e){var t=e.botUser;if(t){var n=this.host.roles._roleConversations[t.id];if(n){if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected roleConversations to be iterable, got "+P(n));if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected roleConversations to be iterable, got "+z(n));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,Q.default)(n);!(r=(i=s.next()).done);r=!0){var u=i.value,c=!1;if(!(y=u.content)||"function"!=typeof y[J.default]&&!Array.isArray(y))throw new TypeError("Expected _conversation$content to be iterable, got "+P(y));if(!y||"function"!=typeof y[J.default]&&!Array.isArray(y))throw new TypeError("Expected _conversation$content to be iterable, got "+z(y));var l=!0,f=!1,d=void 0;try{for(var p,h=(0,Q.default)(y);!(l=(p=h.next()).done);l=!0){var y,v=p.value;v.shouldEnsureRecipientStatus=!0,this.host.models.Message.inject(v),c=!0}}catch(e){f=!0,d=e}finally{try{!l&&h.return&&h.return()}finally{if(f)throw d}}c||this.host.models.Conversation.inject(u)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}}}}},{key:"reactToUserPreferencesEvent",value:function(e){this.emit("preferences:change",he.default.camelizeObject(e))}}]),y=h=ge,h.PROFILE_ATTRIBUTES_PER_ORG=fe.PROFILE_ATTRIBUTES_PER_ORG,o((p=y).prototype,"signOut",[a],(0,$.default)(p.prototype,"signOut"),p.prototype),o(p.prototype,"findOrCreate",[i],(0,$.default)(p.prototype,"findOrCreate"),p.prototype),o(p.prototype,"signOutAllDevices",[s],(0,$.default)(p.prototype,"signOutAllDevices"),p.prototype),o(p.prototype,"findMe",[u],(0,$.default)(p.prototype,"findMe"),p.prototype),o(p.prototype,"findMyProfilesForAllOrganizations",[c],(0,$.default)(p.prototype,"findMyProfilesForAllOrganizations"),p.prototype),o(p.prototype,"find",[l],(0,$.default)(p.prototype,"find"),p.prototype),o(p.prototype,"__find",[f],(0,$.default)(p.prototype,"__find"),p.prototype),o(p.prototype,"refresh",[d],(0,$.default)(p.prototype,"refresh"),p.prototype),p);function ge(){var e,t,C,n,r,o,s=this;(0,te.default)(this,ge);for(var a=arguments.length,i=Array(a),u=0;u<a;u++)i[u]=arguments[u];return t=C=(0,re.default)(this,(e=ge.__proto__||(0,ee.default)(ge)).call.apply(e,[this].concat(i))),C.PROFILE_ATTRIBUTES_PER_ORG=fe.PROFILE_ATTRIBUTES_PER_ORG,C._setMembersOnEntity=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"members",n=e[1<arguments.length&&void 0!==arguments[1]?arguments[1]:"memberIds"],r=e[t];if(n){if(r?r.length=0:r=[],!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected memberIds to be iterable, got "+P(n));if(!n||"function"!=typeof n[J.default]&&!Array.isArray(n))throw new TypeError("Expected memberIds to be iterable, got "+z(n));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,Q.default)(n);!(o=(s=u.next()).done);o=!0){var c=s.value,l=C.host.models.User.get(c);l&&r.push(l)}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}}else r=null;e[t]=r},C._injectPatientEntity=function(e,t,n){var r="patient:"+t;if(e.id=r,e.organizationId=n,e.userId=t,C.host.models.Patient.inject(e),e.patient_contacts){if(!(c=e.patient_contacts)||"function"!=typeof c[J.default]&&!Array.isArray(c))throw new TypeError("Expected _patient$patient_cont to be iterable, got "+P(c));if(!c||"function"!=typeof c[J.default]&&!Array.isArray(c))throw new TypeError("Expected _patient$patient_cont to be iterable, got "+z(c));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,Q.default)(c);!(o=(s=u.next()).done);o=!0){var c,l=s.value,f=l.entity?l.entity:l,d=f.token||f.id;f.id=d,f.patientId=r,C.host.models.User.inject(f)}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}}},C._injectPatientContactEntity=function(e,t){e.entity&&(e=e.entity);var n=e.metadata,r={editVersion:n.edit_version,id:"patientContact:"+e.id,organizationId:t,patientDob:n.patient_dob,patientGender:n.patient_gender,patientId:"patient:"+n.patient_id,patientMrn:n.patient_mrn,phoneNumber:n.phone_number,relationName:n.relation_name,smsOptedOut:n.sms_opted_out,userId:e.id};C.host.models.PatientContact.inject(r)},C._onChangeMetadata=function(e,t){var n=t.entityId,r=C.host.models.User.get(n);r&&C.host.models.User.inject(r)},C._onChangeRole=function(e,t){var n=C.host.currentUserId,r=t.botUserId,o=t.memberIds;o=o||[],r&&C.host.models.User.injectPlaceholder({id:r,botRole:t});var a={},i=C._roleMemberIds[t.id];if(i){if(!i||"function"!=typeof i[J.default]&&!Array.isArray(i))throw new TypeError("Expected lastRoleMemberIds to be iterable, got "+P(i));if(!i||"function"!=typeof i[J.default]&&!Array.isArray(i))throw new TypeError("Expected lastRoleMemberIds to be iterable, got "+z(i));var s=!0,u=!1,c=void 0;try{for(var l,f=(0,Q.default)(i);!(s=(l=f.next()).done);s=!0){var d=l.value,p=C.host.models.User.get(d);if(p&&!o.includes(d)){var h=p.roles,y=h.indexOf(t);-1<y&&(h.splice(y,1),a[d]=h)}}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}if(!(C._roleMemberIds[t.id]=o)||"function"!=typeof o[J.default]&&!Array.isArray(o))throw new TypeError("Expected memberIds to be iterable, got "+P(o));if(!o||"function"!=typeof o[J.default]&&!Array.isArray(o))throw new TypeError("Expected memberIds to be iterable, got "+z(o));var v=!0,g=!1,m=void 0;try{for(var b,_=(0,Q.default)(o);!(v=(b=_.next()).done);v=!0){var w=b.value,x=C.host.models.User.get(w),E=x?x.roles:[];E.includes(t)||(E.push(t),a[w]=E)}}catch(e){g=!0,m=e}finally{try{!v&&_.return&&_.return()}finally{if(g)throw m}}if(!(j=(0,X.default)(a))||"function"!=typeof j[J.default]&&!Array.isArray(j))throw new TypeError("Expected _Object$entries to be iterable, got "+P(j));if(!j||"function"!=typeof j[J.default]&&!Array.isArray(j))throw new TypeError("Expected _Object$entries to be iterable, got "+z(j));var k=!0,T=!1,A=void 0;try{for(var I,O=(0,Q.default)(j);!(k=(I=O.next()).done);k=!0){var j,S=(0,K.default)(I.value,2),M=S[0],R=S[1];C.host.models.User.injectPlaceholder({id:M,roles:R}),M===n&&C._onChangeCurrentUserRole(t)}}catch(e){T=!0,A=e}finally{try{!k&&O.return&&O.return()}finally{if(T)throw A}}},C._onRemoveRole=function(e,t){var n=t.botUserId;n&&C.host.models.User.injectPlaceholder({id:n,botRole:null});var r=C._roleMemberIds[t.id];if(r){if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected lastRoleMemberIds to be iterable, got "+P(r));if(!r||"function"!=typeof r[J.default]&&!Array.isArray(r))throw new TypeError("Expected lastRoleMemberIds to be iterable, got "+z(r));var o=!0,a=!1,i=void 0;try{for(var s,u=(0,Q.default)(r);!(o=(s=u.next()).done);o=!0){var c=s.value,l=C.host.models.User.get(c);if(l){var f=l.roles,d=f.indexOf(t);-1<d&&(f.splice(d,1),C.host.models.User.inject(l))}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}delete C._roleMemberIds[t.id]}},C.getPreferences=(o=(0,W.default)(Z.default.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:C.host.currentUserId;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new le.ValidationError("userId","required");case 2:return e.next=4,C.host.api.users.getPreferences(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,s)})),function(){return o.apply(this,arguments)}),C.editPreferences=(r=(0,W.default)(Z.default.mark(function e(t){var n=t.quickReplies,r=void 0===n?[]:n,o=t.organizationId,a=t.userId,i=void 0===a?C.host.currentUserId:a;return Z.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new le.ValidationError("quickReplies","required");case 2:if(o){e.next=4;break}throw new le.ValidationError("organizationId","required");case 4:if(i){e.next=6;break}throw new le.ValidationError("userId","required");case 6:return e.next=8,C.host.api.users.editPreferences({organizationId:o,quickReplies:r,userId:i});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,s)})),function(e){return r.apply(this,arguments)}),n=t,(0,re.default)(C,n)}t.default=ve,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Users=t.UserRoles=t.TypingStatus=t.Teams=t.Search=t.ScheduledMessages=t.RoleTags=t.Roles=t.Products=t.Presence=t.Patients=t.Organizations=t.Notifications=t.NotificationRouter=t.Mute=t.Metadata=t.MessageTemplates=t.Messages=t.Groups=t.Forums=t.Events=t.EventRouter=t.Escalations=t.Entities=t.DistributionLists=t.Conversations=t.Calls=void 0;var o=r(n(495)),a=r(n(496)),i=r(n(497)),s=r(n(498)),u=r(n(499)),c=r(n(500)),l=r(n(271)),f=r(n(501)),d=r(n(502)),p=r(n(504)),h=r(n(503)),y=r(n(505)),v=r(n(506)),g=r(n(507)),m=r(n(508)),b=r(n(509)),_=r(n(510)),w=r(n(511)),x=r(n(512)),E=r(n(514)),k=r(n(513)),T=r(n(515)),A=r(n(516)),I=r(n(517)),O=r(n(518)),j=r(n(519)),S=r(n(520));t.Calls=o.default,t.Conversations=a.default,t.DistributionLists=i.default,t.Entities=s.default,t.Escalations=u.default,t.EventRouter=c.default,t.Events=l.default,t.Forums=f.default,t.Groups=d.default,t.Messages=p.default,t.MessageTemplates=h.default,t.Metadata=y.default,t.Mute=v.default,t.NotificationRouter=g.default,t.Notifications=m.default,t.Organizations=b.default,t.Patients=_.default,t.Presence=w.default,t.Products=x.default,t.Roles=E.default,t.RoleTags=k.default,t.ScheduledMessages=T.default,t.Search=A.default,t.Teams=I.default,t.TypingStatus=O.default,t.UserRoles=j.default,t.Users=S.default},function(ne,re,oe){(function(G){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function N(e,t){return"organization"===e&&"conversations"===t}function D(e,t,n){for(var r=(2<arguments.length&&void 0!==n?n:{}).previousValue,o=[],a={},i=[],s=0,u=!1,c=1/0,l=0;l<e.length;l++){var f=e[l],d=f._origIndex,p=f.id,h=f.highestSortNumber,y={_origIndex:d,id:p,highestSortNumber:h,sortNumber:f.sortNumber};if(o.push(y),a[p]=(a[p]||0)+1,1<a[p]&&s++,r&&r.id===p&&r.highestSortNumber===h&&c<h||!r&&c<h){u=!0;var v=e[l-1],g=v._origIndex,m=v.id,b=v.highestSortNumber,_=v.sortNumber;i.push({_origIndex:g,id:m,highestSortNumber:b,sortNumber:_}),i.push(y)}c=h}return{copy:o,duplicateCount:s,outOfOrder:u,outOfOrderElements:i}}function U(e,t,n,r,o){var a=4<arguments.length&&void 0!==o?o:{},i=a.action,s=a.previousValue,u=a.source,c=[],l={},f=0;if(!n||"function"!=typeof n[R.default]&&!Array.isArray(n))throw new TypeError("Expected currModels to be iterable, got "+j(n));if(!n||"function"!=typeof n[R.default]&&!Array.isArray(n))throw new TypeError("Expected currModels to be iterable, got "+S(n));var d=!0,p=!1,h=void 0;try{for(var y,v=(0,M.default)(n);!(d=(y=v.next()).done);d=!0){var g=y.value,m=g._origIndex,b=g.id,_=g.highestSortNumber,w=g.sortNumber;c.push({_origIndex:m,id:b,highestSortNumber:_,sortNumber:w}),l[b]=(l[b]||0)+1,1<l[b]&&f++}}catch(e){p=!0,h=e}finally{try{!d&&v.return&&v.return()}finally{if(p)throw h}}if(0<t||0<f){var x=r._origIndex,E=r.id,k=r.highestSortNumber,T=r.sortNumber;return console.error(i+"\n"+u+"\nBefore duplicate count: "+t+"\nAfter duplicate count: "+f,"\nBefore elements ("+e.length+"): ",e,"\nAfter elements ("+c.length+"): ",c,"\nElement info: ",{_origIndex:x,id:E,highestSortNumber:k,sortNumber:T}),s&&console.error("Previous value",{_origIndex:s._origIndex,id:s.id,highestSortNumber:s.highestSortNumber,sortNumber:s.sortNumber}),console.log(new Error("Duplicate items stack trace")),{logged:!0,currCopy:c,counts:l}}return{logged:!1,currCopy:c,counts:l}}function F(e,t,n,r){var o=3<arguments.length&&void 0!==r?r:{},a=o.action,i=o.previousValue,s=o.source,u=t._origIndex,c=t.id,l=t.highestSortNumber,f=t.sortNumber;0===K&&t.$entityClass.emit("displayInfoDialog","We have automatically corrected a Conversation Store problem, please reach out to Mike O to help us debug it further."),G.duplicateDebug.outOfOrderElements[K]=e,console.error(a+"\n"+s+"\n\nBefore elements (also saved in window.duplicateDebug.outOfOrderElements["+K+++"]): ",e,"\nOut of order elements: ",n,"\nElement info: ",{_origIndex:u,id:c,highestSortNumber:l,sortNumber:f}),i&&console.error("Previous value",{_origIndex:i._origIndex,id:i.id,highestSortNumber:i.highestSortNumber,sortNumber:i.sortNumber}),console.log(new Error("Elements out of order stack trace"))}function j(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,s.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=j(t[0],n);return t.every(function(e){return j(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return j(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+j(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}function S(t,n){if(void 0===n&&(n=0),n+=1,null===t)return"null";if(void 0===t)return"void";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return void 0===t?"undefined":(0,s.default)(t);if(Array.isArray(t)){if(0<t.length){if(4<n)return"[...]";var r=S(t[0],n);return t.every(function(e){return S(e,n)===r})?r.trim()+"[]":"["+t.slice(0,15).map(function(e){return S(e,n)}).join(", ")+(15<=t.length?", ...":"")+"]"}return"Array"}var e=(0,c.default)(t);if(!e.length)return t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name:"Object";if(4<n)return"{...}";var o="  ".repeat(n-1),a=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,i.default)(e))+": "+S(t[e],n)+";"}).join("\n  "+o);return 15<=e.length&&(a+="\n  "+o+"..."),t.constructor&&t.constructor.name&&"Object"!==t.constructor.name?t.constructor.name+" {\n  "+o+a+"\n"+o+"}":"{\n  "+o+a+"\n"+o+"}"}Object.defineProperty(re,"__esModule",{value:!0}),re.default=void 0;var i=e(oe(4)),s=e(oe(3)),u=e(oe(16)),c=e(oe(5)),n=e(oe(20)),t=e(oe(54)),v=e(oe(276)),l=e(oe(275)),r=e(oe(537)),f=e(oe(538)),g=e(oe(38)),a=e(oe(1)),o=e(oe(2)),M=e(oe(13)),R=e(oe(12)),d=e(oe(94)),p=e(oe(163)),h=e(oe(368)),y=e(oe(115)),m=e(oe(116)),b=e(oe(889)),_=e(oe(891)),w=e(oe(35)),L=e(oe(162)),B=e(oe(878)),x=e(oe(65)),E=e(oe(876)),k=e(oe(238)),T=e(oe(235)),A=e(oe(112)),I=e(oe(701)),O=e(oe(211)),C=e(oe(704)),P=e(oe(212)),z=e(oe(786)),$=e(oe(87)),V=e(oe(338)),q=e(oe(339)),H=e(oe(41)),Y=oe(29),Z={computed:{},defaultValues:null,idAttribute:"id",methods:{},parseAttrs:A.default,relations:{belongsTo:{},hasMany:{}}},W=(0,d.default)("NOT_PROVIDED"),K=0,X={initRelations:!(G.duplicateDebug={initRelations:{},outOfOrderElements:[],setHighestSortNumber:{conversationId:null},updateRelations:{}}),updateRelationsAdd:!1,updateRelationsRemove:!1},Q=((0,o.default)(J,null,[{key:"create",value:function(e,t,n){return new this(e,t,n)}}]),(0,o.default)(J,[{key:"__initRelations",value:function(){var r=this,O=this,e=(0,k.default)(this.options.relations.belongsTo,function(e,t,n){e[n]={get:function(){return O.store.get(t.type,this[t.foreignKey])},set:function(e){this[t.foreignKey]=O.store.resolveId(t.type,e)}}},{});(0,g.default)(this.options.computed,e);var t=(0,k.default)(this.options.relations.hasMany,function(e,t,x){var E=t.filter,k=t.foreignKey,n=t.sortBy,T=t.type,A=r.__getSorted(n),I=r.options;e[x]={get:function(){if(this.$$transientAttrs.relations||(this.$$transientAttrs.relations={}),this.$$transientAttrs.relations[x])return this.$$transientAttrs.relations[x];var e=[],t=O.store.models[T];if(t.hasManySortFields){if(!(s=t.getAll())||"function"!=typeof s[R.default]&&!Array.isArray(s))throw new TypeError("Expected _entityModel$getAll to be iterable, got "+j(s));if(!s||"function"!=typeof s[R.default]&&!Array.isArray(s))throw new TypeError("Expected _entityModel$getAll to be iterable, got "+S(s));var n=!0,r=!1,o=void 0;try{for(var a,i=(0,M.default)(s);!(n=(a=i.next()).done);n=!0){var s,u=a.value;if(u[k]===this[O.idAttribute]&&(!E||E(u,this))){var c=(0,B.default)(this.previousHasManySortValues,u[this.idAttribute])?this.previousHasManySortValues[u[this.idAttribute]]:W;t.previousHasManySortValues[u[t.idAttribute]]=(0,L.default)(u,t.hasManySortFields);var l=I.host,f=[],d=0;if(l.config.condensedReplays&&N(O.name,x)){var p=D(e,u,{previousValue:c===W?void 0:c}),h=p.copy,y=p.duplicateCount,v=p.outOfOrder,g=p.outOfOrderElements;f=h,d=y,v&&(F(f,u,g,{action:"__initRelations - "+(c===W?"sorted.add":"sorted.update"),previousValue:c===W?void 0:c,source:"Elements are out of order in "+O.name+"."+x}),e.sort(A.cmp))}if(c===W?A.add(e,u):A.update(e,u,{previousValue:c}),l.config.condensedReplays&&!X.initRelations&&N(O.name,x)){var m=U(f,d,e,u,{action:"__initRelations - "+(c===W?"sorted.add":"sorted.update"),previousValue:c===W?void 0:c,source:"There are duplicates in "+O.name+"."+x}),b=m.logged,_=m.currCopy,w=m.counts;(X.initRelations=b)&&(G.duplicateDebug.initRelations={beforeElements:f,afterElements:_,counts:w})}}}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}}return this.$$transientAttrs.relations[x]=e},set:function(e){}}},{});(0,g.default)(this.options.computed,t)}},{key:"__getSorted",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[[this.idAttribute,"asc"]],t=(0,Y.generateComparator)(e);return new Y.SortedArray(t)}},{key:"__initTransientAttrs",value:function(){var e=this,t=this,r={$$transientAttrs:{enumerable:!1,get:function(){var e=this[t.idAttribute];return t.transientAttrsStore[e]||(t.transientAttrsStore[e]={})}}},o={};this.options.transientAttrs&&this.options.transientAttrs.forEach(function(n){e.options.defaultValues&&n in e.options.defaultValues&&(o[n]=(0,Y.jsonCloneDeep)(e.options.defaultValues[n]),delete e.options.defaultValues[n]),r[n]={get:function(){return n in this.$$transientAttrs?this.$$transientAttrs[n]:n in o?this.$$transientAttrs[n]=o[n]:void 0},set:function(e){var t=G.duplicateDebug.setHighestSortNumber;"conversation"!==this.$entityType||"highestSortNumber"!==n||(0,f.default)(t)||(t.conversationId=this.id,t.highestSortNumber=e,t.stackTrace=new Error("Set Conversation.highestSortNumber")),this.$$transientAttrs[n]=e}}}),(0,g.default)(this.options.computed,r)}},{key:"createInstance",value:function(e){1<arguments.length&&void 0!==arguments[1]&&!arguments[1]||(e=this.parseAttrs(e));var t=e[this.idAttribute];if(this.entitiesById[t]||this.entitiesByServerId[t])throw new Error("called createInstance on an existing instance");return this.__wireInstance(e)}},{key:"__wireInstance",value:function(t){var o=this;this.options.defaultValues&&(0,w.default)(t,(0,Y.jsonCloneDeep)(this.options.defaultValues));var n={};this._writablePropertyKeys.forEach(function(e){(0,Y.isConfigurableProperty)(t,e)&&(n[e]=t[e],delete t[e])}),(0,r.default)(t,this.options.computed),(0,g.default)(t,n),this.options.instanceEvents&&(0,g.default)(t,H.default.prototype),(0,g.default)(t,this.options.methods),(0,g.default)(t,{toPlainObject:function(e){var t=this,n={};o._computedKeys.forEach(function(e){return n[e]=t[e]});var r=(0,g.default)({},this,n);return delete r.setMaxListeners,delete r.emit,delete r.addListener,delete r.on,delete r.once,delete r.removeListener,delete r.removeAllListeners,delete r.listeners,delete r.listenerCount,delete r.off,delete r.toPlainObject,delete r._events,delete r._maxListeners,r}});var e=t[this.idAttribute];return!e||"serverId"in t||(t.serverId=e),this.options.beforeCreateInstance&&this.options.beforeCreateInstance(t),t}},{key:"inject",value:function(e){var t=void 0,n=void 0;if(this.is(e)){if(n=e,t=this.resolveId(n),this.entitiesById[t]){if(this.__beforeInject(n),this.__register(t,n),this.options.afterAssignment&&this.options.afterAssignment(n),this.__addToHasManyRelationships(n),this.options.afterInject&&this.options.afterInject(n),this.emit("afterInject",this,n),"conversation"===n.$entityType){var r=G.duplicateDebug.setHighestSortNumber;(0,f.default)(r)||null===r.conversationId||(r.conversationId!==n.id?((0,l.default)(r),console.error("Injected a different conversation after setting Conversation.highestSortNumber.\nCheck `window.duplicateDebug.setHighestSortNumber` for details.")):r.conversationId=null)}return n}(0,f.default)(G.duplicateDebug.setHighestSortNumber)||"conversation"!==n.$entityType||(G.duplicateDebug.setHighestSortNumber.conversationId=null)}if(!n&&(e=this.parseAttrs(e),t=this.resolveId(e),!this.isValidId(t)))throw new Error("'"+this.idAttribute+"' is required");var o=!1,a=this.entitiesById[t]||this.entitiesByServerId[t];return n?(a||(o=!0),this.__beforeInject(n)):a?(n=a,this.__beforeInject(e,n),(0,g.default)(n,e)):(o=!0,n=this.__wireInstance(e),this.__beforeInject(n)),this.__register(t,n),this.options.afterAssignment&&this.options.afterAssignment(n),this.__addToHasManyRelationships(n),this.options.afterInject&&this.options.afterInject(n),this.emit("afterInject",this,n),o&&(this.options.afterCreate&&this.options.afterCreate(n),this.emit("afterCreate",this,n)),n}},{key:"__beforeInject",value:function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=n[0],a=n[1];!a||"serverId"in o||(o.serverId=a.serverId),this.options.beforeInject&&(e=this.options).beforeInject.apply(e,n),this.emit("beforeInject",this,o)}},{key:"replaceExisting",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).instance,n=this.options.idAttribute;if(this.is(e))throw new Error("cannot call replaceExisting() on an instance; should be plain object");if(t&&!this.is(t))throw new Error("provided 'instance' option is not an instance of this model");e=this.parseAttrs(e);var r=this.resolveId(e);if(!this.isValidId(r))throw new Error("'"+n+"' is required");var o=r,a=void 0;if(t){var i=this.resolveId(t);o!==i&&(this.entitiesById[o]?(this.eject(t),t=null):o=i)}if(t||(t=this.entitiesById[o]||this.entitiesByServerId[o])&&(o=t[n]),t){var s={};for(var u in e)s[u]=!0;if(this.__beforeInject(e,t),!(h=(0,v.default)(t))||"function"!=typeof h[R.default]&&!Array.isArray(h))throw new TypeError("Expected _Object$getOwnPropert to be iterable, got "+j(h));if(!h||"function"!=typeof h[R.default]&&!Array.isArray(h))throw new TypeError("Expected _Object$getOwnPropert to be iterable, got "+S(h));var c=!0,l=!1,f=void 0;try{for(var d,p=(0,M.default)(h);!(c=(d=p.next()).done);c=!0){var h,y=d.value;!s[y]&&(0,Y.isConfigurableProperty)(t,y)&&delete t[y]}}catch(e){l=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(l)throw f}}(0,g.default)(t,e),t[n]=o,t.serverId=r,this.__wireInstance(t)}else a=!0,t=this.__wireInstance(e),this.__beforeInject(t);return this.__register(o,t),this.options.afterAssignment&&this.options.afterAssignment(t),this.__addToHasManyRelationships(t),this.options.afterInject&&this.options.afterInject(t),this.emit("afterInject",this,t),a&&(this.options.afterCreate&&this.options.afterCreate(t),this.emit("afterCreate",this,t)),t}},{key:"eject",value:function(e){e=this.resolveId(e);var t=this.entitiesById[e]||this.entitiesByServerId[e];t&&(this.emit("beforeEject",this,t),this.__removeFromHasManyRelationships(t),this.__unregister(e,t),this.emit("afterEject",this,t))}},{key:"__register",value:function(e,t){this.entitiesById[e]!==t&&(this.entitiesById[e]=t,this.entitiesList.push(t));var n=this.previousServerIds[e],r=t.serverId;n&&n!==r&&(delete this.entitiesByServerId[n],r===e?delete this.previousServerIds[e]:(this.entitiesByServerId[r]=t,this.previousServerIds[e]=r)),n||r===e||(this.entitiesByServerId[r]=t,this.previousServerIds[e]=r)}},{key:"__unregister",value:function(e,t){delete this.entitiesById[e],(0,_.default)(this.entitiesList,t),e in this.transientAttrsStore&&delete this.transientAttrsStore[e];var n=this.previousServerIds[e];n&&(delete this.entitiesByServerId[n],delete this.previousServerIds[e])}},{key:"injectPlaceholder",value:function(e){var t=e.token||e[this.idAttribute];if(this.get(t))return this.inject(e);var n=this.createInstance(e);return Object.defineProperty(n,"$placeholder",{value:!0,configurable:!0}),this.inject(n)}},{key:"removePlaceholder",value:function(e){var t=e.entity,n=e.attrs;t&&t.$placeholder&&(n?(delete t.$placeholder,delete t.$notFound):Object.defineProperty(t,"$notFound",{value:!0,configurable:!0}),this.inject(t))}},{key:"touch",value:function(e){e=this.resolveId(e),(this.entitiesById[e]||this.entitiesByServerId[e])&&this.inject((0,t.default)({},this.idAttribute,e))}},{key:"__addToHasManyRelationships",value:function(e){this.__updateRelationsIfNeeded(e,"add")}},{key:"__removeFromHasManyRelationships",value:function(e){this.__updateRelationsIfNeeded(e,"remove")}},{key:"__updateRelationsIfNeeded",value:function(C,P){var z=this,e=this.store.getParentRelationshipsOfModel(this.name);if(e){var t;this.hasManySortFields||(this.hasManySortFields=(t=(t=e.map(function(e){var t=e.sortBy;return t&&t.map(function(e){return(0,n.default)(e,1)[0]})}).filter(Boolean),O.default).call(t).concat([this.idAttribute]),$.default).call(t));var V=(0,B.default)(this.previousHasManySortValues,C[this.idAttribute])?this.previousHasManySortValues[C[this.idAttribute]]:W;this.previousHasManySortValues[C[this.idAttribute]]=(0,L.default)(C,this.hasManySortFields),e.forEach(function(e){var t=e.filter,n=e.foreignKey,r=e.relationKey,o=e.sortBy,a=e.sorted,i=z.store.get(e.parent,C[n]);if(i&&i.$$transientAttrs.relations&&i.$$transientAttrs.relations[r]){var s=!1;if("remove"===P||t&&!t(C,i))if(o){var u=z.options.host,c=[],l=0;if(u.config.condensedReplays&&N(e.parent,r)){var f=D(i[r],C,{previousValue:V===W?void 0:V}),d=f.copy,p=f.duplicateCount,h=f.outOfOrder,y=f.outOfOrderElements;c=d,l=p,h&&(F(c,C,y,{action:"__updateRelationsIfNeeded action:remove - sorted.remove",previousValue:V===W?void 0:V,source:"Elements are out of order in "+e.parent+"."+r}),i[r].sort(a.cmp))}if(s=V===W?a.remove(i[r],C):a.remove(i[r],C,{previousValue:V}),u.config.condensedReplays&&!X.updateRelationsRemove&&N(e.parent,r)){var v=U(c,l,i[r],C,{action:"__updateRelationsIfNeeded action:remove - sorted.remove",previousValue:V===W?void 0:V,source:"There are duplicates in "+e.parent+"."+r}),g=v.logged,m=v.currCopy,b=v.counts;(X.updateRelationsRemove=g)&&(G.duplicateDebug.updateRelations.remove={beforeElements:c,afterElements:m,counts:b})}}else{var _=i[r].indexOf(C);-1!==_&&(i[r].splice(_,1),s=!0)}else if("add"===P)if(o){var w=z.options.host,x=[],E=0;if(w.config.condensedReplays&&N(e.parent,r)){var k=D(i[r],C,{previousValue:V===W?void 0:V}),T=k.copy,A=k.duplicateCount,I=k.outOfOrder,O=k.outOfOrderElements;x=T,E=A,I&&(F(x,C,O,{action:"__updateRelationsIfNeeded action:add - sorted.update",previousValue:V===W?void 0:V,source:"Elements are out of order in "+e.parent+"."+r}),i[r].sort(a.cmp))}if(s=V===W?a.update(i[r],C):a.update(i[r],C,{previousValue:V}),w.config.condensedReplays&&!X.updateRelationsAdd&&N(e.parent,r)){var j=U(x,E,i[r],C,{action:"__updateRelationsIfNeeded action:add - sorted.update",previousValue:V===W?void 0:V,source:"There are duplicates in "+e.parent+"."+r}),S=j.logged,M=j.currCopy,R=j.counts;(X.updateRelationsAdd=S)&&(G.duplicateDebug.updateRelations.add={beforeElements:x,afterElements:M,counts:R})}}else i[r].includes(C)||(i[r].push(C),s=!0);i.$$transientAttrs.$$wasUpdatedByRelation||(i.$$transientAttrs.$$wasUpdatedByRelation=s)}})}}},{key:"ejectAll",value:function(){for(;0<this.entitiesList.length;)this.eject(this.entitiesList[0])}},{key:"parseAttrs",value:function(e){var t=this,n=(0,b.default)(e,function(e){return t.store.isEntity(e)||t.store.isEntityArray(e)}),r=(0,L.default)(e,this.options.transientAttrs),o=(0,m.default)(e,(0,c.default)(n),this.options.transientAttrs),a=this.options.parseAttrs((0,Y.jsonCloneDeep)(o));return(0,u.default)({},a,n,r)}},{key:"getAll",value:function(){return this.entitiesList}},{key:"getMulti",value:function(e){return e.map(this.get)}},{key:"resolveId",value:function(e){return this.isValidId(e)?e:e[this.idAttribute]}},{key:"isValidId",value:function(e){return"string"==typeof e||"number"==typeof e}},{key:"is",value:function(e){return e&&e.$entityClass===this}}]),J);function J(e,t){var n,r=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};(0,a.default)(this,J),this.get=function(e){return r.entitiesById[e]||r.entitiesByServerId[e]||null},this.options=(0,T.default)({},o,Z),this.idAttribute=this.options.idAttribute,this.name=t,this.store=e,this.entitiesById={},this.entitiesByServerId={},this.entitiesList=[],this.hasManySortFields=null,this.previousHasManySortValues={},this.previousServerIds={},this.transientAttrsStore={},this.options.relations&&this.__initRelations(),this.__initTransientAttrs(),(0,g.default)(this.options.computed,{$entityType:{enumerable:!0,value:t,writable:!1},$entityClass:{enumerable:!1,value:this,writable:!1}}),this.options.computed=(0,k.default)(this.options.computed,function(e,t,n){e[n]="function"==typeof t?{get:t,enumerable:!1}:t},{}),this._computedKeys=(n=(n=this.options.computed,C.default).call(n),q.default).call(n,"$entityType","$entityClass","$$transientAttrs"),this._writablePropertyKeys=(n=(n=(n=this.options.computed,z.default).call(n),I.default).call(n,function(e){return e[1].set}),P.default).call(n,E.default),this._relationKeys=(n=(n=(n=this.options.relations,V.default).call(n),P.default).call(n,x.default),O.default).call(n)}(0,g.default)(Q.prototype,H.default.prototype);var ee=((0,o.default)(te,[{key:"defineModel",value:function(a){var i=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(this.models[a])throw new Error(a+" already defined");e=(0,u.default)({},this.options,e),this.models[a]=Q.create(this,a,e);var t=this.models[a].options.relations.hasMany;return(0,y.default)(t)||(0,h.default)(t,function(e,t){var n=e.sortBy,r=e.type,o=i.models[a].__getSorted(n);i.__relationsOfHasManyByContainedItem[r]||(i.__relationsOfHasManyByContainedItem[r]=[]),i.__relationsOfHasManyByContainedItem[r].push((0,u.default)({},e,{relationKey:t,sorted:o,parent:a}))}),this.models[a]}},{key:"getParentRelationshipsOfModel",value:function(e){return this.__relationsOfHasManyByContainedItem[e]}},{key:"isEntity",value:function(e){return e&&e.$entityClass&&e.$entityClass.constructor===Q}},{key:"isEntityArray",value:function(e){return e&&Array.isArray(e)&&e.some(this.isEntity)}},{key:"clear",value:function(){(0,p.default)(this.models).forEach(function(e){return e.ejectAll()})}}]),te);function te(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,te),this.options=e,this.models={},this.__relationsOfHasManyByContainedItem={},["filter","get","getAll","inject","injectPlaceholder","is","resolveId"].forEach(function(a){i[a]=function(e){for(var t,n=arguments.length,r=Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=i.models[e])[a].apply(t,r)}})}re.default=ee,ne.exports=re.default}).call(re,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(16)),o=r(n(77)),i=r(n(1)),s=r(n(2)),u=r(n(162)),c=r(n(116)),l=r(n(115)),f=r(n(35)),d=r(n(368)),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(479)),h=n(29),y=r(n(522)),v=((0,s.default)(g,[{key:"defineModels",value:function(){var n=this,r={},o=(0,a.default)({},this.options,{host:this.host,logger:this.logger});(0,d.default)(p,function(e,t){r[t]=e(n,o)}),this.models=r}},{key:"defineModel",value:function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return(0,f.default)(o,{replaceKeys:{},skipCamelizationForKeys:null}),(0,f.default)(o.replaceKeys,{token:"id"}),this.store.defineModel(e,(0,a.default)({},o,{afterInject:function(e){var t=Date.now();e.$lastModified===t&&(t+=1e-5),e.$lastModified=t,o.afterInject&&o.afterInject(e)},parseAttrs:function(e){var t=void 0;if((0,l.default)(o.skipCamelizationForKeys))t=h.Camelizer.camelizeObject(e);else{var n=(0,c.default)(e,o.skipCamelizationForKeys),r=(0,u.default)(e,o.skipCamelizationForKeys);t=(0,a.default)({},h.Camelizer.camelizeObject(n),r)}return(0,h.replaceKeys)(t,o.replaceKeys),o.parseAttrs&&(t=o.parseAttrs(t,e)),t}}))}},{key:"clear",value:function(){this.store.clear()}}]),g);function g(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.logger,r=(0,o.default)(t,["logger"]);(0,i.default)(this,g),this.host=e,this.options=r,this.logger=n,this.store=new y.default((0,a.default)({},r,{host:e,logger:n})),this.store.host=e}t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(1)),a=r(n(2)),i=r(n(94)),s=r(n(959)),u=Object.prototype.hasOwnProperty,c=(0,i.default)("NOT_PROVIDED"),l=((0,a.default)(f,[{key:"add",value:function(e,t){var n=s.default.gt(e,t,this.cmp);-1!==n?e.splice(n,0,t):e.push(t)}},{key:"indexOf",value:function(e,t,n){var r=n&&u.call(n,"previousValue")?n.previousValue:c,o=e.length;if(r===c||0===this.cmp(t,r)){var a=s.default.gt(e,t,this.cmp);if(-1!=(a=-1===a?o-1:a-1)){for(;0<a&&0===this.cmp(e[a-1],t);)a--;for(;a<o&&0===this.cmp(e[a],t);){if(e[a]===t)return a;a++}}}else for(var i=0;i<o;){if(e[i]===t)return i;i++}return-1}},{key:"remove",value:function(e,t,n){var r=this.indexOf(e,t,n);return-1!==r&&(e.splice(r,1),!0)}},{key:"removeAll",value:function(e,t,n){var r=n&&u.call(n,"previousValue")?n.previousValue:c,o=this.indexOf(e,t,n),a=!1;if(-1!==o)for(var i=r===c||0===this.cmp(t,r);o<e.length&&(!i||0===this.cmp(e[o],t));)e[o]===t?(e.splice(o,1),a=!0):o++;return a}},{key:"update",value:function(e,t,n){var r=n&&u.call(n,"previousValue")?n.previousValue:c,o=r===c||0===this.cmp(t,r),a=this.indexOf(e,t,n);if(-1!==a){if(o)return!1;e.splice(a,1)}return-1!==(a=s.default.gt(e,t,this.cmp))?e.splice(a,0,t):e.push(t),!0}}]),f);function f(e){(0,o.default)(this,f),this.cmp=e}t.default=l,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(258),a=(r=o)&&r.__esModule?r:{default:r},i={isNotEmpty:function(e,t){return!!t},notEmpty:function(e,t,n){i.isNotEmpty(e,t)||(n=n||"expected "+e+" to be provided",i.raise(e,void 0,n))},isOneOf:function(e,t,n){return n.includes(t)},oneOf:function(e,t,n,r){i.isOneOf(e,t,n)||(r=r||"expected "+t+" to be one of ("+n.join(", ")+")",i.raise(e,void 0,r))},raise:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"invalid",n=arguments[2];throw new a.default(e,t,n)}};t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=r(n(19)),a=r(n(94));if(!("find"in Array.prototype))throw new Error("Missing polyfill for Array.find");if(!("from"in Array))throw new Error("Missing polyfill for Array.from");if(!("includes"in Array.prototype))throw new Error("Missing polyfill for Array.includes");if(!("assign"in Object))throw new Error("Missing polyfill for Object.assign");if(!("entries"in Object))throw new Error("Missing polyfill for Object.entries");if(!("values"in Object))throw new Error("Missing polyfill for Object.values");if(!("endsWith"in String.prototype))throw new Error("Missing polyfill for String.endsWith");if(!("includes"in String.prototype))throw new Error("Missing polyfill for String.includes");if(void 0===a.default)throw new Error("Missing polyfill for Symbol");if(void 0===o.default)throw new Error("Missing polyfill for Promise");if(!("finally"in o.default.prototype))throw new Error("Missing polyfill for Promise.finally");if("undefined"==typeof AbortController)throw new Error("Missing polyfill for AbortController");if("undefined"==typeof fetch)throw new Error("Missing polyfill for fetch");if("undefined"==typeof Headers)throw new Error("Missing polyfill for Headers (part of fetch polyfill)");if("undefined"==typeof Request)throw new Error("Missing polyfill for Request (part of fetch polyfill)");if("undefined"==typeof Response)throw new Error("Missing polyfill for Response (part of fetch polyfill)")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var b,_=r(n(176)),w=r(n(19)),x=r(n(276)),E=r(n(12)),k=r(n(94));b="undefined"!=typeof self?self:void 0,function(s){function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=String(e)),e}function e(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return h.iterable&&(e[E.default]=function(){return e}),e}function u(t){this.map={},t instanceof u?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&(0,x.default)(t).forEach(function(e){this.append(e,t[e])},this)}function t(e){return e.bodyUsed?w.default.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function a(n){return new w.default(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function n(e){var t=new FileReader,n=a(t);return t.readAsArrayBuffer(e),n}function i(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function c(){return this.bodyUsed=!1,this._initBody=function(e){(this._bodyInit=e)?"string"==typeof e?this._bodyText=e:h.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:h.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:h.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():h.arrayBuffer&&h.blob&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=i(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||v(e))?this._bodyArrayBuffer=i(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):h.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},h.blob&&(this.blob=function(){var e=t(this);if(e)return e;if(this._bodyBlob)return w.default.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return w.default.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return w.default.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?t(this)||w.default.resolve(this._bodyArrayBuffer):this.blob().then(n)}),this.text=function(){var e=t(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=a(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return w.default.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return w.default.resolve(this._bodyText)},h.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function l(e,t){var n=(t=t||{}).body;if(e instanceof l){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new u(t.headers)),this.method=function(e){var t=e.toUpperCase();return-1<g.indexOf(t)?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function f(e){var o=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),n=t.shift().replace(/\+/g," "),r=t.join("=").replace(/\+/g," ");o.append(decodeURIComponent(n),decodeURIComponent(r))}}),o}function d(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}function p(a,i){return new w.default(function(n,e){function t(){o.abort()}var r=new l(a,i);if(r.signal&&r.signal.aborted)return e(new s.DOMException("Aborted","AbortError"));var o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:function(e){var o=new u;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),n=t.shift().trim();if(n){var r=t.join(":").trim();o.append(n,r)}}),o}(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;n(new d(t,e))},o.onerror=function(){e(new TypeError("Network request failed"))},o.ontimeout=function(){e(new TypeError("Network request failed"))},o.onabort=function(){e(new s.DOMException("Aborted","AbortError"))},o.open(r.method,r.url,!0),"include"===r.credentials?o.withCredentials=!0:"omit"===r.credentials&&(o.withCredentials=!1),"responseType"in o&&h.blob&&(o.responseType="blob"),r.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),r.signal&&(r.signal.addEventListener("abort",t),o.onreadystatechange=function(){4===o.readyState&&r.signal.removeEventListener("abort",t)}),o.send(void 0===r._bodyInit?null:r._bodyInit)})}var h={};if(h.searchParams="URLSearchParams"in b,h.iterable="Symbol"in b&&"iterator"in k.default,h.blob="FileReader"in b&&"Blob"in b&&function(){try{return new Blob,!0}catch(e){return!1}}(),h.formData="FormData"in b,h.arrayBuffer="ArrayBuffer"in b,h.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(e){return e&&-1<y.indexOf(Object.prototype.toString.call(e))};u.prototype.append=function(e,t){e=r(e),t=o(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},u.prototype.delete=function(e){delete this.map[r(e)]},u.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},u.prototype.set=function(e,t){this.map[r(e)]=o(t)},u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},u.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),e(n)},u.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),e(t)},u.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),e(n)},h.iterable&&(u.prototype[E.default]=u.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];l.prototype.clone=function(){return new l(this,{body:this._bodyInit})},c.call(l.prototype),c.call(d.prototype),d.prototype.clone=function(){return new d(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},d.error=function(){var e=new d(null,{status:0,statusText:""});return e.type="error",e};var m=[301,302,303,307,308];d.redirect=function(e,t){if(-1===m.indexOf(t))throw new RangeError("Invalid status code");return new d(null,{status:t,headers:{location:e}})},s.DOMException=b.DOMException;try{new s.DOMException}catch(e){s.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},s.DOMException.prototype=(0,_.default)(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}p.polyfill=!0,b.fetch||(b.fetch=p,b.Headers=u,b.Request=l,b.Response=d),s.Headers=u,s.Request=l,s.Response=d,s.fetch=p}({})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(4)),d=r(n(5)),p=r(n(3)),h=r(n(20)),y=r(n(13)),v=r(n(12));t.default=function(e){var t=0,n=[];if(!e||"function"!=typeof e[v.default]&&!Array.isArray(e))throw new TypeError("Expected rules to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,p.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(e));if(!e||"function"!=typeof e[v.default]&&!Array.isArray(e))throw new TypeError("Expected rules to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,p.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(e));var r=!0,o=!1,a=void 0;try{for(var i,s=(0,y.default)(e);!(r=(i=s.next()).done);r=!0){var u=(0,h.default)(i.value,2),c=u[0],l=u[1];if(n.push("const a"+t+" = a['"+c+"']"),n.push("const b"+t+" = b['"+c+"']"),"asc"===l)n.push("if (a"+t+" === undefined && b"+t+" !== undefined) return -1"),n.push("if (a"+t+" !== undefined && b"+t+" === undefined) return 1"),n.push("if (a"+t+" === null && b"+t+" !== null) return -1"),n.push("if (a"+t+" !== null && b"+t+" === null) return 1"),n.push("if (a"+t+" < b"+t+") return -1"),n.push("if (a"+t+" > b"+t+") return 1");else{if("desc"!==l)throw new Error("unsupported sort ordering for field "+c+": "+l);n.push("if (a"+t+" === undefined && b"+t+" !== undefined) return 1"),n.push("if (a"+t+" !== undefined && b"+t+" === undefined) return -1"),n.push("if (a"+t+" === null && b"+t+" !== null) return 1"),n.push("if (a"+t+" !== null && b"+t+" === null) return -1"),n.push("if (a"+t+" < b"+t+") return 1"),n.push("if (a"+t+" > b"+t+") return -1")}t++}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return n.push("return 0"),new Function("a","b",n.join("\n"))},e.exports=t.default},function(e,t,n){"use strict";var r,o=n(19),a=(r=o)&&r.__esModule?r:{default:r};n(627),n(628),n(629),n(630),n(631),n(632),n(633),n(634),n(635),n(636),!(window&&window.navigator.userAgent.includes("Trident/"))&&void 0!==a.default&&"finally"in a.default.prototype||(n(903).enable(),self.Promise=n(902)),n(403),n(527)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){!(n in e)&&t in e&&(e[n]=e[t],delete e[t])},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(4)),d=r(n(5)),p=r(n(3)),h=r(n(20)),y=r(n(13)),v=r(n(12)),g=r(n(24));t.default=function(e,t){if(!(s=(0,g.default)(t))||"function"!=typeof s[v.default]&&!Array.isArray(s))throw new TypeError("Expected _Object$entries to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,p.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(s));if(!s||"function"!=typeof s[v.default]&&!Array.isArray(s))throw new TypeError("Expected _Object$entries to be iterable, got "+function t(n,r){if(void 0===r&&(r=0),r+=1,null===n)return"null";if(void 0===n)return"void";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)return void 0===n?"undefined":(0,p.default)(n);if(Array.isArray(n)){if(0<n.length){if(4<r)return"[...]";var o=t(n[0],r);return n.every(function(e){return t(e,r)===o})?o.trim()+"[]":"["+n.slice(0,15).map(function(e){return t(e,r)}).join(", ")+(15<=n.length?", ...":"")+"]"}return"Array"}var e=(0,d.default)(n);if(!e.length)return n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name:"Object";if(4<r)return"{...}";var a="  ".repeat(r-1),i=e.slice(0,15).map(function(e){return(/^([A-Z_$][A-Z0-9_$]*)$/i.test(e)?e:(0,f.default)(e))+": "+t(n[e],r)+";"}).join("\n  "+a);return 15<=e.length&&(i+="\n  "+a+"..."),n.constructor&&n.constructor.name&&"Object"!==n.constructor.name?n.constructor.name+" {\n  "+a+i+"\n"+a+"}":"{\n  "+a+i+"\n"+a+"}"}(s));var n=!0,r=!1,o=void 0;try{for(var a,i=(0,y.default)(s);!(n=(a=i.next()).done);n=!0){var s,u=(0,h.default)(a.value,2),c=u[0],l=u[1];!(l in e)&&c in e&&(e[l]=e[c],delete e[c])}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}return e},e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(i){return function(e){for(var t=e[0],n=arguments.length,r=Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];for(var a=0;a<r.length;++a)t+=i(r[a]),t+=e[a+1];return t}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(532),a=(r=o)&&r.__esModule?r:{default:r};t.default=(0,a.default)(encodeURIComponent),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(699),a=((r=o)&&r.__esModule?r:{default:r}).default.version;a=a.replace("-dev",""),t.default=a,e.exports=t.default},function(e,t,n){e.exports={default:n(542),__esModule:!0}},function(e,t,n){e.exports={default:n(544),__esModule:!0}},function(e,t,n){e.exports={default:n(548),__esModule:!0}},function(e,t,n){e.exports={default:n(555),__esModule:!0}},function(e,t,n){e.exports={default:n(557),__esModule:!0}},function(e,t,n){e.exports={default:n(560),__esModule:!0}},function(e,t,n){e.exports={default:n(561),__esModule:!0}},function(e,t,n){n(82),n(586),e.exports=n(17).Array.from},function(e,t,n){n(101),n(82),e.exports=n(584)},function(e,t,n){n(101),n(82),e.exports=n(585)},function(e,t,n){var r=n(17),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t,n){n(589),e.exports=n(17).Object.assign},function(e,t,n){n(590);var r=n(17).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){n(591);var r=n(17).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},function(e,t,n){n(592);var r=n(17).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){n(603),e.exports=n(17).Object.entries},function(e,t,n){n(593),e.exports=n(17).Object.freeze},function(e,t,n){n(594);var r=n(17).Object;e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)}},function(e,t,n){n(595);var r=n(17).Object;e.exports=function(e){return r.getOwnPropertyNames(e)}},function(e,t,n){n(596),e.exports=n(17).Object.getPrototypeOf},function(e,t,n){n(597),e.exports=n(17).Object.isFrozen},function(e,t,n){n(598),e.exports=n(17).Object.keys},function(e,t,n){n(599),e.exports=n(17).Object.setPrototypeOf},function(e,t,n){n(604),e.exports=n(17).Object.values},function(e,t,n){n(195),n(82),n(101),n(600),n(605),n(606),e.exports=n(17).Promise},function(e,t,n){n(195),n(82),n(101),n(601),n(609),n(608),n(607),e.exports=n(17).Set},function(e,t,n){n(588),e.exports=n(131).f("hasInstance")},function(e,t,n){n(602),n(195),n(610),n(611),e.exports=n(17).Symbol},function(e,t,n){n(82),n(101),e.exports=n(131).f("iterator")},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(97);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t,n){var u=n(60),c=n(129),l=n(583);e.exports=function(s){return function(e,t,n){var r,o=u(e),a=c(o.length),i=l(n,a);if(s&&t!=t){for(;i<a;)if((r=o[i++])!=r)return!0}else for(;i<a;i++)if((s||i in o)&&o[i]===t)return s||i||0;return!s&&-1}}},function(e,t,n){var b=n(55),_=n(182),w=n(81),x=n(129),r=n(569);e.exports=function(f,e){var d=1==f,p=2==f,h=3==f,y=4==f,v=6==f,g=5==f||v,m=e||r;return function(e,t,n){for(var r,o,a=w(e),i=_(a),s=b(t,n,3),u=x(i.length),c=0,l=d?m(e,u):p?m(e,0):void 0;c<u;c++)if((g||c in i)&&(o=s(r=i[c],c,a),f))if(d)l[c]=o;else if(o)switch(f){case 3:return!0;case 5:return r;case 6:return c;case 2:l.push(r)}else if(y)return!1;return v?-1:h||y?y:l}}},function(e,t,n){var r=n(33),o=n(280),a=n(27)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&(null===(t=t[a])&&(t=void 0))),void 0===t?Array:t}},function(e,t,n){var r=n(568);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";function i(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n}var s=n(37).f,u=n(128),c=n(188),l=n(55),f=n(178),d=n(97),r=n(183),o=n(283),a=n(292),p=n(39),h=n(127).fastKey,y=n(295),v=p?"_s":"size";e.exports={getConstructor:function(e,a,n,r){var o=e(function(e,t){f(e,o,a,"_i"),e._t=a,e._i=u(null),e._f=void 0,e._l=void 0,e[v]=0,null!=t&&d(t,n,e[r],e)});return c(o.prototype,{clear:function(){for(var e=y(this,a),t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var t=y(this,a),n=i(t,e);if(n){var r=n.n,o=n.p;delete t._i[n.i],n.r=!0,o&&(o.n=r),r&&(r.p=o),t._f==n&&(t._f=r),t._l==n&&(t._l=o),t[v]--}return!!n},forEach:function(e){y(this,a);for(var t,n=l(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!i(y(this,a),e)}}),p&&s(o.prototype,"size",{get:function(){return y(this,a)[v]}}),o},def:function(e,t,n){var r,o,a=i(e,t);return a?a.v=n:(e._l=a={i:o=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=a),r&&(r.n=a),e[v]++,"F"!==o&&(e._i[o]=a)),e},getEntry:i,setStrong:function(e,n,t){r(e,n,function(e,t){this._t=y(e,n),this._k=t,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?o(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,o(1))},t?"entries":"values",!t,!0),a(n)}}},function(e,t,n){var r=n(125),o=n(565);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return o(this)}}},function(e,t,n){"use strict";var f=n(31),d=n(25),p=n(127),h=n(68),y=n(59),v=n(188),g=n(97),m=n(178),b=n(33),_=n(100),w=n(37).f,x=n(567)(0),E=n(39);e.exports=function(n,e,t,r,o,a){var i=f[n],s=i,u=o?"set":"add",c=s&&s.prototype,l={};return E&&"function"==typeof s&&(a||c.forEach&&!h(function(){(new s).entries().next()}))?(s=e(function(e,t){m(e,s,n,"_c"),e._c=new i,null!=t&&g(t,o,e[u],e)}),x("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(r){var o="add"==r||"set"==r;r in c&&(!a||"clear"!=r)&&y(s.prototype,r,function(e,t){if(m(this,s,r),!o&&a&&!b(e))return"get"==r&&void 0;var n=this._c[r](0===e?0:e,t);return o?this:n})}),a||w(s.prototype,"size",{get:function(){return this._c.size}})):(s=r.getConstructor(e,n,o,u),v(s.prototype,t),p.NEED=!0),_(s,n),l[n]=s,d(d.G+d.W+d.F,l),a||r.setStrong(s,n,o),s}},function(e,t,n){"use strict";var r=n(37),o=n(99);e.exports=function(e,t,n){t in e?r.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){var s=n(79),u=n(186),c=n(98);e.exports=function(e){var t=s(e),n=u.f;if(n)for(var r,o=n(e),a=c.f,i=0;o.length>i;)a.call(e,r=o[i++])&&t.push(r);return t}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){"use strict";var r=n(128),o=n(99),a=n(100),i={};n(59)(i,n(27)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(i,{next:o(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var s=n(31),u=n(294).set,c=s.MutationObserver||s.WebKitMutationObserver,l=s.process,f=s.Promise,d="process"==n(96)(l);e.exports=function(){function e(){var e,t;for(d&&(e=l.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(e){throw n?o():r=void 0,e}}r=void 0,e&&e.enter()}var n,r,o;if(d)o=function(){l.nextTick(e)};else if(c){var t=!0,a=document.createTextNode("");new c(e).observe(a,{characterData:!0}),o=function(){a.data=t=!t}}else if(f&&f.resolve){var i=f.resolve();o=function(){i.then(e)}}else o=function(){u.call(s,e)};return function(e){var t={fn:e,next:void 0};r&&(r.next=t),n||(n=t,o()),r=t}}},function(e,t,n){"use strict";var d=n(79),p=n(186),h=n(98),y=n(81),v=n(182),o=Object.assign;e.exports=!o||n(68)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=o({},e)[n]||Object.keys(o({},t)).join("")!=r})?function(e,t){for(var n=y(e),r=arguments.length,o=1,a=p.f,i=h.f;o<r;)for(var s,u=v(arguments[o++]),c=a?d(u).concat(a(u)):d(u),l=c.length,f=0;f<l;)i.call(u,s=c[f++])&&(n[s]=u[s]);return n}:o},function(e,t,n){"use strict";var r=n(25),i=n(95),s=n(55),u=n(97);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,o,a=arguments[1];return i(this),(t=void 0!==a)&&i(a),null==e?new this:(n=[],t?(r=0,o=s(a,arguments[2],2),u(e,!1,function(e){n.push(o(e,r++))})):u(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";var r=n(25);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,o){function a(e,t){if(r(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")}var n=o(33),r=o(48);e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,r){try{(r=o(55)(Function.call,o(185).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return a(e,t),n?e.__proto__=t:r(e,t),e}}({},!1):void 0),check:a}},function(e,t,n){var u=n(191),c=n(179);e.exports=function(s){return function(e,t){var n,r,o=String(c(e)),a=u(t),i=o.length;return a<0||i<=a?s?"":void 0:(n=o.charCodeAt(a))<55296||56319<n||a+1===i||(r=o.charCodeAt(a+1))<56320||57343<r?s?o.charAt(a):n:s?o.slice(a,a+2):r-56320+(n-55296<<10)+65536}}},function(e,t,n){var r=n(191),o=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):a(e,t)}},function(e,t,n){var r=n(48),o=n(194);e.exports=n(17).getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},function(e,t,n){var r=n(125),o=n(27)("iterator"),a=n(78);e.exports=n(17).isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||a.hasOwnProperty(r(t))}},function(e,t,n){"use strict";var d=n(55),r=n(25),p=n(81),h=n(281),y=n(279),v=n(129),g=n(573),m=n(194);r(r.S+r.F*!n(282)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,o,a=p(e),i="function"==typeof this?this:Array,s=arguments.length,u=1<s?arguments[1]:void 0,c=void 0!==u,l=0,f=m(a);if(c&&(u=d(u,2<s?arguments[2]:void 0,2)),null==f||i==Array&&y(f))for(n=new i(t=v(a.length));l<t;l++)g(n,l,c?u(a[l],l):a[l]);else for(o=f.call(a),n=new i;!(r=o.next()).done;l++)g(n,l,c?h(o,u,[r.value,l],!0):r.value);return n.length=l,n}})},function(e,t,n){"use strict";var r=n(564),o=n(283),a=n(78),i=n(60);e.exports=n(183)(Array,"Array",function(e,t){this._t=i(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r=n(33),o=n(187),a=n(27)("hasInstance"),i=Function.prototype;a in i||n(37).f(i,a,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=o(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(25);r(r.S+r.F,"Object",{assign:n(578)})},function(e,t,n){var r=n(25);r(r.S,"Object",{create:n(128)})},function(e,t,n){var r=n(25);r(r.S+r.F*!n(39),"Object",{defineProperties:n(284)})},function(e,t,n){var r=n(25);r(r.S+r.F*!n(39),"Object",{defineProperty:n(37).f})},function(e,t,n){var r=n(33),o=n(127).onFreeze;n(80)("freeze",function(t){return function(e){return t&&r(e)?t(o(e)):e}})},function(e,t,n){var r=n(60),o=n(185).f;n(80)("getOwnPropertyDescriptor",function(){return function(e,t){return o(r(e),t)}})},function(e,t,n){n(80)("getOwnPropertyNames",function(){return n(285).f})},function(e,t,n){var r=n(81),o=n(187);n(80)("getPrototypeOf",function(){return function(e){return o(r(e))}})},function(e,t,n){var r=n(33);n(80)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(e,t,n){var r=n(81),o=n(79);n(80)("keys",function(){return function(e){return o(r(e))}})},function(e,t,n){var r=n(25);r(r.S,"Object",{setPrototypeOf:n(581).set})},function(e,t,n){"use strict";function r(){}function l(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t}function o(c,n){if(!c._n){c._n=!0;var r=c._c;x(function(){for(var s=c._v,u=1==c._s,e=0,t=function(e){var t,n,r=u?e.ok:e.fail,o=e.resolve,a=e.reject,i=e.domain;try{r?(u||(2==c._h&&z(c),c._h=1),!0===r?t=s:(i&&i.enter(),t=r(s),i&&i.exit()),t===e.promise?a(I("Promise-chain cycle")):(n=l(t))?n.call(t,o,a):o(t)):a(s)}catch(e){a(e)}};r.length>e;)t(r[e++]);c._c=[],c._n=!1,n&&!c._h&&C(c)})}}function a(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),o(t,!0))}var i,s,u,c,f=n(126),d=n(31),p=n(55),h=n(125),y=n(25),v=n(33),g=n(95),m=n(178),b=n(97),_=n(293),w=n(294).set,x=n(577)(),E=n(184),k=n(289),T=n(290),A="Promise",I=d.TypeError,O=d.process,j=d[A],S="process"==h(O),M=s=E.f,R=!!function(){try{var e=j.resolve(1),t=(e.constructor={})[n(27)("species")]=function(e){e(r,r)};return(S||"function"==typeof PromiseRejectionEvent)&&e.then(r)instanceof t}catch(e){}}(),C=function(a){w.call(d,function(){var e,t,n,r=a._v,o=P(a);if(o&&(e=k(function(){S?O.emit("unhandledRejection",r,a):(t=d.onunhandledrejection)?t({promise:a,reason:r}):(n=d.console)&&n.error&&n.error("Unhandled promise rejection",r)}),a._h=S||P(a)?2:1),a._a=void 0,o&&e.e)throw e.v})},P=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if((t=n[r++]).fail||!P(t.promise))return!1;return!0},z=function(t){w.call(d,function(){var e;S?O.emit("rejectionHandled",t):(e=d.onrejectionhandled)&&e({promise:t,reason:t._v})})},V=function(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw I("Promise can't be resolved itself");(n=l(e))?x(function(){var t={_w:r,_d:!1};try{n.call(e,p(V,t,1),p(a,t,1))}catch(e){a.call(t,e)}}):(r._v=e,r._s=1,o(r,!1))}catch(e){a.call({_w:r,_d:!1},e)}}};R||(j=function(e){m(this,j,A,"_h"),g(e),i.call(this);try{e(p(V,this,1),p(a,this,1))}catch(e){a.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(188)(j.prototype,{then:function(e,t){var n=M(_(this,j));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=S?O.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&o(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),u=function(){var e=new i;this.promise=e,this.resolve=p(V,e,1),this.reject=p(a,e,1)},E.f=M=function(e){return e===j||e===c?new u(e):s(e)}),y(y.G+y.W+y.F*!R,{Promise:j}),n(100)(j,A),n(292)(A),c=n(17)[A],y(y.S+y.F*!R,A,{reject:function(e){var t=M(this);return(0,t.reject)(e),t.promise}}),y(y.S+y.F*(f||!R),A,{resolve:function(e){return T(f&&this===c?j:this,e)}}),y(y.S+y.F*!(R&&n(282)(function(e){j.all(e).catch(r)})),A,{all:function(e){var i=this,t=M(i),s=t.resolve,u=t.reject,n=k(function(){var r=[],o=0,a=1;b(e,!1,function(e){var t=o++,n=!1;r.push(void 0),a++,i.resolve(e).then(function(e){n||(n=!0,r[t]=e,--a||s(r))},u)}),--a||s(r)});return n.e&&u(n.v),t.promise},race:function(e){var t=this,n=M(t),r=n.reject,o=k(function(){b(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t,n){"use strict";var r=n(570),o=n(295);e.exports=n(572)("Set",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return r.def(o(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";function r(e){var t=$[e]=O(V[D]);return t._k=e,t}function o(e,t){k(e);for(var n,r=x(t=T(t)),o=0,a=r.length;o<a;)Q(e,n=r[o++],t[n]);return e}function a(e){var t=L.call(this,e=A(e,!0));return!(this===H&&l($,e)&&!l(q,e))&&(!(t||!l(this,e)||!l($,e)||l(this,U)&&this[U][e])||t)}function i(e,t){if(e=T(e),t=A(t,!0),e!==H||!l($,t)||l(q,t)){var n=C(e,t);return!n||!l($,t)||l(e,U)&&e[U][t]||(n.enumerable=!0),n}}function s(e){for(var t,n=z(T(e)),r=[],o=0;n.length>o;)l($,t=n[o++])||t==U||t==h||r.push(t);return r}function u(e){for(var t,n=e===H,r=z(n?q:T(e)),o=[],a=0;r.length>a;)!l($,t=r[a++])||n&&!l(H,t)||o.push($[t]);return o}var c=n(31),l=n(69),f=n(39),d=n(25),p=n(291),h=n(127).KEY,y=n(68),v=n(190),g=n(100),m=n(130),b=n(27),_=n(131),w=n(193),x=n(574),E=n(280),k=n(48),T=n(60),A=n(192),I=n(99),O=n(128),j=n(285),S=n(185),M=n(37),R=n(79),C=S.f,P=M.f,z=j.f,V=c.Symbol,G=c.JSON,N=G&&G.stringify,D="prototype",U=b("_hidden"),F=b("toPrimitive"),L={}.propertyIsEnumerable,B=v("symbol-registry"),$=v("symbols"),q=v("op-symbols"),H=Object[D],Y="function"==typeof V,Z=c.QObject,W=!Z||!Z[D]||!Z[D].findChild,K=f&&y(function(){return 7!=O(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=C(H,t);r&&delete H[t],P(e,t,n),r&&e!==H&&P(H,t,r)}:P,X=Y&&"symbol"==typeof V.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof V},Q=function(e,t,n){return e===H&&Q(q,t,n),k(e),t=A(t,!0),k(n),l($,t)?(n.enumerable?(l(e,U)&&e[U][t]&&(e[U][t]=!1),n=O(n,{enumerable:I(0,!1)})):(l(e,U)||P(e,U,I(1,{})),e[U][t]=!0),K(e,t,n)):P(e,t,n)};Y||(p((V=function(){if(this instanceof V)throw TypeError("Symbol is not a constructor!");var t=m(0<arguments.length?arguments[0]:void 0),n=function(e){this===H&&n.call(q,e),l(this,U)&&l(this[U],t)&&(this[U][t]=!1),K(this,t,I(1,e))};return f&&W&&K(H,t,{configurable:!0,set:n}),r(t)})[D],"toString",function(){return this._k}),S.f=i,M.f=Q,n(286).f=j.f=s,n(98).f=a,n(186).f=u,f&&!n(126)&&p(H,"propertyIsEnumerable",a,!0),_.f=function(e){return r(b(e))}),d(d.G+d.W+d.F*!Y,{Symbol:V});for(var J="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;J.length>ee;)b(J[ee++]);for(var te=R(b.store),ne=0;te.length>ne;)w(te[ne++]);d(d.S+d.F*!Y,"Symbol",{for:function(e){return l(B,e+="")?B[e]:B[e]=V(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in B)if(B[t]===e)return t},useSetter:function(){W=!0},useSimple:function(){W=!1}}),d(d.S+d.F*!Y,"Object",{create:function(e,t){return void 0===t?O(e):o(O(e),t)},defineProperty:Q,defineProperties:o,getOwnPropertyDescriptor:i,getOwnPropertyNames:s,getOwnPropertySymbols:u}),G&&d(d.S+d.F*(!Y||y(function(){var e=V();return"[null]"!=N([e])||"{}"!=N({a:e})||"{}"!=N(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!X(e)){for(var t,n,r=[e],o=1;o<arguments.length;)r.push(arguments[o++]);return"function"==typeof(t=r[1])&&(n=t),!n&&E(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!X(t))return t}),r[1]=t,N.apply(G,r)}}}),V[D][F]||n(59)(V[D],F,V[D].valueOf),g(V,"Symbol"),g(Math,"Math",!0),g(c.JSON,"JSON",!0)},function(e,t,n){var r=n(25),o=n(288)(!0);r(r.S,"Object",{entries:function(e){return o(e)}})},function(e,t,n){var r=n(25),o=n(288)(!1);r(r.S,"Object",{values:function(e){return o(e)}})},function(e,t,n){"use strict";var r=n(25),o=n(17),a=n(31),i=n(293),s=n(290);r(r.P+r.R,"Promise",{finally:function(t){var n=i(this,o.Promise||a.Promise),e="function"==typeof t;return this.then(e?function(e){return s(n,t()).then(function(){return e})}:t,e?function(e){return s(n,t()).then(function(){throw e})}:t)}})},function(e,t,n){"use strict";var r=n(25),o=n(184),a=n(289);r(r.S,"Promise",{try:function(e){var t=o.f(this),n=a(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){n(579)("Set")},function(e,t,n){n(580)("Set")},function(e,t,n){var r=n(25);r(r.P+r.R,"Set",{toJSON:n(571)("Set")})},function(e,t,n){n(193)("asyncIterator")},function(e,t,n){n(193)("observable")},function(e,t,n){var r=function(){return this}()||Function("return this")(),o=r.regeneratorRuntime&&0<=Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime"),a=o&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(613),o)r.regeneratorRuntime=a;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(R,e){!function(e){"use strict";function a(e,t,n,r){var o=t&&t.prototype instanceof s?t:s,a=Object.create(o.prototype),i=new f(r||[]);return a._invoke=function(a,i,s){var u=E;return function(e,t){if(u===T)throw new Error("Generator is already running");if(u===A){if("throw"===e)throw t;return p()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){var r=l(n,s);if(r){if(r===I)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(u===E)throw u=A,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);u=T;var o=c(a,i,s);if("normal"===o.type){if(u=s.done?A:k,o.arg===I)continue;return{value:o.arg,done:s.done}}"throw"===o.type&&(u=A,s.method="throw",s.arg=o.arg)}}}(e,n,i),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function s(){}function n(){}function t(){}function r(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function i(u){var t;this._invoke=function(n,r){function e(){return new Promise(function(e,t){!function t(e,n,r,o){var a=c(u[e],u,n);if("throw"!==a.type){var i=a.arg,s=i.value;return s&&"object"==typeof s&&v.call(s,"__await")?Promise.resolve(s.__await).then(function(e){t("next",e,r,o)},function(e){t("throw",e,r,o)}):Promise.resolve(s).then(function(e){i.value=e,r(i)},o)}o(a.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function l(e,t){var n=e.iterator[t.method];if(n===h){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=h,l(e,t),"throw"===t.method))return I;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return I}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,I;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=h),t.delegate=null,I):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,I)}function o(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function u(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function f(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(o,this),this.reset(!0)}function d(t){if(t){var e=t[m];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(v.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=h,e.done=!0,e};return r.next=r}}return{next:p}}function p(){return{value:h,done:!0}}var h,y=Object.prototype,v=y.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},m=g.iterator||"@@iterator",b=g.asyncIterator||"@@asyncIterator",_=g.toStringTag||"@@toStringTag",w="object"==typeof R,x=e.regeneratorRuntime;if(x)w&&(R.exports=x);else{(x=e.regeneratorRuntime=w?R.exports:{}).wrap=a;var E="suspendedStart",k="suspendedYield",T="executing",A="completed",I={},O={};O[m]=function(){return this};var j=Object.getPrototypeOf,S=j&&j(j(d([])));S&&S!==y&&v.call(S,m)&&(O=S);var M=t.prototype=s.prototype=Object.create(O);n.prototype=M.constructor=t,t.constructor=n,t[_]=n.displayName="GeneratorFunction",x.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))},x.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,t):(e.__proto__=t,_ in e||(e[_]="GeneratorFunction")),e.prototype=Object.create(M),e},x.awrap=function(e){return{__await:e}},r(i.prototype),i.prototype[b]=function(){return this},x.AsyncIterator=i,x.async=function(e,t,n,r){var o=new i(a(e,t,n,r));return x.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},r(M),M[_]="Generator",M[m]=function(){return this},M.toString=function(){return"[object Generator]"},x.keys=function(n){var r=[];for(var e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},x.values=d,f.prototype={constructor:f,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(u),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=h)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){function e(e,t){return a.type="throw",a.arg=n,r.next=e,t&&(r.method="next",r.arg=h),!!t}if(this.done)throw n;for(var r=this,t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=v.call(o,"catchLoc"),s=v.call(o,"finallyLoc");if(i&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&v.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,I):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),I},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),u(n),I}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;u(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:d(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=h),I}}}}(function(){return this}()||Function("return this")())},function(e,t){"use strict";function u(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function c(e,t,n){for(var r,o=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],o.push(l[(i=r)>>18&63]+l[i>>12&63]+l[i>>6&63]+l[63&i]);var i;return o.join("")}t.byteLength=function(e){return 3*e.length/4-u(e)},t.toByteArray=function(e){var t,n,r,o,a,i=e.length;o=u(e),a=new d(3*i/4-o),n=0<o?i-4:i;var s=0;for(t=0;t<n;t+=4,3)r=f[e.charCodeAt(t)]<<18|f[e.charCodeAt(t+1)]<<12|f[e.charCodeAt(t+2)]<<6|f[e.charCodeAt(t+3)],a[s++]=r>>16&255,a[s++]=r>>8&255,a[s++]=255&r;return 2===o?(r=f[e.charCodeAt(t)]<<2|f[e.charCodeAt(t+1)]>>4,a[s++]=255&r):1===o&&(r=f[e.charCodeAt(t)]<<10|f[e.charCodeAt(t+1)]<<4|f[e.charCodeAt(t+2)]>>2,a[s++]=r>>8&255,a[s++]=255&r),a},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o="",a=[],i=0,s=n-r;i<s;i+=16383)a.push(c(e,i,s<i+16383?s:i+16383));return 1==r?(t=e[n-1],o+=l[t>>2],o+=l[t<<4&63],o+="=="):2==r&&(t=(e[n-2]<<8)+e[n-1],o+=l[t>>10],o+=l[t>>4&63],o+=l[t<<2&63],o+="="),a.push(o),a.join("")};for(var l=[],f=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,o=n.length;r<o;++r)l[r]=n[r],f[n.charCodeAt(r)]=r;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},function(e,t){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}(e.exports=r).prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){n(661);var r=n(103);e.exports=r("Array","find")},function(e,t,n){n(672),n(662);var r=n(71);e.exports=r.Array.from},function(e,t,n){n(663);var r=n(103);e.exports=r("Array","includes")},function(e,t,n){n(666);var r=n(71);e.exports=r.Object.assign},function(e,t,n){n(667);var r=n(71);e.exports=r.Object.entries},function(e,t,n){n(669);var r=n(71);e.exports=r.Object.values},function(e,t,n){n(670);var r=n(103);e.exports=r("String","endsWith")},function(e,t,n){n(671);var r=n(103);e.exports=r("String","includes")},function(e,t,n){n(673);var r=n(103);e.exports=r("String","startsWith")},function(e,t,n){n(660),n(668),n(679),n(674),n(675),n(676),n(677),n(678),n(681),n(680),n(682),n(683),n(684),n(685),n(686),n(687),n(688),n(665),n(664);var r=n(71);e.exports=r.Symbol},function(e,t,n){e.exports=n(617)},function(e,t,n){e.exports=n(618)},function(e,t,n){e.exports=n(619)},function(e,t,n){e.exports=n(620)},function(e,t,n){e.exports=n(621)},function(e,t,n){e.exports=n(622)},function(e,t,n){e.exports=n(623)},function(e,t,n){e.exports=n(624)},function(e,t,n){e.exports=n(625)},function(e,t,n){e.exports=n(626),n(689),n(690),n(691),n(692),n(693)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var r=n(51);e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,n){"use strict";var d=n(197),p=n(86),h=n(641),y=n(648),v=n(85),g=n(303),m=n(646);e.exports=function(e){var t,n,r,o,a=p(e),i="function"==typeof this?this:Array,s=arguments.length,u=1<s?arguments[1]:void 0,c=void 0!==u,l=0,f=m(a);if(c&&(u=d(u,2<s?arguments[2]:void 0,2)),null==f||i==Array&&y(f))for(n=new i(t=v(a.length));l<t;l++)g(n,l,c?u(a[l],l):a[l]);else for(o=f.call(a),n=new i;!(r=o.next()).done;l++)g(n,l,c?h(o,u,[r.value,l],!0):r.value);return n.length=l,n}},function(e,t,n){var r=n(50),o=n(28)("species");e.exports=function(t){return!r(function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[t](Boolean).foo})}},function(e,t,n){var a=n(70);e.exports=function(e,t,n,r){try{return r?t(a(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&a(o.call(e)),t}}},function(e,t,n){var o=n(28)("iterator"),a=!1;try{var r=0,i={next:function(){return{done:!!r++}},return:function(){a=!0}};i[o]=function(){return this},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var r={};r[o]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}},function(e,t,n){var r=n(50);e.exports=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},function(e,t,n){"use strict";function o(){return this}var a=n(308).IteratorPrototype,i=n(204),s=n(102),u=n(104),c=n(135);e.exports=function(e,t,n){var r=t+" Iterator";return e.prototype=i(a,{next:s(1,n)}),u(e,r,!1,!0),c[r]=o,e}},function(e,t,n){"use strict";function g(){return this}var m=n(34),b=n(644),_=n(310),w=n(655),x=n(104),E=n(61),k=n(138),r=n(28),T=n(134),A=n(135),o=n(308),I=o.IteratorPrototype,O=o.BUGGY_SAFARI_ITERATORS,j=r("iterator"),S="values";e.exports=function(e,t,n,r,o,a,i){b(n,t,r);function s(e){if(e===o&&y)return y;if(!O&&e in p)return p[e];switch(e){case"keys":case S:case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}}var u,c,l,f=t+" Iterator",d=!1,p=e.prototype,h=p[j]||p["@@iterator"]||o&&p[o],y=!O&&h||s(o),v="Array"==t&&p.entries||h;if(v&&(u=_(v.call(new e)),I!==Object.prototype&&u.next&&(T||_(u)===I||(w?w(u,I):"function"!=typeof u[j]&&E(u,j,g)),x(u,f,!0,!0),T&&(A[f]=g))),o==S&&h&&h.name!==S&&(d=!0,y=function(){return h.call(this)}),T&&!i||p[j]===y||E(p,j,y),A[t]=y,o)if(c={values:s(S),keys:a?y:s("keys"),entries:s("entries")},i)for(l in c)!O&&!d&&l in p||k(p,l,c[l]);else m({target:t,proto:!0,forced:O||d},c);return c}},function(e,t,n){var r=n(301),o=n(135),a=n(28)("iterator");e.exports=function(e){if(null!=e)return e[a]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(306);e.exports=r("document","documentElement")},function(e,t,n){var r=n(28),o=n(135),a=r("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||i[a]===e)}},function(e,t,n){function r(e,t){var n=s[i(e)];return n==c||n!=u&&("function"==typeof t?o(t):!!t)}var o=n(50),a=/#|\.prototype\./,i=r.normalize=function(e){return String(e).replace(a,".").toLowerCase()},s=r.data={},u=r.NATIVE="N",c=r.POLYFILL="P";e.exports=r},function(e,t,n){var r=n(51),o=n(132),a=n(28)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==o(e))}},function(e,t,n){var r=n(32),o=n(305),a=r.WeakMap;e.exports="function"==typeof a&&/native code/.test(o.call(a))},function(e,t,n){"use strict";var d=n(56),r=n(50),p=n(136),h=n(207),y=n(137),v=n(86),g=n(200),o=Object.assign;e.exports=!o||r(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=o({},e)[n]||p(o({},t)).join("")!=r})?function(e,t){for(var n=v(e),r=arguments.length,o=1,a=h.f,i=y.f;o<r;)for(var s,u=g(arguments[o++]),c=a?p(u).concat(a(u)):p(u),l=c.length,f=0;f<l;)s=c[f++],d&&!i.call(u,s)||(n[s]=u[s]);return n}:o},function(e,t,n){var r=n(56),i=n(62),s=n(70),u=n(136);e.exports=r?Object.defineProperties:function(e,t){s(e);for(var n,r=u(t),o=r.length,a=0;a<o;)i.f(e,n=r[a++],t[n]);return e}},function(e,t,n){var r=n(84),o=n(206).f,a={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return i&&"[object Window]"==a.call(e)?function(e){try{return o(e)}catch(e){return i.slice()}}(e):o(r(e))}},function(e,t,n){var o=n(70),a=n(638);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(n){}return function(e,t){return o(e),a(t),r?n.call(e,t):e.__proto__=t,e}}():void 0)},function(e,t,n){"use strict";var r=n(301),o={};o[n(28)("toStringTag")]="z",e.exports="[object z]"!==String(o)?function(){return"[object "+r(this)+"]"}:o.toString},function(e,t,n){var r=n(306),o=n(206),a=n(207),i=n(70);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(i(e)),n=a.f;return n?t.concat(n(e)):t}},function(e,t,n){function r(s){return function(e,t){var n,r,o=String(c(e)),a=u(t),i=o.length;return a<0||i<=a?s?"":void 0:(n=o.charCodeAt(a))<55296||56319<n||a+1===i||(r=o.charCodeAt(a+1))<56320||57343<r?s?o.charAt(a):n:s?o.slice(a,a+2):r-56320+(n-55296<<10)+65536}}var u=n(209),c=n(83);e.exports={codeAt:r(!1),charAt:r(!0)}},function(e,t,n){var r=n(209),o=Math.max,a=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):a(n,t)}},function(e,t,n){"use strict";function c(e){if(!i(e))return!1;var t=e[u];return void 0!==t?!!t:a(e)}var r=n(34),o=n(50),a=n(202),i=n(51),l=n(86),f=n(85),d=n(303),p=n(300),s=n(640),u=n(28)("isConcatSpreadable"),h=9007199254740991,y="Maximum allowed index exceeded",v=!o(function(){var e=[];return e[u]=!1,e.concat()[0]!==e}),g=s("concat");r({target:"Array",proto:!0,forced:!v||!g},{concat:function(e){var t,n,r,o,a,i=l(this),s=p(i,0),u=0;for(t=-1,r=arguments.length;t<r;t++)if(c(a=-1===t?i:arguments[t])){if(o=f(a.length),h<u+o)throw TypeError(y);for(n=0;n<o;n++,u++)n in a&&d(s,u,a[n])}else{if(h<=u)throw TypeError(y);d(s,u++,a)}return s.length=u,s}})},function(e,t,n){"use strict";var r=n(34),o=n(299).find,a=n(297),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),r({target:"Array",proto:!0,forced:i},{find:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}}),a("find")},function(e,t,n){var r=n(34),o=n(639);r({target:"Array",stat:!0,forced:!n(642)(function(e){Array.from(e)})},{from:o})},function(e,t,n){"use strict";var r=n(34),o=n(298).includes,a=n(297);r({target:"Array",proto:!0},{includes:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}}),a("includes")},function(e,t,n){var r=n(32);n(104)(r.JSON,"JSON",!0)},function(e,t,n){n(104)(Math,"Math",!0)},function(e,t,n){var r=n(34),o=n(652);r({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(e,t,n){var r=n(34),o=n(312).entries;r({target:"Object",stat:!0},{entries:function(e){return o(e)}})},function(e,t,n){var r=n(138),o=n(656),a=Object.prototype;o!==a.toString&&r(a,"toString",o,{unsafe:!0})},function(e,t,n){var r=n(34),o=n(312).values;r({target:"Object",stat:!0},{values:function(e){return o(e)}})},function(e,t,n){"use strict";var r=n(34),i=n(85),s=n(203),u=n(83),o=n(198),c="".endsWith,l=Math.min;r({target:"String",proto:!0,forced:!o("endsWith")},{endsWith:function(e){var t=String(u(this));s(e);var n=1<arguments.length?arguments[1]:void 0,r=i(t.length),o=void 0===n?r:l(i(n),r),a=String(e);return c?c.call(t,a,o):t.slice(o-a.length,o)===a}})},function(e,t,n){"use strict";var r=n(34),o=n(203),a=n(83);r({target:"String",proto:!0,forced:!n(198)("includes")},{includes:function(e){return!!~String(a(this)).indexOf(o(e),1<arguments.length?arguments[1]:void 0)}})},function(e,t,n){"use strict";var o=n(658).charAt,r=n(201),a=n(645),i="String Iterator",s=r.set,u=r.getterFor(i);a(String,"String",function(e){s(this,{type:i,string:String(e),index:0})},function(){var e,t=u(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=o(n,r),t.index+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(34),o=n(85),a=n(203),i=n(83),s=n(198),u="".startsWith,c=Math.min;r({target:"String",proto:!0,forced:!s("startsWith")},{startsWith:function(e){var t=String(i(this));a(e);var n=o(c(1<arguments.length?arguments[1]:void 0,t.length)),r=String(e);return u?u.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){n(23)("asyncIterator")},function(e,t,n){"use strict";var r=n(34),o=n(56),a=n(32),i=n(40),s=n(51),u=n(62).f,c=n(302),l=a.Symbol;if(o&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var f={},d=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof d?new l(e):void 0===e?l():l(e);return""===e&&(f[t]=!0),t};c(d,l);var p=d.prototype=l.prototype;p.constructor=d;var h=p.toString,y="Symbol(test)"==String(l("test")),v=/^Symbol\((.*)\)[^)]+$/;u(p,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=h.call(e);if(i(f,e))return"";var n=y?t.slice(7,-1):t.replace(v,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:d})}},function(e,t,n){n(23)("hasInstance")},function(e,t,n){n(23)("isConcatSpreadable")},function(e,t,n){n(23)("iterator")},function(e,t,n){"use strict";function r(e,t){var n=te[e]=w(Z[B]);return q(n,{type:L,tag:e,description:t}),l||(n.description=t),n}function o(t,e){v(t);var n=m(e),r=x(n).concat(de(n));return U(r,function(e){l&&!fe.call(n,e)||le(t,e,n[e])}),t}function a(e,t){var n=m(e),r=b(t,!0);if(n!==Y||!p(te,r)||p(ne,r)){var o=X(n,r);return!o||!p(te,r)||p(n,F)&&n[F][r]||(o.enumerable=!0),o}}function i(e){var t=J(m(e)),n=[];return U(t,function(e){p(te,e)||p(C,e)||n.push(e)}),n}var s=n(34),u=n(32),c=n(134),l=n(56),f=n(309),d=n(50),p=n(40),h=n(202),y=n(51),v=n(70),g=n(86),m=n(84),b=n(140),_=n(102),w=n(204),x=n(136),E=n(206),k=n(654),T=n(207),A=n(205),I=n(62),O=n(137),j=n(61),S=n(138),M=n(105),R=n(139),C=n(133),P=n(210),z=n(28),V=n(313),G=n(23),N=n(104),D=n(201),U=n(299).forEach,F=R("hidden"),L="Symbol",B="prototype",$=z("toPrimitive"),q=D.set,H=D.getterFor(L),Y=Object[B],Z=u.Symbol,W=u.JSON,K=W&&W.stringify,X=A.f,Q=I.f,J=k.f,ee=O.f,te=M("symbols"),ne=M("op-symbols"),re=M("string-to-symbol-registry"),oe=M("symbol-to-string-registry"),ae=M("wks"),ie=u.QObject,se=!ie||!ie[B]||!ie[B].findChild,ue=l&&d(function(){return 7!=w(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=X(Y,t);r&&delete Y[t],Q(e,t,n),r&&e!==Y&&Q(Y,t,r)}:Q,ce=f&&"symbol"==typeof Z.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Z},le=function(e,t,n){e===Y&&le(ne,t,n),v(e);var r=b(t,!0);return v(n),p(te,r)?(n.enumerable?(p(e,F)&&e[F][r]&&(e[F][r]=!1),n=w(n,{enumerable:_(0,!1)})):(p(e,F)||Q(e,F,_(1,{})),e[F][r]=!0),ue(e,r,n)):Q(e,r,n)},fe=function(e){var t=b(e,!0),n=ee.call(this,t);return!(this===Y&&p(te,t)&&!p(ne,t))&&(!(n||!p(this,t)||!p(te,t)||p(this,F)&&this[F][t])||n)},de=function(e){var t=e===Y,n=J(t?ne:m(e)),r=[];return U(n,function(e){!p(te,e)||t&&!p(Y,e)||r.push(te[e])}),r};f||(S((Z=function(){if(this instanceof Z)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=P(e),n=function(e){this===Y&&n.call(ne,e),p(this,F)&&p(this[F],t)&&(this[F][t]=!1),ue(this,t,_(1,e))};return l&&se&&ue(Y,t,{configurable:!0,set:n}),r(t,e)})[B],"toString",function(){return H(this).tag}),O.f=fe,I.f=le,A.f=a,E.f=k.f=i,T.f=de,l&&(Q(Z[B],"description",{configurable:!0,get:function(){return H(this).description}}),c||S(Y,"propertyIsEnumerable",fe,{unsafe:!0})),V.f=function(e){return r(z(e),e)}),s({global:!0,wrap:!0,forced:!f,sham:!f},{Symbol:Z}),U(x(ae),function(e){G(e)}),s({target:L,stat:!0,forced:!f},{for:function(e){var t=String(e);if(p(re,t))return re[t];var n=Z(t);return re[t]=n,oe[n]=t,n},keyFor:function(e){if(!ce(e))throw TypeError(e+" is not a symbol");if(p(oe,e))return oe[e]},useSetter:function(){se=!0},useSimple:function(){se=!1}}),s({target:"Object",stat:!0,forced:!f,sham:!l},{create:function(e,t){return void 0===t?w(e):o(w(e),t)},defineProperty:le,defineProperties:o,getOwnPropertyDescriptor:a}),s({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:i,getOwnPropertySymbols:de}),s({target:"Object",stat:!0,forced:d(function(){T.f(1)})},{getOwnPropertySymbols:function(e){return T.f(g(e))}}),W&&s({target:"JSON",stat:!0,forced:!f||d(function(){var e=Z();return"[null]"!=K([e])||"{}"!=K({a:e})||"{}"!=K(Object(e))})},{stringify:function(e){for(var t,n,r=[e],o=1;o<arguments.length;)r.push(arguments[o++]);if(n=t=r[1],(y(t)||void 0!==e)&&!ce(e))return h(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!ce(t))return t}),r[1]=t,K.apply(W,r)}}),Z[B][$]||j(Z[B],$,Z[B].valueOf),N(Z,L),C[F]=!0},function(e,t,n){n(23)("matchAll")},function(e,t,n){n(23)("match")},function(e,t,n){n(23)("replace")},function(e,t,n){n(23)("search")},function(e,t,n){n(23)("species")},function(e,t,n){n(23)("split")},function(e,t,n){n(23)("toPrimitive")},function(e,t,n){n(23)("toStringTag")},function(e,t,n){n(23)("unscopables")},function(e,t,n){n(23)("asyncDispose")},function(e,t,n){n(23)("dispose")},function(e,t,n){n(23)("observable")},function(e,t,n){n(23)("patternMatch")},function(e,t,n){n(23)("replaceAll")},function(e,t){function n(e,t,n){!function e(t,n,r,o){var a;if("object"==typeof t&&null!==t){for(a=0;a<r.length;a++)if(r[a]===t)return o[n]="[Circular]",void l.push([o,n,t]);if(r.push(t),Array.isArray(t))for(a=0;a<t.length;a++)e(t[a],a,r,t);else{var i=Object.keys(t);for(a=0;a<i.length;a++){var s=i[a];e(t[s],s,r,t)}}r.pop()}}(e,"",[],void 0);for(var r=JSON.stringify(e,t,n);0!==l.length;){var o=l.pop();o[0][o[1]]=o[2]}return r}function c(e,t){return e<t?-1:t<e?1:0}function r(e,t,n){for(var r=function e(t,n,r,o){var a;if("object"==typeof t&&null!==t){for(a=0;a<r.length;a++)if(r[a]===t)return o[n]="[Circular]",void l.push([o,n,t]);if("function"==typeof t.toJSON)return;if(r.push(t),Array.isArray(t))for(a=0;a<t.length;a++)e(t[a],a,r,t);else{var i={},s=Object.keys(t).sort(c);for(a=0;a<s.length;a++){var u=s[a];e(t[u],u,r,t),i[u]=t[u]}if(void 0===o)return i;l.push([o,n,t]),o[n]=i}r.pop()}}(e,"",[],void 0)||e,o=JSON.stringify(r,t,n);0!==l.length;){var a=l.pop();a[0][a[1]]=a[2]}return o}((e.exports=n).default=n).stable=r,n.stableStringify=r;var l=[]},function(e,t,n){var r,o=o||function(s){"use strict";if(!(void 0===s||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=s.document,u=function(){return s.URL||s.webkitURL||s},c=e.createElementNS("http://www.w3.org/1999/xhtml","a"),l="download"in c,f=/constructor/i.test(s.HTMLElement)||s.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent),p=function(e){(s.setImmediate||s.setTimeout)(function(){throw e},0)},h=function(e){setTimeout(function(){"string"==typeof e?u().revokeObjectURL(e):e.remove()},4e4)},y=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},r=function(e,t,n){n||(e=y(e));function r(){!function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){p(e)}}}(a,"writestart progress write writeend".split(" "))}var o,a=this,i="application/octet-stream"===e.type;return a.readyState=a.INIT,l?(o=u().createObjectURL(e),void setTimeout(function(){c.href=o,c.download=t,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(c),r(),h(o),a.readyState=a.DONE})):void function(){if((d||i&&f)&&s.FileReader){var t=new FileReader;return t.onloadend=function(){var e=d?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");s.open(e,"_blank")||(s.location.href=e),e=void 0,a.readyState=a.DONE,r()},t.readAsDataURL(e),a.readyState=a.INIT}(o=o||u().createObjectURL(e),i)?s.location.href=o:s.open(o,"_blank")||(s.location.href=o);a.readyState=a.DONE,r(),h(o)}()},t=r.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=y(e)),navigator.msSaveOrOpenBlob(e,t)}:(t.abort=function(){},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,function(e,t,n){return new r(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==e&&e.exports?e.exports.saveAs=o:null!==n(978)&&null!==n(979)&&(void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r))},function(e,t){t.read=function(e,t,n,r,o){var a,i,s=8*o-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?o-1:0,d=n?-1:1,p=e[t+f];for(f+=d,a=p&(1<<-l)-1,p>>=-l,l+=s;0<l;a=256*a+e[t+f],f+=d,l-=8);for(i=a&(1<<-l)-1,a>>=-l,l+=r;0<l;i=256*i+e[t+f],f+=d,l-=8);if(0===a)a=1-c;else{if(a===u)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,r),a-=c}return(p?-1:1)*i*Math.pow(2,a-r)},t.write=function(e,t,n,r,o,a){var i,s,u,c=8*a-o-1,l=(1<<c)-1,f=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,h=r?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,i=l):(i=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-i))<1&&(i--,u*=2),2<=(t+=1<=i+f?d/u:d*Math.pow(2,1-f))*u&&(i++,u/=2),l<=i+f?(s=0,i=l):1<=i+f?(s=(t*u-1)*Math.pow(2,o),i+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,o),i=0));8<=o;e[n+p]=255&s,p+=h,s/=256,o-=8);for(i=i<<o|s,c+=o;0<c;e[n+p]=255&i,p+=h,i/=256,c-=8);e[n+p-h]|=128*y}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o,a,i,s){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,a,i,s],l=0;(u=new Error(t.replace(/%s/g,function(){return c[l++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},function(e,t){"use strict";var n=/.+\@.+\..+/;e.exports=function(e){return n.test(e)}},function(e,t){e.exports={name:"tigerconnect",private:!0,version:"11.7.0",description:"JS (web and node) SDK for TigerConnect",homepage:"https://tigerconnect.github.io/js-sdk/",repository:"tigerconnect/js-sdk",author:{name:"TigerConnect Developers",email:"developersupport@tigerconnect.com",url:"https://tigerconnect.github.io/js-sdk/"},main:"lib/index.js",keywords:["tigerconnect","tigertext","communications","messenger","sdk"],scripts:{"build:clean":"rimraf lib dist","build:js":"babel -d lib/ src/","build:travis":"run-s lint coverage:travis build","build:webpack":"webpack","build:webpack:node":"webpack --target node",build:"run-p build:clean build:js build:webpack","build:node":"run-s build:webpack:node",coverage:"run-s coverage:clean coverage:test coverage:report:html","coverage:check":"nyc check-coverage","coverage:clean":"rimraf .nyc_output","coverage:open":"open-cli coverage/index.html","coverage:report":"run-s coverage:report:*","coverage:report:codecov":"nyc report --reporter=lcov > coverage.lcov && codecov","coverage:report:html":"rimraf coverage && nyc report --reporter=html","coverage:test":'cross-env NODE_ENV=coverage nyc mocha "test/**/*.test.js"',"coverage:travis":"run-s coverage:test coverage:report coverage:check","deploy:docs":"gulp npm:publish:docs:prepare",deps:"npm-check -s","deps:update":"npm-check -u",lint:"eslint . --ext .js","lint:fix":"eslint . --ext .js --fix",test:'mocha "test/**/*.test.js"',watch:"run-s build:clean && gulp build:js && run-p watch:js watch:webpack","watch:js":"gulp watch:js","watch:test":"npm test -- -w","watch:webpack":"webpack --watch"},husky:{hooks:{"pre-push":"./hooks/pre-push"}},nyc:{statements:79,branches:70,lines:80,include:["src/**/*.js"],exclude:["test/**/*.test.js"],require:["babel-register"],sourceMap:!1,instrument:!1,cache:!0},dependencies:{"@tigerconnect/node-fetch":"^2.6.0-tc1","abortcontroller-polyfill":"^1.3.0",btoa:"^1.1.2",events:"^3.1.0","file-saver":"^1.3.3","file-type":"^4.0.0","humanize-list":"^1.0.1",invariant:"^2.2.2","is-email":"^1.0.0",jshashes:"^1.0.7",lodash:"^4.17.15","lodash-bound":"^1.1.2","lodash.throttle":"^4.1.1",maltypart:"^1.5.0",mime:"^1.6.0",moment:"^2.24.0",promise:"^8.0.3",raf:"^3.4.0",request:"^2.88.0","reuse-promise":"^1.1.0",shallowequal:"^0.2.2","sorted-array-functions":"^1.1.0",superagent:"^5.1.0","superagent-prefix":"0.0.2",uuid:"^3.0.0",visibilityjs:"^2.0.2"},devDependencies:{"assets-webpack-plugin":"^4.0.0","babel-cli":"~6.18.0","babel-core":"~6.21.0","babel-eslint":"^7.1.1","babel-loader":"^6.2.8","babel-plugin-add-module-exports":"^0.2.1","babel-plugin-conditional-compilation":"0.0.1","babel-plugin-flow-comments":"^6.3.19","babel-plugin-import-asserts":"^3.0.0","babel-plugin-istanbul":"^4.1.5","babel-plugin-lodash":"^3.2.10","babel-plugin-macros":"^1.0.15","babel-plugin-syntax-flow":"^6.18.0","babel-plugin-transform-class-properties":"~6.19.0","babel-plugin-transform-decorators-legacy":"^1.3.4","babel-plugin-transform-es2015-classes":"^6.18.0","babel-plugin-transform-flow-strip-types":"^6.18.0","babel-plugin-transform-runtime":"~6.15.0","babel-plugin-typecheck":"^3.9.0","babel-preset-es2015":"^6.18.0","babel-preset-stage-0":"^6.16.0",busboy:"^0.2.14",chai:"^4.2.0","chai-as-promised":"^7.1.1","chai-deep-match":"^1.2.1",codecov:"^3.6.5","core-js":"^3.2.1","cross-env":"^3.2.4",decache:"^4.1.0","dom-storage":"^2.0.2",eslint:"^3.17.1",gulp:"^4.0.2","gulp-babel":"^6.1.2","gulp-changed":"^4.0.1","gulp-debug":"^4.0.0","gulp-file":"^0.4.0","gulp-if":"^3.0.0","gulp-load-plugins":"^2.0.1","gulp-plumber":"^1.2.1","gulp-uglify":"^3.0.2","gulp-watch":"^5.0.1",husky:"^3.0.3",jsdom:"^15.1.1","jsdom-global":"^3.0.2","json-loader":"^0.5.4","lodash-webpack-plugin":"^0.11.2",mocha:"^6.2.0","mocha-clean":"^1.0.0",nock:"^9.0.2","npm-check":"^5.9.0","npm-run-all":"^4.0.2",nyc:"^14.1.1","open-cli":"^5.0.0","performance-now":"^2.0.0","promisify-child-process":"^3.1.1",rimraf:"^2.5.4",sinon:"^7.4.1","sinon-chai":"^3.3.0","strip-loader":"^0.1.2",timekeeper:"1.0.0",watch:"^1.0.1",webpack:"^1.13.3","webpack-node-externals":"^1.5.4",yargs:"^6.4.0"},license:{type:"Commercial",url:"https://tigerconnect.com/terms/end-user-terms-use-license-agreement/"}}},function(e,t,n){"use strict";var r=n(762);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){"use strict";var r=n(763);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){"use strict";var r=n(768);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){"use strict";var r=n(774);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){"use strict";var r=n(110);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(325),a=n(326),i=n(327),s=n(328),u=n(329);r.prototype.clear=o,r.prototype.delete=a,r.prototype.get=i,r.prototype.has=s,r.prototype.set=u,e.exports=r},function(e,t,n){var r=n(757).Symbol;e.exports=r},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t){e.exports=function(e,t,n,r){for(var o=-1,a=null==e?0:e.length;++o<a;){var i=e[o];t(r,i,n(i),e)}return r}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,a=[];++n<r;){var i=e[n];t(i,n,e)&&(a[o++]=i)}return a}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t,n){var o=n(319),a=n(332),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var r=e[t];i.call(e,t)&&a(r,n)&&(void 0!==n||t in e)||o(e,t,n)}},function(e,t,n){var i=n(142);e.exports=function(e,r,o,a){return i(e,function(e,t,n){r(a,e,o(e),n)}),a}},function(e,t,n){var p=n(213),h=n(317),y=n(318),v=n(107),g=n(734),m=n(215);e.exports=function(e,t,n,r){var o=-1,a=h,i=!0,s=e.length,u=[],c=t.length;if(!s)return u;n&&(t=v(t,g(n))),r?(a=y,i=!1):200<=t.length&&(a=m,i=!1,t=new p(t));e:for(;++o<s;){var l=e[o],f=null==n?l:n(l);if(l=r||0!==l?l:0,i&&f==f){for(var d=c;d--;)if(t[d]===f)continue e;u.push(l)}else a(t,f,r)||u.push(l)}return u}},function(e,t,n){var a=n(142);e.exports=function(e,r){var o=[];return a(e,function(e,t,n){r(e,t,n)&&o.push(e)}),o}},function(e,t,n){var c=n(711),l=n(753);e.exports=function e(t,n,r,o,a){var i=-1,s=t.length;for(r=r||l,a=a||[];++i<s;){var u=t[i];0<n&&r(u)?1<n?e(u,n-1,r,o,a):c(a,u):o||(a[a.length]=u)}return a}},function(e,t,n){var r=n(740)();e.exports=r},function(e,t,n){var r=n(718),o=n(110);e.exports=function(e,t){return e&&r(e,t,o)}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var y=n(316),v=n(744),g=n(745),m=n(746),b=n(322),_=n(42),w=n(770),x=n(773),E="[object Arguments]",k="[object Array]",T="[object Object]",A=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,r,o,a){var i=_(e),s=_(t),u=i?k:b(e),c=s?k:b(t),l=(u=u==E?T:u)==T,f=(c=c==E?T:c)==T,d=u==c;if(d&&w(e)){if(!w(t))return!1;l=!(i=!0)}if(d&&!l)return a=a||new y,i||x(e)?v(e,t,n,r,o,a):g(e,t,u,n,r,o,a);if(!(1&n)){var p=l&&A.call(e,"__wrapped__"),h=f&&A.call(t,"__wrapped__");if(p||h)return o(p?e.value():e,h?t.value():t,n,r,a=a||new y)}return!!d&&(a=a||new y,m(e,t,n,r,o,a))}},function(e,t,n){var p=n(316),h=n(321);e.exports=function(e,t,n,r){var o=n.length,a=o,i=!r;if(null==e)return!a;for(e=Object(e);o--;){var s=n[o];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<a;){var u=(s=n[o])[0],c=e[u],l=s[1];if(i&&s[2]){if(void 0===c&&!(u in e))return!1}else{var f=new p;if(r)var d=r(c,l,u,e,t,f);if(!(void 0===d?h(l,c,3,r,f):d))return!1}}return!0}},function(e,t,n){var i=n(142),s=n(217);e.exports=function(e,r){var o=-1,a=s(e)?Array(e.length):[];return i(e,function(e,t,n){a[++o]=r(e,t,n)}),a}},function(e,t,n){var r=n(723),o=n(750),a=n(330);e.exports=function(t){var n=o(t);return 1==n.length&&n[0][2]?a(n[0][0],n[0][1]):function(e){return e===t||r(e,t,n)}}},function(e,t,n){var o=n(321),a=n(766),i=n(767),s=n(216),u=n(324),c=n(330),l=n(109);e.exports=function(n,r){return s(n)&&u(r)?c(l(n),r):function(e){var t=a(e,n);return void 0===t&&t===r?i(e,n):o(r,t,3)}}},function(e,t,n){var u=n(214),c=n(731),l=n(143);e.exports=function(e,t,n){for(var r=-1,o=t.length,a={};++r<o;){var i=t[r],s=u(e,i);n(s,i)&&c(a,l(i,e),s)}return a}},function(e,t){e.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(e,t,n){var r=n(214);e.exports=function(t){return function(e){return r(e,t)}}},function(e,t,n){var r=n(333),o=n(756),a=n(760);e.exports=function(e,t){return a(o(e,t,r),e+"")}},function(e,t,n){var f=n(713),d=n(143),p=n(323),h=n(218),y=n(109);e.exports=function(e,t,n,r){if(!h(e))return e;for(var o=-1,a=(t=d(t,e)).length,i=a-1,s=e;null!=s&&++o<a;){var u=y(t[o]),c=n;if(o!=i){var l=s[u];void 0===(c=r?r(l,u,s):void 0)&&(c=h(l)?l:p(t[o+1])?[]:{})}f(s,u,c),s=s[u]}return e}},function(e,t){e.exports=function(e,t,n){var r=-1,o=e.length;t<0&&(t=o<-t?0:o+t),(n=o<n?o:n)<0&&(n+=o),o=n<t?0:n-t>>>0,t>>>=0;for(var a=Array(o);++r<o;)a[r]=e[r+t];return a}},function(e,t,n){var r=n(107);e.exports=function(t,e){return r(e,function(e){return[e,t[e]]})}},function(e,t){e.exports=function(t){return function(e){return t(e)}}},function(e,t,n){var p=n(213),h=n(317),y=n(318),v=n(215),g=n(741),m=n(758);e.exports=function(e,t,n){var r=-1,o=h,a=e.length,i=!0,s=[],u=s;if(n)i=!1,o=y;else if(200<=a){var c=t?null:g(e);if(c)return m(c);i=!1,o=v,u=new p}else u=t?[]:s;e:for(;++r<a;){var l=e[r],f=t?t(l):l;if(l=n||0!==l?l:0,i&&f==f){for(var d=u.length;d--;)if(u[d]===f)continue e;t&&u.push(f),s.push(l)}else o(u,f,n)||(u!==s&&u.push(f),s.push(l))}return s}},function(e,t,n){var r=n(107);e.exports=function(t,e){return r(e,function(e){return t[e]})}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var i=n(708),s=n(714),u=n(108),c=n(42);e.exports=function(o,a){return function(e,t){var n=c(e)?i:s,r=a?a():{};return n(e,o,u(t,2),r)}}},function(e,t,n){var s=n(217);e.exports=function(a,i){return function(e,t){if(null==e)return e;if(!s(e))return a(e,t);for(var n=e.length,r=i?n:-1,o=Object(e);(i?r--:++r<n)&&!1!==t(o[r],r,o););return e}}},function(e,t){e.exports=function(u){return function(e,t,n){for(var r=-1,o=Object(e),a=n(e),i=a.length;i--;){var s=a[u?i:++r];if(!1===t(o[s],s,o))break}return e}}},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(733),o=n(322),a=n(754),i=n(759);e.exports=function(n){return function(e){var t=o(e);return"[object Map]"==t?a(e):"[object Set]"==t?i(e):r(e,n(e))}}},function(e,t,n){var r=n(751),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var v=n(213),g=n(712),m=n(215);e.exports=function(e,t,n,r,o,a){var i=1&n,s=e.length,u=t.length;if(s!=u&&!(i&&s<u))return!1;var c=a.get(e);if(c&&a.get(t))return c==t;var l=-1,f=!0,d=2&n?new v:void 0;for(a.set(e,t),a.set(t,e);++l<s;){var p=e[l],h=t[l];if(r)var y=i?r(h,p,l,t,e,a):r(p,h,l,e,t,a);if(void 0!==y){if(y)continue;f=!1;break}if(d){if(!g(t,function(e,t){if(!m(d,t)&&(p===e||o(p,e,n,r,a)))return d.push(t)})){f=!1;break}}else if(p!==h&&!o(p,h,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var b=n(748),_=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,r,o,a){var i=1&n,s=b(e),u=s.length;if(u!=b(t).length&&!i)return!1;for(var c=u;c--;){var l=s[c];if(!(i?l in t:_.call(t,l)))return!1}var f=a.get(e);if(f&&a.get(t))return f==t;var d=!0;a.set(e,t),a.set(t,e);for(var p=i;++c<u;){var h=e[l=s[c]],y=t[l];if(r)var v=i?r(y,h,l,t,e,a):r(h,y,l,e,t,a);if(!(void 0===v?h===y||o(h,y,n,r,a):v)){d=!1;break}p=p||"constructor"==l}if(d&&!p){var g=e.constructor,m=t.constructor;g!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(d=!1)}return a.delete(e),a.delete(t),d}},function(n,e){(function(e){var t="object"==typeof e&&e&&e.Object===Object&&e;n.exports=t}).call(e,function(){return this}())},function(e,t,n){var r=n(331)(Object.keys,Object);e.exports=r},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){var a=n(324),i=n(110);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,a(o)]}return t}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var s=n(143),u=n(334),c=n(42),l=n(323),f=n(335),d=n(109);e.exports=function(e,t,n){for(var r=-1,o=(t=s(t,e)).length,a=!1;++r<o;){var i=d(t[r]);if(!(a=null!=e&&n(e,i)))break;e=e[i]}return a||++r!=o?a:!!(o=null==e?0:e.length)&&f(o)&&l(i,o)&&(c(e)||u(e))}},function(e,t,n){var r=n(706),o=n(334),a=n(42),i=r?r.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||o(e)||!!(i&&e&&e[i])}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(776);e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},function(e,t,n){var u=n(707),c=Math.max;e.exports=function(a,i,s){return i=c(void 0===i?a.length-1:i,0),function(){for(var e=arguments,t=-1,n=c(e.length-i,0),r=Array(n);++t<n;)r[t]=e[i+t];t=-1;for(var o=Array(i+1);++t<i;)o[t]=e[t];return o[i]=s(r),u(a,this,o)}}},function(e,t,n){var r=n(747),o="object"==typeof self&&self&&self.Object===Object&&self,a=r||o||Function("return this")();e.exports=a},function(e,t){e.exports=function(){return[]}},function(e,t){e.exports=function(){return[]}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(755),a=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,o=r(function(e){var o=[];return a.test(e)&&o.push(""),e.replace(i,function(e,t,n,r){o.push(n?r.replace(s,"$1"):t||e)}),o});e.exports=o},function(e,t,n){e.exports=n(765)},function(e,t,n){var r=n(710),o=n(716),a=n(108),i=n(42);e.exports=function(e,t){return(i(e)?r:o)(e,a(t,3))}},function(e,t,n){var r=n(717);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},function(e,t,n){var r=n(709),o=n(142),a=n(737),i=n(42);e.exports=function(e,t){return(i(e)?r:o)(e,a(t))}},function(e,t,n){var o=n(214);e.exports=function(e,t,n){var r=null==e?void 0:o(e,t);return void 0===r?n:r}},function(e,t,n){var r=n(721),o=n(752);e.exports=function(e,t){return null!=e&&o(e,t,r)}},function(e,t,n){var r=n(732);e.exports=function(e){return(null==e?0:e.length)?r(e,0,-1):[]}},function(e,t,n){var r=n(217),o=n(336);e.exports=function(e){return o(e)&&r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(720),o=n(218);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t){e.exports=function(){return!1}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(319),o=n(738)(function(e,t,n){r(e,n,t)});e.exports=o},function(e,t,n){var r=n(107),o=n(108),a=n(724),i=n(42);e.exports=function(e,t){return(i(e)?r:a)(e,o(t,3))}},function(e,t,n){function r(o,a){if("function"!=typeof o||null!=a&&"function"!=typeof a)throw new TypeError(u);var i=function(){var e=arguments,t=a?a.apply(this,e):e[0],n=i.cache;if(n.has(t))return n.get(t);var r=o.apply(this,e);return i.cache=n.set(t,r)||n,r};return i.cache=new(r.Cache||s),i}var s=n(705),u="Expected a function";r.Cache=s,e.exports=r},function(e,t){e.exports=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}},function(e,t,n){var r=n(108),o=n(777),a=n(779);e.exports=function(e,t){return a(e,o(r(t)))}},function(e,t,n){var r=n(107),o=n(108),a=n(727),i=n(749);e.exports=function(e,n){if(null==e)return{};var t=r(i(e),function(e){return[e]});return n=o(n),a(e,t,function(e,t){return n(e,t[0])})}},function(e,t,n){var r=n(728),o=n(729),a=n(216),i=n(109);e.exports=function(e){return a(e)?r(i(e)):o(e)}},function(e,t,n){var r=n(742)(n(110));e.exports=r},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(735);e.exports=function(e){return e&&e.length?r(e):[]}},function(e,t,n){var r=n(736),o=n(110);e.exports=function(e){return null==e?[]:r(e,o(e))}},function(e,t,n){var r=n(715),o=n(730),a=n(769),i=o(function(e,t){return a(e)?r(e,t):[]});e.exports=i},function(e,t,n){"use strict";var r=n(781);e.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(e,t){var r="[object Function]",o=/^\[object .+?Constructor\]$/,n=Object.prototype,a=Function.prototype.toString,i=n.hasOwnProperty,s=n.toString,u=RegExp("^"+a.call(i).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e,t){var n=null==e?void 0:e[t];return function(e){return null!=e&&(function(e){return function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)&&s.call(e)==r}(e)?u.test(a.call(e)):function(e){return!!e&&"object"==typeof e}(e)&&o.test(e))}(n)?n:void 0}},function(e,t){var n=9007199254740991,r="[object Function]",o="[object GeneratorFunction]",a=Object.prototype,i=a.hasOwnProperty,s=a.toString,u=a.propertyIsEnumerable;e.exports=function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=n}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?s.call(e):"";return t==r||t==o}(e)}(e)}(e)&&i.call(e,"callee")&&(!u.call(e,"callee")||"[object Arguments]"==s.call(e))}},function(e,t){function n(e){return!!e&&"object"==typeof e}var r,o,a,i,s,u,c,l="[object Function]",f=/^\[object .+?Constructor\]$/,d=Object.prototype,p=Function.prototype.toString,h=d.hasOwnProperty,y=d.toString,v=RegExp("^"+p.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=(s=Array,u="isArray",c=null==s?void 0:s[u],null!=(i=c)&&(o=typeof(r=a=i),!r||"object"!=o&&"function"!=o||y.call(a)!=l?n(i)&&f.test(i):v.test(p.call(i)))?c:void 0),m=g||function(e){return n(e)&&function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991}(e.length)&&"[object Array]"==y.call(e)};e.exports=m},function(e,t,n){function u(e,t){return e="number"==typeof e||i.test(e)?+e:-1,t=null==t?h:t,-1<e&&e%1==0&&e<t}function c(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=h}function r(e){for(var t=function(e){if(null==e)return[];l(e)||(e=Object(e));var t=e.length;t=t&&c(t)&&(d(e)||f(e))&&t||0;for(var n=e.constructor,r=-1,o="function"==typeof n&&n.prototype===e,a=Array(t),i=0<t;++r<t;)a[r]=r+"";for(var s in e)i&&u(s,t)||"constructor"==s&&(o||!p.call(e,s))||a.push(s);return a}(e),n=t.length,r=n&&e.length,o=!!r&&c(r)&&(d(e)||f(e)),a=-1,i=[];++a<n;){var s=t[a];(o&&u(s,r)||p.call(e,s))&&i.push(s)}return i}function l(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var o,a=n(787),f=n(788),d=n(789),i=/^\d+$/,p=Object.prototype.hasOwnProperty,s=a(Object,"keys"),h=9007199254740991,y=(o="length",function(e){return null==e?void 0:e[o]}),v=s?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&function(e){return null!=e&&c(y(e))}(e)?r(e):l(e)?s(e):[]}:r;e.exports=v},function(e,t,n){function r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var o=n(359),a=n(360),i=n(361),s=n(362),u=n(363);r.prototype.clear=o,r.prototype.delete=a,r.prototype.get=i,r.prototype.has=s,r.prototype.set=u,e.exports=r},function(e,t,n){var r=n(233).Symbol;e.exports=r},function(e,t,n){var r=n(233).Uint8Array;e.exports=r},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,a=[];++n<r;){var i=e[n];t(i,n,e)&&(a[o++]=i)}return a}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t){e.exports=function(e,t,n,r){var o=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++o]);++o<a;)n=t(n,e[o],o,e);return n}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e){return e.split("")}},function(e,t){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(n)||[]}},function(e,t,n){var r=n(72),o=n(65);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(72),o=n(161);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var g=n(145),m=n(219),b=n(146),_=n(800),w=n(801),x=n(349),E=n(227),k=n(834),T=n(835),A=n(353),I=n(228),O=n(230),j=n(855),S=n(856),M=n(356),R=n(26),C=n(114),P=n(883),z=n(52),V=n(884),G=n(65),N=1,D=2,U=4,F="[object Arguments]",L="[object Function]",B="[object GeneratorFunction]",$="[object Object]",q={};q[F]=q["[object Array]"]=q["[object ArrayBuffer]"]=q["[object DataView]"]=q["[object Boolean]"]=q["[object Date]"]=q["[object Float32Array]"]=q["[object Float64Array]"]=q["[object Int8Array]"]=q["[object Int16Array]"]=q["[object Int32Array]"]=q["[object Map]"]=q["[object Number]"]=q[$]=q["[object RegExp]"]=q["[object Set]"]=q["[object String]"]=q["[object Symbol]"]=q["[object Uint8Array]"]=q["[object Uint8ClampedArray]"]=q["[object Uint16Array]"]=q["[object Uint32Array]"]=!0,q["[object Error]"]=q[L]=q["[object WeakMap]"]=!1,e.exports=function n(r,o,a,e,t,i){var s,u=o&N,c=o&D,l=o&U;if(a&&(s=t?a(r,e,t,i):a(r)),void 0!==s)return s;if(!z(r))return r;var f=R(r);if(f){if(s=j(r),!u)return E(r,s)}else{var d=O(r),p=d==L||d==B;if(C(r))return x(r,u);if(d==$||d==F||p&&!t){if(s=c||p?{}:M(r),!u)return c?T(r,w(s,r)):k(r,_(s,r))}else{if(!q[d])return t?r:{};s=S(r,d,u)}}var h=(i=i||new g).get(r);if(h)return h;i.set(r,s),V(r)?r.forEach(function(e){s.add(n(e,o,a,e,r,i))}):P(r)&&r.forEach(function(e,t){s.set(t,n(e,o,a,t,r,i))});var y=l?c?I:A:c?keysIn:G,v=f?void 0:y(r);return m(v||r,function(e,t){v&&(e=r[t=e]),b(s,t,n(e,o,a,t,r,i))}),s}},function(e,t,n){var a=n(222);e.exports=function(e,r){var o=[];return a(e,function(e,t,n){r(e,t,n)&&o.push(e)}),o}},function(e,t){e.exports=function(e,t,n,r){for(var o=e.length,a=n+(r?1:-1);r?a--:++a<o;)if(t(e[a],a,e))return a;return-1}},function(e,t){e.exports=function(e,r,t){var o;return t(e,function(e,t,n){if(r(e,t,n))return o=t,!1}),o}},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&n.call(e,t)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t){e.exports=function(e,t,n,r){for(var o=n-1,a=e.length;++o<a;)if(r(e[o],t))return o;return-1}},function(e,t,n){var v=n(144),g=n(220),m=n(221),b=n(64),_=n(152),w=n(153),x=Math.min;e.exports=function(e,t,n){for(var r=n?m:g,o=e[0].length,a=e.length,i=a,s=Array(a),u=1/0,c=[];i--;){var l=e[i];i&&t&&(l=b(l,_(t))),u=x(l.length,u),s[i]=!n&&(t||120<=o&&120<=l.length)?new v(i&&l):void 0}l=e[0];var f=-1,d=s[0];e:for(;++f<o&&c.length<u;){var p=l[f],h=t?t(p):p;if(p=n||0!==p?p:0,!(d?w(d,h):r(c,h,n))){for(i=a;--i;){var y=s[i];if(!(y?w(y,h):r(e[i],h,n)))continue e}d&&d.push(h),c.push(p)}}return c}},function(e,t,n){var i=n(111);e.exports=function(e,r,o,a){return i(e,function(e,t,n){r(a,o(e),t,n)}),a}},function(e,t,n){var y=n(145),v=n(846),g=n(847),m=n(848),b=n(230),_=n(26),w=n(114),x=n(160),E="[object Arguments]",k="[object Array]",T="[object Object]",A=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,r,o,a){var i=_(e),s=_(t),u=i?k:b(e),c=s?k:b(t),l=(u=u==E?T:u)==T,f=(c=c==E?T:c)==T,d=u==c;if(d&&w(e)){if(!w(t))return!1;l=!(i=!0)}if(d&&!l)return a=a||new y,i||x(e)?v(e,t,n,r,o,a):g(e,t,u,n,r,o,a);if(!(1&n)){var p=l&&A.call(e,"__wrapped__"),h=f&&A.call(t,"__wrapped__");if(p||h)return o(p?e.value():e,h?t.value():t,n,r,a=a||new y)}return!!d&&(a=a||new y,m(e,t,n,r,o,a))}},function(e,t,n){var p=n(145),h=n(224);e.exports=function(e,t,n,r){var o=n.length,a=o,i=!r;if(null==e)return!a;for(e=Object(e);o--;){var s=n[o];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<a;){var u=(s=n[o])[0],c=e[u],l=s[1];if(i&&s[2]){if(void 0===c&&!(u in e))return!1}else{var f=new p;if(r)var d=r(c,l,u,e,t,f);if(!(void 0===d?h(l,c,3,r,f):d))return!1}}return!0}},function(e,t,n){var r=n(155)(Object.keys,Object);e.exports=r},function(e,t,n){var i=n(222),s=n(74);e.exports=function(e,r){var o=-1,a=s(e)?Array(e.length):[];return i(e,function(e,t,n){a[++o]=r(e,t,n)}),a}},function(e,t,n){var r=n(812),o=n(850),a=n(364);e.exports=function(t){var n=o(t);return 1==n.length&&n[0][2]?a(n[0][0],n[0][1]):function(e){return e===t||r(e,t,n)}}},function(e,t,n){var o=n(224),a=n(73),i=n(370),s=n(231),u=n(358),c=n(364),l=n(89);e.exports=function(n,r){return s(n)&&u(r)?c(l(n),r):function(e){var t=a(e,n);return void 0===t&&t===r?i(e,n):o(r,t,3)}}},function(e,t,n){var y=n(342),v=n(349),g=n(831),m=n(227),b=n(356),_=n(158),w=n(26),x=n(113),E=n(114),k=n(236),T=n(52),A=n(373),I=n(160),O=n(366),j=n(895);e.exports=function(e,t,n,r,o,a,i){var s=O(e,n),u=O(t,n),c=i.get(u);if(c)y(e,n,c);else{var l=a?a(s,u,n+"",e,t,i):void 0,f=void 0===l;if(f){var d=w(u),p=!d&&E(u),h=!d&&!p&&I(u);l=u,d||p||h?l=w(s)?s:x(s)?m(s):p?v(u,!(f=!1)):h?g(u,!(f=!1)):[]:A(u)||_(u)?_(l=s)?l=j(s):T(s)&&!k(s)||(l=b(u)):f=!1}f&&(i.set(u,l),o(l,u,r,a,i),i.delete(u)),y(e,n,l)}}},function(e,t,n){var r=n(348),o=n(370);e.exports=function(n,e){return r(n,e,function(e,t){return o(n,t)})}},function(e,t){e.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(e,t,n){var r=n(150);e.exports=function(t){return function(e){return r(e,t)}}},function(e,t){e.exports=function(t){return function(e){return null==t?void 0:t[e]}}},function(e,t,n){var f=n(64),d=n(151),p=n(808),h=n(152),y=n(227),v=Array.prototype.splice;e.exports=function(e,t,n,r){var o=r?p:d,a=-1,i=t.length,s=e;for(e===t&&(t=y(t)),n&&(s=f(e,h(n)));++a<i;)for(var u=0,c=t[a],l=n?n(c):c;-1<(u=o(s,l,u,r));)s!==e&&v.call(s,u,1),v.call(e,u,1);return e}},function(e,t,n){var f=n(146),d=n(88),p=n(357),h=n(52),y=n(89);e.exports=function(e,t,n,r){if(!h(e))return e;for(var o=-1,a=(t=d(t,e)).length,i=a-1,s=e;null!=s&&++o<a;){var u=y(t[o]),c=n;if(o!=i){var l=s[u];void 0===(c=r?r(l,u,s):void 0)&&(c=h(l)?l:p(t[o+1])?[]:{})}f(s,u,c),s=s[u]}return e}},function(e,t){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},function(e,t,n){var r=n(88),o=n(375),a=n(859),i=n(89);e.exports=function(e,t){return t=r(t,e),null==(e=a(e,t))||delete e[i(o(t))]}},function(e,t,n){var r=n(64);e.exports=function(t,e){return r(e,function(e){return t[e]})}},function(e,t,n){var r=n(113);e.exports=function(e){return r(e)?e:[]}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var o=n(225);e.exports=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&r<=n?e:o(e,t,n)}},function(e,t,n){var r=n(793);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t,n){var r=n(830);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var l=n(374);e.exports=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,o=e==e,a=l(e),i=void 0!==t,s=null===t,u=t==t,c=l(t);if(!s&&!c&&!a&&t<e||a&&i&&u&&!s&&!c||r&&i&&u||!n&&u||!o)return 1;if(!r&&!a&&!c&&e<t||c&&n&&o&&!r&&!a||s&&n&&o||!i&&o||!u)return-1}return 0}},function(e,t,n){var c=n(832);e.exports=function(e,t,n){for(var r=-1,o=e.criteria,a=t.criteria,i=o.length,s=n.length;++r<i;){var u=c(o[r],a[r]);if(u)return s<=r?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}},function(e,t,n){var r=n(72),o=n(852);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t,n){var r=n(72),o=n(853);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t,n){var s=n(74);e.exports=function(a,i){return function(e,t){if(null==e)return e;if(!s(e))return a(e,t);for(var n=e.length,r=i?n:-1,o=Object(e);(i?r--:++r<n)&&!1!==t(o[r],r,o););return e}}},function(e,t){e.exports=function(u){return function(e,t,n){for(var r=-1,o=Object(e),a=n(e),i=a.length;i--;){var s=a[u?i:++r];if(!1===t(o[s],s,o))break}return e}}},function(e,t,n){var a=n(829),i=n(355),s=n(861),u=n(117);e.exports=function(o){return function(e){e=u(e);var t=i(e)?s(e):void 0,n=t?t[0]:e.charAt(0),r=t?a(t,1).join(""):e.slice(1);return n[o]()+r}}},function(e,t,n){var s=n(57),u=n(74),c=n(65);e.exports=function(i){return function(e,t,n){var r=Object(e);if(!u(e)){var o=s(t,3);e=c(e),t=function(e){return o(r[e],e,r)}}var a=i(e,t,n);return-1<a?r[o?e[a]:a]:void 0}}},function(e,t,n){var o=n(810);e.exports=function(n,r){return function(e,t){return o(e,n,r(t),{})}}},function(e,t){e.exports=function(){}},function(e,t,n){var s=n(346),u=n(52);e.exports=function e(t,n,r,o,a,i){return u(t)&&u(n)&&(i.set(n,t),s(t,n,void 0,e,i),i.delete(n)),t}},function(e,t,n){var r=n(373);e.exports=function(e){return r(e)?void 0:e}},function(e,t,n){var r=n(821)({"Ã€":"A","Ã":"A","Ã‚":"A","Ãƒ":"A","Ã„":"A","Ã…":"A","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã‡":"C","Ã§":"c","Ã":"D","Ã°":"d","Ãˆ":"E","Ã‰":"E","ÃŠ":"E","Ã‹":"E","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","ÃŒ":"I","Ã":"I","ÃŽ":"I","Ã":"I","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã‘":"N","Ã±":"n","Ã’":"O","Ã“":"O","Ã”":"O","Ã•":"O","Ã–":"O","Ã˜":"O","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã™":"U","Ãš":"U","Ã›":"U","Ãœ":"U","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã":"Y","Ã½":"y","Ã¿":"y","Ã†":"Ae","Ã¦":"ae","Ãž":"Th","Ã¾":"th","ÃŸ":"ss","Ä€":"A","Ä‚":"A","Ä„":"A","Ä":"a","Äƒ":"a","Ä…":"a","Ä†":"C","Äˆ":"C","ÄŠ":"C","ÄŒ":"C","Ä‡":"c","Ä‰":"c","Ä‹":"c","Ä":"c","ÄŽ":"D","Ä":"D","Ä":"d","Ä‘":"d","Ä’":"E","Ä”":"E","Ä–":"E","Ä˜":"E","Äš":"E","Ä“":"e","Ä•":"e","Ä—":"e","Ä™":"e","Ä›":"e","Äœ":"G","Äž":"G","Ä ":"G","Ä¢":"G","Ä":"g","ÄŸ":"g","Ä¡":"g","Ä£":"g","Ä¤":"H","Ä¦":"H","Ä¥":"h","Ä§":"h","Ä¨":"I","Äª":"I","Ä¬":"I","Ä®":"I","Ä°":"I","Ä©":"i","Ä«":"i","Ä­":"i","Ä¯":"i","Ä±":"i","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Ä»":"L","Ä½":"L","Ä¿":"L","Å":"L","Äº":"l","Ä¼":"l","Ä¾":"l","Å€":"l","Å‚":"l","Åƒ":"N","Å…":"N","Å‡":"N","ÅŠ":"N","Å„":"n","Å†":"n","Åˆ":"n","Å‹":"n","ÅŒ":"O","ÅŽ":"O","Å":"O","Å":"o","Å":"o","Å‘":"o","Å”":"R","Å–":"R","Å˜":"R","Å•":"r","Å—":"r","Å™":"r","Åš":"S","Åœ":"S","Åž":"S","Å ":"S","Å›":"s","Å":"s","ÅŸ":"s","Å¡":"s","Å¢":"T","Å¤":"T","Å¦":"T","Å£":"t","Å¥":"t","Å§":"t","Å¨":"U","Åª":"U","Å¬":"U","Å®":"U","Å°":"U","Å²":"U","Å©":"u","Å«":"u","Å­":"u","Å¯":"u","Å±":"u","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Å»":"Z","Å½":"Z","Åº":"z","Å¼":"z","Å¾":"z","Ä²":"IJ","Ä³":"ij","Å’":"Oe","Å“":"oe","Å‰":"'n","Å¿":"s"});e.exports=r},function(e,t,n){var r=n(851),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var v=n(144),g=n(797),m=n(153);e.exports=function(e,t,n,r,o,a){var i=1&n,s=e.length,u=t.length;if(s!=u&&!(i&&s<u))return!1;var c=a.get(e);if(c&&a.get(t))return c==t;var l=-1,f=!0,d=2&n?new v:void 0;for(a.set(e,t),a.set(t,e);++l<s;){var p=e[l],h=t[l];if(r)var y=i?r(h,p,l,t,e,a):r(p,h,l,e,t,a);if(void 0!==y){if(y)continue;f=!1;break}if(d){if(!g(t,function(e,t){if(!m(d,t)&&(p===e||o(p,e,n,r,a)))return d.push(t)})){f=!1;break}}else if(p!==h&&!o(p,h,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var b=n(353),_=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,r,o,a){var i=1&n,s=b(e),u=s.length;if(u!=b(t).length&&!i)return!1;for(var c=u;c--;){var l=s[c];if(!(i?l in t:_.call(t,l)))return!1}var f=a.get(e);if(f&&a.get(t))return f==t;var d=!0;a.set(e,t),a.set(t,e);for(var p=i;++c<u;){var h=e[l=s[c]],y=t[l];if(r)var v=i?r(y,h,l,t,e,a):r(h,y,l,e,t,a);if(!(void 0===v?h===y||o(h,y,n,r,a):v)){d=!1;break}p=p||"constructor"==l}if(d&&!p){var g=e.constructor,m=t.constructor;g!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(d=!1)}return a.delete(e),a.delete(t),d}},function(n,e){(function(e){var t="object"==typeof e&&e&&e.Object===Object&&e;n.exports=t}).call(e,function(){return this}())},function(e,t,n){var a=n(358),i=n(65);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,a(o)]}return t}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){e.exports=function(){return[]}},function(e,t){e.exports=function(){return[]}},function(e,t){var n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return n.test(e)}},function(e,t){var r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(792),o=n(158),a=n(26),i=r?r.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||o(e)||!!(i&&e&&e[i])}},function(e,t,n){var r=n(376);e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},function(e,t,n){var r=n(150),o=n(225);e.exports=function(e,t){return t.length<2?e:r(e,o(t,0,-1))}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(798),o=n(355),a=n(863);e.exports=function(e){return o(e)?a(e):r(e)}},function(e,t,n){var r=n(858),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,o=r(function(e){var o=[];return 46===e.charCodeAt(0)&&o.push(""),e.replace(a,function(e,t,n,r){o.push(n?r.replace(i,"$1"):t||e)}),o});e.exports=o},function(e,t){var n="\\ud800-\\udfff",r="["+n+"]",o="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\\ud83c[\\udffb-\\udfff]",i="[^"+n+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+o+"|"+a+")"+"?",l="[\\ufe0e\\ufe0f]?",f=l+c+("(?:\\u200d(?:"+[i,s,u].join("|")+")"+l+c+")*"),d="(?:"+[i+o+"?",o,s,u,r].join("|")+")",p=RegExp(a+"(?="+a+")|"+d+f,"g");e.exports=function(e){return e.match(p)||[]}},function(e,t){var n="\\ud800-\\udfff",r="\\u2700-\\u27bf",o="a-z\\xdf-\\xf6\\xf8-\\xff",a="A-Z\\xc0-\\xd6\\xd8-\\xde",i="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",s="["+i+"]",u="\\d+",c="["+r+"]",l="["+o+"]",f="[^"+n+i+u+r+o+a+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="["+a+"]",y="(?:"+l+"|"+f+")",v="(?:"+h+"|"+f+")",g="(?:['â€™](?:d|ll|m|re|s|t|ve))?",m="(?:['â€™](?:D|LL|M|RE|S|T|VE))?",b="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",_="[\\ufe0e\\ufe0f]?",w=_+b+("(?:\\u200d(?:"+["[^"+n+"]",d,p].join("|")+")"+_+b+")*"),x="(?:"+[c,d,p].join("|")+")"+w,E=RegExp([h+"?"+l+"+"+g+"(?="+[s,h,"$"].join("|")+")",v+"+"+m+"(?="+[s,h+y,"$"].join("|")+")",h+"?"+y+"+"+g,h+"+"+m,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",u,x].join("|"),"g");e.exports=function(e){return e.match(E)||[]}},function(e,t,n){var r=n(146),o=n(72),a=n(350),i=n(74),s=n(232),u=n(65),c=Object.prototype.hasOwnProperty,l=a(function(e,t){if(s(t)||i(t))o(t,u(t),e);else for(var n in t)c.call(t,n)&&r(e,n,t[n])});e.exports=l},function(e,t,n){var r=n(867),o=n(351)(function(e,t,n){return t=t.toLowerCase(),e+(n?r(t):t)});e.exports=o},function(e,t,n){var r=n(117),o=n(897);e.exports=function(e){return o(r(e).toLowerCase())}},function(e,t,n){var r=n(26);e.exports=function(){if(!arguments.length)return[];var e=arguments[0];return r(e)?e:[e]}},function(e,t){e.exports=function(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var a=e[t];a&&(o[r++]=a)}return o}},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(844),o=n(117),a=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,i=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=o(e))&&e.replace(a,r).replace(i,"")}},function(e,t,n){var r=n(794),o=n(803),a=n(57),i=n(26);e.exports=function(e,t){return(i(e)?r:o)(e,a(t,3))}},function(e,t,n){var r=n(839)(n(874));e.exports=r},function(e,t,n){var a=n(804),i=n(57),s=n(237),u=Math.max;e.exports=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:s(n);return o<0&&(o=u(r+o,0)),a(e,i(t,3),o)}},function(e,t,n){var r=n(805),o=n(111),a=n(57);e.exports=function(e,t){return r(e,a(t,3),o)}},function(e,t,n){e.exports=n(371)},function(e,t,n){var r=n(219),o=n(222),a=n(828),i=n(26);e.exports=function(e,t){return(i(e)?r:o)(e,a(t))}},function(e,t,n){var r=n(806),o=n(354);e.exports=function(e,t){return null!=e&&o(e,t,r)}},function(e,t,n){var a=n(151),i=n(74),s=n(885),u=n(237),c=n(163),l=Math.max;e.exports=function(e,t,n,r){e=i(e)?e:c(e),n=n&&!r?u(n):0;var o=e.length;return n<0&&(n=l(o+n,0)),s(e)?n<=o&&-1<e.indexOf(t,n):!!o&&-1<a(e,t,n)}},function(e,t,n){var r=n(64),o=n(809),a=n(58),i=n(827),s=a(function(e){var t=r(e,i);return t.length&&t[0]===e[0]?o(t):[]});e.exports=s},function(e,t,n){var r=n(870),o=n(840),a=n(112),i=Object.prototype.toString,s=o(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=i.call(t)),e[t]=n},r(a));e.exports=s},function(e,t,n){var r=n(224);e.exports=function(e,t){return r(e,t)}},function(e,t){e.exports=function(){return!1}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(223),o=n(26),a=n(159);e.exports=function(e){return"string"==typeof e||!o(e)&&a(e)&&"[object String]"==r(e)}},function(e,t,n){var a=n(148),i=n(111),s=n(57);e.exports=function(e,r){var o={};return r=s(r,3),i(e,function(e,t,n){a(o,r(e,t,n),e)}),o}},function(e,t,n){var o=n(346),r=n(350)(function(e,t,n,r){o(e,t,n,r)});e.exports=r},function(e,t,n){var o=n(347),a=n(26);e.exports=function(e,t,n,r){return null==e?[]:(a(t)||(t=null==t?[]:[t]),a(n=r?void 0:n)||(n=null==n?[]:[n]),o(e,t,n))}},function(e,t,n){var r=n(64),o=n(57),a=n(348),i=n(228);e.exports=function(e,n){if(null==e)return{};var t=r(i(e),function(e){return[e]});return n=o(n),a(e,t,function(e,t){return n(e,t[0])})}},function(e,t,n){var r=n(819),o=n(820),a=n(231),i=n(89);e.exports=function(e){return a(e)?r(i(e)):o(e)}},function(e,t,n){var r=n(58)(n(892));e.exports=r},function(e,t,n){var r=n(822);e.exports=function(e,t){return e&&e.length&&t&&t.length?r(e,t):e}},function(e,t,n){var r=n(351)(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});e.exports=r},function(e,t,n){var r=n(149),o=n(347),a=n(58),i=n(154),s=a(function(e,t){if(null==e)return[];var n=t.length;return 1<n&&i(e,t[0],t[1])?t=[]:2<n&&i(t[0],t[1],t[2])&&(t=[t[0]]),o(e,r(t,1),[])});e.exports=s},function(e,t,n){var r=n(72),o=n(161);e.exports=function(e){return r(e,o(e))}},function(e,t,n){var r=n(57),o=n(226);e.exports=function(e,t){return e&&e.length?o(e,r(t,2)):[]}},function(e,t,n){var r=n(838)("toUpperCase");e.exports=r},function(e,t,n){var r=n(344),o=n(58),a=n(113),i=o(function(e,t){return a(e)?r(e,t):[]});e.exports=i},function(e,t,n){var r=n(799),o=n(854),a=n(117),i=n(864);e.exports=function(e,t,n){return e=a(e),void 0===(t=n?void 0:t)?o(e)?i(e):r(e):e.match(t)||[]}},function(e,t,n){var r,o,a;o=[],void 0===(a="function"==typeof(r=function(){function e(e,t,n){this.fields={},"function"==typeof t&&(n=t,t=null),e&&this.append(e,n),this.setBoundary(t)}function s(e,t,n,r){this.data=e,this.contentType=t,this.filename=n,this.headers=r}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}var t=0;return e.prototype={constructor:e,availableTypes:["multipart","form-encoded"],setType:function(e){return this.typeOverride=-1!==this.availableTypes.indexOf(e)?e:null,this},getType:function(){var e=this.typeOverride;if(-1!==this.availableTypes.indexOf(e))return e;for(var t in this.fields)if(this.fields.hasOwnProperty(t)&&(this.fields[t],1)&&this.fields[t].contentType)return"multipart";return"form-encoded"},append:function(e,t,n){var r,o,a,i,s;if("string"==typeof e&&2<=arguments.length)return this.setField.apply(this,arguments);if("function"==typeof t&&(a=n,n=t,t=a),"function"==typeof n&&(i=1,s=function(){--i||n()}),d(e))for(a=0;a<e.length;a++)o=e[a],i++,this.setField(o.name,o.value,!1!==t,null,s);else for(r in e)if(e.hasOwnProperty(r))if(d(o=e[r]))for(a=0;a<o.length;a++)i++,this.setField(r,o[a],!0===t,null,s);else i++,this.setField(r,o,!1!==t,null,s);return i&&s(),this},setField:function(e,t,n,r,o){var a=this.fields;return e+="",window.File&&t instanceof window.File||window.Blob&&t instanceof window.Blob?this.setFileField.apply(this,arguments):("function"==typeof n&&(o=n,n=!0),t&&t.nodeType&&t.nodeName&&t.getAttribute?t=t.value:d(t)||t&&(t instanceof s||t.contentType&&t.data)||(t+=""),e.match(/\[\]$/g)&&(n=!1),!1===n&&a.hasOwnProperty(e)?(d(a[e])||(a[e]=[a[e]]),a[e].push(t)):a[e]=t,"function"==typeof o&&o(),this)},setFileField:function(e,t,n,r,o){var a=this,i=new FileReader;return"function"==typeof n&&(o=n,n=!0),i.onloadend=function(){a.setField(e,new s(function(e){for(var t="",n=new Uint8Array(e),r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return t}(i.result),t.type,t.name,r||t.headers),!1!==n),"function"==typeof o&&o(),t=o=a=i=null},i.readAsArrayBuffer(t),this},setBoundary:function(e){return this.boundary=(e||Math.random().toString(36).substring(2)+(++t).toString(36))+"",this},toString:function(e){var t,n,r,o,a,i,s,u,c,l=this.getType(),f="";for(n in this.boundary||this.setBoundary(),e&&this.append(e),this.fields)if(this.fields.hasOwnProperty(n))for(r=this.fields[n],t=d(r)?r:[r],s=0;s<t.length;s++){if(i=t[s],"multipart"===l){if(u=i.headers,o=null,i.contentType&&(o=i.contentType,i=i.data),a="--"+this.boundary+'\r\nContent-Disposition: form-data; name="'+n+'"',t[s].filename&&(a+='; filename="'+t[s].filename+'"'),a+="\r\n",o&&(a+="Content-type: "+o+"\r\n"),u)for(c in u)u.hasOwnProperty(c)&&(a+=c+": "+u[c]+"\r\n");a+="\r\n"+i+"\r\n"}else"form-encoded"===l&&(a=encodeURIComponent(n)+"="+encodeURIComponent(i)+"&");f+=a}return"multipart"===l?f+="--"+this.boundary+"--\r\n":"form-encoded"===l&&(f=f.substring(0,f.length-1)),f},getData:function(){var e,t,n=this.toString();if("multipart"!==this.getType())return n;e=n.length,t=new Uint8Array(e);for(var r=0;r<e;r++)t[r]=255&n.charCodeAt(r);return t},getContentType:function(e){var t=this.getType();return"multipart"===t?"multipart/form-data; "+(e?"charset=utf-8; ":"")+"boundary="+this.boundary:"application/x-www-form-encoded"}},{RequestBody:e,RequestField:s}})?r.apply(t,o):r)||(e.exports=a)},function(s,e,t){(function(i){(function(){var e,t,n,r,o,a;"undefined"!=typeof performance&&null!==performance&&performance.now?s.exports=function(){return performance.now()}:null!=i&&i.hrtime?(s.exports=function(){return(e()-o)/1e6},t=i.hrtime,r=(e=function(){var e;return 1e9*(e=t())[0]+e[1]})(),a=1e9*i.uptime(),o=r-a):n=Date.now?(s.exports=function(){return Date.now()-n},Date.now()):(s.exports=function(){return(new Date).getTime()-n},(new Date).getTime())}).call(this)}).call(e,t(66))},function(e,t,n){"use strict";function r(e){var t=new u(u._n);return t._i=1,t._j=e,t}var u=n(378);e.exports=u;var o=r(!0),a=r(!1),i=r(null),s=r(void 0),c=r(0),l=r("");u.resolve=function(n){if(n instanceof u)return n;if(null===n)return i;if(void 0===n)return s;if(!0===n)return o;if(!1===n)return a;if(0===n)return c;if(""===n)return l;if("object"==typeof n||"function"==typeof n)try{var e=n.then;if("function"==typeof e)return new u(e.bind(n))}catch(n){return new u(function(e,t){t(n)})}return r(n)},u.all=function(e){var s=Array.prototype.slice.call(e);return new u(function(r,o){function a(t,e){if(e&&("object"==typeof e||"function"==typeof e)){if(e instanceof u&&e.then===u.prototype.then){for(;3===e._i;)e=e._j;return 1===e._i?a(t,e._j):(2===e._i&&o(e._j),void e.then(function(e){a(t,e)},o))}var n=e.then;if("function"==typeof n)return void new u(n.bind(e)).then(function(e){a(t,e)},o)}s[t]=e,0==--i&&r(s)}if(0===s.length)return r([]);for(var i=s.length,e=0;e<s.length;e++)a(e,s[e])})},u.reject=function(n){return new u(function(e,t){t(n)})},u.race=function(e){return new u(function(t,n){e.forEach(function(e){u.resolve(e).then(t,n)})})},u.prototype.catch=function(e){return this.then(null,e)}},function(e,t,n){"use strict";function i(){l=!1,u._l=null,u._m=null}function s(t,e){return e.some(function(e){return t instanceof e})}var u=n(378),c=[ReferenceError,TypeError,RangeError],l=!1;t.disable=i,t.enable=function(t){function n(e){(t.allRejections||s(a[e].error,t.whitelist||c))&&(a[e].displayId=o++,t.onUnhandled?(a[e].logged=!0,t.onUnhandled(a[e].displayId,a[e].error)):(a[e].logged=!0,function(e,t){console.warn("Possible Unhandled Promise Rejection (id: "+e+"):"),((t&&(t.stack||t))+"").split("\n").forEach(function(e){console.warn("  "+e)})}(a[e].displayId,a[e].error)))}t=t||{},l&&i(),l=!0;var r=0,o=0,a={};u._l=function(e){2===e._i&&a[e._o]&&(a[e._o].logged?function(e){a[e].logged&&(t.onHandled?t.onHandled(a[e].displayId,a[e].error):a[e].onUnhandled||(console.warn("Promise Rejection Handled (id: "+a[e].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+a[e].displayId+".")))}(e._o):clearTimeout(a[e._o].timeout),delete a[e._o])},u._m=function(e,t){0===e._h&&(e._o=r++,a[e._o]={displayId:null,error:t,timeout:setTimeout(n.bind(null,e._o),s(t,c)?100:2e3),logged:!1})}}},function(e,t){"use strict";e.exports=function(e,t,n,r){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var i=1e3;r&&"number"==typeof r.maxKeys&&(i=r.maxKeys);var s,u,c=e.length;0<i&&i<c&&(c=i);for(var l=0;l<c;++l){var f,d,p,h,y=e[l].replace(a,"%20"),v=y.indexOf(n);d=0<=v?(f=y.substr(0,v),y.substr(v+1)):(f=y,""),p=decodeURIComponent(f),h=decodeURIComponent(d),s=o,u=p,Object.prototype.hasOwnProperty.call(s,u)?Array.isArray(o[p])?o[p].push(h):o[p]=[o[p],h]:o[p]=h}return o}},function(e,t){"use strict";function a(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}e.exports=function(n,r,o,e){return r=r||"&",o=o||"=",null===n&&(n=void 0),"object"==typeof n?Object.keys(n).map(function(e){var t=encodeURIComponent(a(e))+o;return Array.isArray(n[e])?n[e].map(function(e){return t+encodeURIComponent(a(e))}).join(r):t+encodeURIComponent(a(n[e]))}).join(r):e?encodeURIComponent(a(e))+o+encodeURIComponent(a(n)):""}},function(e,t,n){"use strict";t.decode=t.parse=n(904),t.encode=t.stringify=n(905)},function(f,e,d){(function(e){for(var r=d(901),t="undefined"==typeof window?e:window,n=["moz","webkit"],o="AnimationFrame",a=t["request"+o],i=t["cancel"+o]||t["cancelRequest"+o],s=0;!a&&s<n.length;s++)a=t[n[s]+"Request"+o],i=t[n[s]+"Cancel"+o]||t[n[s]+"CancelRequest"+o];if(!a||!i){var u=0,c=0,l=[];a=function(e){if(0===l.length){var t=r(),n=Math.max(0,1e3/60-(t-u));u=n+t,setTimeout(function(){for(var e=l.slice(0),t=l.length=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return l.push({handle:++c,callback:e,cancelled:!1}),c},i=function(e){for(var t=0;t<l.length;t++)l[t].handle===e&&(l[t].cancelled=!0)}}f.exports=function(e){return a.call(t,e)},f.exports.cancel=function(){i.apply(t,arguments)},f.exports.polyfill=function(e){(e=e||t).requestAnimationFrame=a,e.cancelAnimationFrame=i}}).call(e,function(){return this}())},function(e,t,n){e.exports=n(75)},function(e,t,n){"use strict";function r(){this.head=null,this.tail=null,this.length=0}var o=(n(49).Buffer,n(196));(e.exports=r).prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},r.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},r.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},r.prototype.concat=function(e){if(0===this.length)return o.alloc(0);if(1===this.length)return this.head.data;for(var t=o.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t}},function(e,t,n){e.exports=n(379)},function(e,t,n){e.exports=n(242)},function(e,t,n){e.exports=n(243)},function(e,t,n){e.exports={default:n(918),__esModule:!0}},function(e,t,n){e.exports={default:n(919),__esModule:!0}},function(e,t,n){e.exports={default:n(920),__esModule:!0}},function(e,t,n){e.exports={default:n(921),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var r,o=n(914),a=(r=o)&&r.__esModule?r:{default:r};t.default=a.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},function(e,t,n){var r=n(53),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t,n){n(950),e.exports=n(53).Object.assign},function(e,t,n){n(951),e.exports=n(53).Object.keys},function(e,t,n){n(952),n(954),n(957),n(953),n(955),n(956),e.exports=n(53).Promise},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var u=n(252),c=n(393),l=n(946);e.exports=function(s){return function(e,t,n){var r,o=u(e),a=c(o.length),i=l(n,a);if(s&&t!=t){for(;i<a;)if((r=o[i++])!=r)return!0}else for(;i<a;i++)if((s||i in o)&&o[i]===t)return s||i||0;return!s&&-1}}},function(e,t,n){var d=n(166),p=n(929),h=n(928),y=n(76),v=n(393),g=n(948),m={},b={};(t=e.exports=function(e,t,n,r,o){var a,i,s,u,c=o?function(){return e}:g(e),l=d(n,r,t?2:1),f=0;if("function"!=typeof c)throw TypeError(e+" is not iterable!");if(h(c)){for(a=v(e.length);f<a;f++)if((u=t?l(y(i=e[f])[0],i[1]):l(e[f]))===m||u===b)return u}else for(s=c.call(e);!(i=s.next()).done;)if((u=p(s,l,i.value,t))===m||u===b)return u}).BREAK=m,t.RETURN=b},function(e,t,n){e.exports=!n(118)&&!n(167)(function(){return 7!=Object.defineProperty(n(246)("div"),"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(120),o=n(44)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[o]===e)}},function(e,t,n){var a=n(76);e.exports=function(e,t,n,r){try{return r?t(a(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&a(o.call(e)),t}}},function(e,t,n){"use strict";var r=n(935),o=n(389),a=n(249),i={};n(91)(i,n(44)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(i,{next:o(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var a=n(44)("iterator"),i=!1;try{var r=[7][a]();r.return=function(){i=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var r=[7],o=r[a]();o.next=function(){return{done:n=!0}},r[a]=function(){return o},e(r)}catch(e){}return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var s=n(43),u=n(392).set,c=s.MutationObserver||s.WebKitMutationObserver,l=s.process,f=s.Promise,d="process"==n(165)(l);e.exports=function(){function e(){var e,t;for(d&&(e=l.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(e){throw n?o():r=void 0,e}}r=void 0,e&&e.enter()}var n,r,o;if(d)o=function(){l.nextTick(e)};else if(c){var t=!0,a=document.createTextNode("");new c(e).observe(a,{characterData:!0}),o=function(){a.data=t=!t}}else if(f&&f.resolve){var i=f.resolve();o=function(){i.then(e)}}else o=function(){u.call(s,e)};return function(e){var t={fn:e,next:void 0};r&&(r.next=t),n||(n=t,o()),r=t}}},function(e,t,n){"use strict";var d=n(248),p=n(937),h=n(940),y=n(253),v=n(384),o=Object.assign;e.exports=!o||n(167)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=o({},e)[n]||Object.keys(o({},t)).join("")!=r})?function(e,t){for(var n=y(e),r=arguments.length,o=1,a=p.f,i=h.f;o<r;)for(var s,u=v(arguments[o++]),c=a?d(u).concat(a(u)):d(u),l=c.length,f=0;f<l;)i.call(u,s=c[f++])&&(n[s]=u[s]);return n}:o},function(e,t,r){function o(){}var a=r(76),i=r(936),s=r(382),u=r(250)("IE_PROTO"),c="prototype",l=function(){var e,t=r(246)("iframe"),n=s.length;for(t.style.display="none",r(383).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l[c][s[n]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(o[c]=a(e),n=new o,o[c]=null,n[u]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var i=n(169),s=n(76),u=n(248);e.exports=n(118)?Object.defineProperties:function(e,t){s(e);for(var n,r=u(t),o=r.length,a=0;a<o;)i.f(e,n=r[a++],t[n]);return e}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(168),o=n(253),a=n(250)("IE_PROTO"),i=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?i:null}},function(e,t,n){var i=n(168),s=n(252),u=n(924)(!1),c=n(250)("IE_PROTO");e.exports=function(e,t){var n,r=s(e),o=0,a=[];for(n in r)n!=c&&i(r,n)&&a.push(n);for(;t.length>o;)i(r,n=t[o++])&&(~u(a,n)||a.push(n));return a}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var o=n(90),a=n(53),i=n(167);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],r={};r[e]=t(n),o(o.S+o.F*i(function(){n(1)}),"Object",r)}},function(e,t,n){var o=n(91);e.exports=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:o(e,r,t[r]);return e}},function(e,t,n){e.exports=n(91)},function(e,t,n){"use strict";var r=n(43),o=n(53),a=n(169),i=n(118),s=n(44)("species");e.exports=function(e){var t="function"==typeof o[e]?o[e]:r[e];i&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var u=n(251),c=n(245);e.exports=function(s){return function(e,t){var n,r,o=String(c(e)),a=u(t),i=o.length;return a<0||i<=a?s?"":void 0:(n=o.charCodeAt(a))<55296||56319<n||a+1===i||(r=o.charCodeAt(a+1))<56320||57343<r?s?o.charAt(a):n:s?o.slice(a,a+2):r-56320+(n-55296<<10)+65536}}},function(e,t,n){var r=n(251),o=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):a(e,t)}},function(e,t,n){var o=n(119);e.exports=function(e,t){if(!o(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!o(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!o(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(381),o=n(44)("iterator"),a=n(120);e.exports=n(53).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||a[r(e)]}},function(e,t,n){"use strict";var r=n(922),o=n(932),a=n(120),i=n(252);e.exports=n(385)(Array,"Array",function(e,t){this._t=i(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r=n(90);r(r.S+r.F,"Object",{assign:n(934)})},function(e,t,n){var r=n(253),o=n(248);n(941)("keys",function(){return function(e){return o(r(e))}})},function(e,t){},function(e,t,n){"use strict";function r(){}function l(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t}function o(c,n){if(!c._n){c._n=!0;var r=c._c;x(function(){for(var s=c._v,u=1==c._s,e=0,t=function(e){var t,n,r=u?e.ok:e.fail,o=e.resolve,a=e.reject,i=e.domain;try{r?(u||(2==c._h&&z(c),c._h=1),!0===r?t=s:(i&&i.enter(),t=r(s),i&&i.exit()),t===e.promise?a(I("Promise-chain cycle")):(n=l(t))?n.call(t,o,a):o(t)):a(s)}catch(e){a(e)}};r.length>e;)t(r[e++]);c._c=[],c._n=!1,n&&!c._h&&C(c)})}}function a(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),o(t,!0))}var i,s,u,c,f=n(386),d=n(43),p=n(166),h=n(381),y=n(90),v=n(119),g=n(164),m=n(923),b=n(925),_=n(391),w=n(392).set,x=n(933)(),E=n(247),k=n(387),T=n(388),A="Promise",I=d.TypeError,O=d.process,j=d[A],S="process"==h(O),M=s=E.f,R=!!function(){try{var e=j.resolve(1),t=(e.constructor={})[n(44)("species")]=function(e){e(r,r)};return(S||"function"==typeof PromiseRejectionEvent)&&e.then(r)instanceof t}catch(e){}}(),C=function(a){w.call(d,function(){var e,t,n,r=a._v,o=P(a);if(o&&(e=k(function(){S?O.emit("unhandledRejection",r,a):(t=d.onunhandledrejection)?t({promise:a,reason:r}):(n=d.console)&&n.error&&n.error("Unhandled promise rejection",r)}),a._h=S||P(a)?2:1),a._a=void 0,o&&e.e)throw e.v})},P=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if((t=n[r++]).fail||!P(t.promise))return!1;return!0},z=function(t){w.call(d,function(){var e;S?O.emit("rejectionHandled",t):(e=d.onrejectionhandled)&&e({promise:t,reason:t._v})})},V=function(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw I("Promise can't be resolved itself");(n=l(e))?x(function(){var t={_w:r,_d:!1};try{n.call(e,p(V,t,1),p(a,t,1))}catch(e){a.call(t,e)}}):(r._v=e,r._s=1,o(r,!1))}catch(e){a.call({_w:r,_d:!1},e)}}};R||(j=function(e){m(this,j,A,"_h"),g(e),i.call(this);try{e(p(V,this,1),p(a,this,1))}catch(e){a.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(942)(j.prototype,{then:function(e,t){var n=M(_(this,j));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=S?O.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&o(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),u=function(){var e=new i;this.promise=e,this.resolve=p(V,e,1),this.reject=p(a,e,1)},E.f=M=function(e){return e===j||e===c?new u(e):s(e)}),y(y.G+y.W+y.F*!R,{Promise:j}),n(249)(j,A),n(944)(A),c=n(53)[A],y(y.S+y.F*!R,A,{reject:function(e){var t=M(this);return(0,t.reject)(e),t.promise}}),y(y.S+y.F*(f||!R),A,{resolve:function(e){return T(f&&this===c?j:this,e)}}),y(y.S+y.F*!(R&&n(931)(function(e){j.all(e).catch(r)})),A,{all:function(e){var i=this,t=M(i),s=t.resolve,u=t.reject,n=k(function(){var r=[],o=0,a=1;b(e,!1,function(e){var t=o++,n=!1;r.push(void 0),a++,i.resolve(e).then(function(e){n||(n=!0,r[t]=e,--a||s(r))},u)}),--a||s(r)});return n.e&&u(n.v),t.promise},race:function(e){var t=this,n=M(t),r=n.reject,o=k(function(){b(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t,n){"use strict";var r=n(945)(!0);n(385)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(90),o=n(53),a=n(43),i=n(391),s=n(388);r(r.P+r.R,"Promise",{finally:function(t){var n=i(this,o.Promise||a.Promise),e="function"==typeof t;return this.then(e?function(e){return s(n,t()).then(function(){return e})}:t,e?function(e){return s(n,t()).then(function(){throw e})}:t)}})},function(e,t,n){"use strict";var r=n(90),o=n(247),a=n(387);r(r.S,"Promise",{try:function(e){var t=o.f(this),n=a(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){n(949);for(var r=n(43),o=n(91),a=n(120),i=n(44)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],l=r[c],f=l&&l.prototype;f&&!f[i]&&o(f,i,c),a[c]=a.Array}},function(e,t,n){(function(e,h){!function(n,r){"use strict";function o(e){delete u[e]}function a(e){if(c)setTimeout(a,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}(t)}finally{o(e),c=!1}}}}if(!n.setImmediate){var i,s=1,u={},c=!1,l=n.document,e=Object.getPrototypeOf&&Object.getPrototypeOf(n);e=e&&e.setTimeout?e:n,"[object process]"==={}.toString.call(n.process)?i=function(e){h.nextTick(function(){a(e)})}:function(){if(n.postMessage&&!n.importScripts){var e=!0,t=n.onmessage;return n.onmessage=function(){e=!1},n.postMessage("","*"),n.onmessage=t,e}}()?(d="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",p,!1):n.attachEvent("onmessage",p),i=function(e){n.postMessage(d+e,"*")}):n.MessageChannel?((t=new MessageChannel).port1.onmessage=function(e){a(e.data)},i=function(e){t.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(f=l.documentElement,i=function(e){var t=l.createElement("script");t.onreadystatechange=function(){a(e),t.onreadystatechange=null,f.removeChild(t),t=null},f.appendChild(t)}):i=function(e){setTimeout(a,0,e)},e.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[s]=r,i(s),s++},e.clearImmediate=o}var f,t,d;function p(e){e.source===n&&"string"==typeof e.data&&0===e.data.indexOf(d)&&a(+e.data.slice(d.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,function(){return this}(),n(66))},function(e,t){function c(e,t){return e===t?0:t<e?1:-1}function o(e,t,n){var r=a(e,t,n=n||c);return-1===r?-1:0===n(e[r],t)?r:-1}function a(e,t,n){n=n||c;for(var r=e.length,o=r-1,a=0,i=-1;a<=o&&0<=a&&o<r;){var s=n(e[i=Math.floor((o+a)/2)],t);if(0===s)return i;0<=s?o=i-1:a=i+1}return i}t.add=function(e,t,n){n=n||c;for(var r=e.push(t)-1;r;){if(0<n(t,e[r-1]))return;e[r]=e[r-1],e[r-1]=t,r--}},t.remove=function(e,t,n){var r=o(e,t,n);return-1!==r&&(e.splice(r,1),!0)},t.has=function(e,t,n){return-1<o(e,t,n)},t.eq=o,t.lte=function(e,t,n){var r=a(e,t,n=n||c);if(-1===r)return-1;for(;0<=r;r--){if(n(e[r],t)<=0)return r}return-1},t.lt=function(e,t,n){var r=a(e,t,n=n||c);if(-1===r)return-1;for(;0<=r;r--){if(n(e[r],t)<0)return r}return-1},t.gte=function(e,t,n){var r=a(e,t,n=n||c);if(-1===r)return-1;for(;r<e.length;r++){if(0<=n(e[r],t))return r}return-1},t.gt=function(e,t,n){var r=a(e,t,n=n||c);if(-1===r)return-1;for(;r<e.length;r++){if(0<n(e[r],t))return r}return-1},t.nearest=function(e,t,n){n=n||c;for(var r=e.length,o=r-1,a=0,i=-1,s=1;a<=o&&0<=a&&o<r;){var u=n(e[i=Math.floor((o+a)/2)],t);if(0===u)return i;if(0<=u){if(1===s)s=0;else if(2===s)return Math.abs(e[i]-t)>Math.abs(e[i-1]-t)?i-1:i;o=i-1}else{if(1===s)s=2;else if(0===s)return i;a=i+1}}return i}},function(e,t,n){(function(u){var c=n(961),l=n(980),e=n(615),f=n(972),r=t;r.request=function(e,t){e="string"==typeof e?f.parse(e):l(e);var n=-1===u.location.protocol.search(/^https?:$/)?"http:":"",r=e.protocol||n,o=e.hostname||e.host,a=e.port,i=e.path||"/";o&&-1!==o.indexOf(":")&&(o="["+o+"]"),e.url=(o?r+"//"+o:"")+(a?":"+a:"")+i,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var s=new c(e);return t&&s.on("response",t),s},r.get=function(e,t){var n=r.request(e,t);return n.end(),n},r.Agent=function(){},r.Agent.defaultMaxSockets=4,r.STATUS_CODES=e,r.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(t,function(){return this}())},function(d,e,p){(function(i,s,u){var c=p(396),e=p(63),t=p(962),o=p(244),l=p(970),n=t.IncomingMessage,f=t.readyStates,r=d.exports=function(t){var n=this;o.Writable.call(n),n._opts=t,n._body=[],n._headers={},t.auth&&n.setHeader("Authorization","Basic "+new i(t.auth).toString("base64")),Object.keys(t.headers).forEach(function(e){n.setHeader(e,t.headers[e])});var e,r=!0;if("disable-fetch"===t.mode||"timeout"in t)e=!(r=!1);else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!c.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}n._mode=function(e,t){return c.fetch&&t?"fetch":c.mozchunkedarraybuffer?"moz-chunked-arraybuffer":c.msstream?"ms-stream":c.arraybuffer&&e?"arraybuffer":c.vbArray&&e?"text:vbarray":"text"}(e,r),n.on("finish",function(){n._onFinish()})};e(r,o.Writable),r.prototype.setHeader=function(e,t){var n=e.toLowerCase();-1===a.indexOf(n)&&(this._headers[n]={name:e,value:t})},r.prototype.getHeader=function(e){return this._headers[e.toLowerCase()].value},r.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},r.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e=t._opts,n=t._headers,r=null;if("POST"!==e.method&&"PUT"!==e.method&&"PATCH"!==e.method&&"MERGE"!==e.method||(r=c.blobConstructor?new s.Blob(t._body.map(function(e){return l(e)}),{type:(n["content-type"]||{}).value||""}):i.concat(t._body).toString()),"fetch"===t._mode){var o=Object.keys(n).map(function(e){return[n[e].name,n[e].value]});s.fetch(t._opts.url,{method:t._opts.method,headers:o,body:r||void 0,mode:"cors",credentials:e.withCredentials?"include":"same-origin"}).then(function(e){t._fetchResponse=e,t._connect()},function(e){t.emit("error",e)})}else{var a=t._xhr=new s.XMLHttpRequest;try{a.open(t._opts.method,t._opts.url,!0)}catch(e){return void u.nextTick(function(){t.emit("error",e)})}"responseType"in a&&(a.responseType=t._mode.split(":")[0]),"withCredentials"in a&&(a.withCredentials=!!e.withCredentials),"text"===t._mode&&"overrideMimeType"in a&&a.overrideMimeType("text/plain; charset=x-user-defined"),"timeout"in e&&(a.timeout=e.timeout,a.ontimeout=function(){t.emit("timeout")}),Object.keys(n).forEach(function(e){a.setRequestHeader(n[e].name,n[e].value)}),t._response=null,a.onreadystatechange=function(){switch(a.readyState){case f.LOADING:case f.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(a.onprogress=function(){t._onXHRProgress()}),a.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{a.send(r)}catch(e){return void u.nextTick(function(){t.emit("error",e)})}}}},r.prototype._onXHRProgress=function(){!function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}(this._xhr)||this._destroyed||(this._response||this._connect(),this._response._onXHRProgress())},r.prototype._connect=function(){var t=this;t._destroyed||(t._response=new n(t._xhr,t._fetchResponse,t._mode),t._response.on("error",function(e){t.emit("error",e)}),t.emit("response",t._response))},r.prototype._write=function(e,t,n){this._body.push(e),n()},r.prototype.abort=r.prototype.destroy=function(){this._destroyed=!0,this._response&&(this._response._destroyed=!0),this._xhr&&this._xhr.abort()},r.prototype.end=function(e,t,n){"function"==typeof e&&(n=e,e=void 0),o.Writable.prototype.end.call(this,e,t,n)},r.prototype.flushHeaders=function(){},r.prototype.setTimeout=function(){},r.prototype.setNoDelay=function(){},r.prototype.setSocketKeepAlive=function(){};var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(e,p(49).Buffer,function(){return this}(),p(66))},function(e,n,r){(function(s,u,c){var l=r(396),e=r(63),f=r(244),d=n.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},t=n.IncomingMessage=function(e,t,n){var r=this;if(f.Readable.call(r),r._mode=n,r.headers={},r.rawHeaders=[],r.trailers={},r.rawTrailers=[],r.on("end",function(){s.nextTick(function(){r.emit("close")})}),"fetch"===n){r._fetchResponse=t,r.url=t.url,r.statusCode=t.status,r.statusMessage=t.statusText,t.headers.forEach(function(e,t){r.headers[t.toLowerCase()]=e,r.rawHeaders.push(t,e)});var o=t.body.getReader();!function t(){o.read().then(function(e){if(!r._destroyed){if(e.done)return void r.push(null);r.push(new u(e.value)),t()}}).catch(function(e){r.emit("error",e)})}()}else{if(r._xhr=e,r._pos=0,r.url=e.responseURL,r.statusCode=e.status,r.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var n=t[1].toLowerCase();"set-cookie"===n?(void 0===r.headers[n]&&(r.headers[n]=[]),r.headers[n].push(t[2])):void 0!==r.headers[n]?r.headers[n]+=", "+t[2]:r.headers[n]=t[2],r.rawHeaders.push(t[1],t[2])}}),r._charset="x-user-defined",!l.overrideMimeType){var a=r.rawHeaders["mime-type"];if(a){var i=a.match(/;\s*charset=([^;])(;|$)/);i&&(r._charset=i[1].toLowerCase())}r._charset||(r._charset="utf-8")}}};e(t,f.Readable),t.prototype._read=function(){},t.prototype._onXHRProgress=function(){var e=this,t=e._xhr,n=null;switch(e._mode){case"text:vbarray":if(t.readyState!==d.DONE)break;try{n=new c.VBArray(t.responseBody).toArray()}catch(e){}if(null!==n){e.push(new u(n));break}case"text":try{n=t.responseText}catch(t){e._mode="text:vbarray";break}if(n.length>e._pos){var r=n.substr(e._pos);if("x-user-defined"===e._charset){for(var o=new u(r.length),a=0;a<r.length;a++)o[a]=255&r.charCodeAt(a);e.push(o)}else e.push(r,e._charset);e._pos=n.length}break;case"arraybuffer":if(t.readyState!==d.DONE||!t.response)break;n=t.response,e.push(new u(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=t.response,t.readyState!==d.LOADING||!n)break;e.push(new u(new Uint8Array(n)));break;case"ms-stream":if(n=t.response,t.readyState!==d.LOADING)break;var i=new c.MSStreamReader;i.onprogress=function(){i.result.byteLength>e._pos&&(e.push(new u(new Uint8Array(i.result.slice(e._pos)))),e._pos=i.result.byteLength)},i.onload=function(){e.push(null)},i.readAsArrayBuffer(n)}e._xhr.readyState===d.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(n,r(66),r(49).Buffer,function(){return this}())},function(e,t){e.exports=function(t){return function(e){return"/"===e.url[0]&&(e.url=t+e.url),e}}},function(e,t){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(r){o.prototype[r]=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._defaults.push({fn:r,args:t}),this}}),o.prototype._setDefaults=function(t){this._defaults.forEach(function(e){t[e.fn].apply(t,n(e.args))})},e.exports=o},function(e,n,t){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){}function a(e){if(!v(e))return e;var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i(t,n,e[n]);return t.join("&")}function i(t,n,e){if(void 0!==e){if(null===e)return void t.push(encodeURIComponent(n));if(Array.isArray(e))e.forEach(function(e){i(t,n,e)});else if(v(e))for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&i(t,"".concat(n,"[").concat(r,"]"),e[r]);else t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}}function s(e){for(var t,n,r={},o=e.split("&"),a=0,i=o.length;a<i;++a)-1===(n=(t=o[a]).indexOf("="))?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function u(e){return/[/+]json($|[^-\w])/.test(e)}function c(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!==this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.headers=function(e){for(var t,n,r,o,a=e.split(/\r?\n/),i={},s=0,u=a.length;s<u;++s)-1!==(t=(n=a[s]).indexOf(":"))&&(r=n.slice(0,t).toLowerCase(),o=_(n.slice(t+1)),i[r]=o);return i}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function l(e,t){var r=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e,t=null,n=null;try{n=new c(r)}catch(n){return(t=new Error("Parser is unable to parse the response")).parse=!0,t.original=n,r.xhr?(t.rawResponse=void 0===r.xhr.responseType?r.xhr.responseText:r.xhr.response,t.status=r.xhr.status?r.xhr.status:null,t.statusCode=t.status):(t.rawResponse=null,t.status=null),r.callback(t)}r.emit("response",n);try{r._isResponseOK(n)||(e=new Error(n.statusText||"Unsuccessful HTTP response"))}catch(t){e=t}e?(e.original=t,e.response=n,e.status=n.status,r.callback(e,n)):r.callback(null,n)})}function f(e,t,n){var r=b("DELETE",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}var d;d="undefined"!=typeof window?window:"undefined"==typeof self?void console.warn("Using browser-only version of superagent in non-browser environment"):self;var p=t(616),h=t(694),y=t(966),v=t(398),g=t(967),m=t(964);e.exports=function(e,t){return"function"==typeof t?new n.Request("GET",e).end(t):1===arguments.length?new n.Request("GET",e):new n.Request(e,t)};var b=n=e.exports;n.Request=l,b.getXHR=function(){if(d.XMLHttpRequest&&(!d.location||"file:"!==d.location.protocol||!d.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw new Error("Browser-only version of superagent could not find XHR")};var _="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};b.serializeObject=a,b.parseString=s,b.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},b.serialize={"application/x-www-form-urlencoded":a,"application/json":h},b.parse={"application/x-www-form-urlencoded":s,"application/json":JSON.parse},g(c.prototype),c.prototype._parseBody=function(e){var t=b.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&u(this.type)&&(t=b.parse["application/json"]),t&&e&&(0<e.length||e instanceof Object)?t(e):null)},c.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot ".concat(t," ").concat(n," (").concat(this.status,")"),o=new Error(r);return o.status=this.status,o.method=t,o.url=n,o},b.Response=c,p(l.prototype),y(l.prototype),l.prototype.type=function(e){return this.set("Content-Type",b.types[e]||e),this},l.prototype.accept=function(e){return this.set("Accept",b.types[e]||e),this},l.prototype.auth=function(e,t,n){1===arguments.length&&(t=""),"object"===r(t)&&null!==t&&(n=t,t=""),n=n||{type:"function"==typeof btoa?"basic":"auto"};return this._auth(e,t,n,function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")})},l.prototype.query=function(e){return"string"!=typeof e&&(e=a(e)),e&&this._query.push(e),this},l.prototype.attach=function(e,t,n){if(t){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,n||t.name)}return this},l.prototype._getFormData=function(){return this._formData||(this._formData=new d.FormData),this._formData},l.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),n(e,t)},l.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},l.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},l.prototype.buffer=l.prototype.ca,l.prototype.ca=l.prototype.agent,l.prototype.pipe=l.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},l.prototype._isHost=function(e){return e&&"object"===r(e)&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},l.prototype.end=function(e){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||o,this._finalizeQueryString(),this._end()},l.prototype._setUploadTimeout=function(){var e=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(function(){e._timeoutError("Upload timeout of ",e._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))},l.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var n=this;this.xhr=b.getXHR();var r=this.xhr,e=this._formData||this._data;this._setTimeouts(),r.onreadystatechange=function(){var e=r.readyState;if(2<=e&&n._responseTimeoutTimer&&clearTimeout(n._responseTimeoutTimer),4===e){var t;try{t=r.status}catch(e){t=0}if(!t){if(n.timedout||n._aborted)return;return n.crossDomainError()}n.emit("end")}};function t(e,t){0<t.total&&(t.percent=t.loaded/t.total*100,100===t.percent&&clearTimeout(n._uploadTimeoutTimer)),t.direction=e,n.emit("progress",t)}if(this.hasListeners("progress"))try{r.addEventListener("progress",t.bind(null,"download")),r.upload&&r.upload.addEventListener("progress",t.bind(null,"upload"))}catch(n){}r.upload&&this._setUploadTimeout();try{this.username&&this.password?r.open(this.method,this.url,!0,this.username,this.password):r.open(this.method,this.url,!0)}catch(n){return this.callback(n)}if(this._withCredentials&&(r.withCredentials=!0),!this._formData&&"GET"!==this.method&&"HEAD"!==this.method&&"string"!=typeof e&&!this._isHost(e)){var o=this._header["content-type"],a=this._serializer||b.serialize[o?o.split(";")[0]:""];!a&&u(o)&&(a=b.serialize["application/json"]),a&&(e=a(e))}for(var i in this.header)null!==this.header[i]&&Object.prototype.hasOwnProperty.call(this.header,i)&&r.setRequestHeader(i,this.header[i]);this._responseType&&(r.responseType=this._responseType),this.emit("request",this),r.send(void 0===e?null:e)},b.agent=function(){return new m},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(r){m.prototype[r.toLowerCase()]=function(e,t){var n=new b.Request(r,e);return this._setDefaults(n),t&&n.end(t),n}}),m.prototype.del=m.prototype.delete,b.get=function(e,t,n){var r=b("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},b.head=function(e,t,n){var r=b("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},b.options=function(e,t,n){var r=b("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},b.del=f,b.delete=f,b.patch=function(e,t,n){var r=b("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},b.post=function(e,t,n){var r=b("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},b.put=function(e,t,n){var r=b("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){if(e)return function(e){for(var t in o.prototype)Object.prototype.hasOwnProperty.call(o.prototype,t)&&(e[t]=o.prototype[t]);return e}(e)}var a=n(398);(e.exports=o).prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},o.prototype.parse=function(e){return this._parser=e,this},o.prototype.responseType=function(e){return this._responseType=e,this},o.prototype.serialize=function(e){return this._serializer=e,this},o.prototype.timeout=function(e){if(!e||"object"!==r(e))return this._timeout=e,this._responseTimeout=0,this._uploadTimeout=0,this;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;case"upload":this._uploadTimeout=e.upload;break;default:console.warn("Unknown timeout option",t)}return this},o.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var i=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];o.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&500<=t.status&&501!==t.status)return!0;if(e){if(e.code&&-1!==i.indexOf(e.code))return!0;if(e.timeout&&"ECONNABORTED"===e.code)return!0;if(e.crossDomain)return!0}return!1},o.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},o.prototype.then=function(e,t){var o=this;if(!this._fullfilledPromise){var a=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(n,r){a.on("abort",function(){var e=new Error("Aborted");e.code="ABORTED",e.status=o.status,e.method=o.method,e.url=o.url,r(e)}),a.end(function(e,t){e?r(e):n(t)})})}return this._fullfilledPromise.then(e,t)},o.prototype.catch=function(e){return this.then(void 0,e)},o.prototype.use=function(e){return e(this),this},o.prototype.ok=function(e){if("function"!=typeof e)throw new Error("Callback required");return this._okCallback=e,this},o.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):200<=e.status&&e.status<300)},o.prototype.getHeader=o.prototype.get=function(e){return this._header[e.toLowerCase()]},o.prototype.set=function(e,t){if(a(e)){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},o.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},o.prototype.field=function(e,t){if(null==e)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(a(e)){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.field(n,e[n]);return this}if(Array.isArray(t)){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&this.field(e,t[r]);return this}if(null==t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=String(t)),this._getFormData().append(e,t),this},o.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},o.prototype._auth=function(e,t,n,r){switch(n.type){case"basic":this.set("Authorization","Basic ".concat(r("".concat(e,":").concat(t))));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer ".concat(e))}return this},o.prototype.withCredentials=function(e){return void 0===e&&(e=!0),this._withCredentials=e,this},o.prototype.redirects=function(e){return this._maxRedirects=e,this},o.prototype.maxResponseSize=function(e){if("number"!=typeof e)throw new TypeError("Invalid argument");return this._maxResponseSize=e,this},o.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},o.prototype.send=function(e){var t=a(e),n=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(t&&a(this._data))for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this._data[r]=e[r]);else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"===n?this._data?"".concat(this._data,"&").concat(e):e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)||n||this.type("json"),this},o.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},o.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(0<=this.url.indexOf("?")?"&":"?")+e),this._query.length=0,this._sort){var t=this.url.indexOf("?");if(0<=t){var n=this.url.substring(t+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,t)+"?"+n.join("&")}}},o.prototype._appendQueryString=function(){console.warn("Unsupported")},o.prototype._timeoutError=function(e,t,n){if(!this._aborted){var r=new Error("".concat(e+t,"ms exceeded"));r.timeout=t,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},o.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},function(e,t,n){"use strict";function r(e){if(e)return function(e){for(var t in r.prototype)Object.prototype.hasOwnProperty.call(r.prototype,t)&&(e[t]=r.prototype[t]);return e}(e)}var o=n(968);(e.exports=r).prototype.get=function(e){return this.header[e.toLowerCase()]},r.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=o.type(t);var n=o.params(t);for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(this[r]=n[r]);this.links={};try{e.link&&(this.links=o.parseLinks(e.link))}catch(e){}},r.prototype._setStatusProperties=function(e){var t=e/100|0;this.statusCode=e,this.status=this.statusCode,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.created=201===e,this.accepted=202===e,this.noContent=204===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.forbidden=403===e,this.notFound=404===e,this.unprocessableEntity=422===e}},function(e,t){"use strict";t.type=function(e){return e.split(/ *; */).shift()},t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),o=n.shift();return r&&o&&(e[r]=o),e},{})},t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var n=t.split(/ *; */),r=n[0].slice(1,-1);return e[n[1].split(/ *= */)[1].slice(1,-1)]=r,e},{})},t.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e}},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var o=Function.prototype.apply;t.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(958),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){var o=n(49).Buffer;e.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(o.isBuffer(e)){for(var t=new Uint8Array(e.length),n=e.length,r=0;r<n;r++)t[r]=e[r];return t.buffer}throw new Error("Argument must be a Buffer")}},function(e,y,v){var M;(function(p,h){!function(){function g(e){throw RangeError(f[e])}function o(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function t(e,t){var n=e.split("@"),r="";return 1<n.length&&(r=n[0]+"@",e=n[1]),r+o((e=e.replace(l,".")).split("."),t).join(".")}function m(e){for(var t,n,r=[],o=0,a=e.length;o<a;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<a?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function b(e){return o(e,function(e){var t="";return 65535<e&&(t+=S((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+S(e)}).join("")}function _(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function w(e,t,n){var r=0;for(e=n?j(e/s):e>>1,e+=j(e/t);d*T>>1<e;r+=E)e=j(e/d);return j(r+(d+1)*e/(e+i))}function n(e){var t,n,r,o,a,i,s,u,c,l,f,d=[],p=e.length,h=0,y=I,v=A;for((n=e.lastIndexOf(O))<0&&(n=0),r=0;r<n;++r)128<=e.charCodeAt(r)&&g("not-basic"),d.push(e.charCodeAt(r));for(o=0<n?n+1:0;o<p;){for(a=h,i=1,s=E;p<=o&&g("invalid-input"),f=e.charCodeAt(o++),(E<=(u=f-48<10?f-22:f-65<26?f-65:f-97<26?f-97:E)||u>j((x-h)/i))&&g("overflow"),h+=u*i,!(u<(c=s<=v?k:v+T<=s?T:s-v));s+=E)i>j(x/(l=E-c))&&g("overflow"),i*=l;v=w(h-a,t=d.length+1,0==a),j(h/t)>x-y&&g("overflow"),y+=j(h/t),h%=t,d.splice(h++,0,y)}return b(d)}function r(e){var t,n,r,o,a,i,s,u,c,l,f,d,p,h,y,v=[];for(d=(e=m(e)).length,t=I,a=A,i=n=0;i<d;++i)(f=e[i])<128&&v.push(S(f));for(r=o=v.length,o&&v.push(O);r<d;){for(s=x,i=0;i<d;++i)t<=(f=e[i])&&f<s&&(s=f);for(s-t>j((x-n)/(p=r+1))&&g("overflow"),n+=(s-t)*p,t=s,i=0;i<d;++i)if((f=e[i])<t&&++n>x&&g("overflow"),f==t){for(u=n,c=E;!(u<(l=c<=a?k:a+T<=c?T:c-a));c+=E)y=u-l,h=E-l,v.push(S(_(l+y%h,0))),u=j(y/h);v.push(S(_(u,0))),a=w(n,p,r==o),n=0,++r}++n,++t}return v.join("")}var e=("object"==typeof y&&y&&y.nodeType,"object"==typeof p&&p&&p.nodeType,"object"==typeof h&&h);e.global!==e&&e.window!==e&&e.self;var a,x=2147483647,E=36,k=1,T=26,i=38,s=700,A=72,I=128,O="-",u=/^xn--/,c=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=E-k,j=Math.floor,S=String.fromCharCode;a={version:"1.3.2",ucs2:{decode:m,encode:b},decode:n,encode:r,toASCII:function(e){return t(e,function(e){return c.test(e)?"xn--"+r(e):e})},toUnicode:function(e){return t(e,function(e){return u.test(e)?n(e.slice(4).toLowerCase()):e})}},void 0===(M=function(){return a}.call(y,v,y,p))||(p.exports=M)}()}).call(y,v(256)(e),function(){return this}())},function(e,t,n){"use strict";function I(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(e,t,n){if(e&&P.isObject(e)&&e instanceof I)return e;var r=new I;return r.parse(e,t,n),r}var C=n(971),P=n(973);t.parse=r,t.resolve=function(e,t){return r(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?r(e,!1,!0).resolveObject(t):t},t.format=function(e){return P.isString(e)&&(e=r(e)),e instanceof I?e.format():I.prototype.format.call(e)},t.Url=I;var z=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,V=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,a=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),G=["'"].concat(a),N=["%","/","?",";","#"].concat(G),D=["/","?","#"],U=/^[+a-z0-9A-Z_-]{0,63}$/,F=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,L={javascript:!0,"javascript:":!0},B={javascript:!0,"javascript:":!0},$={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},q=n(906);I.prototype.parse=function(e,t,n){if(!P.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=-1!==r&&r<e.indexOf("#")?"?":"#",a=e.split(o);a[0]=a[0].replace(/\\/g,"/");var i=e=a.join(o);if(i=i.trim(),!n&&1===e.split("#").length){var s=V.exec(i);if(s)return this.path=i,this.href=i,this.pathname=s[1],s[2]?(this.search=s[2],this.query=t?q.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=z.exec(i);if(u){var c=(u=u[0]).toLowerCase();this.protocol=c,i=i.substr(u.length)}if(n||u||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===i.substr(0,2);!l||u&&B[u]||(i=i.substr(2),this.slashes=!0)}if(!B[u]&&(l||u&&!$[u])){for(var f=-1,d=0;d<D.length;d++){-1!==(y=i.indexOf(D[d]))&&(-1===f||y<f)&&(f=y)}var p,h;-1!==(h=-1===f?i.lastIndexOf("@"):i.lastIndexOf("@",f))&&(p=i.slice(0,h),i=i.slice(h+1),this.auth=decodeURIComponent(p)),f=-1;for(d=0;d<N.length;d++){var y;-1!==(y=i.indexOf(N[d]))&&(-1===f||y<f)&&(f=y)}-1===f&&(f=i.length),this.host=i.slice(0,f),i=i.slice(f),this.parseHost(),this.hostname=this.hostname||"";var v="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!v)for(var g=this.hostname.split(/\./),m=(d=0,g.length);d<m;d++){var b=g[d];if(b&&!b.match(U)){for(var _="",w=0,x=b.length;w<x;w++)_+=127<b.charCodeAt(w)?"x":b[w];if(!_.match(U)){var E=g.slice(0,d),k=g.slice(d+1),T=b.match(F);T&&(E.push(T[1]),k.unshift(T[2])),k.length&&(i="/"+k.join(".")+i),this.hostname=E.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=C.toASCII(this.hostname));var A=this.port?":"+this.port:"",I=this.hostname||"";this.host=I+A,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!L[c])for(d=0,m=G.length;d<m;d++){var O=G[d];if(-1!==i.indexOf(O)){var j=encodeURIComponent(O);j===O&&(j=escape(O)),i=i.split(O).join(j)}}var S=i.indexOf("#");-1!==S&&(this.hash=i.substr(S),i=i.slice(0,S));var M=i.indexOf("?");if(-1!==M?(this.search=i.substr(M),this.query=i.substr(M+1),t&&(this.query=q.parse(this.query)),i=i.slice(0,M)):t&&(this.search="",this.query={}),i&&(this.pathname=i),$[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){A=this.pathname||"";var R=this.search||"";this.path=A+R}return this.href=this.format(),this},I.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&P.isObject(this.query)&&Object.keys(this.query).length&&(a=q.stringify(this.query));var i=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||$[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o=o||"",r&&"#"!==r.charAt(0)&&(r="#"+r),i&&"?"!==i.charAt(0)&&(i="?"+i),t+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(i=i.replace("#","%23"))+r},I.prototype.resolve=function(e){return this.resolveObject(r(e,!1,!0)).format()},I.prototype.resolveObject=function(e){if(P.isString(e)){var t=new I;t.parse(e,!1,!0),e=t}for(var n=new I,r=Object.keys(this),o=0;o<r.length;o++){var a=r[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var i=Object.keys(e),s=0;s<i.length;s++){var u=i[s];"protocol"!==u&&(n[u]=e[u])}return $[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!$[e.protocol]){for(var c=Object.keys(e),l=0;l<c.length;l++){var f=c[l];n[f]=e[f]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||B[e.protocol])n.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),n.pathname=d.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",h=n.search||"";n.path=p+h}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),g=v||y||n.host&&e.pathname,m=g,b=n.pathname&&n.pathname.split("/")||[],_=(d=e.pathname&&e.pathname.split("/")||[],n.protocol&&!$[n.protocol]);if(_&&(n.hostname="",n.port=null,n.host&&(""===b[0]?b[0]=n.host:b.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),g=g&&(""===d[0]||""===b[0])),v)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,b=d;else if(d.length)(b=b||[]).pop(),b=b.concat(d),n.search=e.search,n.query=e.query;else if(!P.isNullOrUndefined(e.search)){if(_)n.hostname=n.host=b.shift(),(T=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=T.shift(),n.host=n.hostname=T.shift());return n.search=e.search,n.query=e.query,P.isNull(n.pathname)&&P.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!b.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var w=b.slice(-1)[0],x=(n.host||e.host||1<b.length)&&("."===w||".."===w)||""===w,E=0,k=b.length;0<=k;k--)"."===(w=b[k])?b.splice(k,1):".."===w?(b.splice(k,1),E++):E&&(b.splice(k,1),E--);if(!g&&!m)for(;E--;)b.unshift("..");!g||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),x&&"/"!==b.join("/").substr(-1)&&b.push("");var T,A=""===b[0]||b[0]&&"/"===b[0].charAt(0);_&&(n.hostname=n.host=A?"":b.length?b.shift():"",(T=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=T.shift(),n.host=n.hostname=T.shift()));return(g=g||n.host&&b.length)&&!A&&b.unshift(""),b.length?n.pathname=b.join("/"):(n.pathname=null,n.path=null),P.isNull(n.pathname)&&P.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},I.prototype.parseHost=function(){var e=this.host,t=o.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t){(function(n){function r(e){try{if(!n.localStorage)return!1}catch(e){return!1}var t=n.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(t,function(){return this}())},function(e,t,n){var r=n(400),p=n(399),o=r(),h=[1|o[0],o[1],o[2],o[3],o[4],o[5]],y=16383&(o[6]<<8|o[7]),v=0,g=0;e.exports=function(e,t,n){var r=t&&n||0,o=t||[],a=void 0!==(e=e||{}).clockseq?e.clockseq:y,i=void 0!==e.msecs?e.msecs:(new Date).getTime(),s=void 0!==e.nsecs?e.nsecs:g+1,u=i-v+(s-g)/1e4;if(u<0&&void 0===e.clockseq&&(a=a+1&16383),(u<0||v<i)&&void 0===e.nsecs&&(s=0),1e4<=s)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");v=i,y=a;var c=(1e4*(268435455&(i+=122192928e5))+(g=s))%4294967296;o[r++]=c>>>24&255,o[r++]=c>>>16&255,o[r++]=c>>>8&255,o[r++]=255&c;var l=i/4294967296*1e4&268435455;o[r++]=l>>>8&255,o[r++]=255&l,o[r++]=l>>>24&15|16,o[r++]=l>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var f=e.node||h,d=0;d<6;++d)o[r+d]=f[d];return t||p(o)}},function(e,t,n){var i=n(400),s=n(399);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[r+a]=o[a];return t||s(o)}},function(e,t,n){function r(i){return i.every=function(e,t,n){i._time(),n||(n=t,t=null);var r=o+=1;return i._timers[r]={visible:e,hidden:t,callback:n},i._run(r,!1),i.isSupported()&&i._listen(),r},i.stop=function(e){return!!i._timers[e]&&(i._stop(e),delete i._timers[e],!0)},i._timers={},i._time=function(){i._timed||(i._timed=!0,i._wasHidden=i.hidden(),i.change(function(){i._stopRun(),i._wasHidden=i.hidden()}))},i._run=function(e,t){var n,r=i._timers[e];if(i.hidden()){if(null===r.hidden)return;n=r.hidden}else n=r.visible;function o(){r.last=new Date,r.callback.call(s)}if(t){var a=new Date-r.last;a<n?r.delay=setTimeout(function(){r.id=setInterval(o,n),o()},n-a):(r.id=setInterval(o,n),o())}else r.id=setInterval(o,n)},i._stop=function(e){var t=i._timers[e];clearInterval(t.id),clearTimeout(t.delay),delete t.id,delete t.delay},i._stopRun=function(e){var t=i.hidden(),n=i._wasHidden;if(t&&!n||!t&&n)for(var r in i._timers)i._stop(r),i._run(r,!t)},i}var s,o;s=window,o=-1,void 0!==e&&e.exports?e.exports=r(n(402)):r(s.Visibility||n(402))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)o.call(n,r)&&(e[r]=n[r])}return e};var o=Object.prototype.hasOwnProperty},function(e,t,n){function r(e){return n(o(e))}function o(e){return a[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var a={"./node":269,"./node.js":269,"./web":270,"./web.js":270};r.keys=function(){return Object.keys(a)},r.resolve=o,(e.exports=r).id=981},function(e,t){}]);