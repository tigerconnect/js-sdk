var TigerConnect=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=213)}([function(t,e,n){"use strict";n.r(e),n.d(e,"ConnectionUnavailableError",(function(){return i})),n.d(e,"NotFoundError",(function(){return a})),n.d(e,"NotSignedInError",(function(){return c})),n.d(e,"NotSupportedError",(function(){return d})),n.d(e,"PermissionDeniedError",(function(){return h})),n.d(e,"RequiresBasicAuthError",(function(){return v})),n.d(e,"TargetNotSupportedError",(function(){return g})),n.d(e,"ValidationError",(function(){return m.a})),n.d(e,"WrongCredentialsError",(function(){return b}));var r,o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(t){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.call(this,"No internet connection")||this;return o.code=e.CODE,o}return o(e,t),e.CODE="connection-unavailable",e}(Error),s=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(n,r,o){var i=this;return o||(o=n+" '"+r+"' not found"),(i=t.call(this,o)||this).code=e.CODE,i.resource=n,i.id=r,i}return s(e,t),e.CODE="not-found",e}(Error),u=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.apply(this,n)||this;return o.code=e.CODE,o}return u(e,t),e.CODE="not-signed-in",e}(Error),l=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(n){var r=t.call(this,n)||this;return r.code=e.CODE,r}return l(e,t),e.CODE="not-supported",e}(Error),f=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function e(n,r,o,i){void 0===i&&(i="can't perform action '"+o+"' on "+(n.name||n)+" #"+r);var s=t.call(this,i)||this;return s.code=e.CODE,s.resource=n,s.action=o,s.id=r,s}return f(e,t),e.CODE="permission-denied",e}(Error),p=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.apply(this,n)||this;return o.code=e.CODE,o}return p(e,t),e.CODE="requires-basic-auth",e}(Error),y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(t){function e(e){return t.call(this,"method"+(e?" "+e:"")+" not supported in target web")||this}return y(e,t),e.raise=function(t){throw new this(t)},e.CODE="target-not-supported",e}(Error),m=n(85),_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(t){function e(n){void 0===n&&(n={});for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var i=t.apply(this,r)||this,s=n.tt_login_attempts_left;return i.code=e.CODE,i.loginAttemptsLeft=void 0===s?null:s,i}return _(e,t),e.CODE="wrong-credentials",e}(Error)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return d})),n.d(e,"d",(function(){return h}));var r=n(10),o=n.n(r),i=n(0),s=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},a=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},u=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},c=[403,404],l={CONVERSATION_FIND_ALL:"conversations.findAll",DISTRIBUTION_LIST_FIND:"distributionLists.find",ENTITIES_FIND_ALL:"entities.findAll",ESCALATION:"escalation",EVENTS_ACK:"events.ack",EVENTS_CLOSE_ALL_CONNECTIONS:"events.closeAllConnections",GROUP_ADD_MEMBERS:"group.addMembers",GROUP_CREATE:"group.create",GROUP_DESTROY:"group.destroy",GROUP_FIND:"group.find",GROUP_FIND_ALL_MEMBER_IDS:"group.findAllMemberIds",GROUP_UPDATE:"group.update",MESSAGE_FIND:"messages.find",MESSAGE_FIND_RECIPIENT_STATUS:"messages.findRecipientStatus",MESSAGE_FIND_RECIPIENT_STATUS_MULTI:"messages.findRecipientStatusMulti",MESSAGE_FORWARD:"message.forward",MESSAGE_SEND:"message.send",MESSAGE_UPDATE_RECIPIENT_STATUS_MULTI:"messages.updateRecipientStatusMulti",METADATA_FIND:"metadata.find",MUTE_FIND_ALL:"mute.findAll",ORGANIZATION_FIND:"organization.find",ORGANIZATION_FIND_ALL_OF_USER:"organization.findAllOfUser",ROLES_CREATE_P2P_GROUP:"roles.createP2PGroup",SEARCH_QUERY:"search.query",TEAMS_CREATE:"teams.create",TEAMS_FIND:"teams.find",TEAMS_LEAVE:"teams.leave",TEAMS_UPDATE:"teams.update",USER_FIND:"user.find",USER_FIND_ME:"user.findMe"},d={VERSION_TWO:"v2",VERSION_FIVE:"v5"},f=function(){function t(t,e){Object.assign(this,e),this.config=t.config,this.host=t,this.httpClient=t.httpClient}return t.prototype.getVersion=function(t){var e=d.VERSION_TWO,n=d.VERSION_FIVE;return{version:this.config.condensedReplays?n:e}},t}();function h(t){var e=void 0===t?{}:t,n=e.fallbackValue,r=void 0===n?null:n,o=e.httpStatusCodes,l=void 0===o?c:o;return function(t,e,n){var o=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o.call.apply(o,u([this],t))];case 1:return[2,n.sent()];case 2:if((e=n.sent()).response&&l.includes(e.response.status))return[2,r];if(e.code===i.PermissionDeniedError.CODE&&l.includes(403))return[2,r];if(e.code===i.WrongCredentialsError.CODE&&l.includes(401))return[2,r];throw e;case 3:return[2]}}))}))},n}}e.c=f,Object.assign(f.prototype,o.a.prototype)},function(t,e,n){(function(t,r){var o;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var i="Expected a function",s="__lodash_placeholder__",a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],u="[object Arguments]",c="[object Array]",l="[object Boolean]",d="[object Date]",f="[object Error]",h="[object Function]",p="[object GeneratorFunction]",v="[object Map]",y="[object Number]",g="[object Object]",m="[object RegExp]",_="[object Set]",b="[object String]",w="[object Symbol]",I="[object WeakMap]",O="[object ArrayBuffer]",E="[object DataView]",T="[object Float32Array]",S="[object Float64Array]",A="[object Int8Array]",C="[object Int16Array]",R="[object Int32Array]",P="[object Uint8Array]",j="[object Uint16Array]",x="[object Uint32Array]",M=/\b__p \+= '';/g,k=/\b(__p \+=) '' \+/g,N=/(__e\(.*?\)|\b__t\)) \+\n'';/g,z=/&(?:amp|lt|gt|quot|#39);/g,D=/[&<>"']/g,U=RegExp(z.source),L=RegExp(D.source),F=/<%-([\s\S]+?)%>/g,B=/<%([\s\S]+?)%>/g,q=/<%=([\s\S]+?)%>/g,V=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G=/^\w*$/,H=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,W=/[\\^$.*+?()[\]{}|]/g,Y=RegExp(W.source),K=/^\s+|\s+$/g,$=/^\s+/,X=/\s+$/,Q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Z=/\{\n\/\* \[wrapped with (.+)\] \*/,J=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,et=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,ot=/^[-+]0x[0-9a-f]+$/i,it=/^0b[01]+$/i,st=/^\[object .+?Constructor\]$/,at=/^0o[0-7]+$/i,ut=/^(?:0|[1-9]\d*)$/,ct=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lt=/($^)/,dt=/['\n\r\u2028\u2029\\]/g,ft="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ht="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="[\\ud800-\\udfff]",vt="["+ht+"]",yt="["+ft+"]",gt="\\d+",mt="[\\u2700-\\u27bf]",_t="[a-z\\xdf-\\xf6\\xf8-\\xff]",bt="[^\\ud800-\\udfff"+ht+gt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",wt="\\ud83c[\\udffb-\\udfff]",It="[^\\ud800-\\udfff]",Ot="(?:\\ud83c[\\udde6-\\uddff]){2}",Et="[\\ud800-\\udbff][\\udc00-\\udfff]",Tt="[A-Z\\xc0-\\xd6\\xd8-\\xde]",St="(?:"+_t+"|"+bt+")",At="(?:"+Tt+"|"+bt+")",Ct="(?:"+yt+"|"+wt+")"+"?",Rt="[\\ufe0e\\ufe0f]?"+Ct+("(?:\\u200d(?:"+[It,Ot,Et].join("|")+")[\\ufe0e\\ufe0f]?"+Ct+")*"),Pt="(?:"+[mt,Ot,Et].join("|")+")"+Rt,jt="(?:"+[It+yt+"?",yt,Ot,Et,pt].join("|")+")",xt=RegExp("['’]","g"),Mt=RegExp(yt,"g"),kt=RegExp(wt+"(?="+wt+")|"+jt+Rt,"g"),Nt=RegExp([Tt+"?"+_t+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[vt,Tt,"$"].join("|")+")",At+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[vt,Tt+St,"$"].join("|")+")",Tt+"?"+St+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Tt+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",gt,Pt].join("|"),"g"),zt=RegExp("[\\u200d\\ud800-\\udfff"+ft+"\\ufe0e\\ufe0f]"),Dt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ut=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Lt=-1,Ft={};Ft[T]=Ft[S]=Ft[A]=Ft[C]=Ft[R]=Ft[P]=Ft["[object Uint8ClampedArray]"]=Ft[j]=Ft[x]=!0,Ft[u]=Ft[c]=Ft[O]=Ft[l]=Ft[E]=Ft[d]=Ft[f]=Ft[h]=Ft[v]=Ft[y]=Ft[g]=Ft[m]=Ft[_]=Ft[b]=Ft[I]=!1;var Bt={};Bt[u]=Bt[c]=Bt[O]=Bt[E]=Bt[l]=Bt[d]=Bt[T]=Bt[S]=Bt[A]=Bt[C]=Bt[R]=Bt[v]=Bt[y]=Bt[g]=Bt[m]=Bt[_]=Bt[b]=Bt[w]=Bt[P]=Bt["[object Uint8ClampedArray]"]=Bt[j]=Bt[x]=!0,Bt[f]=Bt[h]=Bt[I]=!1;var qt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Vt=parseFloat,Gt=parseInt,Ht="object"==typeof t&&t&&t.Object===Object&&t,Wt="object"==typeof self&&self&&self.Object===Object&&self,Yt=Ht||Wt||Function("return this")(),Kt=e&&!e.nodeType&&e,$t=Kt&&"object"==typeof r&&r&&!r.nodeType&&r,Xt=$t&&$t.exports===Kt,Qt=Xt&&Ht.process,Zt=function(){try{var t=$t&&$t.require&&$t.require("util").types;return t||Qt&&Qt.binding&&Qt.binding("util")}catch(t){}}(),Jt=Zt&&Zt.isArrayBuffer,te=Zt&&Zt.isDate,ee=Zt&&Zt.isMap,ne=Zt&&Zt.isRegExp,re=Zt&&Zt.isSet,oe=Zt&&Zt.isTypedArray;function ie(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function se(t,e,n,r){for(var o=-1,i=null==t?0:t.length;++o<i;){var s=t[o];e(r,s,n(s),t)}return r}function ae(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function ue(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ce(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function le(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}function de(t,e){return!!(null==t?0:t.length)&&we(t,e,0)>-1}function fe(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}function he(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}function pe(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function ve(t,e,n,r){var o=-1,i=null==t?0:t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function ye(t,e,n,r){var o=null==t?0:t.length;for(r&&o&&(n=t[--o]);o--;)n=e(n,t[o],o,t);return n}function ge(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var me=Te("length");function _e(t,e,n){var r;return n(t,(function(t,n,o){if(e(t,n,o))return r=n,!1})),r}function be(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function we(t,e,n){return e==e?function(t,e,n){var r=n-1,o=t.length;for(;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):be(t,Oe,n)}function Ie(t,e,n,r){for(var o=n-1,i=t.length;++o<i;)if(r(t[o],e))return o;return-1}function Oe(t){return t!=t}function Ee(t,e){var n=null==t?0:t.length;return n?Ce(t,e)/n:NaN}function Te(t){return function(e){return null==e?void 0:e[t]}}function Se(t){return function(e){return null==t?void 0:t[e]}}function Ae(t,e,n,r,o){return o(t,(function(t,o,i){n=r?(r=!1,t):e(n,t,o,i)})),n}function Ce(t,e){for(var n,r=-1,o=t.length;++r<o;){var i=e(t[r]);void 0!==i&&(n=void 0===n?i:n+i)}return n}function Re(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Pe(t){return function(e){return t(e)}}function je(t,e){return he(e,(function(e){return t[e]}))}function xe(t,e){return t.has(e)}function Me(t,e){for(var n=-1,r=t.length;++n<r&&we(e,t[n],0)>-1;);return n}function ke(t,e){for(var n=t.length;n--&&we(e,t[n],0)>-1;);return n}function Ne(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var ze=Se({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),De=Se({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ue(t){return"\\"+qt[t]}function Le(t){return zt.test(t)}function Fe(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function Be(t,e){return function(n){return t(e(n))}}function qe(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var a=t[n];a!==e&&a!==s||(t[n]=s,i[o++]=n)}return i}function Ve(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function Ge(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function He(t){return Le(t)?function(t){var e=kt.lastIndex=0;for(;kt.test(t);)++e;return e}(t):me(t)}function We(t){return Le(t)?function(t){return t.match(kt)||[]}(t):function(t){return t.split("")}(t)}var Ye=Se({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Ke=function t(e){var n,r=(e=null==e?Yt:Ke.defaults(Yt.Object(),e,Ke.pick(Yt,Ut))).Array,o=e.Date,ft=e.Error,ht=e.Function,pt=e.Math,vt=e.Object,yt=e.RegExp,gt=e.String,mt=e.TypeError,_t=r.prototype,bt=ht.prototype,wt=vt.prototype,It=e["__core-js_shared__"],Ot=bt.toString,Et=wt.hasOwnProperty,Tt=0,St=(n=/[^.]+$/.exec(It&&It.keys&&It.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",At=wt.toString,Ct=Ot.call(vt),Rt=Yt._,Pt=yt("^"+Ot.call(Et).replace(W,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),jt=Xt?e.Buffer:void 0,kt=e.Symbol,zt=e.Uint8Array,qt=jt?jt.allocUnsafe:void 0,Ht=Be(vt.getPrototypeOf,vt),Wt=vt.create,Kt=wt.propertyIsEnumerable,$t=_t.splice,Qt=kt?kt.isConcatSpreadable:void 0,Zt=kt?kt.iterator:void 0,me=kt?kt.toStringTag:void 0,Se=function(){try{var t=ti(vt,"defineProperty");return t({},"",{}),t}catch(t){}}(),$e=e.clearTimeout!==Yt.clearTimeout&&e.clearTimeout,Xe=o&&o.now!==Yt.Date.now&&o.now,Qe=e.setTimeout!==Yt.setTimeout&&e.setTimeout,Ze=pt.ceil,Je=pt.floor,tn=vt.getOwnPropertySymbols,en=jt?jt.isBuffer:void 0,nn=e.isFinite,rn=_t.join,on=Be(vt.keys,vt),sn=pt.max,an=pt.min,un=o.now,cn=e.parseInt,ln=pt.random,dn=_t.reverse,fn=ti(e,"DataView"),hn=ti(e,"Map"),pn=ti(e,"Promise"),vn=ti(e,"Set"),yn=ti(e,"WeakMap"),gn=ti(vt,"create"),mn=yn&&new yn,_n={},bn=Ai(fn),wn=Ai(hn),In=Ai(pn),On=Ai(vn),En=Ai(yn),Tn=kt?kt.prototype:void 0,Sn=Tn?Tn.valueOf:void 0,An=Tn?Tn.toString:void 0;function Cn(t){if(Gs(t)&&!Ms(t)&&!(t instanceof xn)){if(t instanceof jn)return t;if(Et.call(t,"__wrapped__"))return Ci(t)}return new jn(t)}var Rn=function(){function t(){}return function(e){if(!Vs(e))return{};if(Wt)return Wt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function Pn(){}function jn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function xn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Mn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function kn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Nn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function zn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Nn;++e<n;)this.add(t[e])}function Dn(t){var e=this.__data__=new kn(t);this.size=e.size}function Un(t,e){var n=Ms(t),r=!n&&xs(t),o=!n&&!r&&Ds(t),i=!n&&!r&&!o&&Zs(t),s=n||r||o||i,a=s?Re(t.length,gt):[],u=a.length;for(var c in t)!e&&!Et.call(t,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ai(c,u))||a.push(c);return a}function Ln(t){var e=t.length;return e?t[zr(0,e-1)]:void 0}function Fn(t,e){return Ei(mo(t),$n(e,0,t.length))}function Bn(t){return Ei(mo(t))}function qn(t,e,n){(void 0!==n&&!Rs(t[e],n)||void 0===n&&!(e in t))&&Yn(t,e,n)}function Vn(t,e,n){var r=t[e];Et.call(t,e)&&Rs(r,n)&&(void 0!==n||e in t)||Yn(t,e,n)}function Gn(t,e){for(var n=t.length;n--;)if(Rs(t[n][0],e))return n;return-1}function Hn(t,e,n,r){return tr(t,(function(t,o,i){e(r,t,n(t),i)})),r}function Wn(t,e){return t&&_o(e,ba(e),t)}function Yn(t,e,n){"__proto__"==e&&Se?Se(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Kn(t,e){for(var n=-1,o=e.length,i=r(o),s=null==t;++n<o;)i[n]=s?void 0:va(t,e[n]);return i}function $n(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function Xn(t,e,n,r,o,i){var s,a=1&e,c=2&e,f=4&e;if(n&&(s=o?n(t,r,o,i):n(t)),void 0!==s)return s;if(!Vs(t))return t;var I=Ms(t);if(I){if(s=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&Et.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!a)return mo(t,s)}else{var M=ri(t),k=M==h||M==p;if(Ds(t))return fo(t,a);if(M==g||M==u||k&&!o){if(s=c||k?{}:ii(t),!a)return c?function(t,e){return _o(t,ni(t),e)}(t,function(t,e){return t&&_o(e,wa(e),t)}(s,t)):function(t,e){return _o(t,ei(t),e)}(t,Wn(s,t))}else{if(!Bt[M])return o?t:{};s=function(t,e,n){var r=t.constructor;switch(e){case O:return ho(t);case l:case d:return new r(+t);case E:return function(t,e){var n=e?ho(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case T:case S:case A:case C:case R:case P:case"[object Uint8ClampedArray]":case j:case x:return po(t,n);case v:return new r;case y:case b:return new r(t);case m:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case _:return new r;case w:return o=t,Sn?vt(Sn.call(o)):{}}var o}(t,M,a)}}i||(i=new Dn);var N=i.get(t);if(N)return N;i.set(t,s),$s(t)?t.forEach((function(r){s.add(Xn(r,e,n,r,t,i))})):Hs(t)&&t.forEach((function(r,o){s.set(o,Xn(r,e,n,o,t,i))}));var z=I?void 0:(f?c?Yo:Wo:c?wa:ba)(t);return ae(z||t,(function(r,o){z&&(r=t[o=r]),Vn(s,o,Xn(r,e,n,o,t,i))})),s}function Qn(t,e,n){var r=n.length;if(null==t)return!r;for(t=vt(t);r--;){var o=n[r],i=e[o],s=t[o];if(void 0===s&&!(o in t)||!i(s))return!1}return!0}function Zn(t,e,n){if("function"!=typeof t)throw new mt(i);return bi((function(){t.apply(void 0,n)}),e)}function Jn(t,e,n,r){var o=-1,i=de,s=!0,a=t.length,u=[],c=e.length;if(!a)return u;n&&(e=he(e,Pe(n))),r?(i=fe,s=!1):e.length>=200&&(i=xe,s=!1,e=new zn(e));t:for(;++o<a;){var l=t[o],d=null==n?l:n(l);if(l=r||0!==l?l:0,s&&d==d){for(var f=c;f--;)if(e[f]===d)continue t;u.push(l)}else i(e,d,r)||u.push(l)}return u}Cn.templateSettings={escape:F,evaluate:B,interpolate:q,variable:"",imports:{_:Cn}},Cn.prototype=Pn.prototype,Cn.prototype.constructor=Cn,jn.prototype=Rn(Pn.prototype),jn.prototype.constructor=jn,xn.prototype=Rn(Pn.prototype),xn.prototype.constructor=xn,Mn.prototype.clear=function(){this.__data__=gn?gn(null):{},this.size=0},Mn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Mn.prototype.get=function(t){var e=this.__data__;if(gn){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Et.call(e,t)?e[t]:void 0},Mn.prototype.has=function(t){var e=this.__data__;return gn?void 0!==e[t]:Et.call(e,t)},Mn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=gn&&void 0===e?"__lodash_hash_undefined__":e,this},kn.prototype.clear=function(){this.__data__=[],this.size=0},kn.prototype.delete=function(t){var e=this.__data__,n=Gn(e,t);return!(n<0)&&(n==e.length-1?e.pop():$t.call(e,n,1),--this.size,!0)},kn.prototype.get=function(t){var e=this.__data__,n=Gn(e,t);return n<0?void 0:e[n][1]},kn.prototype.has=function(t){return Gn(this.__data__,t)>-1},kn.prototype.set=function(t,e){var n=this.__data__,r=Gn(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Nn.prototype.clear=function(){this.size=0,this.__data__={hash:new Mn,map:new(hn||kn),string:new Mn}},Nn.prototype.delete=function(t){var e=Zo(this,t).delete(t);return this.size-=e?1:0,e},Nn.prototype.get=function(t){return Zo(this,t).get(t)},Nn.prototype.has=function(t){return Zo(this,t).has(t)},Nn.prototype.set=function(t,e){var n=Zo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},zn.prototype.add=zn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},zn.prototype.has=function(t){return this.__data__.has(t)},Dn.prototype.clear=function(){this.__data__=new kn,this.size=0},Dn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Dn.prototype.get=function(t){return this.__data__.get(t)},Dn.prototype.has=function(t){return this.__data__.has(t)},Dn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof kn){var r=n.__data__;if(!hn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Nn(r)}return n.set(t,e),this.size=n.size,this};var tr=Io(ur),er=Io(cr,!0);function nr(t,e){var n=!0;return tr(t,(function(t,r,o){return n=!!e(t,r,o)})),n}function rr(t,e,n){for(var r=-1,o=t.length;++r<o;){var i=t[r],s=e(i);if(null!=s&&(void 0===a?s==s&&!Qs(s):n(s,a)))var a=s,u=i}return u}function or(t,e){var n=[];return tr(t,(function(t,r,o){e(t,r,o)&&n.push(t)})),n}function ir(t,e,n,r,o){var i=-1,s=t.length;for(n||(n=si),o||(o=[]);++i<s;){var a=t[i];e>0&&n(a)?e>1?ir(a,e-1,n,r,o):pe(o,a):r||(o[o.length]=a)}return o}var sr=Oo(),ar=Oo(!0);function ur(t,e){return t&&sr(t,e,ba)}function cr(t,e){return t&&ar(t,e,ba)}function lr(t,e){return le(e,(function(e){return Fs(t[e])}))}function dr(t,e){for(var n=0,r=(e=ao(e,t)).length;null!=t&&n<r;)t=t[Si(e[n++])];return n&&n==r?t:void 0}function fr(t,e,n){var r=e(t);return Ms(t)?r:pe(r,n(t))}function hr(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":me&&me in vt(t)?function(t){var e=Et.call(t,me),n=t[me];try{t[me]=void 0;var r=!0}catch(t){}var o=At.call(t);r&&(e?t[me]=n:delete t[me]);return o}(t):function(t){return At.call(t)}(t)}function pr(t,e){return t>e}function vr(t,e){return null!=t&&Et.call(t,e)}function yr(t,e){return null!=t&&e in vt(t)}function gr(t,e,n){for(var o=n?fe:de,i=t[0].length,s=t.length,a=s,u=r(s),c=1/0,l=[];a--;){var d=t[a];a&&e&&(d=he(d,Pe(e))),c=an(d.length,c),u[a]=!n&&(e||i>=120&&d.length>=120)?new zn(a&&d):void 0}d=t[0];var f=-1,h=u[0];t:for(;++f<i&&l.length<c;){var p=d[f],v=e?e(p):p;if(p=n||0!==p?p:0,!(h?xe(h,v):o(l,v,n))){for(a=s;--a;){var y=u[a];if(!(y?xe(y,v):o(t[a],v,n)))continue t}h&&h.push(v),l.push(p)}}return l}function mr(t,e,n){var r=null==(t=yi(t,e=ao(e,t)))?t:t[Si(Li(e))];return null==r?void 0:ie(r,t,n)}function _r(t){return Gs(t)&&hr(t)==u}function br(t,e,n,r,o){return t===e||(null==t||null==e||!Gs(t)&&!Gs(e)?t!=t&&e!=e:function(t,e,n,r,o,i){var s=Ms(t),a=Ms(e),h=s?c:ri(t),p=a?c:ri(e),I=(h=h==u?g:h)==g,T=(p=p==u?g:p)==g,S=h==p;if(S&&Ds(t)){if(!Ds(e))return!1;s=!0,I=!1}if(S&&!I)return i||(i=new Dn),s||Zs(t)?Go(t,e,n,r,o,i):function(t,e,n,r,o,i,s){switch(n){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!i(new zt(t),new zt(e)));case l:case d:case y:return Rs(+t,+e);case f:return t.name==e.name&&t.message==e.message;case m:case b:return t==e+"";case v:var a=Fe;case _:var u=1&r;if(a||(a=Ve),t.size!=e.size&&!u)return!1;var c=s.get(t);if(c)return c==e;r|=2,s.set(t,e);var h=Go(a(t),a(e),r,o,i,s);return s.delete(t),h;case w:if(Sn)return Sn.call(t)==Sn.call(e)}return!1}(t,e,h,n,r,o,i);if(!(1&n)){var A=I&&Et.call(t,"__wrapped__"),C=T&&Et.call(e,"__wrapped__");if(A||C){var R=A?t.value():t,P=C?e.value():e;return i||(i=new Dn),o(R,P,n,r,i)}}if(!S)return!1;return i||(i=new Dn),function(t,e,n,r,o,i){var s=1&n,a=Wo(t),u=a.length,c=Wo(e).length;if(u!=c&&!s)return!1;var l=u;for(;l--;){var d=a[l];if(!(s?d in e:Et.call(e,d)))return!1}var f=i.get(t);if(f&&i.get(e))return f==e;var h=!0;i.set(t,e),i.set(e,t);var p=s;for(;++l<u;){d=a[l];var v=t[d],y=e[d];if(r)var g=s?r(y,v,d,e,t,i):r(v,y,d,t,e,i);if(!(void 0===g?v===y||o(v,y,n,r,i):g)){h=!1;break}p||(p="constructor"==d)}if(h&&!p){var m=t.constructor,_=e.constructor;m==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof m&&m instanceof m&&"function"==typeof _&&_ instanceof _||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,n,r,o,i)}(t,e,n,r,br,o))}function wr(t,e,n,r){var o=n.length,i=o,s=!r;if(null==t)return!i;for(t=vt(t);o--;){var a=n[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var u=(a=n[o])[0],c=t[u],l=a[1];if(s&&a[2]){if(void 0===c&&!(u in t))return!1}else{var d=new Dn;if(r)var f=r(c,l,u,t,e,d);if(!(void 0===f?br(l,c,3,r,d):f))return!1}}return!0}function Ir(t){return!(!Vs(t)||(e=t,St&&St in e))&&(Fs(t)?Pt:st).test(Ai(t));var e}function Or(t){return"function"==typeof t?t:null==t?Wa:"object"==typeof t?Ms(t)?Rr(t[0],t[1]):Cr(t):eu(t)}function Er(t){if(!fi(t))return on(t);var e=[];for(var n in vt(t))Et.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Tr(t){if(!Vs(t))return function(t){var e=[];if(null!=t)for(var n in vt(t))e.push(n);return e}(t);var e=fi(t),n=[];for(var r in t)("constructor"!=r||!e&&Et.call(t,r))&&n.push(r);return n}function Sr(t,e){return t<e}function Ar(t,e){var n=-1,o=Ns(t)?r(t.length):[];return tr(t,(function(t,r,i){o[++n]=e(t,r,i)})),o}function Cr(t){var e=Jo(t);return 1==e.length&&e[0][2]?pi(e[0][0],e[0][1]):function(n){return n===t||wr(n,t,e)}}function Rr(t,e){return ci(t)&&hi(e)?pi(Si(t),e):function(n){var r=va(n,t);return void 0===r&&r===e?ya(n,t):br(e,r,3)}}function Pr(t,e,n,r,o){t!==e&&sr(e,(function(i,s){if(o||(o=new Dn),Vs(i))!function(t,e,n,r,o,i,s){var a=mi(t,n),u=mi(e,n),c=s.get(u);if(c)return void qn(t,n,c);var l=i?i(a,u,n+"",t,e,s):void 0,d=void 0===l;if(d){var f=Ms(u),h=!f&&Ds(u),p=!f&&!h&&Zs(u);l=u,f||h||p?Ms(a)?l=a:zs(a)?l=mo(a):h?(d=!1,l=fo(u,!0)):p?(d=!1,l=po(u,!0)):l=[]:Ys(u)||xs(u)?(l=a,xs(a)?l=sa(a):Vs(a)&&!Fs(a)||(l=ii(u))):d=!1}d&&(s.set(u,l),o(l,u,r,i,s),s.delete(u));qn(t,n,l)}(t,e,s,n,Pr,r,o);else{var a=r?r(mi(t,s),i,s+"",t,e,o):void 0;void 0===a&&(a=i),qn(t,s,a)}}),wa)}function jr(t,e){var n=t.length;if(n)return ai(e+=e<0?n:0,n)?t[e]:void 0}function xr(t,e,n){var r=-1;return e=he(e.length?e:[Wa],Pe(Qo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Ar(t,(function(t,n,o){return{criteria:he(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,o=t.criteria,i=e.criteria,s=o.length,a=n.length;for(;++r<s;){var u=vo(o[r],i[r]);if(u){if(r>=a)return u;var c=n[r];return u*("desc"==c?-1:1)}}return t.index-e.index}(t,e,n)}))}function Mr(t,e,n){for(var r=-1,o=e.length,i={};++r<o;){var s=e[r],a=dr(t,s);n(a,s)&&Br(i,ao(s,t),a)}return i}function kr(t,e,n,r){var o=r?Ie:we,i=-1,s=e.length,a=t;for(t===e&&(e=mo(e)),n&&(a=he(t,Pe(n)));++i<s;)for(var u=0,c=e[i],l=n?n(c):c;(u=o(a,l,u,r))>-1;)a!==t&&$t.call(a,u,1),$t.call(t,u,1);return t}function Nr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var o=e[n];if(n==r||o!==i){var i=o;ai(o)?$t.call(t,o,1):Jr(t,o)}}return t}function zr(t,e){return t+Je(ln()*(e-t+1))}function Dr(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=Je(e/2))&&(t+=t)}while(e);return n}function Ur(t,e){return wi(vi(t,e,Wa),t+"")}function Lr(t){return Ln(Ra(t))}function Fr(t,e){var n=Ra(t);return Ei(n,$n(e,0,n.length))}function Br(t,e,n,r){if(!Vs(t))return t;for(var o=-1,i=(e=ao(e,t)).length,s=i-1,a=t;null!=a&&++o<i;){var u=Si(e[o]),c=n;if(o!=s){var l=a[u];void 0===(c=r?r(l,u,a):void 0)&&(c=Vs(l)?l:ai(e[o+1])?[]:{})}Vn(a,u,c),a=a[u]}return t}var qr=mn?function(t,e){return mn.set(t,e),t}:Wa,Vr=Se?function(t,e){return Se(t,"toString",{configurable:!0,enumerable:!1,value:Va(e),writable:!0})}:Wa;function Gr(t){return Ei(Ra(t))}function Hr(t,e,n){var o=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=r(i);++o<i;)s[o]=t[o+e];return s}function Wr(t,e){var n;return tr(t,(function(t,r,o){return!(n=e(t,r,o))})),!!n}function Yr(t,e,n){var r=0,o=null==t?r:t.length;if("number"==typeof e&&e==e&&o<=2147483647){for(;r<o;){var i=r+o>>>1,s=t[i];null!==s&&!Qs(s)&&(n?s<=e:s<e)?r=i+1:o=i}return o}return Kr(t,e,Wa,n)}function Kr(t,e,n,r){e=n(e);for(var o=0,i=null==t?0:t.length,s=e!=e,a=null===e,u=Qs(e),c=void 0===e;o<i;){var l=Je((o+i)/2),d=n(t[l]),f=void 0!==d,h=null===d,p=d==d,v=Qs(d);if(s)var y=r||p;else y=c?p&&(r||f):a?p&&f&&(r||!h):u?p&&f&&!h&&(r||!v):!h&&!v&&(r?d<=e:d<e);y?o=l+1:i=l}return an(i,4294967294)}function $r(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!Rs(a,u)){var u=a;i[o++]=0===s?0:s}}return i}function Xr(t){return"number"==typeof t?t:Qs(t)?NaN:+t}function Qr(t){if("string"==typeof t)return t;if(Ms(t))return he(t,Qr)+"";if(Qs(t))return An?An.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Zr(t,e,n){var r=-1,o=de,i=t.length,s=!0,a=[],u=a;if(n)s=!1,o=fe;else if(i>=200){var c=e?null:Uo(t);if(c)return Ve(c);s=!1,o=xe,u=new zn}else u=e?[]:a;t:for(;++r<i;){var l=t[r],d=e?e(l):l;if(l=n||0!==l?l:0,s&&d==d){for(var f=u.length;f--;)if(u[f]===d)continue t;e&&u.push(d),a.push(l)}else o(u,d,n)||(u!==a&&u.push(d),a.push(l))}return a}function Jr(t,e){return null==(t=yi(t,e=ao(e,t)))||delete t[Si(Li(e))]}function to(t,e,n,r){return Br(t,e,n(dr(t,e)),r)}function eo(t,e,n,r){for(var o=t.length,i=r?o:-1;(r?i--:++i<o)&&e(t[i],i,t););return n?Hr(t,r?0:i,r?i+1:o):Hr(t,r?i+1:0,r?o:i)}function no(t,e){var n=t;return n instanceof xn&&(n=n.value()),ve(e,(function(t,e){return e.func.apply(e.thisArg,pe([t],e.args))}),n)}function ro(t,e,n){var o=t.length;if(o<2)return o?Zr(t[0]):[];for(var i=-1,s=r(o);++i<o;)for(var a=t[i],u=-1;++u<o;)u!=i&&(s[i]=Jn(s[i]||a,t[u],e,n));return Zr(ir(s,1),e,n)}function oo(t,e,n){for(var r=-1,o=t.length,i=e.length,s={};++r<o;){var a=r<i?e[r]:void 0;n(s,t[r],a)}return s}function io(t){return zs(t)?t:[]}function so(t){return"function"==typeof t?t:Wa}function ao(t,e){return Ms(t)?t:ci(t,e)?[t]:Ti(aa(t))}var uo=Ur;function co(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:Hr(t,e,n)}var lo=$e||function(t){return Yt.clearTimeout(t)};function fo(t,e){if(e)return t.slice();var n=t.length,r=qt?qt(n):new t.constructor(n);return t.copy(r),r}function ho(t){var e=new t.constructor(t.byteLength);return new zt(e).set(new zt(t)),e}function po(t,e){var n=e?ho(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function vo(t,e){if(t!==e){var n=void 0!==t,r=null===t,o=t==t,i=Qs(t),s=void 0!==e,a=null===e,u=e==e,c=Qs(e);if(!a&&!c&&!i&&t>e||i&&s&&u&&!a&&!c||r&&s&&u||!n&&u||!o)return 1;if(!r&&!i&&!c&&t<e||c&&n&&o&&!r&&!i||a&&n&&o||!s&&o||!u)return-1}return 0}function yo(t,e,n,o){for(var i=-1,s=t.length,a=n.length,u=-1,c=e.length,l=sn(s-a,0),d=r(c+l),f=!o;++u<c;)d[u]=e[u];for(;++i<a;)(f||i<s)&&(d[n[i]]=t[i]);for(;l--;)d[u++]=t[i++];return d}function go(t,e,n,o){for(var i=-1,s=t.length,a=-1,u=n.length,c=-1,l=e.length,d=sn(s-u,0),f=r(d+l),h=!o;++i<d;)f[i]=t[i];for(var p=i;++c<l;)f[p+c]=e[c];for(;++a<u;)(h||i<s)&&(f[p+n[a]]=t[i++]);return f}function mo(t,e){var n=-1,o=t.length;for(e||(e=r(o));++n<o;)e[n]=t[n];return e}function _o(t,e,n,r){var o=!n;n||(n={});for(var i=-1,s=e.length;++i<s;){var a=e[i],u=r?r(n[a],t[a],a,n,t):void 0;void 0===u&&(u=t[a]),o?Yn(n,a,u):Vn(n,a,u)}return n}function bo(t,e){return function(n,r){var o=Ms(n)?se:Hn,i=e?e():{};return o(n,t,Qo(r,2),i)}}function wo(t){return Ur((function(e,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,s&&ui(n[0],n[1],s)&&(i=o<3?void 0:i,o=1),e=vt(e);++r<o;){var a=n[r];a&&t(e,a,r,i)}return e}))}function Io(t,e){return function(n,r){if(null==n)return n;if(!Ns(n))return t(n,r);for(var o=n.length,i=e?o:-1,s=vt(n);(e?i--:++i<o)&&!1!==r(s[i],i,s););return n}}function Oo(t){return function(e,n,r){for(var o=-1,i=vt(e),s=r(e),a=s.length;a--;){var u=s[t?a:++o];if(!1===n(i[u],u,i))break}return e}}function Eo(t){return function(e){var n=Le(e=aa(e))?We(e):void 0,r=n?n[0]:e.charAt(0),o=n?co(n,1).join(""):e.slice(1);return r[t]()+o}}function To(t){return function(e){return ve(Fa(xa(e).replace(xt,"")),t,"")}}function So(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Rn(t.prototype),r=t.apply(n,e);return Vs(r)?r:n}}function Ao(t){return function(e,n,r){var o=vt(e);if(!Ns(e)){var i=Qo(n,3);e=ba(e),n=function(t){return i(o[t],t,o)}}var s=t(e,n,r);return s>-1?o[i?e[s]:s]:void 0}}function Co(t){return Ho((function(e){var n=e.length,r=n,o=jn.prototype.thru;for(t&&e.reverse();r--;){var s=e[r];if("function"!=typeof s)throw new mt(i);if(o&&!a&&"wrapper"==$o(s))var a=new jn([],!0)}for(r=a?r:n;++r<n;){var u=$o(s=e[r]),c="wrapper"==u?Ko(s):void 0;a=c&&li(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?a[$o(c[0])].apply(a,c[3]):1==s.length&&li(s)?a[u]():a.thru(s)}return function(){var t=arguments,r=t[0];if(a&&1==t.length&&Ms(r))return a.plant(r).value();for(var o=0,i=n?e[o].apply(this,t):r;++o<n;)i=e[o].call(this,i);return i}}))}function Ro(t,e,n,o,i,s,a,u,c,l){var d=128&e,f=1&e,h=2&e,p=24&e,v=512&e,y=h?void 0:So(t);return function g(){for(var m=arguments.length,_=r(m),b=m;b--;)_[b]=arguments[b];if(p)var w=Xo(g),I=Ne(_,w);if(o&&(_=yo(_,o,i,p)),s&&(_=go(_,s,a,p)),m-=I,p&&m<l){var O=qe(_,w);return zo(t,e,Ro,g.placeholder,n,_,O,u,c,l-m)}var E=f?n:this,T=h?E[t]:t;return m=_.length,u?_=gi(_,u):v&&m>1&&_.reverse(),d&&c<m&&(_.length=c),this&&this!==Yt&&this instanceof g&&(T=y||So(T)),T.apply(E,_)}}function Po(t,e){return function(n,r){return function(t,e,n,r){return ur(t,(function(t,o,i){e(r,n(t),o,i)})),r}(n,t,e(r),{})}}function jo(t,e){return function(n,r){var o;if(void 0===n&&void 0===r)return e;if(void 0!==n&&(o=n),void 0!==r){if(void 0===o)return r;"string"==typeof n||"string"==typeof r?(n=Qr(n),r=Qr(r)):(n=Xr(n),r=Xr(r)),o=t(n,r)}return o}}function xo(t){return Ho((function(e){return e=he(e,Pe(Qo())),Ur((function(n){var r=this;return t(e,(function(t){return ie(t,r,n)}))}))}))}function Mo(t,e){var n=(e=void 0===e?" ":Qr(e)).length;if(n<2)return n?Dr(e,t):e;var r=Dr(e,Ze(t/He(e)));return Le(e)?co(We(r),0,t).join(""):r.slice(0,t)}function ko(t){return function(e,n,o){return o&&"number"!=typeof o&&ui(e,n,o)&&(n=o=void 0),e=na(e),void 0===n?(n=e,e=0):n=na(n),function(t,e,n,o){for(var i=-1,s=sn(Ze((e-t)/(n||1)),0),a=r(s);s--;)a[o?s:++i]=t,t+=n;return a}(e,n,o=void 0===o?e<n?1:-1:na(o),t)}}function No(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ia(e),n=ia(n)),t(e,n)}}function zo(t,e,n,r,o,i,s,a,u,c){var l=8&e;e|=l?32:64,4&(e&=~(l?64:32))||(e&=-4);var d=[t,e,o,l?i:void 0,l?s:void 0,l?void 0:i,l?void 0:s,a,u,c],f=n.apply(void 0,d);return li(t)&&_i(f,d),f.placeholder=r,Ii(f,t,e)}function Do(t){var e=pt[t];return function(t,n){if(t=ia(t),(n=null==n?0:an(ra(n),292))&&nn(t)){var r=(aa(t)+"e").split("e");return+((r=(aa(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Uo=vn&&1/Ve(new vn([,-0]))[1]==1/0?function(t){return new vn(t)}:Qa;function Lo(t){return function(e){var n=ri(e);return n==v?Fe(e):n==_?Ge(e):function(t,e){return he(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Fo(t,e,n,o,a,u,c,l){var d=2&e;if(!d&&"function"!=typeof t)throw new mt(i);var f=o?o.length:0;if(f||(e&=-97,o=a=void 0),c=void 0===c?c:sn(ra(c),0),l=void 0===l?l:ra(l),f-=a?a.length:0,64&e){var h=o,p=a;o=a=void 0}var v=d?void 0:Ko(t),y=[t,e,n,o,a,h,p,u,c,l];if(v&&function(t,e){var n=t[1],r=e[1],o=n|r,i=o<131,a=128==r&&8==n||128==r&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!i&&!a)return t;1&r&&(t[2]=e[2],o|=1&n?0:4);var u=e[3];if(u){var c=t[3];t[3]=c?yo(c,u,e[4]):u,t[4]=c?qe(t[3],s):e[4]}(u=e[5])&&(c=t[5],t[5]=c?go(c,u,e[6]):u,t[6]=c?qe(t[5],s):e[6]);(u=e[7])&&(t[7]=u);128&r&&(t[8]=null==t[8]?e[8]:an(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=o}(y,v),t=y[0],e=y[1],n=y[2],o=y[3],a=y[4],!(l=y[9]=void 0===y[9]?d?0:t.length:sn(y[9]-f,0))&&24&e&&(e&=-25),e&&1!=e)g=8==e||16==e?function(t,e,n){var o=So(t);return function i(){for(var s=arguments.length,a=r(s),u=s,c=Xo(i);u--;)a[u]=arguments[u];var l=s<3&&a[0]!==c&&a[s-1]!==c?[]:qe(a,c);if((s-=l.length)<n)return zo(t,e,Ro,i.placeholder,void 0,a,l,void 0,void 0,n-s);var d=this&&this!==Yt&&this instanceof i?o:t;return ie(d,this,a)}}(t,e,l):32!=e&&33!=e||a.length?Ro.apply(void 0,y):function(t,e,n,o){var i=1&e,s=So(t);return function e(){for(var a=-1,u=arguments.length,c=-1,l=o.length,d=r(l+u),f=this&&this!==Yt&&this instanceof e?s:t;++c<l;)d[c]=o[c];for(;u--;)d[c++]=arguments[++a];return ie(f,i?n:this,d)}}(t,e,n,o);else var g=function(t,e,n){var r=1&e,o=So(t);return function e(){var i=this&&this!==Yt&&this instanceof e?o:t;return i.apply(r?n:this,arguments)}}(t,e,n);return Ii((v?qr:_i)(g,y),t,e)}function Bo(t,e,n,r){return void 0===t||Rs(t,wt[n])&&!Et.call(r,n)?e:t}function qo(t,e,n,r,o,i){return Vs(t)&&Vs(e)&&(i.set(e,t),Pr(t,e,void 0,qo,i),i.delete(e)),t}function Vo(t){return Ys(t)?void 0:t}function Go(t,e,n,r,o,i){var s=1&n,a=t.length,u=e.length;if(a!=u&&!(s&&u>a))return!1;var c=i.get(t);if(c&&i.get(e))return c==e;var l=-1,d=!0,f=2&n?new zn:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var h=t[l],p=e[l];if(r)var v=s?r(p,h,l,e,t,i):r(h,p,l,t,e,i);if(void 0!==v){if(v)continue;d=!1;break}if(f){if(!ge(e,(function(t,e){if(!xe(f,e)&&(h===t||o(h,t,n,r,i)))return f.push(e)}))){d=!1;break}}else if(h!==p&&!o(h,p,n,r,i)){d=!1;break}}return i.delete(t),i.delete(e),d}function Ho(t){return wi(vi(t,void 0,ki),t+"")}function Wo(t){return fr(t,ba,ei)}function Yo(t){return fr(t,wa,ni)}var Ko=mn?function(t){return mn.get(t)}:Qa;function $o(t){for(var e=t.name+"",n=_n[e],r=Et.call(_n,e)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==t)return o.name}return e}function Xo(t){return(Et.call(Cn,"placeholder")?Cn:t).placeholder}function Qo(){var t=Cn.iteratee||Ya;return t=t===Ya?Or:t,arguments.length?t(arguments[0],arguments[1]):t}function Zo(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Jo(t){for(var e=ba(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,hi(o)]}return e}function ti(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return Ir(n)?n:void 0}var ei=tn?function(t){return null==t?[]:(t=vt(t),le(tn(t),(function(e){return Kt.call(t,e)})))}:ou,ni=tn?function(t){for(var e=[];t;)pe(e,ei(t)),t=Ht(t);return e}:ou,ri=hr;function oi(t,e,n){for(var r=-1,o=(e=ao(e,t)).length,i=!1;++r<o;){var s=Si(e[r]);if(!(i=null!=t&&n(t,s)))break;t=t[s]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&qs(o)&&ai(s,o)&&(Ms(t)||xs(t))}function ii(t){return"function"!=typeof t.constructor||fi(t)?{}:Rn(Ht(t))}function si(t){return Ms(t)||xs(t)||!!(Qt&&t&&t[Qt])}function ai(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&ut.test(t))&&t>-1&&t%1==0&&t<e}function ui(t,e,n){if(!Vs(n))return!1;var r=typeof e;return!!("number"==r?Ns(n)&&ai(e,n.length):"string"==r&&e in n)&&Rs(n[e],t)}function ci(t,e){if(Ms(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Qs(t))||(G.test(t)||!V.test(t)||null!=e&&t in vt(e))}function li(t){var e=$o(t),n=Cn[e];if("function"!=typeof n||!(e in xn.prototype))return!1;if(t===n)return!0;var r=Ko(n);return!!r&&t===r[0]}(fn&&ri(new fn(new ArrayBuffer(1)))!=E||hn&&ri(new hn)!=v||pn&&"[object Promise]"!=ri(pn.resolve())||vn&&ri(new vn)!=_||yn&&ri(new yn)!=I)&&(ri=function(t){var e=hr(t),n=e==g?t.constructor:void 0,r=n?Ai(n):"";if(r)switch(r){case bn:return E;case wn:return v;case In:return"[object Promise]";case On:return _;case En:return I}return e});var di=It?Fs:iu;function fi(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||wt)}function hi(t){return t==t&&!Vs(t)}function pi(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in vt(n)))}}function vi(t,e,n){return e=sn(void 0===e?t.length-1:e,0),function(){for(var o=arguments,i=-1,s=sn(o.length-e,0),a=r(s);++i<s;)a[i]=o[e+i];i=-1;for(var u=r(e+1);++i<e;)u[i]=o[i];return u[e]=n(a),ie(t,this,u)}}function yi(t,e){return e.length<2?t:dr(t,Hr(e,0,-1))}function gi(t,e){for(var n=t.length,r=an(e.length,n),o=mo(t);r--;){var i=e[r];t[r]=ai(i,n)?o[i]:void 0}return t}function mi(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var _i=Oi(qr),bi=Qe||function(t,e){return Yt.setTimeout(t,e)},wi=Oi(Vr);function Ii(t,e,n){var r=e+"";return wi(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Q,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return ae(a,(function(n){var r="_."+n[0];e&n[1]&&!de(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(Z);return e?e[1].split(J):[]}(r),n)))}function Oi(t){var e=0,n=0;return function(){var r=un(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Ei(t,e){var n=-1,r=t.length,o=r-1;for(e=void 0===e?r:e;++n<e;){var i=zr(n,o),s=t[i];t[i]=t[n],t[n]=s}return t.length=e,t}var Ti=function(t){var e=Os(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(H,(function(t,n,r,o){e.push(r?o.replace(et,"$1"):n||t)})),e}));function Si(t){if("string"==typeof t||Qs(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ai(t){if(null!=t){try{return Ot.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ci(t){if(t instanceof xn)return t.clone();var e=new jn(t.__wrapped__,t.__chain__);return e.__actions__=mo(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Ri=Ur((function(t,e){return zs(t)?Jn(t,ir(e,1,zs,!0)):[]})),Pi=Ur((function(t,e){var n=Li(e);return zs(n)&&(n=void 0),zs(t)?Jn(t,ir(e,1,zs,!0),Qo(n,2)):[]})),ji=Ur((function(t,e){var n=Li(e);return zs(n)&&(n=void 0),zs(t)?Jn(t,ir(e,1,zs,!0),void 0,n):[]}));function xi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ra(n);return o<0&&(o=sn(r+o,0)),be(t,Qo(e,3),o)}function Mi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r-1;return void 0!==n&&(o=ra(n),o=n<0?sn(r+o,0):an(o,r-1)),be(t,Qo(e,3),o,!0)}function ki(t){return(null==t?0:t.length)?ir(t,1):[]}function Ni(t){return t&&t.length?t[0]:void 0}var zi=Ur((function(t){var e=he(t,io);return e.length&&e[0]===t[0]?gr(e):[]})),Di=Ur((function(t){var e=Li(t),n=he(t,io);return e===Li(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?gr(n,Qo(e,2)):[]})),Ui=Ur((function(t){var e=Li(t),n=he(t,io);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?gr(n,void 0,e):[]}));function Li(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Fi=Ur(Bi);function Bi(t,e){return t&&t.length&&e&&e.length?kr(t,e):t}var qi=Ho((function(t,e){var n=null==t?0:t.length,r=Kn(t,e);return Nr(t,he(e,(function(t){return ai(t,n)?+t:t})).sort(vo)),r}));function Vi(t){return null==t?t:dn.call(t)}var Gi=Ur((function(t){return Zr(ir(t,1,zs,!0))})),Hi=Ur((function(t){var e=Li(t);return zs(e)&&(e=void 0),Zr(ir(t,1,zs,!0),Qo(e,2))})),Wi=Ur((function(t){var e=Li(t);return e="function"==typeof e?e:void 0,Zr(ir(t,1,zs,!0),void 0,e)}));function Yi(t){if(!t||!t.length)return[];var e=0;return t=le(t,(function(t){if(zs(t))return e=sn(t.length,e),!0})),Re(e,(function(e){return he(t,Te(e))}))}function Ki(t,e){if(!t||!t.length)return[];var n=Yi(t);return null==e?n:he(n,(function(t){return ie(e,void 0,t)}))}var $i=Ur((function(t,e){return zs(t)?Jn(t,e):[]})),Xi=Ur((function(t){return ro(le(t,zs))})),Qi=Ur((function(t){var e=Li(t);return zs(e)&&(e=void 0),ro(le(t,zs),Qo(e,2))})),Zi=Ur((function(t){var e=Li(t);return e="function"==typeof e?e:void 0,ro(le(t,zs),void 0,e)})),Ji=Ur(Yi);var ts=Ur((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,Ki(t,n)}));function es(t){var e=Cn(t);return e.__chain__=!0,e}function ns(t,e){return e(t)}var rs=Ho((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,o=function(e){return Kn(e,t)};return!(e>1||this.__actions__.length)&&r instanceof xn&&ai(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:ns,args:[o],thisArg:void 0}),new jn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(o)}));var os=bo((function(t,e,n){Et.call(t,n)?++t[n]:Yn(t,n,1)}));var is=Ao(xi),ss=Ao(Mi);function as(t,e){return(Ms(t)?ae:tr)(t,Qo(e,3))}function us(t,e){return(Ms(t)?ue:er)(t,Qo(e,3))}var cs=bo((function(t,e,n){Et.call(t,n)?t[n].push(e):Yn(t,n,[e])}));var ls=Ur((function(t,e,n){var o=-1,i="function"==typeof e,s=Ns(t)?r(t.length):[];return tr(t,(function(t){s[++o]=i?ie(e,t,n):mr(t,e,n)})),s})),ds=bo((function(t,e,n){Yn(t,n,e)}));function fs(t,e){return(Ms(t)?he:Ar)(t,Qo(e,3))}var hs=bo((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var ps=Ur((function(t,e){if(null==t)return[];var n=e.length;return n>1&&ui(t,e[0],e[1])?e=[]:n>2&&ui(e[0],e[1],e[2])&&(e=[e[0]]),xr(t,ir(e,1),[])})),vs=Xe||function(){return Yt.Date.now()};function ys(t,e,n){return e=n?void 0:e,Fo(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function gs(t,e){var n;if("function"!=typeof e)throw new mt(i);return t=ra(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var ms=Ur((function(t,e,n){var r=1;if(n.length){var o=qe(n,Xo(ms));r|=32}return Fo(t,r,e,n,o)})),_s=Ur((function(t,e,n){var r=3;if(n.length){var o=qe(n,Xo(_s));r|=32}return Fo(e,r,t,n,o)}));function bs(t,e,n){var r,o,s,a,u,c,l=0,d=!1,f=!1,h=!0;if("function"!=typeof t)throw new mt(i);function p(e){var n=r,i=o;return r=o=void 0,l=e,a=t.apply(i,n)}function v(t){return l=t,u=bi(g,e),d?p(t):a}function y(t){var n=t-c;return void 0===c||n>=e||n<0||f&&t-l>=s}function g(){var t=vs();if(y(t))return m(t);u=bi(g,function(t){var n=e-(t-c);return f?an(n,s-(t-l)):n}(t))}function m(t){return u=void 0,h&&r?p(t):(r=o=void 0,a)}function _(){var t=vs(),n=y(t);if(r=arguments,o=this,c=t,n){if(void 0===u)return v(c);if(f)return lo(u),u=bi(g,e),p(c)}return void 0===u&&(u=bi(g,e)),a}return e=ia(e)||0,Vs(n)&&(d=!!n.leading,s=(f="maxWait"in n)?sn(ia(n.maxWait)||0,e):s,h="trailing"in n?!!n.trailing:h),_.cancel=function(){void 0!==u&&lo(u),l=0,r=c=o=u=void 0},_.flush=function(){return void 0===u?a:m(vs())},_}var ws=Ur((function(t,e){return Zn(t,1,e)})),Is=Ur((function(t,e,n){return Zn(t,ia(e)||0,n)}));function Os(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new mt(i);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(Os.Cache||Nn),n}function Es(t){if("function"!=typeof t)throw new mt(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Os.Cache=Nn;var Ts=uo((function(t,e){var n=(e=1==e.length&&Ms(e[0])?he(e[0],Pe(Qo())):he(ir(e,1),Pe(Qo()))).length;return Ur((function(r){for(var o=-1,i=an(r.length,n);++o<i;)r[o]=e[o].call(this,r[o]);return ie(t,this,r)}))})),Ss=Ur((function(t,e){return Fo(t,32,void 0,e,qe(e,Xo(Ss)))})),As=Ur((function(t,e){return Fo(t,64,void 0,e,qe(e,Xo(As)))})),Cs=Ho((function(t,e){return Fo(t,256,void 0,void 0,void 0,e)}));function Rs(t,e){return t===e||t!=t&&e!=e}var Ps=No(pr),js=No((function(t,e){return t>=e})),xs=_r(function(){return arguments}())?_r:function(t){return Gs(t)&&Et.call(t,"callee")&&!Kt.call(t,"callee")},Ms=r.isArray,ks=Jt?Pe(Jt):function(t){return Gs(t)&&hr(t)==O};function Ns(t){return null!=t&&qs(t.length)&&!Fs(t)}function zs(t){return Gs(t)&&Ns(t)}var Ds=en||iu,Us=te?Pe(te):function(t){return Gs(t)&&hr(t)==d};function Ls(t){if(!Gs(t))return!1;var e=hr(t);return e==f||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!Ys(t)}function Fs(t){if(!Vs(t))return!1;var e=hr(t);return e==h||e==p||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Bs(t){return"number"==typeof t&&t==ra(t)}function qs(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Vs(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Gs(t){return null!=t&&"object"==typeof t}var Hs=ee?Pe(ee):function(t){return Gs(t)&&ri(t)==v};function Ws(t){return"number"==typeof t||Gs(t)&&hr(t)==y}function Ys(t){if(!Gs(t)||hr(t)!=g)return!1;var e=Ht(t);if(null===e)return!0;var n=Et.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ot.call(n)==Ct}var Ks=ne?Pe(ne):function(t){return Gs(t)&&hr(t)==m};var $s=re?Pe(re):function(t){return Gs(t)&&ri(t)==_};function Xs(t){return"string"==typeof t||!Ms(t)&&Gs(t)&&hr(t)==b}function Qs(t){return"symbol"==typeof t||Gs(t)&&hr(t)==w}var Zs=oe?Pe(oe):function(t){return Gs(t)&&qs(t.length)&&!!Ft[hr(t)]};var Js=No(Sr),ta=No((function(t,e){return t<=e}));function ea(t){if(!t)return[];if(Ns(t))return Xs(t)?We(t):mo(t);if(Zt&&t[Zt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Zt]());var e=ri(t);return(e==v?Fe:e==_?Ve:Ra)(t)}function na(t){return t?(t=ia(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ra(t){var e=na(t),n=e%1;return e==e?n?e-n:e:0}function oa(t){return t?$n(ra(t),0,4294967295):0}function ia(t){if("number"==typeof t)return t;if(Qs(t))return NaN;if(Vs(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Vs(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(K,"");var n=it.test(t);return n||at.test(t)?Gt(t.slice(2),n?2:8):ot.test(t)?NaN:+t}function sa(t){return _o(t,wa(t))}function aa(t){return null==t?"":Qr(t)}var ua=wo((function(t,e){if(fi(e)||Ns(e))_o(e,ba(e),t);else for(var n in e)Et.call(e,n)&&Vn(t,n,e[n])})),ca=wo((function(t,e){_o(e,wa(e),t)})),la=wo((function(t,e,n,r){_o(e,wa(e),t,r)})),da=wo((function(t,e,n,r){_o(e,ba(e),t,r)})),fa=Ho(Kn);var ha=Ur((function(t,e){t=vt(t);var n=-1,r=e.length,o=r>2?e[2]:void 0;for(o&&ui(e[0],e[1],o)&&(r=1);++n<r;)for(var i=e[n],s=wa(i),a=-1,u=s.length;++a<u;){var c=s[a],l=t[c];(void 0===l||Rs(l,wt[c])&&!Et.call(t,c))&&(t[c]=i[c])}return t})),pa=Ur((function(t){return t.push(void 0,qo),ie(Oa,void 0,t)}));function va(t,e,n){var r=null==t?void 0:dr(t,e);return void 0===r?n:r}function ya(t,e){return null!=t&&oi(t,e,yr)}var ga=Po((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=At.call(e)),t[e]=n}),Va(Wa)),ma=Po((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=At.call(e)),Et.call(t,e)?t[e].push(n):t[e]=[n]}),Qo),_a=Ur(mr);function ba(t){return Ns(t)?Un(t):Er(t)}function wa(t){return Ns(t)?Un(t,!0):Tr(t)}var Ia=wo((function(t,e,n){Pr(t,e,n)})),Oa=wo((function(t,e,n,r){Pr(t,e,n,r)})),Ea=Ho((function(t,e){var n={};if(null==t)return n;var r=!1;e=he(e,(function(e){return e=ao(e,t),r||(r=e.length>1),e})),_o(t,Yo(t),n),r&&(n=Xn(n,7,Vo));for(var o=e.length;o--;)Jr(n,e[o]);return n}));var Ta=Ho((function(t,e){return null==t?{}:function(t,e){return Mr(t,e,(function(e,n){return ya(t,n)}))}(t,e)}));function Sa(t,e){if(null==t)return{};var n=he(Yo(t),(function(t){return[t]}));return e=Qo(e),Mr(t,n,(function(t,n){return e(t,n[0])}))}var Aa=Lo(ba),Ca=Lo(wa);function Ra(t){return null==t?[]:je(t,ba(t))}var Pa=To((function(t,e,n){return e=e.toLowerCase(),t+(n?ja(e):e)}));function ja(t){return La(aa(t).toLowerCase())}function xa(t){return(t=aa(t))&&t.replace(ct,ze).replace(Mt,"")}var Ma=To((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),ka=To((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Na=Eo("toLowerCase");var za=To((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var Da=To((function(t,e,n){return t+(n?" ":"")+La(e)}));var Ua=To((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),La=Eo("toUpperCase");function Fa(t,e,n){return t=aa(t),void 0===(e=n?void 0:e)?function(t){return Dt.test(t)}(t)?function(t){return t.match(Nt)||[]}(t):function(t){return t.match(tt)||[]}(t):t.match(e)||[]}var Ba=Ur((function(t,e){try{return ie(t,void 0,e)}catch(t){return Ls(t)?t:new ft(t)}})),qa=Ho((function(t,e){return ae(e,(function(e){e=Si(e),Yn(t,e,ms(t[e],t))})),t}));function Va(t){return function(){return t}}var Ga=Co(),Ha=Co(!0);function Wa(t){return t}function Ya(t){return Or("function"==typeof t?t:Xn(t,1))}var Ka=Ur((function(t,e){return function(n){return mr(n,t,e)}})),$a=Ur((function(t,e){return function(n){return mr(t,n,e)}}));function Xa(t,e,n){var r=ba(e),o=lr(e,r);null!=n||Vs(e)&&(o.length||!r.length)||(n=e,e=t,t=this,o=lr(e,ba(e)));var i=!(Vs(n)&&"chain"in n&&!n.chain),s=Fs(t);return ae(o,(function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),o=n.__actions__=mo(this.__actions__);return o.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,pe([this.value()],arguments))})})),t}function Qa(){}var Za=xo(he),Ja=xo(ce),tu=xo(ge);function eu(t){return ci(t)?Te(Si(t)):function(t){return function(e){return dr(e,t)}}(t)}var nu=ko(),ru=ko(!0);function ou(){return[]}function iu(){return!1}var su=jo((function(t,e){return t+e}),0),au=Do("ceil"),uu=jo((function(t,e){return t/e}),1),cu=Do("floor");var lu,du=jo((function(t,e){return t*e}),1),fu=Do("round"),hu=jo((function(t,e){return t-e}),0);return Cn.after=function(t,e){if("function"!=typeof e)throw new mt(i);return t=ra(t),function(){if(--t<1)return e.apply(this,arguments)}},Cn.ary=ys,Cn.assign=ua,Cn.assignIn=ca,Cn.assignInWith=la,Cn.assignWith=da,Cn.at=fa,Cn.before=gs,Cn.bind=ms,Cn.bindAll=qa,Cn.bindKey=_s,Cn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ms(t)?t:[t]},Cn.chain=es,Cn.chunk=function(t,e,n){e=(n?ui(t,e,n):void 0===e)?1:sn(ra(e),0);var o=null==t?0:t.length;if(!o||e<1)return[];for(var i=0,s=0,a=r(Ze(o/e));i<o;)a[s++]=Hr(t,i,i+=e);return a},Cn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,o=[];++e<n;){var i=t[e];i&&(o[r++]=i)}return o},Cn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return pe(Ms(n)?mo(n):[n],ir(e,1))},Cn.cond=function(t){var e=null==t?0:t.length,n=Qo();return t=e?he(t,(function(t){if("function"!=typeof t[1])throw new mt(i);return[n(t[0]),t[1]]})):[],Ur((function(n){for(var r=-1;++r<e;){var o=t[r];if(ie(o[0],this,n))return ie(o[1],this,n)}}))},Cn.conforms=function(t){return function(t){var e=ba(t);return function(n){return Qn(n,t,e)}}(Xn(t,1))},Cn.constant=Va,Cn.countBy=os,Cn.create=function(t,e){var n=Rn(t);return null==e?n:Wn(n,e)},Cn.curry=function t(e,n,r){var o=Fo(e,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return o.placeholder=t.placeholder,o},Cn.curryRight=function t(e,n,r){var o=Fo(e,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return o.placeholder=t.placeholder,o},Cn.debounce=bs,Cn.defaults=ha,Cn.defaultsDeep=pa,Cn.defer=ws,Cn.delay=Is,Cn.difference=Ri,Cn.differenceBy=Pi,Cn.differenceWith=ji,Cn.drop=function(t,e,n){var r=null==t?0:t.length;return r?Hr(t,(e=n||void 0===e?1:ra(e))<0?0:e,r):[]},Cn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?Hr(t,0,(e=r-(e=n||void 0===e?1:ra(e)))<0?0:e):[]},Cn.dropRightWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3),!0,!0):[]},Cn.dropWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3),!0):[]},Cn.fill=function(t,e,n,r){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&ui(t,e,n)&&(n=0,r=o),function(t,e,n,r){var o=t.length;for((n=ra(n))<0&&(n=-n>o?0:o+n),(r=void 0===r||r>o?o:ra(r))<0&&(r+=o),r=n>r?0:oa(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Cn.filter=function(t,e){return(Ms(t)?le:or)(t,Qo(e,3))},Cn.flatMap=function(t,e){return ir(fs(t,e),1)},Cn.flatMapDeep=function(t,e){return ir(fs(t,e),1/0)},Cn.flatMapDepth=function(t,e,n){return n=void 0===n?1:ra(n),ir(fs(t,e),n)},Cn.flatten=ki,Cn.flattenDeep=function(t){return(null==t?0:t.length)?ir(t,1/0):[]},Cn.flattenDepth=function(t,e){return(null==t?0:t.length)?ir(t,e=void 0===e?1:ra(e)):[]},Cn.flip=function(t){return Fo(t,512)},Cn.flow=Ga,Cn.flowRight=Ha,Cn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var o=t[e];r[o[0]]=o[1]}return r},Cn.functions=function(t){return null==t?[]:lr(t,ba(t))},Cn.functionsIn=function(t){return null==t?[]:lr(t,wa(t))},Cn.groupBy=cs,Cn.initial=function(t){return(null==t?0:t.length)?Hr(t,0,-1):[]},Cn.intersection=zi,Cn.intersectionBy=Di,Cn.intersectionWith=Ui,Cn.invert=ga,Cn.invertBy=ma,Cn.invokeMap=ls,Cn.iteratee=Ya,Cn.keyBy=ds,Cn.keys=ba,Cn.keysIn=wa,Cn.map=fs,Cn.mapKeys=function(t,e){var n={};return e=Qo(e,3),ur(t,(function(t,r,o){Yn(n,e(t,r,o),t)})),n},Cn.mapValues=function(t,e){var n={};return e=Qo(e,3),ur(t,(function(t,r,o){Yn(n,r,e(t,r,o))})),n},Cn.matches=function(t){return Cr(Xn(t,1))},Cn.matchesProperty=function(t,e){return Rr(t,Xn(e,1))},Cn.memoize=Os,Cn.merge=Ia,Cn.mergeWith=Oa,Cn.method=Ka,Cn.methodOf=$a,Cn.mixin=Xa,Cn.negate=Es,Cn.nthArg=function(t){return t=ra(t),Ur((function(e){return jr(e,t)}))},Cn.omit=Ea,Cn.omitBy=function(t,e){return Sa(t,Es(Qo(e)))},Cn.once=function(t){return gs(2,t)},Cn.orderBy=function(t,e,n,r){return null==t?[]:(Ms(e)||(e=null==e?[]:[e]),Ms(n=r?void 0:n)||(n=null==n?[]:[n]),xr(t,e,n))},Cn.over=Za,Cn.overArgs=Ts,Cn.overEvery=Ja,Cn.overSome=tu,Cn.partial=Ss,Cn.partialRight=As,Cn.partition=hs,Cn.pick=Ta,Cn.pickBy=Sa,Cn.property=eu,Cn.propertyOf=function(t){return function(e){return null==t?void 0:dr(t,e)}},Cn.pull=Fi,Cn.pullAll=Bi,Cn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?kr(t,e,Qo(n,2)):t},Cn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?kr(t,e,void 0,n):t},Cn.pullAt=qi,Cn.range=nu,Cn.rangeRight=ru,Cn.rearg=Cs,Cn.reject=function(t,e){return(Ms(t)?le:or)(t,Es(Qo(e,3)))},Cn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,o=[],i=t.length;for(e=Qo(e,3);++r<i;){var s=t[r];e(s,r,t)&&(n.push(s),o.push(r))}return Nr(t,o),n},Cn.rest=function(t,e){if("function"!=typeof t)throw new mt(i);return Ur(t,e=void 0===e?e:ra(e))},Cn.reverse=Vi,Cn.sampleSize=function(t,e,n){return e=(n?ui(t,e,n):void 0===e)?1:ra(e),(Ms(t)?Fn:Fr)(t,e)},Cn.set=function(t,e,n){return null==t?t:Br(t,e,n)},Cn.setWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:Br(t,e,n,r)},Cn.shuffle=function(t){return(Ms(t)?Bn:Gr)(t)},Cn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&ui(t,e,n)?(e=0,n=r):(e=null==e?0:ra(e),n=void 0===n?r:ra(n)),Hr(t,e,n)):[]},Cn.sortBy=ps,Cn.sortedUniq=function(t){return t&&t.length?$r(t):[]},Cn.sortedUniqBy=function(t,e){return t&&t.length?$r(t,Qo(e,2)):[]},Cn.split=function(t,e,n){return n&&"number"!=typeof n&&ui(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=aa(t))&&("string"==typeof e||null!=e&&!Ks(e))&&!(e=Qr(e))&&Le(t)?co(We(t),0,n):t.split(e,n):[]},Cn.spread=function(t,e){if("function"!=typeof t)throw new mt(i);return e=null==e?0:sn(ra(e),0),Ur((function(n){var r=n[e],o=co(n,0,e);return r&&pe(o,r),ie(t,this,o)}))},Cn.tail=function(t){var e=null==t?0:t.length;return e?Hr(t,1,e):[]},Cn.take=function(t,e,n){return t&&t.length?Hr(t,0,(e=n||void 0===e?1:ra(e))<0?0:e):[]},Cn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?Hr(t,(e=r-(e=n||void 0===e?1:ra(e)))<0?0:e,r):[]},Cn.takeRightWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3),!1,!0):[]},Cn.takeWhile=function(t,e){return t&&t.length?eo(t,Qo(e,3)):[]},Cn.tap=function(t,e){return e(t),t},Cn.throttle=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new mt(i);return Vs(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),bs(t,e,{leading:r,maxWait:e,trailing:o})},Cn.thru=ns,Cn.toArray=ea,Cn.toPairs=Aa,Cn.toPairsIn=Ca,Cn.toPath=function(t){return Ms(t)?he(t,Si):Qs(t)?[t]:mo(Ti(aa(t)))},Cn.toPlainObject=sa,Cn.transform=function(t,e,n){var r=Ms(t),o=r||Ds(t)||Zs(t);if(e=Qo(e,4),null==n){var i=t&&t.constructor;n=o?r?new i:[]:Vs(t)&&Fs(i)?Rn(Ht(t)):{}}return(o?ae:ur)(t,(function(t,r,o){return e(n,t,r,o)})),n},Cn.unary=function(t){return ys(t,1)},Cn.union=Gi,Cn.unionBy=Hi,Cn.unionWith=Wi,Cn.uniq=function(t){return t&&t.length?Zr(t):[]},Cn.uniqBy=function(t,e){return t&&t.length?Zr(t,Qo(e,2)):[]},Cn.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Zr(t,void 0,e):[]},Cn.unset=function(t,e){return null==t||Jr(t,e)},Cn.unzip=Yi,Cn.unzipWith=Ki,Cn.update=function(t,e,n){return null==t?t:to(t,e,so(n))},Cn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:to(t,e,so(n),r)},Cn.values=Ra,Cn.valuesIn=function(t){return null==t?[]:je(t,wa(t))},Cn.without=$i,Cn.words=Fa,Cn.wrap=function(t,e){return Ss(so(e),t)},Cn.xor=Xi,Cn.xorBy=Qi,Cn.xorWith=Zi,Cn.zip=Ji,Cn.zipObject=function(t,e){return oo(t||[],e||[],Vn)},Cn.zipObjectDeep=function(t,e){return oo(t||[],e||[],Br)},Cn.zipWith=ts,Cn.entries=Aa,Cn.entriesIn=Ca,Cn.extend=ca,Cn.extendWith=la,Xa(Cn,Cn),Cn.add=su,Cn.attempt=Ba,Cn.camelCase=Pa,Cn.capitalize=ja,Cn.ceil=au,Cn.clamp=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=ia(n))==n?n:0),void 0!==e&&(e=(e=ia(e))==e?e:0),$n(ia(t),e,n)},Cn.clone=function(t){return Xn(t,4)},Cn.cloneDeep=function(t){return Xn(t,5)},Cn.cloneDeepWith=function(t,e){return Xn(t,5,e="function"==typeof e?e:void 0)},Cn.cloneWith=function(t,e){return Xn(t,4,e="function"==typeof e?e:void 0)},Cn.conformsTo=function(t,e){return null==e||Qn(t,e,ba(e))},Cn.deburr=xa,Cn.defaultTo=function(t,e){return null==t||t!=t?e:t},Cn.divide=uu,Cn.endsWith=function(t,e,n){t=aa(t),e=Qr(e);var r=t.length,o=n=void 0===n?r:$n(ra(n),0,r);return(n-=e.length)>=0&&t.slice(n,o)==e},Cn.eq=Rs,Cn.escape=function(t){return(t=aa(t))&&L.test(t)?t.replace(D,De):t},Cn.escapeRegExp=function(t){return(t=aa(t))&&Y.test(t)?t.replace(W,"\\$&"):t},Cn.every=function(t,e,n){var r=Ms(t)?ce:nr;return n&&ui(t,e,n)&&(e=void 0),r(t,Qo(e,3))},Cn.find=is,Cn.findIndex=xi,Cn.findKey=function(t,e){return _e(t,Qo(e,3),ur)},Cn.findLast=ss,Cn.findLastIndex=Mi,Cn.findLastKey=function(t,e){return _e(t,Qo(e,3),cr)},Cn.floor=cu,Cn.forEach=as,Cn.forEachRight=us,Cn.forIn=function(t,e){return null==t?t:sr(t,Qo(e,3),wa)},Cn.forInRight=function(t,e){return null==t?t:ar(t,Qo(e,3),wa)},Cn.forOwn=function(t,e){return t&&ur(t,Qo(e,3))},Cn.forOwnRight=function(t,e){return t&&cr(t,Qo(e,3))},Cn.get=va,Cn.gt=Ps,Cn.gte=js,Cn.has=function(t,e){return null!=t&&oi(t,e,vr)},Cn.hasIn=ya,Cn.head=Ni,Cn.identity=Wa,Cn.includes=function(t,e,n,r){t=Ns(t)?t:Ra(t),n=n&&!r?ra(n):0;var o=t.length;return n<0&&(n=sn(o+n,0)),Xs(t)?n<=o&&t.indexOf(e,n)>-1:!!o&&we(t,e,n)>-1},Cn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ra(n);return o<0&&(o=sn(r+o,0)),we(t,e,o)},Cn.inRange=function(t,e,n){return e=na(e),void 0===n?(n=e,e=0):n=na(n),function(t,e,n){return t>=an(e,n)&&t<sn(e,n)}(t=ia(t),e,n)},Cn.invoke=_a,Cn.isArguments=xs,Cn.isArray=Ms,Cn.isArrayBuffer=ks,Cn.isArrayLike=Ns,Cn.isArrayLikeObject=zs,Cn.isBoolean=function(t){return!0===t||!1===t||Gs(t)&&hr(t)==l},Cn.isBuffer=Ds,Cn.isDate=Us,Cn.isElement=function(t){return Gs(t)&&1===t.nodeType&&!Ys(t)},Cn.isEmpty=function(t){if(null==t)return!0;if(Ns(t)&&(Ms(t)||"string"==typeof t||"function"==typeof t.splice||Ds(t)||Zs(t)||xs(t)))return!t.length;var e=ri(t);if(e==v||e==_)return!t.size;if(fi(t))return!Er(t).length;for(var n in t)if(Et.call(t,n))return!1;return!0},Cn.isEqual=function(t,e){return br(t,e)},Cn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===r?br(t,e,void 0,n):!!r},Cn.isError=Ls,Cn.isFinite=function(t){return"number"==typeof t&&nn(t)},Cn.isFunction=Fs,Cn.isInteger=Bs,Cn.isLength=qs,Cn.isMap=Hs,Cn.isMatch=function(t,e){return t===e||wr(t,e,Jo(e))},Cn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:void 0,wr(t,e,Jo(e),n)},Cn.isNaN=function(t){return Ws(t)&&t!=+t},Cn.isNative=function(t){if(di(t))throw new ft("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ir(t)},Cn.isNil=function(t){return null==t},Cn.isNull=function(t){return null===t},Cn.isNumber=Ws,Cn.isObject=Vs,Cn.isObjectLike=Gs,Cn.isPlainObject=Ys,Cn.isRegExp=Ks,Cn.isSafeInteger=function(t){return Bs(t)&&t>=-9007199254740991&&t<=9007199254740991},Cn.isSet=$s,Cn.isString=Xs,Cn.isSymbol=Qs,Cn.isTypedArray=Zs,Cn.isUndefined=function(t){return void 0===t},Cn.isWeakMap=function(t){return Gs(t)&&ri(t)==I},Cn.isWeakSet=function(t){return Gs(t)&&"[object WeakSet]"==hr(t)},Cn.join=function(t,e){return null==t?"":rn.call(t,e)},Cn.kebabCase=Ma,Cn.last=Li,Cn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r;return void 0!==n&&(o=(o=ra(n))<0?sn(r+o,0):an(o,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):be(t,Oe,o,!0)},Cn.lowerCase=ka,Cn.lowerFirst=Na,Cn.lt=Js,Cn.lte=ta,Cn.max=function(t){return t&&t.length?rr(t,Wa,pr):void 0},Cn.maxBy=function(t,e){return t&&t.length?rr(t,Qo(e,2),pr):void 0},Cn.mean=function(t){return Ee(t,Wa)},Cn.meanBy=function(t,e){return Ee(t,Qo(e,2))},Cn.min=function(t){return t&&t.length?rr(t,Wa,Sr):void 0},Cn.minBy=function(t,e){return t&&t.length?rr(t,Qo(e,2),Sr):void 0},Cn.stubArray=ou,Cn.stubFalse=iu,Cn.stubObject=function(){return{}},Cn.stubString=function(){return""},Cn.stubTrue=function(){return!0},Cn.multiply=du,Cn.nth=function(t,e){return t&&t.length?jr(t,ra(e)):void 0},Cn.noConflict=function(){return Yt._===this&&(Yt._=Rt),this},Cn.noop=Qa,Cn.now=vs,Cn.pad=function(t,e,n){t=aa(t);var r=(e=ra(e))?He(t):0;if(!e||r>=e)return t;var o=(e-r)/2;return Mo(Je(o),n)+t+Mo(Ze(o),n)},Cn.padEnd=function(t,e,n){t=aa(t);var r=(e=ra(e))?He(t):0;return e&&r<e?t+Mo(e-r,n):t},Cn.padStart=function(t,e,n){t=aa(t);var r=(e=ra(e))?He(t):0;return e&&r<e?Mo(e-r,n)+t:t},Cn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),cn(aa(t).replace($,""),e||0)},Cn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&ui(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=na(t),void 0===e?(e=t,t=0):e=na(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var o=ln();return an(t+o*(e-t+Vt("1e-"+((o+"").length-1))),e)}return zr(t,e)},Cn.reduce=function(t,e,n){var r=Ms(t)?ve:Ae,o=arguments.length<3;return r(t,Qo(e,4),n,o,tr)},Cn.reduceRight=function(t,e,n){var r=Ms(t)?ye:Ae,o=arguments.length<3;return r(t,Qo(e,4),n,o,er)},Cn.repeat=function(t,e,n){return e=(n?ui(t,e,n):void 0===e)?1:ra(e),Dr(aa(t),e)},Cn.replace=function(){var t=arguments,e=aa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Cn.result=function(t,e,n){var r=-1,o=(e=ao(e,t)).length;for(o||(o=1,t=void 0);++r<o;){var i=null==t?void 0:t[Si(e[r])];void 0===i&&(r=o,i=n),t=Fs(i)?i.call(t):i}return t},Cn.round=fu,Cn.runInContext=t,Cn.sample=function(t){return(Ms(t)?Ln:Lr)(t)},Cn.size=function(t){if(null==t)return 0;if(Ns(t))return Xs(t)?He(t):t.length;var e=ri(t);return e==v||e==_?t.size:Er(t).length},Cn.snakeCase=za,Cn.some=function(t,e,n){var r=Ms(t)?ge:Wr;return n&&ui(t,e,n)&&(e=void 0),r(t,Qo(e,3))},Cn.sortedIndex=function(t,e){return Yr(t,e)},Cn.sortedIndexBy=function(t,e,n){return Kr(t,e,Qo(n,2))},Cn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=Yr(t,e);if(r<n&&Rs(t[r],e))return r}return-1},Cn.sortedLastIndex=function(t,e){return Yr(t,e,!0)},Cn.sortedLastIndexBy=function(t,e,n){return Kr(t,e,Qo(n,2),!0)},Cn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=Yr(t,e,!0)-1;if(Rs(t[n],e))return n}return-1},Cn.startCase=Da,Cn.startsWith=function(t,e,n){return t=aa(t),n=null==n?0:$n(ra(n),0,t.length),e=Qr(e),t.slice(n,n+e.length)==e},Cn.subtract=hu,Cn.sum=function(t){return t&&t.length?Ce(t,Wa):0},Cn.sumBy=function(t,e){return t&&t.length?Ce(t,Qo(e,2)):0},Cn.template=function(t,e,n){var r=Cn.templateSettings;n&&ui(t,e,n)&&(e=void 0),t=aa(t),e=la({},e,r,Bo);var o,i,s=la({},e.imports,r.imports,Bo),a=ba(s),u=je(s,a),c=0,l=e.interpolate||lt,d="__p += '",f=yt((e.escape||lt).source+"|"+l.source+"|"+(l===q?nt:lt).source+"|"+(e.evaluate||lt).source+"|$","g"),h="//# sourceURL="+(Et.call(e,"sourceURL")?(e.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++Lt+"]")+"\n";t.replace(f,(function(e,n,r,s,a,u){return r||(r=s),d+=t.slice(c,u).replace(dt,Ue),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(i=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+e.length,e})),d+="';\n";var p=Et.call(e,"variable")&&e.variable;p||(d="with (obj) {\n"+d+"\n}\n"),d=(i?d.replace(M,""):d).replace(k,"$1").replace(N,"$1;"),d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var v=Ba((function(){return ht(a,h+"return "+d).apply(void 0,u)}));if(v.source=d,Ls(v))throw v;return v},Cn.times=function(t,e){if((t=ra(t))<1||t>9007199254740991)return[];var n=4294967295,r=an(t,4294967295);t-=4294967295;for(var o=Re(r,e=Qo(e));++n<t;)e(n);return o},Cn.toFinite=na,Cn.toInteger=ra,Cn.toLength=oa,Cn.toLower=function(t){return aa(t).toLowerCase()},Cn.toNumber=ia,Cn.toSafeInteger=function(t){return t?$n(ra(t),-9007199254740991,9007199254740991):0===t?t:0},Cn.toString=aa,Cn.toUpper=function(t){return aa(t).toUpperCase()},Cn.trim=function(t,e,n){if((t=aa(t))&&(n||void 0===e))return t.replace(K,"");if(!t||!(e=Qr(e)))return t;var r=We(t),o=We(e);return co(r,Me(r,o),ke(r,o)+1).join("")},Cn.trimEnd=function(t,e,n){if((t=aa(t))&&(n||void 0===e))return t.replace(X,"");if(!t||!(e=Qr(e)))return t;var r=We(t);return co(r,0,ke(r,We(e))+1).join("")},Cn.trimStart=function(t,e,n){if((t=aa(t))&&(n||void 0===e))return t.replace($,"");if(!t||!(e=Qr(e)))return t;var r=We(t);return co(r,Me(r,We(e))).join("")},Cn.truncate=function(t,e){var n=30,r="...";if(Vs(e)){var o="separator"in e?e.separator:o;n="length"in e?ra(e.length):n,r="omission"in e?Qr(e.omission):r}var i=(t=aa(t)).length;if(Le(t)){var s=We(t);i=s.length}if(n>=i)return t;var a=n-He(r);if(a<1)return r;var u=s?co(s,0,a).join(""):t.slice(0,a);if(void 0===o)return u+r;if(s&&(a+=u.length-a),Ks(o)){if(t.slice(a).search(o)){var c,l=u;for(o.global||(o=yt(o.source,aa(rt.exec(o))+"g")),o.lastIndex=0;c=o.exec(l);)var d=c.index;u=u.slice(0,void 0===d?a:d)}}else if(t.indexOf(Qr(o),a)!=a){var f=u.lastIndexOf(o);f>-1&&(u=u.slice(0,f))}return u+r},Cn.unescape=function(t){return(t=aa(t))&&U.test(t)?t.replace(z,Ye):t},Cn.uniqueId=function(t){var e=++Tt;return aa(t)+e},Cn.upperCase=Ua,Cn.upperFirst=La,Cn.each=as,Cn.eachRight=us,Cn.first=Ni,Xa(Cn,(lu={},ur(Cn,(function(t,e){Et.call(Cn.prototype,e)||(lu[e]=t)})),lu),{chain:!1}),Cn.VERSION="4.17.15",ae(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Cn[t].placeholder=Cn})),ae(["drop","take"],(function(t,e){xn.prototype[t]=function(n){n=void 0===n?1:sn(ra(n),0);var r=this.__filtered__&&!e?new xn(this):this.clone();return r.__filtered__?r.__takeCount__=an(n,r.__takeCount__):r.__views__.push({size:an(n,4294967295),type:t+(r.__dir__<0?"Right":"")}),r},xn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),ae(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;xn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Qo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),ae(["head","last"],(function(t,e){var n="take"+(e?"Right":"");xn.prototype[t]=function(){return this[n](1).value()[0]}})),ae(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");xn.prototype[t]=function(){return this.__filtered__?new xn(this):this[n](1)}})),xn.prototype.compact=function(){return this.filter(Wa)},xn.prototype.find=function(t){return this.filter(t).head()},xn.prototype.findLast=function(t){return this.reverse().find(t)},xn.prototype.invokeMap=Ur((function(t,e){return"function"==typeof t?new xn(this):this.map((function(n){return mr(n,t,e)}))})),xn.prototype.reject=function(t){return this.filter(Es(Qo(t)))},xn.prototype.slice=function(t,e){t=ra(t);var n=this;return n.__filtered__&&(t>0||e<0)?new xn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=ra(e))<0?n.dropRight(-e):n.take(e-t)),n)},xn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},xn.prototype.toArray=function(){return this.take(4294967295)},ur(xn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),o=Cn[r?"take"+("last"==e?"Right":""):e],i=r||/^find/.test(e);o&&(Cn.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,a=e instanceof xn,u=s[0],c=a||Ms(e),l=function(t){var e=o.apply(Cn,pe([t],s));return r&&d?e[0]:e};c&&n&&"function"==typeof u&&1!=u.length&&(a=c=!1);var d=this.__chain__,f=!!this.__actions__.length,h=i&&!d,p=a&&!f;if(!i&&c){e=p?e:new xn(this);var v=t.apply(e,s);return v.__actions__.push({func:ns,args:[l],thisArg:void 0}),new jn(v,d)}return h&&p?t.apply(this,s):(v=this.thru(l),h?r?v.value()[0]:v.value():v)})})),ae(["pop","push","shift","sort","splice","unshift"],(function(t){var e=_t[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Cn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var o=this.value();return e.apply(Ms(o)?o:[],t)}return this[n]((function(n){return e.apply(Ms(n)?n:[],t)}))}})),ur(xn.prototype,(function(t,e){var n=Cn[e];if(n){var r=n.name+"";Et.call(_n,r)||(_n[r]=[]),_n[r].push({name:e,func:n})}})),_n[Ro(void 0,2).name]=[{name:"wrapper",func:void 0}],xn.prototype.clone=function(){var t=new xn(this.__wrapped__);return t.__actions__=mo(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=mo(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=mo(this.__views__),t},xn.prototype.reverse=function(){if(this.__filtered__){var t=new xn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},xn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ms(t),r=e<0,o=n?t.length:0,i=function(t,e,n){var r=-1,o=n.length;for(;++r<o;){var i=n[r],s=i.size;switch(i.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=an(e,t+s);break;case"takeRight":t=sn(t,e-s)}}return{start:t,end:e}}(0,o,this.__views__),s=i.start,a=i.end,u=a-s,c=r?a:s-1,l=this.__iteratees__,d=l.length,f=0,h=an(u,this.__takeCount__);if(!n||!r&&o==u&&h==u)return no(t,this.__actions__);var p=[];t:for(;u--&&f<h;){for(var v=-1,y=t[c+=e];++v<d;){var g=l[v],m=g.iteratee,_=g.type,b=m(y);if(2==_)y=b;else if(!b){if(1==_)continue t;break t}}p[f++]=y}return p},Cn.prototype.at=rs,Cn.prototype.chain=function(){return es(this)},Cn.prototype.commit=function(){return new jn(this.value(),this.__chain__)},Cn.prototype.next=function(){void 0===this.__values__&&(this.__values__=ea(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},Cn.prototype.plant=function(t){for(var e,n=this;n instanceof Pn;){var r=Ci(n);r.__index__=0,r.__values__=void 0,e?o.__wrapped__=r:e=r;var o=r;n=n.__wrapped__}return o.__wrapped__=t,e},Cn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof xn){var e=t;return this.__actions__.length&&(e=new xn(this)),(e=e.reverse()).__actions__.push({func:ns,args:[Vi],thisArg:void 0}),new jn(e,this.__chain__)}return this.thru(Vi)},Cn.prototype.toJSON=Cn.prototype.valueOf=Cn.prototype.value=function(){return no(this.__wrapped__,this.__actions__)},Cn.prototype.first=Cn.prototype.head,Zt&&(Cn.prototype[Zt]=function(){return this}),Cn}();Yt._=Ke,void 0===(o=function(){return Ke}.call(e,n,e,r))||(r.exports=o)}).call(this)}).call(this,n(7),n(110)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(358)),o=a(n(367)),i=a(n(394)),s=a(n(401));function a(t){return t&&t.__esModule?t:{default:t}}e.default=d,e.clear=h,e.decorator=p;var u=[],c=[];function l(t){return(0,s.default)(t)}function d(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];e=(0,i.default)({memoize:!1,serializeArguments:l},e);var n={},r={},s=function(){for(var i=arguments.length,s=Array(i),a=0;a<i;a++)s[a]=arguments[a];var u=e.serializeArguments(s),c=n[u];if(c)return c;if(e.memoize&&u in r)return o.default.resolve(r[u]);var l=function(){return delete n[u]},d=t.apply(this,s),f=d.then((function(t){return e.memoize&&(r[u]=t),l(),t}),(function(t){throw l(),t}));return n[u]=f,f};return s.__reusePromise__origFn=t,s.__reusePromise__clear=function(){d.clear(s)},s.__reusePromise__promiseMapsByArgs=n,s.__reusePromise__memoizedValuesByArgs=r,u.push(n),c.push(r),s}function f(t){(0,r.default)(t).forEach((function(e){return delete t[e]}))}function h(){var t=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];void 0===t?(u.forEach(f),c.forEach(f)):(f(t.__reusePromise__promiseMapsByArgs),f(t.__reusePromise__memoizedValuesByArgs))}function p(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(e,n,r){return r.value=d(r.value,t),r}}p.clear=h,d.clear=h},function(t,e,n){"use strict";n.d(e,"a",(function(){return r.a})),n.d(e,"f",(function(){return o})),n.d(e,"g",(function(){return i})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return a})),n.d(e,"j",(function(){return u})),n.d(e,"k",(function(){return c.a})),n.d(e,"l",(function(){return l.a})),n.d(e,"m",(function(){return d})),n.d(e,"n",(function(){return f})),n.d(e,"o",(function(){return h})),n.d(e,"b",(function(){return m})),n.d(e,"c",(function(){return I})),n.d(e,"e",(function(){return O})),n.d(e,"d",(function(){return E}));var r=n(5),o=n(86),i=n(32),s=n(13),a=n(28);function u(t){for(var e=0,n=[],r=0,o=t;r<o.length;r++){var i=o[r],s=i[0],a=i[1];if(n.push("const a"+e+" = a['"+s+"']"),n.push("const b"+e+" = b['"+s+"']"),"asc"===a)n.push("if (a"+e+" === undefined && b"+e+" !== undefined) return -1"),n.push("if (a"+e+" !== undefined && b"+e+" === undefined) return 1"),n.push("if (a"+e+" === null && b"+e+" !== null) return -1"),n.push("if (a"+e+" !== null && b"+e+" === null) return 1"),n.push("if (a"+e+" < b"+e+") return -1"),n.push("if (a"+e+" > b"+e+") return 1");else{if("desc"!==a)throw new Error("unsupported sort ordering for field "+s+": "+a);n.push("if (a"+e+" === undefined && b"+e+" !== undefined) return 1"),n.push("if (a"+e+" !== undefined && b"+e+" === undefined) return -1"),n.push("if (a"+e+" === null && b"+e+" !== null) return 1"),n.push("if (a"+e+" !== null && b"+e+" === null) return -1"),n.push("if (a"+e+" < b"+e+") return 1"),n.push("if (a"+e+" > b"+e+") return -1")}e++}return n.push("return 0"),new Function("a","b",n.join("\n"))}var c=n(87),l=n(88),d=n(6);function f(t,e,n){!(n in t)&&e in t&&(t[n]=t[e],delete t[e])}function h(t,e){for(var n=0,r=Object.entries(e);n<r.length;n++){var o=r[n],i=o[0],s=o[1];!(s in t)&&i in t&&(t[s]=t[i],delete t[i])}return t}var p=n(93),v=n.n(p),y=Object.prototype.hasOwnProperty,g=Symbol("NOT_PROVIDED"),m=function(){function t(t){this.cmp=t}return t.prototype.add=function(t,e){var n=v.a.gt(t,e,this.cmp);-1!==n?t.splice(n,0,e):t.push(e)},t.prototype.indexOf=function(t,e,n){var r=n&&y.call(n,"previousValue")?n.previousValue:g,o=t.length;if(r===g||0===this.cmp(e,r)){if(-1!==(i=-1===(i=v.a.gt(t,e,this.cmp))?o-1:i-1)){for(;i>0&&0===this.cmp(t[i-1],e);)i--;for(;i<o&&0===this.cmp(t[i],e);){if(t[i]===e)return i;i++}}}else for(var i=0;i<o;){if(t[i]===e)return i;i++}return-1},t.prototype.remove=function(t,e,n){var r=this.indexOf(t,e,n);return-1!==r&&(t.splice(r,1),!0)},t.prototype.removeAll=function(t,e,n){var r=n&&y.call(n,"previousValue")?n.previousValue:g,o=this.indexOf(t,e,n),i=!1;if(-1!==o)for(var s=r===g||0===this.cmp(e,r);o<t.length&&(!s||0===this.cmp(t[o],e));)t[o]===e?(t.splice(o,1),i=!0):o++;return i},t.prototype.update=function(t,e,n){var r=n&&y.call(n,"previousValue")?n.previousValue:g,o=r===g||0===this.cmp(e,r),i=this.indexOf(t,e,n);if(-1!==i){if(o)return!1;t.splice(i,1)}return-1!==(i=v.a.gt(t,e,this.cmp))?t.splice(i,0,e):t.push(e),!0},t}();_=encodeURIComponent;var _,b=n(85),w={isNotEmpty:function(t,e){return!!e},notEmpty:function(t,e,n){w.isNotEmpty(t,e)||(n||(n="expected "+t+" to be provided"),w.raise(t,void 0,n))},isOneOf:function(t,e,n){return n.includes(e)},oneOf:function(t,e,n,r){w.isOneOf(t,e,n)||(r||(r="expected "+e+" to be one of ("+n.join(", ")+")"),w.raise(t,void 0,r))},raise:function(t,e,n){throw void 0===e&&(e="invalid"),new b.a(t,e,n)}},I=w;function O(){return E(this)}function E(t){return Array.isArray(t)?t:null!=t?[t]:[]}},function(t,e,n){"use strict";var r=n(2),o=n.n(r),i={camelizeKey:o.a.memoize(o.a.camelCase),underscoreKey:o.a.memoize(o.a.snakeCase),camelizeObject:function(t){return s(t,i.camelizeKey)},underscoreObject:function(t){return s(t,i.underscoreKey)}};function s(t,e){return o.a.isArray(t)?t.map((function(t){return s(t,e)})):o.a.isObject(t)?o.a.transform(t,(function(t,n,r){t[e(r)]=s(n,e)}),{}):t}e.a=i},function(t,e,n){"use strict";function r(t){return t&&/^\+?([0-9]{7,15})$/.test(t.replace(/[-.● ()]/g,""))}function o(t){var e=t.replace(/\D/g,"");return/^\+?1/.test(t)?e.replace(/^(1)(\d{3})(\d{3})(\d{4})/,"+$1 $2 $3 $4"):("1"===e[0]&&(e=e.slice(1)),e.replace(/^(\d{3})(\d{3})(\d{4})/,"$1 $2 $3"))}function i(t){var e=t.replace(/\D/g,"");return"1"===e[0]&&(e=e.slice(1)),e.replace(/^(\d{3})(\d{3})(\d{4})/,"$1-$2-$3")}function s(t){return t.replace(/\D/g,"")}function a(t){var e=t.replace(/\D/g,"");return"1"!==e[0]&&(e="1"+e),"+"+e}n.r(e),n.d(e,"isPhone",(function(){return r})),n.d(e,"formatPhone",(function(){return o})),n.d(e,"formatPhoneWithDash",(function(){return i})),n.d(e,"normalizePhone",(function(){return s})),n.d(e,"normalizePhoneUS",(function(){return a}))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.a={WAITING:-1,CONNECTING:0,OPEN:1,CLOSED:2}},function(t,e,n){var r=n(34),o=n(17),i=n(146),s=n(31).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});o(e,t)||s(e,t,{value:i.f(t)})}},function(t,e,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(n,r){function o(){void 0!==i&&t.removeListener("error",i),n([].slice.call(arguments))}var i;"error"!==e&&(i=function(n){t.removeListener(e,o),r(n)},t.once("error",i)),t.once(e,o)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function d(t,e,n,r){var o,i,s,a;if(c(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"==typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=l(t))>0&&s.length>o&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,a=u,console&&console.warn&&console.warn(a)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=f.bind(r);return o.listener=n,r.wrapFn=o,o}function p(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):y(o,o.length)}function v(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=o[t];if(void 0===u)return!1;if("function"==typeof u)i(u,this,e);else{var c=u.length,l=y(u,c);for(n=0;n<c;++n)i(l[n],this,e)}return!0},a.prototype.addListener=function(t,e){return d(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return d(this,t,e,!0)},a.prototype.once=function(t,e){return c(e),this.on(t,h(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,h(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,o,i,s;if(c(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return p(this,t,!0)},a.prototype.rawListeners=function(t){return p(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},a.prototype.listenerCount=v,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){"use strict";var r=n(445);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){var r=n(14),o=n(50),i=n(99),s=n(139),a=r.Symbol,u=o("wks");t.exports=function(t){return u[t]||(u[t]=s&&a[t]||(s?a:i)("Symbol."+t))}},function(t,e,n){"use strict";n.r(e);var r=n(162),o=n.n(r);n.d(e,"isEmail",(function(){return o.a}))},function(t,e,n){(function(e){var n="object",r=function(t){return t&&t.Math==Math&&t};t.exports=r(typeof globalThis==n&&globalThis)||r(typeof window==n&&window)||r(typeof self==n&&self)||r(typeof e==n&&e)||Function("return this")()}).call(this,n(7))},function(t,e,n){var r=n(14),o=n(95).f,i=n(30),s=n(68),a=n(97),u=n(133),c=n(222);t.exports=function(t,e){var n,l,d,f,h,p=t.target,v=t.global,y=t.stat;if(n=v?r:y?r[p]||a(p,{}):(r[p]||{}).prototype)for(l in e){if(f=e[l],d=t.noTargetGet?(h=o(n,l))&&h.value:n[l],!c(v?l:p+(y?".":"#")+l,t.forced)&&void 0!==d){if(typeof f==typeof d)continue;u(f,d)}(t.sham||d&&d.sham)&&i(f,"sham",!0),s(n,l,f,t)}}},function(t,e,n){var r=n(322),o=n(323),i=o;i.v1=r,i.v4=o,t.exports=i},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var r=n(185)("wks"),o=n(186),i=n(19).Symbol,s="function"==typeof i;(t.exports=function(t){return r[t]||(r[t]=s&&i[t]||(s?i:o)("Symbol."+t))}).store=r},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(t,e,n){(function(t){t.exports=function(){"use strict";var e,n;function r(){return e.apply(null,arguments)}function o(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function i(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function s(t){return void 0===t}function a(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function u(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function c(t,e){var n,r=[];for(n=0;n<t.length;++n)r.push(e(t[n],n));return r}function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function d(t,e){for(var n in e)l(e,n)&&(t[n]=e[n]);return l(e,"toString")&&(t.toString=e.toString),l(e,"valueOf")&&(t.valueOf=e.valueOf),t}function f(t,e,n,r){return Oe(t,e,n,r,!0).utc()}function h(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function p(t){if(null==t._isValid){var e=h(t),r=n.call(e.parsedDateParts,(function(t){return null!=t})),o=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(o=o&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return o;t._isValid=o}return t._isValid}function v(t){var e=f(NaN);return null!=t?d(h(e),t):h(e).userInvalidated=!0,e}n=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),n=e.length>>>0,r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};var y=r.momentProperties=[];function g(t,e){var n,r,o;if(s(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),s(e._i)||(t._i=e._i),s(e._f)||(t._f=e._f),s(e._l)||(t._l=e._l),s(e._strict)||(t._strict=e._strict),s(e._tzm)||(t._tzm=e._tzm),s(e._isUTC)||(t._isUTC=e._isUTC),s(e._offset)||(t._offset=e._offset),s(e._pf)||(t._pf=h(e)),s(e._locale)||(t._locale=e._locale),y.length>0)for(n=0;n<y.length;n++)s(o=e[r=y[n]])||(t[r]=o);return t}var m=!1;function _(t){g(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===m&&(m=!0,r.updateOffset(this),m=!1)}function b(t){return t instanceof _||null!=t&&null!=t._isAMomentObject}function w(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function I(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=w(e)),n}function O(t,e,n){var r,o=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0;for(r=0;r<o;r++)(n&&t[r]!==e[r]||!n&&I(t[r])!==I(e[r]))&&s++;return s+i}function E(t){!1===r.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function T(t,e){var n=!0;return d((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,t),n){for(var o,i=[],s=0;s<arguments.length;s++){if(o="","object"==typeof arguments[s]){for(var a in o+="\n["+s+"] ",arguments[0])o+=a+": "+arguments[0][a]+", ";o=o.slice(0,-2)}else o=arguments[s];i.push(o)}E(t+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),n=!1}return e.apply(this,arguments)}),e)}var S,A={};function C(t,e){null!=r.deprecationHandler&&r.deprecationHandler(t,e),A[t]||(E(e),A[t]=!0)}function R(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function P(t,e){var n,r=d({},t);for(n in e)l(e,n)&&(i(t[n])&&i(e[n])?(r[n]={},d(r[n],t[n]),d(r[n],e[n])):null!=e[n]?r[n]=e[n]:delete r[n]);for(n in t)l(t,n)&&!l(e,n)&&i(t[n])&&(r[n]=d({},r[n]));return r}function j(t){null!=t&&this.set(t)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,S=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)l(t,e)&&n.push(e);return n};var x={};function M(t,e){var n=t.toLowerCase();x[n]=x[n+"s"]=x[e]=t}function k(t){return"string"==typeof t?x[t]||x[t.toLowerCase()]:void 0}function N(t){var e,n,r={};for(n in t)l(t,n)&&(e=k(n))&&(r[e]=t[n]);return r}var z={};function D(t,e){z[t]=e}function U(t,e,n){var r=""+Math.abs(t),o=e-r.length;return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}var L=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,F=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,B={},q={};function V(t,e,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),t&&(q[t]=o),e&&(q[e[0]]=function(){return U(o.apply(this,arguments),e[1],e[2])}),n&&(q[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),t)})}function G(t,e){return t.isValid()?(e=H(e,t.localeData()),B[e]=B[e]||function(t){var e,n,r,o=t.match(L);for(e=0,n=o.length;e<n;e++)q[o[e]]?o[e]=q[o[e]]:o[e]=(r=o[e]).match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"");return function(e){var r,i="";for(r=0;r<n;r++)i+=R(o[r])?o[r].call(e,t):o[r];return i}}(e),B[e](t)):t.localeData().invalidDate()}function H(t,e){var n=5;function r(t){return e.longDateFormat(t)||t}for(F.lastIndex=0;n>=0&&F.test(t);)t=t.replace(F,r),F.lastIndex=0,n-=1;return t}var W=/\d/,Y=/\d\d/,K=/\d{3}/,$=/\d{4}/,X=/[+-]?\d{6}/,Q=/\d\d?/,Z=/\d\d\d\d?/,J=/\d\d\d\d\d\d?/,tt=/\d{1,3}/,et=/\d{1,4}/,nt=/[+-]?\d{1,6}/,rt=/\d+/,ot=/[+-]?\d+/,it=/Z|[+-]\d\d:?\d\d/gi,st=/Z|[+-]\d\d(?::?\d\d)?/gi,at=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ut={};function ct(t,e,n){ut[t]=R(e)?e:function(t,r){return t&&n?n:e}}function lt(t,e){return l(ut,t)?ut[t](e._strict,e._locale):new RegExp(dt(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,n,r,o){return e||n||r||o}))))}function dt(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ft={};function ht(t,e){var n,r=e;for("string"==typeof t&&(t=[t]),a(e)&&(r=function(t,n){n[e]=I(t)}),n=0;n<t.length;n++)ft[t[n]]=r}function pt(t,e){ht(t,(function(t,n,r,o){r._w=r._w||{},e(t,r._w,r,o)}))}function vt(t,e,n){null!=e&&l(ft,t)&&ft[t](e,n._a,n,t)}function yt(t){return gt(t)?366:365}function gt(t){return t%4==0&&t%100!=0||t%400==0}V("Y",0,0,(function(){var t=this.year();return t<=9999?""+t:"+"+t})),V(0,["YY",2],0,(function(){return this.year()%100})),V(0,["YYYY",4],0,"year"),V(0,["YYYYY",5],0,"year"),V(0,["YYYYYY",6,!0],0,"year"),M("year","y"),D("year",1),ct("Y",ot),ct("YY",Q,Y),ct("YYYY",et,$),ct("YYYYY",nt,X),ct("YYYYYY",nt,X),ht(["YYYYY","YYYYYY"],0),ht("YYYY",(function(t,e){e[0]=2===t.length?r.parseTwoDigitYear(t):I(t)})),ht("YY",(function(t,e){e[0]=r.parseTwoDigitYear(t)})),ht("Y",(function(t,e){e[0]=parseInt(t,10)})),r.parseTwoDigitYear=function(t){return I(t)+(I(t)>68?1900:2e3)};var mt,_t=bt("FullYear",!0);function bt(t,e){return function(n){return null!=n?(It(this,t,n),r.updateOffset(this,e),this):wt(this,t)}}function wt(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function It(t,e,n){t.isValid()&&!isNaN(n)&&("FullYear"===e&&gt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Ot(n,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function Ot(t,e){if(isNaN(t)||isNaN(e))return NaN;var n,r=(e%(n=12)+n)%n;return t+=(e-r)/12,1===r?gt(t)?29:28:31-r%7%2}mt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},V("M",["MM",2],"Mo",(function(){return this.month()+1})),V("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),V("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),M("month","M"),D("month",8),ct("M",Q),ct("MM",Q,Y),ct("MMM",(function(t,e){return e.monthsShortRegex(t)})),ct("MMMM",(function(t,e){return e.monthsRegex(t)})),ht(["M","MM"],(function(t,e){e[1]=I(t)-1})),ht(["MMM","MMMM"],(function(t,e,n,r){var o=n._locale.monthsParse(t,r,n._strict);null!=o?e[1]=o:h(n).invalidMonth=t}));var Et=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Tt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),St="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function At(t,e,n){var r,o,i,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=f([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(o=mt.call(this._shortMonthsParse,s))?o:null:-1!==(o=mt.call(this._longMonthsParse,s))?o:null:"MMM"===e?-1!==(o=mt.call(this._shortMonthsParse,s))||-1!==(o=mt.call(this._longMonthsParse,s))?o:null:-1!==(o=mt.call(this._longMonthsParse,s))||-1!==(o=mt.call(this._shortMonthsParse,s))?o:null}function Ct(t,e){var n;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=I(e);else if(!a(e=t.localeData().monthsParse(e)))return t;return n=Math.min(t.date(),Ot(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function Rt(t){return null!=t?(Ct(this,t),r.updateOffset(this,!0),this):wt(this,"Month")}var Pt=at,jt=at;function xt(){function t(t,e){return e.length-t.length}var e,n,r=[],o=[],i=[];for(e=0;e<12;e++)n=f([2e3,e]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),i.push(this.months(n,"")),i.push(this.monthsShort(n,""));for(r.sort(t),o.sort(t),i.sort(t),e=0;e<12;e++)r[e]=dt(r[e]),o[e]=dt(o[e]);for(e=0;e<24;e++)i[e]=dt(i[e]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Mt(t,e,n,r,o,i,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,o,i,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,o,i,s),a}function kt(t){var e;if(t<100&&t>=0){var n=Array.prototype.slice.call(arguments);n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)}else e=new Date(Date.UTC.apply(null,arguments));return e}function Nt(t,e,n){var r=7+e-n;return-(7+kt(t,0,r).getUTCDay()-e)%7+r-1}function zt(t,e,n,r,o){var i,s,a=1+7*(e-1)+(7+n-r)%7+Nt(t,r,o);return a<=0?s=yt(i=t-1)+a:a>yt(t)?(i=t+1,s=a-yt(t)):(i=t,s=a),{year:i,dayOfYear:s}}function Dt(t,e,n){var r,o,i=Nt(t.year(),e,n),s=Math.floor((t.dayOfYear()-i-1)/7)+1;return s<1?r=s+Ut(o=t.year()-1,e,n):s>Ut(t.year(),e,n)?(r=s-Ut(t.year(),e,n),o=t.year()+1):(o=t.year(),r=s),{week:r,year:o}}function Ut(t,e,n){var r=Nt(t,e,n),o=Nt(t+1,e,n);return(yt(t)-r+o)/7}function Lt(t,e){return t.slice(e,7).concat(t.slice(0,e))}V("w",["ww",2],"wo","week"),V("W",["WW",2],"Wo","isoWeek"),M("week","w"),M("isoWeek","W"),D("week",5),D("isoWeek",5),ct("w",Q),ct("ww",Q,Y),ct("W",Q),ct("WW",Q,Y),pt(["w","ww","W","WW"],(function(t,e,n,r){e[r.substr(0,1)]=I(t)})),V("d",0,"do","day"),V("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),V("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),V("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),V("e",0,0,"weekday"),V("E",0,0,"isoWeekday"),M("day","d"),M("weekday","e"),M("isoWeekday","E"),D("day",11),D("weekday",11),D("isoWeekday",11),ct("d",Q),ct("e",Q),ct("E",Q),ct("dd",(function(t,e){return e.weekdaysMinRegex(t)})),ct("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),ct("dddd",(function(t,e){return e.weekdaysRegex(t)})),pt(["dd","ddd","dddd"],(function(t,e,n,r){var o=n._locale.weekdaysParse(t,r,n._strict);null!=o?e.d=o:h(n).invalidWeekday=t})),pt(["d","e","E"],(function(t,e,n,r){e[r]=I(t)}));var Ft="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Bt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),qt="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Vt(t,e,n){var r,o,i,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=f([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(o=mt.call(this._weekdaysParse,s))?o:null:"ddd"===e?-1!==(o=mt.call(this._shortWeekdaysParse,s))?o:null:-1!==(o=mt.call(this._minWeekdaysParse,s))?o:null:"dddd"===e?-1!==(o=mt.call(this._weekdaysParse,s))||-1!==(o=mt.call(this._shortWeekdaysParse,s))||-1!==(o=mt.call(this._minWeekdaysParse,s))?o:null:"ddd"===e?-1!==(o=mt.call(this._shortWeekdaysParse,s))||-1!==(o=mt.call(this._weekdaysParse,s))||-1!==(o=mt.call(this._minWeekdaysParse,s))?o:null:-1!==(o=mt.call(this._minWeekdaysParse,s))||-1!==(o=mt.call(this._weekdaysParse,s))||-1!==(o=mt.call(this._shortWeekdaysParse,s))?o:null}var Gt=at,Ht=at,Wt=at;function Yt(){function t(t,e){return e.length-t.length}var e,n,r,o,i,s=[],a=[],u=[],c=[];for(e=0;e<7;e++)n=f([2e3,1]).day(e),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),i=this.weekdays(n,""),s.push(r),a.push(o),u.push(i),c.push(r),c.push(o),c.push(i);for(s.sort(t),a.sort(t),u.sort(t),c.sort(t),e=0;e<7;e++)a[e]=dt(a[e]),u[e]=dt(u[e]),c[e]=dt(c[e]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Kt(){return this.hours()%12||12}function $t(t,e){V(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function Xt(t,e){return e._meridiemParse}V("H",["HH",2],0,"hour"),V("h",["hh",2],0,Kt),V("k",["kk",2],0,(function(){return this.hours()||24})),V("hmm",0,0,(function(){return""+Kt.apply(this)+U(this.minutes(),2)})),V("hmmss",0,0,(function(){return""+Kt.apply(this)+U(this.minutes(),2)+U(this.seconds(),2)})),V("Hmm",0,0,(function(){return""+this.hours()+U(this.minutes(),2)})),V("Hmmss",0,0,(function(){return""+this.hours()+U(this.minutes(),2)+U(this.seconds(),2)})),$t("a",!0),$t("A",!1),M("hour","h"),D("hour",13),ct("a",Xt),ct("A",Xt),ct("H",Q),ct("h",Q),ct("k",Q),ct("HH",Q,Y),ct("hh",Q,Y),ct("kk",Q,Y),ct("hmm",Z),ct("hmmss",J),ct("Hmm",Z),ct("Hmmss",J),ht(["H","HH"],3),ht(["k","kk"],(function(t,e,n){var r=I(t);e[3]=24===r?0:r})),ht(["a","A"],(function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t})),ht(["h","hh"],(function(t,e,n){e[3]=I(t),h(n).bigHour=!0})),ht("hmm",(function(t,e,n){var r=t.length-2;e[3]=I(t.substr(0,r)),e[4]=I(t.substr(r)),h(n).bigHour=!0})),ht("hmmss",(function(t,e,n){var r=t.length-4,o=t.length-2;e[3]=I(t.substr(0,r)),e[4]=I(t.substr(r,2)),e[5]=I(t.substr(o)),h(n).bigHour=!0})),ht("Hmm",(function(t,e,n){var r=t.length-2;e[3]=I(t.substr(0,r)),e[4]=I(t.substr(r))})),ht("Hmmss",(function(t,e,n){var r=t.length-4,o=t.length-2;e[3]=I(t.substr(0,r)),e[4]=I(t.substr(r,2)),e[5]=I(t.substr(o))}));var Qt,Zt=bt("Hours",!0),Jt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Tt,monthsShort:St,week:{dow:0,doy:6},weekdays:Ft,weekdaysMin:qt,weekdaysShort:Bt,meridiemParse:/[ap]\.?m?\.?/i},te={},ee={};function ne(t){return t?t.toLowerCase().replace("_","-"):t}function re(e){var n=null;if(!te[e]&&void 0!==t&&t&&t.exports)try{n=Qt._abbr,!function(){var t=new Error("Cannot find module 'undefined'");throw t.code="MODULE_NOT_FOUND",t}(),oe(n)}catch(t){}return te[e]}function oe(t,e){var n;return t&&((n=s(e)?se(t):ie(t,e))?Qt=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Qt._abbr}function ie(t,e){if(null!==e){var n,r=Jt;if(e.abbr=t,null!=te[t])C("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=te[t]._config;else if(null!=e.parentLocale)if(null!=te[e.parentLocale])r=te[e.parentLocale]._config;else{if(null==(n=re(e.parentLocale)))return ee[e.parentLocale]||(ee[e.parentLocale]=[]),ee[e.parentLocale].push({name:t,config:e}),null;r=n._config}return te[t]=new j(P(r,e)),ee[t]&&ee[t].forEach((function(t){ie(t.name,t.config)})),oe(t),te[t]}return delete te[t],null}function se(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Qt;if(!o(t)){if(e=re(t))return e;t=[t]}return function(t){for(var e,n,r,o,i=0;i<t.length;){for(e=(o=ne(t[i]).split("-")).length,n=(n=ne(t[i+1]))?n.split("-"):null;e>0;){if(r=re(o.slice(0,e).join("-")))return r;if(n&&n.length>=e&&O(o,n,!0)>=e-1)break;e--}i++}return Qt}(t)}function ae(t){var e,n=t._a;return n&&-2===h(t).overflow&&(e=n[1]<0||n[1]>11?1:n[2]<1||n[2]>Ot(n[0],n[1])?2:n[3]<0||n[3]>24||24===n[3]&&(0!==n[4]||0!==n[5]||0!==n[6])?3:n[4]<0||n[4]>59?4:n[5]<0||n[5]>59?5:n[6]<0||n[6]>999?6:-1,h(t)._overflowDayOfYear&&(e<0||e>2)&&(e=2),h(t)._overflowWeeks&&-1===e&&(e=7),h(t)._overflowWeekday&&-1===e&&(e=8),h(t).overflow=e),t}function ue(t,e,n){return null!=t?t:null!=e?e:n}function ce(t){var e,n,o,i,s,a=[];if(!t._d){for(o=function(t){var e=new Date(r.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[2]&&null==t._a[1]&&function(t){var e,n,r,o,i,s,a,u;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)i=1,s=4,n=ue(e.GG,t._a[0],Dt(Ee(),1,4).year),r=ue(e.W,1),((o=ue(e.E,1))<1||o>7)&&(u=!0);else{i=t._locale._week.dow,s=t._locale._week.doy;var c=Dt(Ee(),i,s);n=ue(e.gg,t._a[0],c.year),r=ue(e.w,c.week),null!=e.d?((o=e.d)<0||o>6)&&(u=!0):null!=e.e?(o=e.e+i,(e.e<0||e.e>6)&&(u=!0)):o=i}r<1||r>Ut(n,i,s)?h(t)._overflowWeeks=!0:null!=u?h(t)._overflowWeekday=!0:(a=zt(n,r,o,i,s),t._a[0]=a.year,t._dayOfYear=a.dayOfYear)}(t),null!=t._dayOfYear&&(s=ue(t._a[0],o[0]),(t._dayOfYear>yt(s)||0===t._dayOfYear)&&(h(t)._overflowDayOfYear=!0),n=kt(s,0,t._dayOfYear),t._a[1]=n.getUTCMonth(),t._a[2]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=a[e]=o[e];for(;e<7;e++)t._a[e]=a[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[3]&&0===t._a[4]&&0===t._a[5]&&0===t._a[6]&&(t._nextDay=!0,t._a[3]=0),t._d=(t._useUTC?kt:Mt).apply(null,a),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[3]=24),t._w&&void 0!==t._w.d&&t._w.d!==i&&(h(t).weekdayMismatch=!0)}}var le=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,de=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fe=/Z|[+-]\d\d(?::?\d\d)?/,he=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],pe=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ve=/^\/?Date\((\-?\d+)/i;function ye(t){var e,n,r,o,i,s,a=t._i,u=le.exec(a)||de.exec(a);if(u){for(h(t).iso=!0,e=0,n=he.length;e<n;e++)if(he[e][1].exec(u[1])){o=he[e][0],r=!1!==he[e][2];break}if(null==o)return void(t._isValid=!1);if(u[3]){for(e=0,n=pe.length;e<n;e++)if(pe[e][1].exec(u[3])){i=(u[2]||" ")+pe[e][0];break}if(null==i)return void(t._isValid=!1)}if(!r&&null!=i)return void(t._isValid=!1);if(u[4]){if(!fe.exec(u[4]))return void(t._isValid=!1);s="Z"}t._f=o+(i||"")+(s||""),we(t)}else t._isValid=!1}var ge=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function me(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}var _e={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function be(t){var e,n,r,o,i,s,a,u=ge.exec(t._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(u){var c=(e=u[4],n=u[3],r=u[2],o=u[5],i=u[6],s=u[7],a=[me(e),St.indexOf(n),parseInt(r,10),parseInt(o,10),parseInt(i,10)],s&&a.push(parseInt(s,10)),a);if(!function(t,e,n){return!t||Bt.indexOf(t)===new Date(e[0],e[1],e[2]).getDay()||(h(n).weekdayMismatch=!0,n._isValid=!1,!1)}(u[1],c,t))return;t._a=c,t._tzm=function(t,e,n){if(t)return _e[t];if(e)return 0;var r=parseInt(n,10),o=r%100;return(r-o)/100*60+o}(u[8],u[9],u[10]),t._d=kt.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),h(t).rfc2822=!0}else t._isValid=!1}function we(t){if(t._f!==r.ISO_8601)if(t._f!==r.RFC_2822){t._a=[],h(t).empty=!0;var e,n,o,i,s,a=""+t._i,u=a.length,c=0;for(o=H(t._f,t._locale).match(L)||[],e=0;e<o.length;e++)i=o[e],(n=(a.match(lt(i,t))||[])[0])&&((s=a.substr(0,a.indexOf(n))).length>0&&h(t).unusedInput.push(s),a=a.slice(a.indexOf(n)+n.length),c+=n.length),q[i]?(n?h(t).empty=!1:h(t).unusedTokens.push(i),vt(i,n,t)):t._strict&&!n&&h(t).unusedTokens.push(i);h(t).charsLeftOver=u-c,a.length>0&&h(t).unusedInput.push(a),t._a[3]<=12&&!0===h(t).bigHour&&t._a[3]>0&&(h(t).bigHour=void 0),h(t).parsedDateParts=t._a.slice(0),h(t).meridiem=t._meridiem,t._a[3]=function(t,e,n){var r;return null==n?e:null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?((r=t.isPM(n))&&e<12&&(e+=12),r||12!==e||(e=0),e):e}(t._locale,t._a[3],t._meridiem),ce(t),ae(t)}else be(t);else ye(t)}function Ie(t){var e=t._i,n=t._f;return t._locale=t._locale||se(t._l),null===e||void 0===n&&""===e?v({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),b(e)?new _(ae(e)):(u(e)?t._d=e:o(n)?function(t){var e,n,r,o,i;if(0===t._f.length)return h(t).invalidFormat=!0,void(t._d=new Date(NaN));for(o=0;o<t._f.length;o++)i=0,e=g({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[o],we(e),p(e)&&(i+=h(e).charsLeftOver,i+=10*h(e).unusedTokens.length,h(e).score=i,(null==r||i<r)&&(r=i,n=e));d(t,n||e)}(t):n?we(t):function(t){var e=t._i;s(e)?t._d=new Date(r.now()):u(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=ve.exec(t._i);null===e?(ye(t),!1===t._isValid&&(delete t._isValid,be(t),!1===t._isValid&&(delete t._isValid,r.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):o(e)?(t._a=c(e.slice(0),(function(t){return parseInt(t,10)})),ce(t)):i(e)?function(t){if(!t._d){var e=N(t._i);t._a=c([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),ce(t)}}(t):a(e)?t._d=new Date(e):r.createFromInputFallback(t)}(t),p(t)||(t._d=null),t))}function Oe(t,e,n,r,s){var a,u={};return!0!==n&&!1!==n||(r=n,n=void 0),(i(t)&&function(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}(t)||o(t)&&0===t.length)&&(t=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=s,u._l=n,u._i=t,u._f=e,u._strict=r,(a=new _(ae(Ie(u))))._nextDay&&(a.add(1,"d"),a._nextDay=void 0),a}function Ee(t,e,n,r){return Oe(t,e,n,r,!1)}r.createFromInputFallback=T("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var Te=T("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Ee.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:v()})),Se=T("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Ee.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:v()}));function Ae(t,e){var n,r;if(1===e.length&&o(e[0])&&(e=e[0]),!e.length)return Ee();for(n=e[0],r=1;r<e.length;++r)e[r].isValid()&&!e[r][t](n)||(n=e[r]);return n}var Ce=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Re(t){var e=N(t),n=e.year||0,r=e.quarter||0,o=e.month||0,i=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,u=e.minute||0,c=e.second||0,l=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===mt.call(Ce,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var n=!1,r=0;r<Ce.length;++r)if(t[Ce[r]]){if(n)return!1;parseFloat(t[Ce[r]])!==I(t[Ce[r]])&&(n=!0)}return!0}(e),this._milliseconds=+l+1e3*c+6e4*u+1e3*a*60*60,this._days=+s+7*i,this._months=+o+3*r+12*n,this._data={},this._locale=se(),this._bubble()}function Pe(t){return t instanceof Re}function je(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function xe(t,e){V(t,0,0,(function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+U(~~(t/60),2)+e+U(~~t%60,2)}))}xe("Z",":"),xe("ZZ",""),ct("Z",st),ct("ZZ",st),ht(["Z","ZZ"],(function(t,e,n){n._useUTC=!0,n._tzm=ke(st,t)}));var Me=/([\+\-]|\d\d)/gi;function ke(t,e){var n=(e||"").match(t);if(null===n)return null;var r=((n[n.length-1]||[])+"").match(Me)||["-",0,0],o=60*r[1]+I(r[2]);return 0===o?0:"+"===r[0]?o:-o}function Ne(t,e){var n,o;return e._isUTC?(n=e.clone(),o=(b(t)||u(t)?t.valueOf():Ee(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),r.updateOffset(n,!1),n):Ee(t).local()}function ze(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function De(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var Ue=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Le=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Fe(t,e){var n,r,o,i,s,u,c=t,d=null;return Pe(t)?c={ms:t._milliseconds,d:t._days,M:t._months}:a(t)?(c={},e?c[e]=t:c.milliseconds=t):(d=Ue.exec(t))?(n="-"===d[1]?-1:1,c={y:0,d:I(d[2])*n,h:I(d[3])*n,m:I(d[4])*n,s:I(d[5])*n,ms:I(je(1e3*d[6]))*n}):(d=Le.exec(t))?(n="-"===d[1]?-1:1,c={y:Be(d[2],n),M:Be(d[3],n),w:Be(d[4],n),d:Be(d[5],n),h:Be(d[6],n),m:Be(d[7],n),s:Be(d[8],n)}):null==c?c={}:"object"==typeof c&&("from"in c||"to"in c)&&(i=Ee(c.from),s=Ee(c.to),o=i.isValid()&&s.isValid()?(s=Ne(s,i),i.isBefore(s)?u=qe(i,s):((u=qe(s,i)).milliseconds=-u.milliseconds,u.months=-u.months),u):{milliseconds:0,months:0},(c={}).ms=o.milliseconds,c.M=o.months),r=new Re(c),Pe(t)&&l(t,"_locale")&&(r._locale=t._locale),r}function Be(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function qe(t,e){var n={};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Ve(t,e){return function(n,r){var o;return null===r||isNaN(+r)||(C(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),Ge(this,Fe(n="string"==typeof n?+n:n,r),t),this}}function Ge(t,e,n,o){var i=e._milliseconds,s=je(e._days),a=je(e._months);t.isValid()&&(o=null==o||o,a&&Ct(t,wt(t,"Month")+a*n),s&&It(t,"Date",wt(t,"Date")+s*n),i&&t._d.setTime(t._d.valueOf()+i*n),o&&r.updateOffset(t,s||a))}Fe.fn=Re.prototype,Fe.invalid=function(){return Fe(NaN)};var He=Ve(1,"add"),We=Ve(-1,"subtract");function Ye(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(n,"months");return-(n+(e-r<0?(e-r)/(r-t.clone().add(n-1,"months")):(e-r)/(t.clone().add(n+1,"months")-r)))||0}function Ke(t){var e;return void 0===t?this._locale._abbr:(null!=(e=se(t))&&(this._locale=e),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var $e=T("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function Xe(){return this._locale}function Qe(t,e){return(t%e+e)%e}function Ze(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-126227808e5:new Date(t,e,n).valueOf()}function Je(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-126227808e5:Date.UTC(t,e,n)}function tn(t,e){V(0,[t,t.length],0,e)}function en(t,e,n,r,o){var i;return null==t?Dt(this,r,o).year:(e>(i=Ut(t,r,o))&&(e=i),nn.call(this,t,e,n,r,o))}function nn(t,e,n,r,o){var i=zt(t,e,n,r,o),s=kt(i.year,0,i.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}V(0,["gg",2],0,(function(){return this.weekYear()%100})),V(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),tn("gggg","weekYear"),tn("ggggg","weekYear"),tn("GGGG","isoWeekYear"),tn("GGGGG","isoWeekYear"),M("weekYear","gg"),M("isoWeekYear","GG"),D("weekYear",1),D("isoWeekYear",1),ct("G",ot),ct("g",ot),ct("GG",Q,Y),ct("gg",Q,Y),ct("GGGG",et,$),ct("gggg",et,$),ct("GGGGG",nt,X),ct("ggggg",nt,X),pt(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,n,r){e[r.substr(0,2)]=I(t)})),pt(["gg","GG"],(function(t,e,n,o){e[o]=r.parseTwoDigitYear(t)})),V("Q",0,"Qo","quarter"),M("quarter","Q"),D("quarter",7),ct("Q",W),ht("Q",(function(t,e){e[1]=3*(I(t)-1)})),V("D",["DD",2],"Do","date"),M("date","D"),D("date",9),ct("D",Q),ct("DD",Q,Y),ct("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),ht(["D","DD"],2),ht("Do",(function(t,e){e[2]=I(t.match(Q)[0])}));var rn=bt("Date",!0);V("DDD",["DDDD",3],"DDDo","dayOfYear"),M("dayOfYear","DDD"),D("dayOfYear",4),ct("DDD",tt),ct("DDDD",K),ht(["DDD","DDDD"],(function(t,e,n){n._dayOfYear=I(t)})),V("m",["mm",2],0,"minute"),M("minute","m"),D("minute",14),ct("m",Q),ct("mm",Q,Y),ht(["m","mm"],4);var on=bt("Minutes",!1);V("s",["ss",2],0,"second"),M("second","s"),D("second",15),ct("s",Q),ct("ss",Q,Y),ht(["s","ss"],5);var sn,an=bt("Seconds",!1);for(V("S",0,0,(function(){return~~(this.millisecond()/100)})),V(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),V(0,["SSS",3],0,"millisecond"),V(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),V(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),V(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),V(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),V(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),V(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),M("millisecond","ms"),D("millisecond",16),ct("S",tt,W),ct("SS",tt,Y),ct("SSS",tt,K),sn="SSSS";sn.length<=9;sn+="S")ct(sn,rt);function un(t,e){e[6]=I(1e3*("0."+t))}for(sn="S";sn.length<=9;sn+="S")ht(sn,un);var cn=bt("Milliseconds",!1);V("z",0,0,"zoneAbbr"),V("zz",0,0,"zoneName");var ln=_.prototype;function dn(t){return t}ln.add=He,ln.calendar=function(t,e){var n=t||Ee(),o=Ne(n,this).startOf("day"),i=r.calendarFormat(this,o)||"sameElse",s=e&&(R(e[i])?e[i].call(this,n):e[i]);return this.format(s||this.localeData().calendar(i,this,Ee(n)))},ln.clone=function(){return new _(this)},ln.diff=function(t,e,n){var r,o,i;if(!this.isValid())return NaN;if(!(r=Ne(t,this)).isValid())return NaN;switch(o=6e4*(r.utcOffset()-this.utcOffset()),e=k(e)){case"year":i=Ye(this,r)/12;break;case"month":i=Ye(this,r);break;case"quarter":i=Ye(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-o)/864e5;break;case"week":i=(this-r-o)/6048e5;break;default:i=this-r}return n?i:w(i)},ln.endOf=function(t){var e;if(void 0===(t=k(t))||"millisecond"===t||!this.isValid())return this;var n=this._isUTC?Je:Ze;switch(t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=36e5-Qe(e+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":e=this._d.valueOf(),e+=6e4-Qe(e,6e4)-1;break;case"second":e=this._d.valueOf(),e+=1e3-Qe(e,1e3)-1}return this._d.setTime(e),r.updateOffset(this,!0),this},ln.format=function(t){t||(t=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var e=G(this,t);return this.localeData().postformat(e)},ln.from=function(t,e){return this.isValid()&&(b(t)&&t.isValid()||Ee(t).isValid())?Fe({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ln.fromNow=function(t){return this.from(Ee(),t)},ln.to=function(t,e){return this.isValid()&&(b(t)&&t.isValid()||Ee(t).isValid())?Fe({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ln.toNow=function(t){return this.to(Ee(),t)},ln.get=function(t){return R(this[t=k(t)])?this[t]():this},ln.invalidAt=function(){return h(this).overflow},ln.isAfter=function(t,e){var n=b(t)?t:Ee(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=k(e)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},ln.isBefore=function(t,e){var n=b(t)?t:Ee(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=k(e)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},ln.isBetween=function(t,e,n,r){var o=b(t)?t:Ee(t),i=b(e)?e:Ee(e);return!!(this.isValid()&&o.isValid()&&i.isValid())&&("("===(r=r||"()")[0]?this.isAfter(o,n):!this.isBefore(o,n))&&(")"===r[1]?this.isBefore(i,n):!this.isAfter(i,n))},ln.isSame=function(t,e){var n,r=b(t)?t:Ee(t);return!(!this.isValid()||!r.isValid())&&("millisecond"===(e=k(e)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},ln.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},ln.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},ln.isValid=function(){return p(this)},ln.lang=$e,ln.locale=Ke,ln.localeData=Xe,ln.max=Se,ln.min=Te,ln.parsingFlags=function(){return d({},h(this))},ln.set=function(t,e){if("object"==typeof t)for(var n=function(t){var e=[];for(var n in t)e.push({unit:n,priority:z[n]});return e.sort((function(t,e){return t.priority-e.priority})),e}(t=N(t)),r=0;r<n.length;r++)this[n[r].unit](t[n[r].unit]);else if(R(this[t=k(t)]))return this[t](e);return this},ln.startOf=function(t){var e;if(void 0===(t=k(t))||"millisecond"===t||!this.isValid())return this;var n=this._isUTC?Je:Ze;switch(t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Qe(e+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":e=this._d.valueOf(),e-=Qe(e,6e4);break;case"second":e=this._d.valueOf(),e-=Qe(e,1e3)}return this._d.setTime(e),r.updateOffset(this,!0),this},ln.subtract=We,ln.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},ln.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},ln.toDate=function(){return new Date(this.valueOf())},ln.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?G(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):R(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",G(n,"Z")):G(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ln.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=e+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+o)},ln.toJSON=function(){return this.isValid()?this.toISOString():null},ln.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ln.unix=function(){return Math.floor(this.valueOf()/1e3)},ln.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ln.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ln.year=_t,ln.isLeapYear=function(){return gt(this.year())},ln.weekYear=function(t){return en.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ln.isoWeekYear=function(t){return en.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},ln.quarter=ln.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},ln.month=Rt,ln.daysInMonth=function(){return Ot(this.year(),this.month())},ln.week=ln.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},ln.isoWeek=ln.isoWeeks=function(t){var e=Dt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},ln.weeksInYear=function(){var t=this.localeData()._week;return Ut(this.year(),t.dow,t.doy)},ln.isoWeeksInYear=function(){return Ut(this.year(),1,4)},ln.date=rn,ln.day=ln.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},ln.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},ln.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},ln.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},ln.hour=ln.hours=Zt,ln.minute=ln.minutes=on,ln.second=ln.seconds=an,ln.millisecond=ln.milliseconds=cn,ln.utcOffset=function(t,e,n){var o,i=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=ke(st,t)))return this}else Math.abs(t)<16&&!n&&(t*=60);return!this._isUTC&&e&&(o=ze(this)),this._offset=t,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==t&&(!e||this._changeInProgress?Ge(this,Fe(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:ze(this)},ln.utc=function(t){return this.utcOffset(0,t)},ln.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(ze(this),"m")),this},ln.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=ke(it,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},ln.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?Ee(t).utcOffset():0,(this.utcOffset()-t)%60==0)},ln.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ln.isLocal=function(){return!!this.isValid()&&!this._isUTC},ln.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ln.isUtc=De,ln.isUTC=De,ln.zoneAbbr=function(){return this._isUTC?"UTC":""},ln.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ln.dates=T("dates accessor is deprecated. Use date instead.",rn),ln.months=T("months accessor is deprecated. Use month instead",Rt),ln.years=T("years accessor is deprecated. Use year instead",_t),ln.zone=T("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()})),ln.isDSTShifted=T("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!s(this._isDSTShifted))return this._isDSTShifted;var t={};if(g(t,this),(t=Ie(t))._a){var e=t._isUTC?f(t._a):Ee(t._a);this._isDSTShifted=this.isValid()&&O(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}));var fn=j.prototype;function hn(t,e,n,r){var o=se(),i=f().set(r,e);return o[n](i,t)}function pn(t,e,n){if(a(t)&&(e=t,t=void 0),t=t||"",null!=e)return hn(t,e,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=hn(t,r,n,"month");return o}function vn(t,e,n,r){"boolean"==typeof t?(a(e)&&(n=e,e=void 0),e=e||""):(n=e=t,t=!1,a(e)&&(n=e,e=void 0),e=e||"");var o,i=se(),s=t?i._week.dow:0;if(null!=n)return hn(e,(n+s)%7,r,"day");var u=[];for(o=0;o<7;o++)u[o]=hn(e,(o+s)%7,r,"day");return u}fn.calendar=function(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return R(r)?r.call(e,n):r},fn.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,(function(t){return t.slice(1)})),this._longDateFormat[t])},fn.invalidDate=function(){return this._invalidDate},fn.ordinal=function(t){return this._ordinal.replace("%d",t)},fn.preparse=dn,fn.postformat=dn,fn.relativeTime=function(t,e,n,r){var o=this._relativeTime[n];return R(o)?o(t,e,n,r):o.replace(/%d/i,t)},fn.pastFuture=function(t,e){var n=this._relativeTime[t>0?"future":"past"];return R(n)?n(e):n.replace(/%s/i,e)},fn.set=function(t){var e,n;for(n in t)R(e=t[n])?this[n]=e:this["_"+n]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},fn.months=function(t,e){return t?o(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Et).test(e)?"format":"standalone"][t.month()]:o(this._months)?this._months:this._months.standalone},fn.monthsShort=function(t,e){return t?o(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Et.test(e)?"format":"standalone"][t.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},fn.monthsParse=function(t,e,n){var r,o,i;if(this._monthsParseExact)return At.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=f([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[r].test(t))return r;if(n&&"MMM"===e&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}},fn.monthsRegex=function(t){return this._monthsParseExact?(l(this,"_monthsRegex")||xt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=jt),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},fn.monthsShortRegex=function(t){return this._monthsParseExact?(l(this,"_monthsRegex")||xt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=Pt),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},fn.week=function(t){return Dt(t,this._week.dow,this._week.doy).week},fn.firstDayOfYear=function(){return this._week.doy},fn.firstDayOfWeek=function(){return this._week.dow},fn.weekdays=function(t,e){var n=o(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?Lt(n,this._week.dow):t?n[t.day()]:n},fn.weekdaysMin=function(t){return!0===t?Lt(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},fn.weekdaysShort=function(t){return!0===t?Lt(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},fn.weekdaysParse=function(t,e,n){var r,o,i;if(this._weekdaysParseExact)return Vt.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=f([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[r].test(t))return r;if(n&&"ddd"===e&&this._shortWeekdaysParse[r].test(t))return r;if(n&&"dd"===e&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}},fn.weekdaysRegex=function(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Yt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=Gt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},fn.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Yt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ht),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},fn.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Yt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Wt),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},fn.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},fn.meridiem=function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},oe("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===I(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),r.lang=T("moment.lang is deprecated. Use moment.locale instead.",oe),r.langData=T("moment.langData is deprecated. Use moment.localeData instead.",se);var yn=Math.abs;function gn(t,e,n,r){var o=Fe(e,n);return t._milliseconds+=r*o._milliseconds,t._days+=r*o._days,t._months+=r*o._months,t._bubble()}function mn(t){return t<0?Math.floor(t):Math.ceil(t)}function _n(t){return 4800*t/146097}function bn(t){return 146097*t/4800}function wn(t){return function(){return this.as(t)}}var In=wn("ms"),On=wn("s"),En=wn("m"),Tn=wn("h"),Sn=wn("d"),An=wn("w"),Cn=wn("M"),Rn=wn("Q"),Pn=wn("y");function jn(t){return function(){return this.isValid()?this._data[t]:NaN}}var xn=jn("milliseconds"),Mn=jn("seconds"),kn=jn("minutes"),Nn=jn("hours"),zn=jn("days"),Dn=jn("months"),Un=jn("years"),Ln=Math.round,Fn={ss:44,s:45,m:45,h:22,d:26,M:11};function Bn(t,e,n,r,o){return o.relativeTime(e||1,!!n,t,r)}var qn=Math.abs;function Vn(t){return(t>0)-(t<0)||+t}function Gn(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n=qn(this._milliseconds)/1e3,r=qn(this._days),o=qn(this._months);t=w(n/60),e=w(t/60),n%=60,t%=60;var i=w(o/12),s=o%=12,a=r,u=e,c=t,l=n?n.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var f=d<0?"-":"",h=Vn(this._months)!==Vn(d)?"-":"",p=Vn(this._days)!==Vn(d)?"-":"",v=Vn(this._milliseconds)!==Vn(d)?"-":"";return f+"P"+(i?h+i+"Y":"")+(s?h+s+"M":"")+(a?p+a+"D":"")+(u||c||l?"T":"")+(u?v+u+"H":"")+(c?v+c+"M":"")+(l?v+l+"S":"")}var Hn=Re.prototype;return Hn.isValid=function(){return this._isValid},Hn.abs=function(){var t=this._data;return this._milliseconds=yn(this._milliseconds),this._days=yn(this._days),this._months=yn(this._months),t.milliseconds=yn(t.milliseconds),t.seconds=yn(t.seconds),t.minutes=yn(t.minutes),t.hours=yn(t.hours),t.months=yn(t.months),t.years=yn(t.years),this},Hn.add=function(t,e){return gn(this,t,e,1)},Hn.subtract=function(t,e){return gn(this,t,e,-1)},Hn.as=function(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if("month"===(t=k(t))||"quarter"===t||"year"===t)switch(e=this._days+r/864e5,n=this._months+_n(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(bn(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return 24*e+r/36e5;case"minute":return 1440*e+r/6e4;case"second":return 86400*e+r/1e3;case"millisecond":return Math.floor(864e5*e)+r;default:throw new Error("Unknown unit "+t)}},Hn.asMilliseconds=In,Hn.asSeconds=On,Hn.asMinutes=En,Hn.asHours=Tn,Hn.asDays=Sn,Hn.asWeeks=An,Hn.asMonths=Cn,Hn.asQuarters=Rn,Hn.asYears=Pn,Hn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*I(this._months/12):NaN},Hn._bubble=function(){var t,e,n,r,o,i=this._milliseconds,s=this._days,a=this._months,u=this._data;return i>=0&&s>=0&&a>=0||i<=0&&s<=0&&a<=0||(i+=864e5*mn(bn(a)+s),s=0,a=0),u.milliseconds=i%1e3,t=w(i/1e3),u.seconds=t%60,e=w(t/60),u.minutes=e%60,n=w(e/60),u.hours=n%24,s+=w(n/24),o=w(_n(s)),a+=o,s-=mn(bn(o)),r=w(a/12),a%=12,u.days=s,u.months=a,u.years=r,this},Hn.clone=function(){return Fe(this)},Hn.get=function(t){return t=k(t),this.isValid()?this[t+"s"]():NaN},Hn.milliseconds=xn,Hn.seconds=Mn,Hn.minutes=kn,Hn.hours=Nn,Hn.days=zn,Hn.weeks=function(){return w(this.days()/7)},Hn.months=Dn,Hn.years=Un,Hn.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),n=function(t,e,n){var r=Fe(t).abs(),o=Ln(r.as("s")),i=Ln(r.as("m")),s=Ln(r.as("h")),a=Ln(r.as("d")),u=Ln(r.as("M")),c=Ln(r.as("y")),l=o<=Fn.ss&&["s",o]||o<Fn.s&&["ss",o]||i<=1&&["m"]||i<Fn.m&&["mm",i]||s<=1&&["h"]||s<Fn.h&&["hh",s]||a<=1&&["d"]||a<Fn.d&&["dd",a]||u<=1&&["M"]||u<Fn.M&&["MM",u]||c<=1&&["y"]||["yy",c];return l[2]=e,l[3]=+t>0,l[4]=n,Bn.apply(null,l)}(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)},Hn.toISOString=Gn,Hn.toString=Gn,Hn.toJSON=Gn,Hn.locale=Ke,Hn.localeData=Xe,Hn.toIsoString=T("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gn),Hn.lang=$e,V("X",0,0,"unix"),V("x",0,0,"valueOf"),ct("x",ot),ct("X",/[+-]?\d+(\.\d{1,3})?/),ht("X",(function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))})),ht("x",(function(t,e,n){n._d=new Date(I(t))})),r.version="2.24.0",e=Ee,r.fn=ln,r.min=function(){var t=[].slice.call(arguments,0);return Ae("isBefore",t)},r.max=function(){var t=[].slice.call(arguments,0);return Ae("isAfter",t)},r.now=function(){return Date.now?Date.now():+new Date},r.utc=f,r.unix=function(t){return Ee(1e3*t)},r.months=function(t,e){return pn(t,e,"months")},r.isDate=u,r.locale=oe,r.invalid=v,r.duration=Fe,r.isMoment=b,r.weekdays=function(t,e,n){return vn(t,e,n,"weekdays")},r.parseZone=function(){return Ee.apply(null,arguments).parseZone()},r.localeData=se,r.isDuration=Pe,r.monthsShort=function(t,e){return pn(t,e,"monthsShort")},r.weekdaysMin=function(t,e,n){return vn(t,e,n,"weekdaysMin")},r.defineLocale=ie,r.updateLocale=function(t,e){if(null!=e){var n,r,o=Jt;null!=(r=re(t))&&(o=r._config),e=P(o,e),(n=new j(e)).parentLocale=te[t],te[t]=n,oe(t)}else null!=te[t]&&(null!=te[t].parentLocale?te[t]=te[t].parentLocale:null!=te[t]&&delete te[t]);return te[t]},r.locales=function(){return S(te)},r.weekdaysShort=function(t,e,n){return vn(t,e,n,"weekdaysShort")},r.normalizeUnits=k,r.relativeTimeRounding=function(t){return void 0===t?Ln:"function"==typeof t&&(Ln=t,!0)},r.relativeTimeThreshold=function(t,e){return void 0!==Fn[t]&&(void 0===e?Fn[t]:(Fn[t]=e,"s"===t&&(Fn.ss=e-1),!0))},r.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},r.prototype=ln,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()}).call(this,n(110)(t))},function(t,e,n){var r=n(409);t.exports=function(t,e,n){var o=null==t?void 0:r(t,e);return void 0===o?n:o}},function(t,e,n){var r=n(21);t.exports=!r((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){"use strict";function r(t){return o(function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}(t))}function o(t){for(var e=new Uint8Array(t),n="",r=0;r<e.byteLength;r++)n+=String.fromCharCode(e[r]);return n}function i(t){for(var e=window.atob(t),n=e.length,r=new Uint8Array(n),o=0;o<n;o++){var i=e.charCodeAt(o);r[o]=i}return r}n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.r(e),n.d(e,"downloadFile",(function(){return a})),n.d(e,"loadLocalFilePathWithFileReader",(function(){return u})),n.d(e,"saveByteArray",(function(){return c}));var r=n(27),o=n(0),i=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},s=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};function a(t){var e=t.attachmentContentType,a=t.blob,l=t.fileName;return i(this,void 0,void 0,(function(){var t,i,d,f;return s(this,(function(s){switch(s.label){case 0:return(t=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&navigator.userAgent.match("chrome")?[4,u(a)]:[3,2];case 1:return i=s.sent(),d=Object(r.b)(i),c(l,d,e),[3,3];case 2:t?(f=window.URL.createObjectURL(a),window.open(f,"_blank")):(0,n(425).saveAs)(a,l),s.label=3;case 3:return[3,5];case 4:o.TargetNotSupportedError.raise(),s.label=5;case 5:return[2]}}))}))}function u(t){return new Promise((function(e,n){var r=new FileReader;r.addEventListener("load",(function(){e(r.result)}),!1),r.addEventListener("error",(function(t){n(t)}),!1),r.readAsDataURL(t)}))}function c(t,e,n){var r=new FileReader,o=new Blob([e],{type:n});r.fileName=t,r.onload=function(t){window.open(r.result,"_blank")},r.readAsDataURL(o)}},function(t,e,n){"use strict";var r=n(437);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){var r=n(26),o=n(31),i=n(49);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(26),o=n(130),i=n(33),s=n(67),a=Object.defineProperty;e.f=r?a:function(t,e,n){if(i(t),e=s(e,!0),i(n),o)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";n.r(e),n.d(e,"formatDob",(function(){return r})),n.d(e,"secondsToDurationFormat",(function(){return o}));function r(t){if(!t)return t;var e=t.split("T")[0];if(e.includes("-")){var n=e.split("-"),r=n[0];return[n[1],n[2],r].join("/")}if(e.includes("/")){var o=e.split("/");return[o[0],o[1],r=o[2]].join("/")}return t}function o(t){if(!t||!parseInt(t))return"";var e=parseInt(t),n=Math.floor(e/86400),r=e%86400,o=new Date(0);o.setSeconds(r);var i=o.toISOString().substr(11,8).split(":").map((function(t){return parseInt(t)})),s=i[0],a=i[1],u=i[2]+" sec";return(a||s||n)&&(u=a+" min "+u),(s||n)&&(u=s+24*n+" hr "+u),u}},function(t,e,n){var r=n(22);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){t.exports=n(14)},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(302),o=n(303),i=n(150);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),o=(t=a(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|h(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):f(t,e);if("Buffer"===e.type&&i(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(l(e),t=a(t,e<0?0:0|h(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|h(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(t).length;default:if(r)return F(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return C(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,o);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,o){var i,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var l=-1;for(i=n;i<a;i++)if(c(t,i)===c(e,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*s}else-1!==l&&(i-=i-l),l=-1}else for(n+u>a&&(n=a-u),i=n;i>=0;i--){for(var d=!0,f=0;f<u;f++)if(c(t,i+f)!==c(e,f)){d=!1;break}if(d)return i}return-1}function _(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function b(t,e,n,r){return q(F(e,t.length-n),t,n,r)}function w(t,e,n,r){return q(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function I(t,e,n,r){return w(t,e,n,r)}function O(t,e,n,r){return q(B(e),t,n,r)}function E(t,e,n,r){return q(function(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function T(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,s,a,u,c=t[o],l=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(i=t[o+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(u=(15&c)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=d}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return d(null,t)},u.allocUnsafeSlow=function(t){return d(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):v.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,o){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(i,s),c=this.slice(r,o),l=t.slice(e,n),d=0;d<a;++d)if(c[d]!==l[d]){i=c[d],s=l[d];break}return i<s?-1:s<i?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return I(this,t,e,n);case"base64":return O(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function C(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function R(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=L(t[i]);return o}function P(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function j(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function x(t,e,n,r,o,i){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function k(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function N(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(t,e,n,r,i){return i||N(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function D(t,e,n,r,i){return i||N(t,0,n,8),o.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var o=e-t;n=new u(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},u.prototype.readUInt8=function(t,e){return e||j(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||j(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||j(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||j(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||j(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||j(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},u.prototype.readInt8=function(t,e){return e||j(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||j(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||j(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||j(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||j(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||j(t,4,this.length),o.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||j(t,4,this.length),o.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||j(t,8,this.length),o.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||j(t,8,this.length),o.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||x(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||x(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):k(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);x(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);x(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):k(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||x(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return z(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return z(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return D(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=u.isBuffer(t)?t:F(new u(t,r).toString()),a=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function L(t){return t<16?"0"+t.toString(16):t.toString(16)}function F(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function B(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(7))},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&h())}function h(){if(!l){var t=a(f);l=!0;for(var e=c.length;e;){for(u=c,c=[];++d<e;)u&&u[d].run();d=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},function(t,e,n){var r=n(58);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";var r=n(428);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return h}));var r=n(92),o=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},i=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=t.navigator&&t.navigator.userAgent,a=!!s&&s.includes("Trident/"),u=!!s&&/\/([0-9]|1[0-2])[.\d]* Mobile\/[0-9A-F]* Safari/.test(s),c=!(a||u||!t.fetch||!t.Headers||!t.Response||!t.AbortController),l=Object(r.c)()?r.a:r.b,d=t.fetch,f=function(){function t(t){this._headers=t}return t.prototype.get=function(t){return this._headers.get(t)},t}(),h=function(){function t(t){var e=t.headers,n=t.onProgress,r=t.onStart,o=t.url,i=t.withCredentials;this.controller=new AbortController,this.headers=new Headers(e),this.isAborted=!1,this.onProgress=n,this.onStart=r,this.response=null,this.textDecoder=new l,this.url=o,this.withCredentials=i,this._reader=null,this._stream=null}return t.prototype.fetch=function(){return o(this,void 0,void 0,(function(){var t,e;return i(this,(function(n){switch(n.label){case 0:return this.isAborted?[2]:(e=this,[4,d(this.url,{headers:this.headers,credentials:this.withCredentials?"include":"same-origin",signal:this.controller.signal,cache:"no-store"})]);case 1:return(t=e.response=n.sent()).body.on?(this._emitStart(),[4,this._streamBody()]):[3,3];case 2:return n.sent(),[3,6];case 3:return"getReader"in t.body?(this._emitStart(),[4,this._readBody()]):[3,5];case 4:return n.sent(),[3,6];case 5:throw new Error("Cannot read from response.body, lacks 'getReader' or 'on' property");case 6:return[2]}}))}))},t.prototype._emitStart=function(){var t=this.response,e=t.headers,n=t.status,r=t.statusText;this.onStart({contentType:e.get("Content-Type"),headers:new f(e),status:n,statusText:r})},t.prototype._streamBody=function(){return o(this,void 0,void 0,(function(){var t=this;return i(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e,n){var r=!1,o=function(){r||(r=!0,e())};t._stream=t.response.body.on("data",(function(e){var n=e.toString("utf8");t.onProgress(n)})).on("close",o).on("end",o).on("error",(function(t){return n(t)}))}))];case 1:return e.sent(),[2]}}))}))},t.prototype._readBody=function(){return o(this,void 0,void 0,(function(){var t,e,n;return i(this,(function(r){switch(r.label){case 0:this._reader=this.response.body.getReader(),t=!1,r.label=1;case 1:return t||this.isAborted?[3,3]:[4,this._reader.read()];case 2:return(e=r.sent()).done?t=!0:(n=this.textDecoder.decode(e.value,{stream:!0}),this.onProgress(n)),[3,1];case 3:return[2]}}))}))},t.prototype.abort=function(){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(this.isAborted)return[2];if(this.isAborted=!0,!this._reader)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._reader.cancel()];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:this._reader=null,t.label=5;case 5:return this._stream&&(this._stream.destroy(),this._stream=null),this.controller.abort(),[2]}}))}))},t}()}).call(this,n(7))},function(t,e,n){var r=n(96),o=n(42);t.exports=function(t){return r(o(t))}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var r=n(101),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){var r=n(42);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";var r=n(74),o=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=d;var i=n(53);i.inherits=n(37);var s=n(154),a=n(157);i.inherits(d,s);for(var u=o(a.prototype),c=0;c<u.length;c++){var l=u[c];d.prototype[l]||(d.prototype[l]=a.prototype[l])}function d(t){if(!(this instanceof d))return new d(t);s.call(this,t),a.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(h,this)}function h(t){t.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),d.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){var r=n(19),o=n(23),i=n(79),s=n(47),a=function(t,e,n){var u,c,l,d=t&a.F,f=t&a.G,h=t&a.S,p=t&a.P,v=t&a.B,y=t&a.W,g=f?o:o[e]||(o[e]={}),m=g.prototype,_=f?r:h?r[e]:(r[e]||{}).prototype;for(u in f&&(n=e),n)(c=!d&&_&&void 0!==_[u])&&u in g||(l=c?_[u]:n[u],g[u]=f&&"function"!=typeof _[u]?n[u]:v&&c?i(l,r):y&&_[u]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):p&&"function"==typeof l?i(Function.call,l):l,p&&((g.virtual||(g.virtual={}))[u]=l,t&a.R&&m&&!m[u]&&s(m,u,l)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,e,n){var r=n(81),o=n(188);t.exports=n(59)?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,o,i,s,a){if(!t){var u;if(void 0===e)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,s,a],l=0;(u=new Error(e.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(14),o=n(97),i=n(69),s=r["__core-js_shared__"]||o("__core-js_shared__",{});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.2.1",mode:i?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(14),o=n(104),i=Function.call;t.exports=function(t,e,n){return o(i,r[t].prototype[e],n)}},function(t,e,n){var r=n(31).f,o=n(17),i=n(12)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(35).Buffer)},function(t,e,n){var r=n(325),o=n(336),i=n(181),s=n(18),a=n(347);t.exports=function(t){return"function"==typeof t?t:null==t?i:"object"==typeof t?s(t)?o(t[0],t[1]):r(t):a(t)}},function(t,e,n){var r=n(173)(Object.keys,Object);t.exports=r},function(t,e){t.exports=function(t){return t}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){t.exports=!n(82)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e){t.exports={}},function(t,e,n){(function(e){!function(){"use strict";t.exports=function(t){return(t instanceof e?t:new e(t.toString(),"binary")).toString("base64")}}()}).call(this,n(35).Buffer)},function(t,e,n){(function(e){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt,a="object"==typeof e&&e&&e.Object===Object&&e,u="object"==typeof self&&self&&self.Object===Object&&self,c=a||u||Function("return this")(),l=Object.prototype.toString,d=Math.max,f=Math.min,h=function(){return c.Date.now()};function p(t,e,n){var r,o,i,s,a,u,c=0,l=!1,p=!1,g=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function m(e){var n=r,i=o;return r=o=void 0,c=e,s=t.apply(i,n)}function _(t){return c=t,a=setTimeout(w,e),l?m(t):s}function b(t){var n=t-u;return void 0===u||n>=e||n<0||p&&t-c>=i}function w(){var t=h();if(b(t))return I(t);a=setTimeout(w,function(t){var n=e-(t-u);return p?f(n,i-(t-c)):n}(t))}function I(t){return a=void 0,g&&r?m(t):(r=o=void 0,s)}function O(){var t=h(),n=b(t);if(r=arguments,o=this,u=t,n){if(void 0===a)return _(u);if(p)return a=setTimeout(w,e),m(u)}return void 0===a&&(a=setTimeout(w,e)),s}return e=y(e)||0,v(n)&&(l=!!n.leading,i=(p="maxWait"in n)?d(y(n.maxWait)||0,e):i,g="trailing"in n?!!n.trailing:g),O.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=u=o=a=void 0},O.flush=function(){return void 0===a?s:I(h())},O}function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function y(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==l.call(t)}(t))return NaN;if(v(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=v(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(n,"");var a=o.test(t);return a||i.test(t)?s(t.slice(2),a?2:8):r.test(t)?NaN:+t}t.exports=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return v(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),p(t,e,{leading:r,maxWait:e,trailing:o})}}).call(this,n(7))},function(t,e,n){"use strict";var r=n(458);t.exports=function(t,e,n,o){var i=n?n.call(o,t,e):void 0;if(void 0!==i)return!!i;if(t===e)return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var s=r(t),a=r(e),u=s.length;if(u!==a.length)return!1;o=o||null;for(var c=Object.prototype.hasOwnProperty.bind(e),l=0;l<u;l++){var d=s[l];if(!c(d))return!1;var f=t[d],h=e[d],p=n?n.call(o,f,h,d):void 0;if(!1===p||void 0===p&&f!==h)return!1}return!0}},function(t,e,n){"use strict";var r=n(462);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:r},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(22);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(14),o=n(50),i=n(30),s=n(17),a=n(97),u=n(132),c=n(98),l=c.get,d=c.enforce,f=String(u).split("toString");o("inspectSource",(function(t){return u.call(t)})),(t.exports=function(t,e,n,o){var u=!!o&&!!o.unsafe,c=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof n&&("string"!=typeof e||s(n,"name")||i(n,"name",e),d(n).source=f.join("string"==typeof e?e:"")),t!==r?(u?!l&&t[e]&&(c=!0):delete t[e],c?t[e]=n:i(t,e,n)):c?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||u.call(this)}))},function(t,e){t.exports=!1},function(t,e,n){var r=n(50),o=n(99),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e){t.exports={}},function(t,e,n){var r=n(135),o=n(102);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e){t.exports={}},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,o){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var i,s,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,n)}));case 3:return e.nextTick((function(){t.call(null,n,r)}));case 4:return e.nextTick((function(){t.call(null,n,r,o)}));default:for(i=new Array(a-1),s=0;s<i.length;)i[s++]=arguments[s];return e.nextTick((function(){t.apply(null,i)}))}}}:t.exports=e}).call(this,n(36))},function(t,e,n){var r=n(167);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(18),o=n(115),i=n(339),s=n(343);t.exports=function(t,e){return r(t)?t:o(t,e)?[t]:i(s(t))}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(80);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(38),o=n(365),i=n(366),s=Object.defineProperty;e.f=n(59)?Object.defineProperty:function(t,e,n){if(r(t),e=i(e,!0),r(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(419);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(439),o=n(442)(r);t.exports=o},function(t,e,n){"use strict";var r,o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(t){function e(n,r,o){void 0===r&&(r="invalid"),void 0===o&&(o=n+" is "+r);var i=t.call(this,o)||this;return i.code=e.CODE,i.name=n,i.reason=r,i}return o(e,t),e.CODE="validation",e}(Error);e.a=i},function(t,e,n){"use strict";n.r(e),n.d(e,"allContentTypes",(function(){return l})),n.d(e,"allExtensions",(function(){return d})),n.d(e,"getMimeEntryByContentType",(function(){return f})),n.d(e,"getMimeEntryByExtension",(function(){return h}));for(var r={},o={},i=0,s=[{ext:"csv",mime:"text/csv"},{ext:"csv",mime:"text/plain"},{ext:"doc",mime:"application/msword"},{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},{ext:"gif",mime:"image/gif"},{ext:"gz",mime:"application/gzip"},{ext:"gz",mime:"application/x-gzip"},{ext:"gz",mime:"application/x-compressed"},{ext:"jpg",mime:"image/jpeg"},{ext:"jpeg",mime:"image/jpeg"},{ext:"m4a",mime:"audio/m4a"},{ext:"m4a",mime:"audio/x-m4a"},{ext:"m4a",mime:"audio/mp4"},{ext:"m4v",mime:"video/x-m4v"},{ext:"mov",mime:"video/quicktime"},{ext:"mp3",mime:"audio/mpeg"},{ext:"mp3",mime:"audio/mp3"},{ext:"mp3",mime:"audio/mpeg3"},{ext:"mp3",mime:"audio/x-mpeg"},{ext:"mp3",mime:"audio/x-mpeg-3"},{ext:"mp3",mime:"video/mpeg"},{ext:"mp3",mime:"video/x-mpeg"},{ext:"mp4",mime:"video/mp4"},{ext:"pdf",mime:"application/pdf"},{ext:"png",mime:"image/png"},{ext:"ppsx",mime:"application/vnd.openxmlformats-officedocument.presentationml.slideshow"},{ext:"ppt",mime:"application/vnd.ms-powerpoint"},{ext:"ppt",mime:"application/ms-powerpoint"},{ext:"ppt",mime:"application/mspowerpoint"},{ext:"ppt",mime:"application/powerpoint"},{ext:"ppt",mime:"application/x-mspowerpoint"},{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"},{ext:"svg",mime:"image/svg+xml"},{ext:"txt",mime:"text/plain"},{ext:"wav",mime:"audio/wav"},{ext:"wav",mime:"audio/wave"},{ext:"wav",mime:"audio/x-pn-wav"},{ext:"wav",mime:"audio/x-wav"},{ext:"xls",mime:"application/vnd.ms-excel"},{ext:"xls",mime:"application/excel"},{ext:"xls",mime:"application/x-excel"},{ext:"xls",mime:"application/x-msexcel"},{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},{ext:"zip",mime:"application/zip"}];i<s.length;i++){var a=s[i],u=a.ext,c=a.mime;r[c]||(r[c]=[]),r[c].push(a),o[u]||(o[u]=[]),o[u].push(a)}var l=Object.keys(r),d=Object.keys(o);function f(t){return r[t]}function h(t){return t&&"."===t[0]&&(t=t.slice(1)),o[t]}},function(t,e,n){"use strict";e.a=function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return n&&n.configurable}},function(t,e,n){"use strict";e.a=function(t){return void 0!==t?JSON.parse(JSON.stringify(t)):null}},function(t,e,n){"use strict";var r=n(324);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){(function(r){var o;!function(){var i;function s(t){var e,n,r,o="",i=-1;if(t&&t.length)for(r=t.length;(i+=1)<r;)e=t.charCodeAt(i),n=i+1<r?t.charCodeAt(i+1):0,55296<=e&&e<=56319&&56320<=n&&n<=57343&&(e=65536+((1023&e)<<10)+(1023&n),i+=1),e<=127?o+=String.fromCharCode(e):e<=2047?o+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o}function a(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function u(t,e){return t<<e|t>>>32-e}function c(t,e){for(var n,r=e?"0123456789ABCDEF":"0123456789abcdef",o="",i=0,s=t.length;i<s;i+=1)n=t.charCodeAt(i),o+=r.charAt(n>>>4&15)+r.charAt(15&n);return o}function l(t){var e,n=32*t.length,r="";for(e=0;e<n;e+=8)r+=String.fromCharCode(t[e>>5]>>>24-e%32&255);return r}function d(t){var e,n=32*t.length,r="";for(e=0;e<n;e+=8)r+=String.fromCharCode(t[e>>5]>>>e%32&255);return r}function f(t){var e,n=8*t.length,r=Array(t.length>>2),o=r.length;for(e=0;e<o;e+=1)r[e]=0;for(e=0;e<n;e+=8)r[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return r}function h(t){var e,n=8*t.length,r=Array(t.length>>2),o=r.length;for(e=0;e<o;e+=1)r[e]=0;for(e=0;e<n;e+=8)r[e>>5]|=(255&t.charCodeAt(e/8))<<24-e%32;return r}function p(t,e){var n,r,o,i,s,a,u,c,l=e.length,d=Array();for(i=(a=Array(Math.ceil(t.length/2))).length,n=0;n<i;n+=1)a[n]=t.charCodeAt(2*n)<<8|t.charCodeAt(2*n+1);for(;a.length>0;){for(s=Array(),o=0,n=0;n<a.length;n+=1)o=(o<<16)+a[n],o-=(r=Math.floor(o/l))*l,(s.length>0||r>0)&&(s[s.length]=r);d[d.length]=o,a=s}for(u="",n=d.length-1;n>=0;n--)u+=e.charAt(d[n]);for(c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),n=u.length;n<c;n+=1)u=e[0]+u;return u}function v(t,e){var n,r,o,i="",s=t.length;for(e=e||"=",n=0;n<s;n+=3)for(o=t.charCodeAt(n)<<16|(n+1<s?t.charCodeAt(n+1)<<8:0)|(n+2<s?t.charCodeAt(n+2):0),r=0;r<4;r+=1)8*n+6*r>8*t.length?i+=e:i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-r)&63);return i}i={VERSION:"1.0.6",Base64:function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e="=",n=!0;this.encode=function(r){var o,i,a,u="",c=r.length;for(e=e||"=",r=n?s(r):r,o=0;o<c;o+=3)for(a=r.charCodeAt(o)<<16|(o+1<c?r.charCodeAt(o+1)<<8:0)|(o+2<c?r.charCodeAt(o+2):0),i=0;i<4;i+=1)u+=8*o+6*i>8*c?e:t.charAt(a>>>6*(3-i)&63);return u},this.decode=function(r){var o,i,s,a,u,c,l,d,f="",h=[];if(!r)return r;o=d=0,r=r.replace(new RegExp("\\"+e,"gi"),"");do{i=(l=t.indexOf(r.charAt(o+=1))<<18|t.indexOf(r.charAt(o+=1))<<12|(u=t.indexOf(r.charAt(o+=1)))<<6|(c=t.indexOf(r.charAt(o+=1))))>>16&255,s=l>>8&255,a=255&l,h[d+=1]=64===u?String.fromCharCode(i):64===c?String.fromCharCode(i,s):String.fromCharCode(i,s,a)}while(o<r.length);return f=h.join(""),f=n?function(t){var e,n,r,o,i,s,a=[];if(e=n=r=o=i=0,t&&t.length)for(s=t.length,t+="";e<s;)n+=1,(r=t.charCodeAt(e))<128?(a[n]=String.fromCharCode(r),e+=1):r>191&&r<224?(o=t.charCodeAt(e+1),a[n]=String.fromCharCode((31&r)<<6|63&o),e+=2):(o=t.charCodeAt(e+1),i=t.charCodeAt(e+2),a[n]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&i),e+=3);return a.join("")}(f):f},this.setPad=function(t){return e=t||e,this},this.setTab=function(e){return t=e||t,this},this.setUTF8=function(t){return"boolean"==typeof t&&(n=t),this}},CRC32:function(t){var e,n,r,o=0,i=0;for(t=s(t),e=["00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 ","79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 ","84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F ","63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD ","A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC ","51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 ","B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 ","06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 ","E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 ","12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 ","D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 ","33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 ","CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 ","9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E ","7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D ","806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 ","60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA ","AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 ","5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 ","B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 ","05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 ","F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA ","11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 ","D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F ","30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E ","C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D"].join(""),o^=-1,n=0,r=t.length;n<r;n+=1)i=255&(o^t.charCodeAt(n)),o=o>>>8^"0x"+e.substr(9*i,8);return(-1^o)>>>0},MD5:function(t){var e=!(!t||"boolean"!=typeof t.uppercase)&&t.uppercase,n=t&&"string"==typeof t.pad?t.pad:"=",r=!t||"boolean"!=typeof t.utf8||t.utf8;function o(t){return d(l(f(t=r?s(t):t),8*t.length))}function i(t,e){var n,o,i,a,u;for(t=r?s(t):t,e=r?s(e):e,(n=f(t)).length>16&&(n=l(n,8*t.length)),o=Array(16),i=Array(16),u=0;u<16;u+=1)o[u]=909522486^n[u],i[u]=1549556828^n[u];return a=l(o.concat(f(e)),512+8*e.length),d(l(i.concat(a),640))}function l(t,e){var n,r,o,i,s,u=1732584193,c=-271733879,l=-1732584194,d=271733878;for(t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e,n=0;n<t.length;n+=16)r=u,o=c,i=l,s=d,u=y(u,c,l,d,t[n+0],7,-680876936),d=y(d,u,c,l,t[n+1],12,-389564586),l=y(l,d,u,c,t[n+2],17,606105819),c=y(c,l,d,u,t[n+3],22,-1044525330),u=y(u,c,l,d,t[n+4],7,-176418897),d=y(d,u,c,l,t[n+5],12,1200080426),l=y(l,d,u,c,t[n+6],17,-1473231341),c=y(c,l,d,u,t[n+7],22,-45705983),u=y(u,c,l,d,t[n+8],7,1770035416),d=y(d,u,c,l,t[n+9],12,-1958414417),l=y(l,d,u,c,t[n+10],17,-42063),c=y(c,l,d,u,t[n+11],22,-1990404162),u=y(u,c,l,d,t[n+12],7,1804603682),d=y(d,u,c,l,t[n+13],12,-40341101),l=y(l,d,u,c,t[n+14],17,-1502002290),u=g(u,c=y(c,l,d,u,t[n+15],22,1236535329),l,d,t[n+1],5,-165796510),d=g(d,u,c,l,t[n+6],9,-1069501632),l=g(l,d,u,c,t[n+11],14,643717713),c=g(c,l,d,u,t[n+0],20,-373897302),u=g(u,c,l,d,t[n+5],5,-701558691),d=g(d,u,c,l,t[n+10],9,38016083),l=g(l,d,u,c,t[n+15],14,-660478335),c=g(c,l,d,u,t[n+4],20,-405537848),u=g(u,c,l,d,t[n+9],5,568446438),d=g(d,u,c,l,t[n+14],9,-1019803690),l=g(l,d,u,c,t[n+3],14,-187363961),c=g(c,l,d,u,t[n+8],20,1163531501),u=g(u,c,l,d,t[n+13],5,-1444681467),d=g(d,u,c,l,t[n+2],9,-51403784),l=g(l,d,u,c,t[n+7],14,1735328473),u=m(u,c=g(c,l,d,u,t[n+12],20,-1926607734),l,d,t[n+5],4,-378558),d=m(d,u,c,l,t[n+8],11,-2022574463),l=m(l,d,u,c,t[n+11],16,1839030562),c=m(c,l,d,u,t[n+14],23,-35309556),u=m(u,c,l,d,t[n+1],4,-1530992060),d=m(d,u,c,l,t[n+4],11,1272893353),l=m(l,d,u,c,t[n+7],16,-155497632),c=m(c,l,d,u,t[n+10],23,-1094730640),u=m(u,c,l,d,t[n+13],4,681279174),d=m(d,u,c,l,t[n+0],11,-358537222),l=m(l,d,u,c,t[n+3],16,-722521979),c=m(c,l,d,u,t[n+6],23,76029189),u=m(u,c,l,d,t[n+9],4,-640364487),d=m(d,u,c,l,t[n+12],11,-421815835),l=m(l,d,u,c,t[n+15],16,530742520),u=_(u,c=m(c,l,d,u,t[n+2],23,-995338651),l,d,t[n+0],6,-198630844),d=_(d,u,c,l,t[n+7],10,1126891415),l=_(l,d,u,c,t[n+14],15,-1416354905),c=_(c,l,d,u,t[n+5],21,-57434055),u=_(u,c,l,d,t[n+12],6,1700485571),d=_(d,u,c,l,t[n+3],10,-1894986606),l=_(l,d,u,c,t[n+10],15,-1051523),c=_(c,l,d,u,t[n+1],21,-2054922799),u=_(u,c,l,d,t[n+8],6,1873313359),d=_(d,u,c,l,t[n+15],10,-30611744),l=_(l,d,u,c,t[n+6],15,-1560198380),c=_(c,l,d,u,t[n+13],21,1309151649),u=_(u,c,l,d,t[n+4],6,-145523070),d=_(d,u,c,l,t[n+11],10,-1120210379),l=_(l,d,u,c,t[n+2],15,718787259),c=_(c,l,d,u,t[n+9],21,-343485551),u=a(u,r),c=a(c,o),l=a(l,i),d=a(d,s);return Array(u,c,l,d)}function h(t,e,n,r,o,i){return a(u(a(a(e,t),a(r,i)),o),n)}function y(t,e,n,r,o,i,s){return h(e&n|~e&r,t,e,o,i,s)}function g(t,e,n,r,o,i,s){return h(e&r|n&~r,t,e,o,i,s)}function m(t,e,n,r,o,i,s){return h(e^n^r,t,e,o,i,s)}function _(t,e,n,r,o,i,s){return h(n^(e|~r),t,e,o,i,s)}this.hex=function(t){return c(o(t),e)},this.b64=function(t){return v(o(t),n)},this.any=function(t,e){return p(o(t),e)},this.raw=function(t){return o(t)},this.hex_hmac=function(t,n){return c(i(t,n),e)},this.b64_hmac=function(t,e){return v(i(t,e),n)},this.any_hmac=function(t,e,n){return p(i(t,e),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(t){return"boolean"==typeof t&&(e=t),this},this.setPad=function(t){return n=t||n,this},this.setUTF8=function(t){return"boolean"==typeof t&&(r=t),this}},SHA1:function(t){var e=!(!t||"boolean"!=typeof t.uppercase)&&t.uppercase,n=t&&"string"==typeof t.pad?t.pad:"=",r=!t||"boolean"!=typeof t.utf8||t.utf8;function o(t){return l(d(h(t=r?s(t):t),8*t.length))}function i(t,e){var n,o,i,a,u;for(t=r?s(t):t,e=r?s(e):e,(n=h(t)).length>16&&(n=d(n,8*t.length)),o=Array(16),i=Array(16),a=0;a<16;a+=1)o[a]=909522486^n[a],i[a]=1549556828^n[a];return u=d(o.concat(h(e)),512+8*e.length),l(d(i.concat(u),672))}function d(t,e){var n,r,o,i,s,c,l,d,h=Array(80),p=1732584193,v=-271733879,g=-1732584194,m=271733878,_=-1009589776;for(t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e,n=0;n<t.length;n+=16){for(i=p,s=v,c=g,l=m,d=_,r=0;r<80;r+=1)h[r]=r<16?t[n+r]:u(h[r-3]^h[r-8]^h[r-14]^h[r-16],1),o=a(a(u(p,5),f(r,v,g,m)),a(a(_,h[r]),y(r))),_=m,m=g,g=u(v,30),v=p,p=o;p=a(p,i),v=a(v,s),g=a(g,c),m=a(m,l),_=a(_,d)}return Array(p,v,g,m,_)}function f(t,e,n,r){return t<20?e&n|~e&r:t<40?e^n^r:t<60?e&n|e&r|n&r:e^n^r}function y(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}this.hex=function(t){return c(o(t),e)},this.b64=function(t){return v(o(t),n)},this.any=function(t,e){return p(o(t),e)},this.raw=function(t){return o(t)},this.hex_hmac=function(t,e){return c(i(t,e))},this.b64_hmac=function(t,e){return v(i(t,e),n)},this.any_hmac=function(t,e,n){return p(i(t,e),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(t){return"boolean"==typeof t&&(e=t),this},this.setPad=function(t){return n=t||n,this},this.setUTF8=function(t){return"boolean"==typeof t&&(r=t),this}},SHA256:function(t){!(!t||"boolean"!=typeof t.uppercase)&&t.uppercase;var e,n=t&&"string"==typeof t.pad?t.pad:"=",r=!t||"boolean"!=typeof t.utf8||t.utf8;function o(t,e){return l(b(h(t=e?s(t):t),8*t.length))}function i(t,e){t=r?s(t):t,e=r?s(e):e;var n,o=0,i=h(t),a=Array(16),u=Array(16);for(i.length>16&&(i=b(i,8*t.length));o<16;o+=1)a[o]=909522486^i[o],u[o]=1549556828^i[o];return n=b(a.concat(h(e)),512+8*e.length),l(b(u.concat(n),768))}function u(t,e){return t>>>e|t<<32-e}function d(t,e){return t>>>e}function f(t,e,n){return t&e^~t&n}function y(t,e,n){return t&e^t&n^e&n}function g(t){return u(t,2)^u(t,13)^u(t,22)}function m(t){return u(t,6)^u(t,11)^u(t,25)}function _(t){return u(t,7)^u(t,18)^d(t,3)}function b(t,n){var r,o,i,s,c,l,h,p,v,b,w,I,O,E=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],T=new Array(64);for(t[n>>5]|=128<<24-n%32,t[15+(n+64>>9<<4)]=n,v=0;v<t.length;v+=16){for(r=E[0],o=E[1],i=E[2],s=E[3],c=E[4],l=E[5],h=E[6],p=E[7],b=0;b<64;b+=1)T[b]=b<16?t[b+v]:a(a(a(u(O=T[b-2],17)^u(O,19)^d(O,10),T[b-7]),_(T[b-15])),T[b-16]),w=a(a(a(a(p,m(c)),f(c,l,h)),e[b]),T[b]),I=a(g(r),y(r,o,i)),p=h,h=l,l=c,c=a(s,w),s=i,i=o,o=r,r=a(w,I);E[0]=a(r,E[0]),E[1]=a(o,E[1]),E[2]=a(i,E[2]),E[3]=a(s,E[3]),E[4]=a(c,E[4]),E[5]=a(l,E[5]),E[6]=a(h,E[6]),E[7]=a(p,E[7])}return E}this.hex=function(t){return c(o(t,r))},this.b64=function(t){return v(o(t,r),n)},this.any=function(t,e){return p(o(t,r),e)},this.raw=function(t){return o(t,r)},this.hex_hmac=function(t,e){return c(i(t,e))},this.b64_hmac=function(t,e){return v(i(t,e),n)},this.any_hmac=function(t,e,n){return p(i(t,e),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(t){return"boolean"==typeof t&&t,this},this.setPad=function(t){return n=t||n,this},this.setUTF8=function(t){return"boolean"==typeof t&&(r=t),this},e=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998]},SHA512:function(t){!(!t||"boolean"!=typeof t.uppercase)&&t.uppercase;var e,n=t&&"string"==typeof t.pad?t.pad:"=",r=!t||"boolean"!=typeof t.utf8||t.utf8;function o(t){return l(a(h(t=r?s(t):t),8*t.length))}function i(t,e){t=r?s(t):t,e=r?s(e):e;var n,o=0,i=h(t),u=Array(32),c=Array(32);for(i.length>32&&(i=a(i,8*t.length));o<32;o+=1)u[o]=909522486^i[o],c[o]=1549556828^i[o];return n=a(u.concat(h(e)),1024+8*e.length),l(a(c.concat(n),1536))}function a(t,n){var r,o,i,s=new Array(80),a=new Array(16),c=[new u(1779033703,-205731576),new u(-1150833019,-2067093701),new u(1013904242,-23791573),new u(-1521486534,1595750129),new u(1359893119,-1377402159),new u(-1694144372,725511199),new u(528734635,-79577749),new u(1541459225,327033209)],l=new u(0,0),h=new u(0,0),p=new u(0,0),v=new u(0,0),w=new u(0,0),I=new u(0,0),O=new u(0,0),E=new u(0,0),T=new u(0,0),S=new u(0,0),A=new u(0,0),C=new u(0,0),R=new u(0,0),P=new u(0,0),j=new u(0,0),x=new u(0,0),M=new u(0,0);for(void 0===e&&(e=[new u(1116352408,-685199838),new u(1899447441,602891725),new u(-1245643825,-330482897),new u(-373957723,-2121671748),new u(961987163,-213338824),new u(1508970993,-1241133031),new u(-1841331548,-1357295717),new u(-1424204075,-630357736),new u(-670586216,-1560083902),new u(310598401,1164996542),new u(607225278,1323610764),new u(1426881987,-704662302),new u(1925078388,-226784913),new u(-2132889090,991336113),new u(-1680079193,633803317),new u(-1046744716,-815192428),new u(-459576895,-1628353838),new u(-272742522,944711139),new u(264347078,-1953704523),new u(604807628,2007800933),new u(770255983,1495990901),new u(1249150122,1856431235),new u(1555081692,-1119749164),new u(1996064986,-2096016459),new u(-1740746414,-295247957),new u(-1473132947,766784016),new u(-1341970488,-1728372417),new u(-1084653625,-1091629340),new u(-958395405,1034457026),new u(-710438585,-1828018395),new u(113926993,-536640913),new u(338241895,168717936),new u(666307205,1188179964),new u(773529912,1546045734),new u(1294757372,1522805485),new u(1396182291,-1651133473),new u(1695183700,-1951439906),new u(1986661051,1014477480),new u(-2117940946,1206759142),new u(-1838011259,344077627),new u(-1564481375,1290863460),new u(-1474664885,-1136513023),new u(-1035236496,-789014639),new u(-949202525,106217008),new u(-778901479,-688958952),new u(-694614492,1432725776),new u(-200395387,1467031594),new u(275423344,851169720),new u(430227734,-1194143544),new u(506948616,1363258195),new u(659060556,-544281703),new u(883997877,-509917016),new u(958139571,-976659869),new u(1322822218,-482243893),new u(1537002063,2003034995),new u(1747873779,-692930397),new u(1955562222,1575990012),new u(2024104815,1125592928),new u(-2067236844,-1578062990),new u(-1933114872,442776044),new u(-1866530822,593698344),new u(-1538233109,-561857047),new u(-1090935817,-1295615723),new u(-965641998,-479046869),new u(-903397682,-366583396),new u(-779700025,566280711),new u(-354779690,-840897762),new u(-176337025,-294727304),new u(116418474,1914138554),new u(174292421,-1563912026),new u(289380356,-1090974290),new u(460393269,320620315),new u(685471733,587496836),new u(852142971,1086792851),new u(1017036298,365543100),new u(1126000580,-1676669620),new u(1288033470,-885112138),new u(1501505948,-60457430),new u(1607167915,987167468),new u(1816402316,1246189591)]),o=0;o<80;o+=1)s[o]=new u(0,0);for(t[n>>5]|=128<<24-(31&n),t[31+(n+128>>10<<5)]=n,i=t.length,o=0;o<i;o+=32){for(d(p,c[0]),d(v,c[1]),d(w,c[2]),d(I,c[3]),d(O,c[4]),d(E,c[5]),d(T,c[6]),d(S,c[7]),r=0;r<16;r+=1)s[r].h=t[o+2*r],s[r].l=t[o+2*r+1];for(r=16;r<80;r+=1)f(j,s[r-2],19),y(x,s[r-2],29),g(M,s[r-2],6),C.l=j.l^x.l^M.l,C.h=j.h^x.h^M.h,f(j,s[r-15],1),f(x,s[r-15],8),g(M,s[r-15],7),A.l=j.l^x.l^M.l,A.h=j.h^x.h^M.h,_(s[r],C,s[r-7],A,s[r-16]);for(r=0;r<80;r+=1)R.l=O.l&E.l^~O.l&T.l,R.h=O.h&E.h^~O.h&T.h,f(j,O,14),f(x,O,18),y(M,O,9),C.l=j.l^x.l^M.l,C.h=j.h^x.h^M.h,f(j,p,28),y(x,p,2),y(M,p,7),A.l=j.l^x.l^M.l,A.h=j.h^x.h^M.h,P.l=p.l&v.l^p.l&w.l^v.l&w.l,P.h=p.h&v.h^p.h&w.h^v.h&w.h,b(l,S,C,R,e[r],s[r]),m(h,A,P),d(S,T),d(T,E),d(E,O),m(O,I,l),d(I,w),d(w,v),d(v,p),m(p,l,h);m(c[0],c[0],p),m(c[1],c[1],v),m(c[2],c[2],w),m(c[3],c[3],I),m(c[4],c[4],O),m(c[5],c[5],E),m(c[6],c[6],T),m(c[7],c[7],S)}for(o=0;o<8;o+=1)a[2*o]=c[o].h,a[2*o+1]=c[o].l;return a}function u(t,e){this.h=t,this.l=e}function d(t,e){t.h=e.h,t.l=e.l}function f(t,e,n){t.l=e.l>>>n|e.h<<32-n,t.h=e.h>>>n|e.l<<32-n}function y(t,e,n){t.l=e.h>>>n|e.l<<32-n,t.h=e.l>>>n|e.h<<32-n}function g(t,e,n){t.l=e.l>>>n|e.h<<32-n,t.h=e.h>>>n}function m(t,e,n){var r=(65535&e.l)+(65535&n.l),o=(e.l>>>16)+(n.l>>>16)+(r>>>16),i=(65535&e.h)+(65535&n.h)+(o>>>16),s=(e.h>>>16)+(n.h>>>16)+(i>>>16);t.l=65535&r|o<<16,t.h=65535&i|s<<16}function _(t,e,n,r,o){var i=(65535&e.l)+(65535&n.l)+(65535&r.l)+(65535&o.l),s=(e.l>>>16)+(n.l>>>16)+(r.l>>>16)+(o.l>>>16)+(i>>>16),a=(65535&e.h)+(65535&n.h)+(65535&r.h)+(65535&o.h)+(s>>>16),u=(e.h>>>16)+(n.h>>>16)+(r.h>>>16)+(o.h>>>16)+(a>>>16);t.l=65535&i|s<<16,t.h=65535&a|u<<16}function b(t,e,n,r,o,i){var s=(65535&e.l)+(65535&n.l)+(65535&r.l)+(65535&o.l)+(65535&i.l),a=(e.l>>>16)+(n.l>>>16)+(r.l>>>16)+(o.l>>>16)+(i.l>>>16)+(s>>>16),u=(65535&e.h)+(65535&n.h)+(65535&r.h)+(65535&o.h)+(65535&i.h)+(a>>>16),c=(e.h>>>16)+(n.h>>>16)+(r.h>>>16)+(o.h>>>16)+(i.h>>>16)+(u>>>16);t.l=65535&s|a<<16,t.h=65535&u|c<<16}this.hex=function(t){return c(o(t))},this.b64=function(t){return v(o(t),n)},this.any=function(t,e){return p(o(t),e)},this.raw=function(t){return o(t)},this.hex_hmac=function(t,e){return c(i(t,e))},this.b64_hmac=function(t,e){return v(i(t,e),n)},this.any_hmac=function(t,e,n){return p(i(t,e),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(t){return"boolean"==typeof t&&t,this},this.setPad=function(t){return n=t||n,this},this.setUTF8=function(t){return"boolean"==typeof t&&(r=t),this}},RMD160:function(t){!(!t||"boolean"!=typeof t.uppercase)&&t.uppercase;var e=t&&"string"==typeof t.pad?t.pa:"=",n=!t||"boolean"!=typeof t.utf8||t.utf8,r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],o=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],i=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function d(t){return y(g(f(t=n?s(t):t),8*t.length))}function h(t,e){t=n?s(t):t,e=n?s(e):e;var r,o,i=f(t),a=Array(16),u=Array(16);for(i.length>16&&(i=g(i,8*t.length)),r=0;r<16;r+=1)a[r]=909522486^i[r],u[r]=1549556828^i[r];return o=g(a.concat(f(e)),512+8*e.length),y(g(u.concat(o),672))}function y(t){var e,n="",r=32*t.length;for(e=0;e<r;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function g(t,e){var n,s,c,d,f,h,p,v,y,g,w,I,O,E,T=1732584193,S=4023233417,A=2562383102,C=271733878,R=3285377520;for(t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e,d=t.length,c=0;c<d;c+=16){for(f=g=T,h=w=S,p=I=A,v=O=C,y=E=R,s=0;s<=79;s+=1)n=a(f,m(s,h,p,v)),n=a(n,t[c+r[s]]),n=a(n,_(s)),n=a(u(n,i[s]),y),f=y,y=v,v=u(p,10),p=h,h=n,n=a(g,m(79-s,w,I,O)),n=a(n,t[c+o[s]]),n=a(n,b(s)),n=a(u(n,l[s]),E),g=E,E=O,O=u(I,10),I=w,w=n;n=a(S,a(p,O)),S=a(A,a(v,E)),A=a(C,a(y,g)),C=a(R,a(f,w)),R=a(T,a(h,I)),T=n}return[T,S,A,C,R]}function m(t,e,n,r){return 0<=t&&t<=15?e^n^r:16<=t&&t<=31?e&n|~e&r:32<=t&&t<=47?(e|~n)^r:48<=t&&t<=63?e&r|n&~r:64<=t&&t<=79?e^(n|~r):"rmd160_f: j out of range"}function _(t){return 0<=t&&t<=15?0:16<=t&&t<=31?1518500249:32<=t&&t<=47?1859775393:48<=t&&t<=63?2400959708:64<=t&&t<=79?2840853838:"rmd160_K1: j out of range"}function b(t){return 0<=t&&t<=15?1352829926:16<=t&&t<=31?1548603684:32<=t&&t<=47?1836072691:48<=t&&t<=63?2053994217:64<=t&&t<=79?0:"rmd160_K2: j out of range"}this.hex=function(t){return c(d(t))},this.b64=function(t){return v(d(t),e)},this.any=function(t,e){return p(d(t),e)},this.raw=function(t){return d(t)},this.hex_hmac=function(t,e){return c(h(t,e))},this.b64_hmac=function(t,n){return v(h(t,n),e)},this.any_hmac=function(t,e,n){return p(h(t,e),n)},this.vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"===hex("abc").toLowerCase()},this.setUpperCase=function(t){return"boolean"==typeof t&&t,this},this.setPad=function(t){return void 0!==t&&(e=t),this},this.setUTF8=function(t){return"boolean"==typeof t&&(n=t),this}}},e&&"object"==typeof r&&r&&r.global,void 0===(o=function(){return i}.call(e,n,e,t))||(t.exports=o)}()}).call(this,n(7))},function(t,e,n){"use strict";var r=n(449);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a}));var r=t.TextDecoder;function o(){if(!r||"undefined"==typeof TextEncoder)return!1;try{return"test"===(new r).decode((new TextEncoder).encode("test"),{stream:!0})}catch(t){}return!1}function i(t,e,n){if(1===n)return t>=128>>e&&t<<e<=2047;if(2===n)return t>=2048>>e&&t<<e<=55295||t>=57344>>e&&t<<e<=65535;if(3===n)return t>=65536>>e&&t<<e<=1114111;throw new Error("Invalid octetsCount")}function s(t,e){if(6===t)return e>>6>15?3:e>31?2:1;if(12===t)return e>15?3:2;if(18===t)return 3;throw new Error}var a=function(){function t(){this.bitsNeeded=0,this.codePoint=0}return t.prototype.decode=function(t){for(var e="",n=this.bitsNeeded,r=this.codePoint,o=0;o<t.length;o+=1){var a=t[o];0!==n&&(a<128||a>191||!i(r<<6|63&a,n-6,s(n,r)))&&(n=0,r=65533,e+=String.fromCharCode(r)),0===n?(a>=0&&a<=127?(n=0,r=a):a>=192&&a<=223?(n=6,r=31&a):a>=224&&a<=239?(n=12,r=15&a):a>=240&&a<=247?(n=18,r=7&a):(n=0,r=65533),0===n||i(r,n,s(n,r))||(n=0,r=65533)):(n-=6,r=r<<6|63&a),0===n&&(r<=65535?e+=String.fromCharCode(r):(e+=String.fromCharCode(55296+(r-65535-1>>10)),e+=String.fromCharCode(56320+(r-65535-1&1023))))}return this.bitsNeeded=n,this.codePoint=r,e},t}()}).call(this,n(7))},function(t,e){function n(t,e){return t===e?0:t>e?1:-1}function r(t,e,r){r||(r=n);var i=o(t,e,r);return-1===i?-1:0===r(t[i],e)?i:-1}function o(t,e,r){r||(r=n);for(var o=t.length,i=o-1,s=0,a=-1;i>=s&&s>=0&&i<o;){var u=r(t[a=Math.floor((i+s)/2)],e);if(0===u)return a;u>=0?i=a-1:s=a+1}return a}e.add=function(t,e,r){r||(r=n);var o=t.push(e)-1;for(;o;){if(r(e,t[o-1])>0)return;t[o]=t[o-1],t[o-1]=e,o--}},e.remove=function(t,e,n){var o=r(t,e,n);return-1!==o&&(t.splice(o,1),!0)},e.has=function(t,e,n){return r(t,e,n)>-1},e.eq=r,e.lte=function(t,e,r){r||(r=n);var i=o(t,e,r);if(-1===i)return-1;for(;i>=0;i--){if(r(t[i],e)<=0)return i}return-1},e.lt=function(t,e,r){r||(r=n);var i=o(t,e,r);if(-1===i)return-1;for(;i>=0;i--){if(r(t[i],e)<0)return i}return-1},e.gte=function(t,e,r){r||(r=n);var i=o(t,e,r);if(-1===i)return-1;for(;i<t.length;i++){if(r(t[i],e)>=0)return i}return-1},e.gt=function(t,e,r){r||(r=n);var i=o(t,e,r);if(-1===i)return-1;for(;i<t.length;i++){if(r(t[i],e)>0)return i}return-1},e.nearest=function(t,e,r){r||(r=n);var o=t.length,i=o-1,s=0,a=-1,u=1;for(;i>=s&&s>=0&&i<o;){a=Math.floor((i+s)/2);var c=r(t[a],e);if(0===c)return a;if(c>=0){if(1===u)u=0;else if(2===u)return Math.abs(t[a]-e)>Math.abs(t[a-1]-e)?a-1:a;i=a-1}else{if(1===u)u=2;else if(0===u)return a;s=a+1}}return a}},function(t,e,n){"use strict";function r(t){return t.replace(/[A-Z]/g,(function(t){return String.fromCharCode(t.charCodeAt(0)+32)}))}n.d(e,"a",(function(){return c}));var o=function(){function t(t){for(var e=Object.create(null),n=t.split("\r\n"),o=0;o<n.length;o+=1){var i=n[o].split(": "),s=i.shift(),a=i.join(": ");e[r(s)]=a}this._map=e}return t.prototype.get=function(t){return this._map[r(t)]},t}(),i=function(){},s=function(){function t(t){this.withCredentials=!1,this.responseType="",this.readyState=0,this.status=0,this.statusText="",this.responseText="",this.onprogress=i,this.onreadystatechange=i,this._contentType="",this._xhr=t,this._sendTimeout=0,this._abort=i}return t.prototype.open=function(t,e){this._abort(!0);var n=this,r=this._xhr,o=1,s=0;this._abort=function(t){0!==n._sendTimeout&&(clearTimeout(n._sendTimeout),n._sendTimeout=0),1!==o&&2!==o&&3!==o||(o=4,r.onload=i,r.onerror=i,r.onabort=i,r.onprogress=i,r.onreadystatechange=i,r.abort(),0!==s&&(clearTimeout(s),s=0),t||(n.readyState=4,n.onreadystatechange())),o=0};var a=function(){if(1===o){var t="",e=void 0,i=0;if("contentType"in r)i=200,t="OK",e=r.contentType;else try{i=r.status,t=r.statusText,e=r.getResponseHeader("Content-Type")}catch(n){i=0,t="",e=void 0}0!==i&&(o=2,n.readyState=2,n.status=i,n.statusText=t,n._contentType=e,n.onreadystatechange())}},u=function(){if(a(),2===o||3===o){o=3;var t="";try{t=r.responseText}catch(t){}n.readyState=3,n.responseText=t,n.onprogress()}},c=function(){u(),1!==o&&2!==o&&3!==o||(o=4,0!==s&&(clearTimeout(s),s=0),n.readyState=4,n.onreadystatechange())},l=function(){s=setTimeout((function(){l()}),500),3===r.readyState&&u()};r.onload=c,r.onerror=c,r.onabort=c,"sendAsBinary"in XMLHttpRequest.prototype||"mozAnon"in XMLHttpRequest.prototype||(r.onprogress=u),r.onreadystatechange=function(){r&&(4===r.readyState?c():3===r.readyState?u():2===r.readyState&&a())},"contentType"in r&&(e+=(-1===e.indexOf("?")?"?":"&")+"padding=true"),r.open(t,e,!0),"readyState"in r&&(s=setTimeout((function(){l()}),0))},t.prototype.abort=function(){this._abort(!1)},t.prototype.getResponseHeader=function(t){return this._contentType},t.prototype.setRequestHeader=function(t,e){var n=this._xhr;"setRequestHeader"in n&&n.setRequestHeader(t,e)},t.prototype.getAllResponseHeaders=function(){return this._xhr.getAllResponseHeaders?this._xhr.getAllResponseHeaders():""},t.prototype.send=function(){if(!("ontimeout"in XMLHttpRequest.prototype)&&document&&document.readyState&&"complete"!==document.readyState){var t=this;t._sendTimeout=setTimeout((function(){t._sendTimeout=0,t.send()}),4)}else{var e=this._xhr;e.withCredentials=this.withCredentials,e.responseType=this.responseType;try{e.send(void 0)}catch(t){throw t}}},t}(),a=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},u=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},c=function(){function t(t){var e=t.headers,n=t.onProgress,r=t.onStart,o=t.url,i=t.withCredentials;this.headers=e,this.isAborted=!1,this.offset=0,this.onProgress=n,this.onStart=r,this.url=o,this.withCredentials=i,this.xhr=new s(new XMLHttpRequest)}return t.prototype.fetch=function(){return a(this,void 0,void 0,(function(){var t,e,n,r,i,s,a,c=this;return u(this,(function(u){switch(u.label){case 0:if(this.isAborted)return[2];for(e=new Promise((function(e){t=e})),this.xhr.open("GET",this.url),this.xhr.onprogress=function(){var t=c.xhr.responseText.slice(c.offset);c.offset+=t.length,c.onProgress(t)},this.xhr.onreadystatechange=function(){if(c.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED){var e=c.xhr.getResponseHeader("Content-Type"),n=c.xhr.getAllResponseHeaders();c.onStart({contentType:e,headers:new o(n),status:c.xhr.status,statusText:c.xhr.statusText})}else c.xhr.readyState===XMLHttpRequest.DONE&&t()},this.xhr.withCredentials=this.withCredentials,this.xhr.responseType="text",n=0,r=Object.entries(this.headers);n<r.length;n++)i=r[n],s=i[0],a=i[1],this.xhr.setRequestHeader(s,a);return this.xhr.send(),[4,e];case 1:return u.sent(),[2]}}))}))},t.prototype.abort=function(){return a(this,void 0,void 0,(function(){return u(this,(function(t){return this.isAborted||(this.isAborted=!0,this.xhr.abort()),[2]}))}))},t}()},function(t,e,n){var r=n(26),o=n(65),i=n(49),s=n(41),a=n(67),u=n(17),c=n(130),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=s(t),e=a(e,!0),c)try{return l(t,e)}catch(t){}if(u(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e,n){var r=n(21),o=n(66),i="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?i.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(14),o=n(30);t.exports=function(t,e){try{o(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r,o,i,s=n(219),a=n(14),u=n(22),c=n(30),l=n(17),d=n(70),f=n(71),h=a.WeakMap;if(s){var p=new h,v=p.get,y=p.has,g=p.set;r=function(t,e){return g.call(p,t,e),e},o=function(t){return v.call(p,t)||{}},i=function(t){return y.call(p,t)}}else{var m=d("state");f[m]=!0,r=function(t,e){return c(t,m,e),e},o=function(t){return l(t,m)?t[m]:{}},i=function(t){return l(t,m)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!u(e)||(n=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e,n){var r=n(135),o=n(102).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(223);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(66);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(33),o=n(224),i=n(102),s=n(71),a=n(225),u=n(131),c=n(70)("IE_PROTO"),l=function(){},d=function(){var t,e=u("iframe"),n=i.length;for(e.style.display="none",a.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),d=t.F;n--;)delete d.prototype[i[n]];return d()};t.exports=Object.create||function(t,e){var n;return null!==t?(l.prototype=r(t),n=new l,l.prototype=null,n[c]=t):n=d(),void 0===e?n:o(n,e)},s[c]=!0},function(t,e,n){var r=n(257);t.exports=function(t){if(r(t))throw TypeError("The method doesn't accept regular expressions");return t}},function(t,e,n){var r=n(12)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(t){}}return!1}},function(t,e,n){var r=n(35),o=r.Buffer;function i(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return o(t,e,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=s),i(o,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return o(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=o(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return o(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(18);t.exports=function(){if(!arguments.length)return[];var t=arguments[0];return r(t)?t:[t]}},function(t,e,n){var r=n(172);t.exports=function(t,e){return!!(null==t?0:t.length)&&r(t,e,0)>-1}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){var r=n(76),o=n(56);t.exports=function(t,e){for(var n=0,i=(e=r(e,t)).length;null!=t&&n<i;)t=t[o(e[n++])];return n&&n==i?t:void 0}},function(t,e,n){var r=n(18),o=n(338),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||(s.test(t)||!i.test(t)||null!=e&&t in Object(e))}},function(t,e,n){var r=n(117);t.exports=function(t){return Object(r(t))}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(361),o=n(187);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e,n){var r=n(183),o=n(117);t.exports=function(t){return r(o(t))}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(185)("keys"),o=n(186);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e,n){var r=n(58),o=n(19).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e,n){var r=n(81).f,o=n(77),i=n(20)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){"use strict";var r=n(80);function o(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new o(t)}},function(t,e,n){var r=n(443),o=n(180);t.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},function(t,e,n){"use strict";(function(t){var r=n(10),o=n.n(r),i=n(8),s=n(212),a=n(40),u=n(94),c=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},l=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},d=function(){function t(t,e){var n=this,r=void 0===e?{}:e,c=r.RequestClass,l=r.headers,d=r.lastEventId,f=r.withCredentials;this.CLOSED=i.a.CLOSED,this.CONNECTING=i.a.CONNECTING,this.OPEN=i.a.OPEN,this.FetchRequest=a.a,this.XHRRequest=u.a,this.isFetchSupported=a.b,this._events=new o.a,this.onerror=void 0,this.onmessage=void 0,this.onopen=void 0,this.readyState=i.a.WAITING,this.url=t=String(t),this.withCredentials=f,c||(c=a.b?a.a:u.a),this._esRequest=new s.a({RequestClass:c,dispatchEvent:function(t){return n.dispatchEvent(t)},headers:l,lastEventId:d,onError:function(t){return n.onerror&&n.onerror(t)},onMessage:function(t){return n.onmessage&&n.onmessage(t)},onOpen:function(t){return n.onopen&&n.onopen(t)},onReadyStateChange:function(t){n.readyState=t},url:t,withCredentials:f})}return t.prototype.addEventListener=function(t,e){this._events.on(t,e)},t.prototype.removeEventListener=function(t,e){this._events.removeListener(t,e)},t.prototype.dispatchEvent=function(t){t&&t.type&&this._events.emit(t.type,t)},t.prototype.start=function(){return c(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return this.readyState!==i.a.WAITING?[2]:[4,this._esRequest.start()];case 1:return t.sent(),[2]}}))}))},t.prototype.close=function(){this.readyState!==i.a.CLOSED&&(this._esRequest.close(),this._esRequest.onFinish(new Error("Connection closed by caller")))},t.CLOSED=i.a.CLOSED,t.CONNECTING=i.a.CONNECTING,t.OPEN=i.a.OPEN,t.FetchRequest=a.a,t.XHRRequest=u.a,t.isFetchSupported=a.b,t}();t.EventSource;e.a=d}).call(this,n(7))},function(t,e,n){(function(e){for(var r=n(321),o="undefined"==typeof window?e:window,i=["moz","webkit"],s="AnimationFrame",a=o["request"+s],u=o["cancel"+s]||o["cancelRequest"+s],c=0;!a&&c<i.length;c++)a=o[i[c]+"Request"+s],u=o[i[c]+"Cancel"+s]||o[i[c]+"CancelRequest"+s];if(!a||!u){var l=0,d=0,f=[];a=function(t){if(0===f.length){var e=r(),n=Math.max(0,1e3/60-(e-l));l=n+e,setTimeout((function(){var t=f.slice(0);f.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(l)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(n))}return f.push({handle:++d,callback:t,cancelled:!1}),d},u=function(t){for(var e=0;e<f.length;e++)f[e].handle===t&&(f[e].cancelled=!0)}}t.exports=function(t){return a.call(o,t)},t.exports.cancel=function(){u.apply(o,arguments)},t.exports.polyfill=function(t){t||(t=o),t.requestAnimationFrame=a,t.cancelAnimationFrame=u}}).call(this,n(7))},function(t,e){t.exports=function(t){return function(e){return"/"===e.url[0]&&(e.url=t+e.url),e}}},function(t,e,n){var r,o,i;o=[],void 0===(i="function"==typeof(r=function(){var t=0;function e(t,e,n){this.fields={},"function"==typeof e&&(n=e,e=null),t&&this.append(t,n),this.setBoundary(e)}function n(t,e,n,r){this.data=t,this.contentType=e,this.filename=n,this.headers=r}function r(t){return"[object Array]"===Object.prototype.toString.call(t)}return e.prototype={constructor:e,availableTypes:["multipart","form-encoded"],setType:function(t){return this.typeOverride=-1!==this.availableTypes.indexOf(t)?t:null,this},getType:function(){var t=this.typeOverride;if(-1!==this.availableTypes.indexOf(t))return t;for(var e in this.fields)if(this.fields.hasOwnProperty(e)&&(this.fields[e],1)&&this.fields[e].contentType)return"multipart";return"form-encoded"},append:function(t,e,n){var o,i,s,a,u;if("string"==typeof t&&arguments.length>=2)return this.setField.apply(this,arguments);if("function"==typeof e&&(s=n,n=e,e=s),"function"==typeof n&&(a=1,u=function(){--a||n()}),r(t))for(s=0;s<t.length;s++)i=t[s],a++,this.setField(i.name,i.value,!1!==e,null,u);else for(o in t)if(t.hasOwnProperty(o))if(r(i=t[o]))for(s=0;s<i.length;s++)a++,this.setField(o,i[s],!0===e,null,u);else a++,this.setField(o,i,!1!==e,null,u);return a&&u(),this},setField:function(t,e,o,i,s){var a=this.fields;return t+="",window.File&&e instanceof window.File||window.Blob&&e instanceof window.Blob?this.setFileField.apply(this,arguments):("function"==typeof o&&(s=o,o=!0),e&&e.nodeType&&e.nodeName&&e.getAttribute?e=e.value:r(e)||e&&(e instanceof n||e.contentType&&e.data)||(e+=""),t.match(/\[\]$/g)&&(o=!1),!1===o&&a.hasOwnProperty(t)?(r(a[t])||(a[t]=[a[t]]),a[t].push(e)):a[t]=e,"function"==typeof s&&s(),this)},setFileField:function(t,e,r,o,i){var s=this,a=new FileReader;return"function"==typeof r&&(i=r,r=!0),a.onloadend=function(){s.setField(t,new n(function(t){for(var e="",n=new Uint8Array(t),r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return e}(a.result),e.type,e.name,o||e.headers),!1!==r),"function"==typeof i&&i(),e=i=s=a=null},a.readAsArrayBuffer(e),this},setBoundary:function(e){return this.boundary=(e||Math.random().toString(36).substring(2)+(++t).toString(36))+"",this},toString:function(t){var e,n,o,i,s,a,u,c,l,d=this.getType(),f="";for(n in this.boundary||this.setBoundary(),t&&this.append(t),this.fields)if(this.fields.hasOwnProperty(n))for(e=r(o=this.fields[n])?o:[o],u=0;u<e.length;u++){if(a=e[u],"multipart"===d){if(c=a.headers,i=null,a.contentType&&(i=a.contentType,a=a.data),s="--"+this.boundary+'\r\nContent-Disposition: form-data; name="'+n+'"',e[u].filename&&(s+='; filename="'+e[u].filename+'"'),s+="\r\n",i&&(s+="Content-type: "+i+"\r\n"),c)for(l in c)c.hasOwnProperty(l)&&(s+=l+": "+c[l]+"\r\n");s+="\r\n"+a+"\r\n"}else"form-encoded"===d&&(s=encodeURIComponent(n)+"="+encodeURIComponent(a)+"&");f+=s}return"multipart"===d?f+="--"+this.boundary+"--\r\n":"form-encoded"===d&&(f=f.substring(0,f.length-1)),f},getData:function(){var t,e,n=this.toString();if("multipart"===this.getType()){t=n.length,e=new Uint8Array(t);for(var r=0;r<t;r++)e[r]=255&n.charCodeAt(r);return e}return n},getContentType:function(t){return"multipart"===this.getType()?"multipart/form-data; "+(t?"charset=utf-8; ":"")+"boundary="+this.boundary:"application/x-www-form-encoded"}},{RequestBody:e,RequestField:n}})?r.apply(e,o):r)||(t.exports=i)},function(t,e,n){var r=n(26),o=n(21),i=n(131);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(14),o=n(22),i=r.document,s=o(i)&&o(i.createElement);t.exports=function(t){return s?i.createElement(t):{}}},function(t,e,n){var r=n(50);t.exports=r("native-function-to-string",Function.toString)},function(t,e,n){var r=n(17),o=n(220),i=n(95),s=n(31);t.exports=function(t,e){for(var n=o(e),a=s.f,u=i.f,c=0;c<n.length;c++){var l=n[c];r(t,l)||a(t,l,u(e,l))}}},function(t,e,n){var r=n(34),o=n(14),i=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t])||i(o[t]):r[t]&&r[t][e]||o[t]&&o[t][e]}},function(t,e,n){var r=n(17),o=n(41),i=n(136).indexOf,s=n(71);t.exports=function(t,e){var n,a=o(t),u=0,c=[];for(n in a)!r(s,n)&&r(a,n)&&c.push(n);for(;e.length>u;)r(a,n=e[u++])&&(~i(c,n)||c.push(n));return c}},function(t,e,n){var r=n(41),o=n(43),i=n(221),s=function(t){return function(e,n,s){var a,u=r(e),c=o(u.length),l=i(s,c);if(t&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},function(t,e,n){var r=n(104),o=n(96),i=n(44),s=n(43),a=n(138),u=[].push,c=function(t){var e=1==t,n=2==t,c=3==t,l=4==t,d=6==t,f=5==t||d;return function(h,p,v,y){for(var g,m,_=i(h),b=o(_),w=r(p,v,3),I=s(b.length),O=0,E=y||a,T=e?E(h,I):n?E(h,0):void 0;I>O;O++)if((f||O in b)&&(m=w(g=b[O],O,_),t))if(e)T[O]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return O;case 2:u.call(T,g)}else if(l)return!1;return d?-1:c||l?l:T}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(t,e,n){var r=n(22),o=n(105),i=n(12)("species");t.exports=function(t,e){var n;return o(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[i])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){var r=n(21);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){var r=n(12),o=n(106),i=n(30),s=r("unscopables"),a=Array.prototype;null==a[s]&&i(a,s,o(null)),t.exports=function(t){a[s][t]=!0}},function(t,e,n){"use strict";var r,o,i,s=n(142),a=n(30),u=n(17),c=n(12),l=n(69),d=c("iterator"),f=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(r=o):f=!0),null==r&&(r={}),l||u(r,d)||a(r,d,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},function(t,e,n){var r=n(17),o=n(44),i=n(70),s=n(232),a=i("IE_PROTO"),u=Object.prototype;t.exports=s?Object.getPrototypeOf:function(t){return t=o(t),r(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){"use strict";var r=n(67),o=n(31),i=n(49);t.exports=function(t,e,n){var s=r(e);s in t?o.f(t,s,i(0,n)):t[s]=n}},function(t,e,n){var r=n(66),o=n(12)("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:i?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var r=n(26),o=n(72),i=n(41),s=n(65).f,a=function(t){return function(e){for(var n,a=i(e),u=o(a),c=u.length,l=0,d=[];c>l;)n=u[l++],r&&!s.call(a,n)||d.push(t?[n,a[n]]:a[n]);return d}};t.exports={entries:a(!0),values:a(!1)}},function(t,e,n){e.f=n(12)},function(t,e,n){"use strict";var r=n(294);function o(){}var i=null,s={};function a(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("Promise constructor's argument is not a function");this._h=0,this._i=0,this._j=null,this._k=null,t!==o&&h(t,this)}function u(t,e){for(;3===t._i;)t=t._j;if(a._l&&a._l(t),0===t._i)return 0===t._h?(t._h=1,void(t._k=e)):1===t._h?(t._h=2,void(t._k=[t._k,e])):void t._k.push(e);!function(t,e){r((function(){var n=1===t._i?e.onFulfilled:e.onRejected;if(null!==n){var r=function(t,e){try{return t(e)}catch(t){return i=t,s}}(n,t._j);r===s?l(e.promise,i):c(e.promise,r)}else 1===t._i?c(e.promise,t._j):l(e.promise,t._j)}))}(t,e)}function c(t,e){if(e===t)return l(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"==typeof e||"function"==typeof e)){var n=function(t){try{return t.then}catch(t){return i=t,s}}(e);if(n===s)return l(t,i);if(n===t.then&&e instanceof a)return t._i=3,t._j=e,void d(t);if("function"==typeof n)return void h(n.bind(e),t)}t._i=1,t._j=e,d(t)}function l(t,e){t._i=2,t._j=e,a._m&&a._m(t,e),d(t)}function d(t){if(1===t._h&&(u(t,t._k),t._k=null),2===t._h){for(var e=0;e<t._k.length;e++)u(t,t._k[e]);t._k=null}}function f(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function h(t,e){var n=!1,r=function(t,e,n){try{t(e,n)}catch(t){return i=t,s}}(t,(function(t){n||(n=!0,c(e,t))}),(function(t){n||(n=!0,l(e,t))}));n||r!==s||(n=!0,l(e,i))}t.exports=a,a._l=null,a._m=null,a._n=o,a.prototype.then=function(t,e){if(this.constructor!==a)return function(t,e,n){return new t.constructor((function(r,i){var s=new a(o);s.then(r,i),u(t,new f(e,n,s))}))}(this,t,e);var n=new a(o);return u(this,new f(t,e,n)),n}},function(t,e,n){"use strict"},function(t,e,n){"use strict";!function(){try{var t=n(300).request().constructor.prototype;t.setNoDelay||(t.setNoDelay=function(){}),t.abort||(t.abort=function(){this.xhr&&this.xhr.abort()})}catch(t){}}()},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(t){e.fetch=a(t.fetch)&&a(t.ReadableStream),e.writableStream=a(t.WritableStream),e.abortController=a(t.AbortController),e.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),e.blobConstructor=!0}catch(t){}var n;function r(){if(void 0!==n)return n;if(t.XMLHttpRequest){n=new t.XMLHttpRequest;try{n.open("GET",t.XDomainRequest?"/":"https://example.com")}catch(t){n=null}}else n=null;return n}function o(t){var e=r();if(!e)return!1;try{return e.responseType=t,e.responseType===t}catch(t){}return!1}var i=void 0!==t.ArrayBuffer,s=i&&a(t.ArrayBuffer.prototype.slice);function a(t){return"function"==typeof t}e.arraybuffer=e.fetch||i&&o("arraybuffer"),e.msstream=!e.fetch&&s&&o("ms-stream"),e.mozchunkedarraybuffer=!e.fetch&&i&&o("moz-chunked-arraybuffer"),e.overrideMimeType=e.fetch||!!r()&&a(r().overrideMimeType),e.vbArray=a(t.VBArray),n=null}).call(this,n(7))},function(t,e,n){(function(t,r,o){var i=n(151),s=n(37),a=n(153),u=e.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},c=e.IncomingMessage=function(e,n,s,u){var c=this;if(a.Readable.call(c),c._mode=s,c.headers={},c.rawHeaders=[],c.trailers={},c.rawTrailers=[],c.on("end",(function(){t.nextTick((function(){c.emit("close")}))})),"fetch"===s){if(c._fetchResponse=n,c.url=n.url,c.statusCode=n.status,c.statusMessage=n.statusText,n.headers.forEach((function(t,e){c.headers[e.toLowerCase()]=t,c.rawHeaders.push(e,t)})),i.writableStream){var l=new WritableStream({write:function(t){return new Promise((function(e,n){c._destroyed?n():c.push(new r(t))?e():c._resumeFetch=e}))},close:function(){o.clearTimeout(u),c._destroyed||c.push(null)},abort:function(t){c._destroyed||c.emit("error",t)}});try{return void n.body.pipeTo(l).catch((function(t){o.clearTimeout(u),c._destroyed||c.emit("error",t)}))}catch(t){}}var d=n.body.getReader();!function t(){d.read().then((function(e){if(!c._destroyed){if(e.done)return o.clearTimeout(u),void c.push(null);c.push(new r(e.value)),t()}})).catch((function(t){o.clearTimeout(u),c._destroyed||c.emit("error",t)}))}()}else{if(c._xhr=e,c._pos=0,c.url=e.responseURL,c.statusCode=e.status,c.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach((function(t){var e=t.match(/^([^:]+):\s*(.*)/);if(e){var n=e[1].toLowerCase();"set-cookie"===n?(void 0===c.headers[n]&&(c.headers[n]=[]),c.headers[n].push(e[2])):void 0!==c.headers[n]?c.headers[n]+=", "+e[2]:c.headers[n]=e[2],c.rawHeaders.push(e[1],e[2])}})),c._charset="x-user-defined",!i.overrideMimeType){var f=c.rawHeaders["mime-type"];if(f){var h=f.match(/;\s*charset=([^;])(;|$)/);h&&(c._charset=h[1].toLowerCase())}c._charset||(c._charset="utf-8")}}};s(c,a.Readable),c.prototype._read=function(){var t=this._resumeFetch;t&&(this._resumeFetch=null,t())},c.prototype._onXHRProgress=function(){var t=this,e=t._xhr,n=null;switch(t._mode){case"text:vbarray":if(e.readyState!==u.DONE)break;try{n=new o.VBArray(e.responseBody).toArray()}catch(t){}if(null!==n){t.push(new r(n));break}case"text":try{n=e.responseText}catch(e){t._mode="text:vbarray";break}if(n.length>t._pos){var i=n.substr(t._pos);if("x-user-defined"===t._charset){for(var s=new r(i.length),a=0;a<i.length;a++)s[a]=255&i.charCodeAt(a);t.push(s)}else t.push(i,t._charset);t._pos=n.length}break;case"arraybuffer":if(e.readyState!==u.DONE||!e.response)break;n=e.response,t.push(new r(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=e.response,e.readyState!==u.LOADING||!n)break;t.push(new r(new Uint8Array(n)));break;case"ms-stream":if(n=e.response,e.readyState!==u.LOADING)break;var c=new o.MSStreamReader;c.onprogress=function(){c.result.byteLength>t._pos&&(t.push(new r(new Uint8Array(c.result.slice(t._pos)))),t._pos=c.result.byteLength)},c.onload=function(){t.push(null)},c.readAsArrayBuffer(n)}t._xhr.readyState===u.DONE&&"ms-stream"!==t._mode&&t.push(null)}}).call(this,n(36),n(35).Buffer,n(7))},function(t,e,n){(e=t.exports=n(154)).Stream=e,e.Readable=e,e.Writable=n(157),e.Duplex=n(45),e.Transform=n(159),e.PassThrough=n(311)},function(t,e,n){"use strict";(function(e,r){var o=n(74);t.exports=_;var i,s=n(150);_.ReadableState=m;n(10).EventEmitter;var a=function(t,e){return t.listeners(e).length},u=n(155),c=n(109).Buffer,l=e.Uint8Array||function(){};var d=n(53);d.inherits=n(37);var f=n(304),h=void 0;h=f&&f.debuglog?f.debuglog("stream"):function(){};var p,v=n(305),y=n(156);d.inherits(_,u);var g=["error","close","destroy","pause","resume"];function m(t,e){t=t||{};var r=e instanceof(i=i||n(45));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var o=t.highWaterMark,s=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:r&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=n(158).StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function _(t){if(i=i||n(45),!(this instanceof _))return new _(t);this._readableState=new m(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function b(t,e,n,r,o){var i,s=t._readableState;null===e?(s.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,O(t)}(t,s)):(o||(i=function(t,e){var n;r=e,c.isBuffer(r)||r instanceof l||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(s,e)),i?t.emit("error",i):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===c.prototype||(e=function(t){return c.from(t)}(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?w(t,s,e,!1):T(t,s)):w(t,s,e,!1))):r||(s.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function w(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&O(t)),T(t,e)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),_.prototype.destroy=y.destroy,_.prototype._undestroy=y.undestroy,_.prototype._destroy=function(t,e){this.push(null),e(t)},_.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=c.from(t,e),e=""),n=!0),b(this,t,e,!1,n)},_.prototype.unshift=function(t){return b(this,t,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(t){return p||(p=n(158).StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};function I(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function O(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(h("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?o.nextTick(E,t):E(t))}function E(t){h("emit readable"),t.emit("readable"),R(t)}function T(t,e){e.readingMore||(e.readingMore=!0,o.nextTick(S,t,e))}function S(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(h("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function A(t){h("readable nexttick read 0"),t.read(0)}function C(t,e){e.reading||(h("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),R(t),e.flowing&&!e.reading&&t.read(0)}function R(t){var e=t._readableState;for(h("flow",e.flowing);e.flowing&&null!==t.read(););}function P(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,o=n.data;t-=o.length;for(;n=n.next;){var i=n.data,s=t>i.length?i.length:t;if(s===i.length?o+=i:o+=i.slice(0,t),0===(t-=s)){s===i.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=i.slice(s));break}++r}return e.length-=r,o}(t,e):function(t,e){var n=c.allocUnsafe(t),r=e.head,o=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var i=r.data,s=t>i.length?i.length:t;if(i.copy(n,n.length-t,0,s),0===(t-=s)){s===i.length?(++o,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=i.slice(s));break}++o}return e.length-=o,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function j(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,o.nextTick(x,e,t))}function x(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function M(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}_.prototype.read=function(t){h("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return h("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?j(this):O(this),null;if(0===(t=I(t,e))&&e.ended)return 0===e.length&&j(this),null;var r,o=e.needReadable;return h("need readable",o),(0===e.length||e.length-t<e.highWaterMark)&&h("length less than watermark",o=!0),e.ended||e.reading?h("reading or ended",o=!1):o&&(h("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=I(n,e))),null===(r=t>0?P(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&j(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(t,e){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t)}i.pipesCount+=1,h("pipe count=%d opts=%j",i.pipesCount,e);var u=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr?l:_;function c(e,r){h("onunpipe"),e===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,h("cleanup"),t.removeListener("close",g),t.removeListener("finish",m),t.removeListener("drain",d),t.removeListener("error",y),t.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",_),n.removeListener("data",v),f=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||d())}function l(){h("onend"),t.end()}i.endEmitted?o.nextTick(u):n.once("end",u),t.on("unpipe",c);var d=function(t){return function(){var e=t._readableState;h("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&a(t,"data")&&(e.flowing=!0,R(t))}}(n);t.on("drain",d);var f=!1;var p=!1;function v(e){h("ondata"),p=!1,!1!==t.write(e)||p||((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==M(i.pipes,t))&&!f&&(h("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function y(e){h("onerror",e),_(),t.removeListener("error",y),0===a(t,"error")&&t.emit("error",e)}function g(){t.removeListener("finish",m),_()}function m(){h("onfinish"),t.removeListener("close",g),_()}function _(){h("unpipe"),n.unpipe(t)}return n.on("data",v),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?s(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",y),t.once("close",g),t.once("finish",m),t.emit("pipe",n),i.flowing||(h("pipe resume"),n.resume()),t},_.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,o=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<o;i++)r[i].emit("unpipe",this,n);return this}var s=M(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},_.prototype.on=function(t,e){var n=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&O(this):o.nextTick(A,this))}return n},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var t=this._readableState;return t.flowing||(h("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,o.nextTick(C,t,e))}(this,t)),this},_.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var o in t.on("end",(function(){if(h("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(o){(h("wrapped data"),n.decoder&&(o=n.decoder.write(o)),n.objectMode&&null==o)||(n.objectMode||o&&o.length)&&(e.push(o)||(r=!0,t.pause()))})),t)void 0===this[o]&&"function"==typeof t[o]&&(this[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));for(var i=0;i<g.length;i++)t.on(g[i],this.emit.bind(this,g[i]));return this._read=function(e){h("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=P}).call(this,n(7),n(36))},function(t,e,n){t.exports=n(10).EventEmitter},function(t,e,n){"use strict";var r=n(74);function o(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,i=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return i||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(o,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(r.nextTick(o,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";(function(e,r,o){var i=n(74);function s(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;t.entry=null;for(;r;){var o=r.callback;e.pendingcb--,o(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=m;var a,u=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?r:i.nextTick;m.WritableState=g;var c=n(53);c.inherits=n(37);var l={deprecate:n(309)},d=n(155),f=n(109).Buffer,h=o.Uint8Array||function(){};var p,v=n(156);function y(){}function g(t,e){a=a||n(45),t=t||{};var r=e instanceof a;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var o=t.highWaterMark,c=t.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:r&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===t.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,o=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,o){--e.pendingcb,n?(i.nextTick(o,r),i.nextTick(E,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(o(r),t._writableState.errorEmitted=!0,t.emit("error",r),E(t,e))}(t,n,r,e,o);else{var s=I(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||w(t,n),r?u(b,t,n,s,o):b(t,n,s,o)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function m(t){if(a=a||n(45),!(p.call(m,this)||this instanceof a))return new m(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),d.call(this)}function _(t,e,n,r,o,i,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(o,e.onwrite):t._write(o,i,e.onwrite),e.sync=!1}function b(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),E(t,e)}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,o=new Array(r),i=e.corkedRequestsFree;i.entry=n;for(var a=0,u=!0;n;)o[a]=n,n.isBuf||(u=!1),n=n.next,a+=1;o.allBuffers=u,_(t,e,!0,e.length,o,"",i.finish),e.pendingcb++,e.lastBufferedRequest=null,i.next?(e.corkedRequestsFree=i.next,i.next=null):e.corkedRequestsFree=new s(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,d=n.callback;if(_(t,e,!1,e.objectMode?1:c.length,c,l,d),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function I(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function O(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),E(t,e)}))}function E(t,e){var n=I(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,i.nextTick(O,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}c.inherits(m,d),g.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(g.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(t){return!!p.call(this,t)||this===m&&(t&&t._writableState instanceof g)}})):p=function(t){return t instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(t,e,n){var r,o=this._writableState,s=!1,a=!o.objectMode&&(r=t,f.isBuffer(r)||r instanceof h);return a&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(n=e,e=null),a?e="buffer":e||(e=o.defaultEncoding),"function"!=typeof n&&(n=y),o.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),i.nextTick(e,n)}(this,n):(a||function(t,e,n,r){var o=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),i.nextTick(r,s),o=!1),o}(this,o,t,n))&&(o.pendingcb++,s=function(t,e,n,r,o,i){if(!n){var s=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,n));return e}(e,r,o);r!==s&&(n=!0,o="buffer",r=s)}var a=e.objectMode?1:r.length;e.length+=a;var u=e.length<e.highWaterMark;u||(e.needDrain=!0);if(e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:o,isBuf:n,callback:i,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else _(t,e,!1,a,r,o,i);return u}(this,o,a,t,e,n)),s},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},m.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,E(t,e),n&&(e.finished?i.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),m.prototype.destroy=v.destroy,m.prototype._undestroy=v.undestroy,m.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(36),n(307).setImmediate,n(7))},function(t,e,n){"use strict";var r=n(310).Buffer,o=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===o||!o(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=l,this.end=d,e=3;break;default:return this.write=f,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function l(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function d(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function h(t){return t&&t.length?this.write(t):""}e.StringDecoder=i,i.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},i.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},i.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var o=s(e[r]);if(o>=0)return o>0&&(t.lastNeed=o-1),o;if(--r<n||-2===o)return 0;if((o=s(e[r]))>=0)return o>0&&(t.lastNeed=o-2),o;if(--r<n||-2===o)return 0;if((o=s(e[r]))>=0)return o>0&&(2===o?o=0:t.lastNeed=o-3),o;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},i.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";t.exports=s;var r=n(45),o=n(53);function i(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function s(t){if(!(this instanceof s))return new s(t);r.call(this,t),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",a)}function a(){var t=this;"function"==typeof this._flush?this._flush((function(e,n){u(t,e,n)})):u(this,null,null)}function u(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}o.inherits=n(37),o.inherits(s,r),s.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},s.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},s.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},s.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},s.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},function(t,e,n){(function(e){var n,r=e.crypto||e.msCrypto;if(r&&r.getRandomValues){var o=new Uint8Array(16);n=function(){return r.getRandomValues(o),o}}if(!n){var i=new Array(16);n=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}t.exports=n}).call(this,n(7))},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,o=n;return o[t[r++]]+o[t[r++]]+o[t[r++]]+o[t[r++]]+"-"+o[t[r++]]+o[t[r++]]+"-"+o[t[r++]]+o[t[r++]]+"-"+o[t[r++]]+o[t[r++]]+"-"+o[t[r++]]+o[t[r++]]+o[t[r++]]+o[t[r++]]+o[t[r++]]+o[t[r++]]}},function(t,e,n){"use strict";var r=/.+\@.+\..+/;t.exports=function(t){return r.test(t)}},function(t,e,n){"use strict";(function(t){var r,o=n(1),i=n(89),s=n.n(i),a=n(61),u=n.n(a),c=n(90),l=n.n(c),d=n(13),f=n(6),h=n(5),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(){return(v=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},y=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},g=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},m=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},_=o.b.VERSION_TWO,b=o.a.USER_FIND,w=o.a.USER_FIND_ME,I=new l.a.MD5,O=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.getSignInAuthHeader=function(t,e,n){var r=[t,e,n].join(":");return"XMPP-Simple "+u()(r)},n.prototype.getAnonymousAuthHeader=function(t){var e=this.config.signUpHashKey,n=this.config.signUpHashSalt,r=[e,n,t].join(":"),o=I.hex(r),i=[o.substr(0,2),o.substr(o.length-2)].join(""),s=[this.config.productKey,e,n,t,i].join(":");return"XMPP-Anonymous "+u()(s)},n.prototype.getSignInAuthHeader=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this.constructor).getSignInAuthHeader.apply(t,e)},n.prototype.checkLogin=function(t,e){return g(this,void 0,void 0,(function(){var n,r;return m(this,(function(o){switch(o.label){case 0:return n={Authorization:this.getAnonymousAuthHeader(e.udid)},r={device:e.udid,tt_product_version:this.config.partnerName},Object(f.isPhone)(t)?r.phones=Object(f.normalizePhoneUS)(t):r.emails=t,[4,this.httpClient.get("/v4/login_check",{headers:n,query:r})];case 1:return[2,o.sent()]}}))}))},n.prototype.signUp=function(t){return g(this,void 0,void 0,(function(){var e,n;return m(this,(function(r){switch(r.label){case 0:return e={Authorization:this.getAnonymousAuthHeader(t.udid)},n={primary_email:t.email,unique_id:t.email,password:t.password,push_routing:this.config.pushAgent,product:this.config.productKey,country_code:t.countryCode,device_id:t.udid,version:this.config.version},[4,this.httpClient.post("/v2/signup",{headers:e,data:n})];case 1:return[2,r.sent()]}}))}))},n.prototype.signIn=function(e,n){return g(this,void 0,void 0,(function(){var r,o,i,s,a,u,c;return m(this,(function(l){switch(l.label){case 0:return r={device_id:n.udid,metadata:{device_type:"js_sdk",device_version:"12.5.0beta2",tt_product_version:this.config.partnerName,user_agent:t.navigator&&t.navigator.userAgent},push_routing:this.config.pushAgent,version:this.config.version,want_condensed_replays:this.config.wantCondensedReplays,want_processing_events:this.config.wantCondensedReplays},[4,this.httpClient.post("/v5/login",{headers:e,data:r})];case 1:return(o=l.sent()).data&&o.data.settings&&(i=o.data.settings,s=i.condensed_replays,a=void 0!==s&&s,u=i.processing_events,c=void 0!==u&&u,this.host.configure({condensedReplays:a,processingEvents:c})),[2,o]}}))}))},n.prototype.signOut=function(){return g(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,this.httpClient.post("/v2/logout")];case 1:return[2,t.sent()]}}))}))},n.prototype.lookup=function(t){return g(this,void 0,void 0,(function(){var n,r,o;return m(this,(function(i){switch(i.label){case 0:return n=e.prototype.getVersion.call(this,b).version,r=void 0===n?_:n,o={display_name:t},Object(d.isEmail)(t)?o.email_address=t:Object(f.isPhone)(t)&&(o.phone_number=Object(f.normalizePhoneUS)(t)),[4,this.httpClient.post("/:version/user_lookup/:id",{urlParams:{id:t,version:r},data:o})];case 1:return[2,i.sent().data]}}))}))},n.prototype.wipe=function(t){return g(this,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v2/wipe",{data:{},query:{token:t}})];case 1:return[2,e.sent()]}}))}))},n.prototype.find=function(t,n){var r=(void 0===n?{}:n).organizationId;return g(this,void 0,void 0,(function(){var n,o,i;return m(this,(function(s){switch(s.label){case 0:return n=e.prototype.getVersion.call(this,b).version,o=void 0===n?_:n,Object(d.isEmail)(t)&&(t=t.toLowerCase()),i=r?{"TT-X-Organization-Key":r}:null,[4,this.httpClient.get("/:version/user/:id",{headers:i,urlParams:{id:t,version:o},query:{render_metadata:!0}})];case 1:return[2,s.sent().data]}}))}))},n.prototype.findMe=function(t){var n=(void 0===t?{}:t).organizationId;return g(this,void 0,void 0,(function(){var t,r,o;return m(this,(function(i){switch(i.label){case 0:return t=e.prototype.getVersion.call(this,w).version,r=void 0===t?_:t,o=n?{"TT-X-Organization-Key":n}:null,[4,this.httpClient.get("/:version/user",{headers:o,query:{render_metadata:!0},urlParams:{version:r}})];case 1:return[2,i.sent().data]}}))}))},n.prototype.update=function(t,e){var n=e.firstName,r=void 0===n?void 0:n,o=e.lastName,i=void 0===o?void 0:o,a=e.displayName,u=void 0===a?void 0:a,c=e.status,l=void 0===c?void 0:c,d=e.dnd,f=void 0===d?void 0:d,h=e.dndText,p=void 0===h?void 0:h,y=e.avatarFile,_=void 0===y?void 0:y,b=e.removeAvatar,w=void 0===b?void 0:b;return g(this,void 0,void 0,(function(){var e,n;return m(this,(function(o){switch(o.label){case 0:return e={},w?e.avatar=null:_&&(e.avatar=_),n=s.a.call({first_name:r,last_name:i,display_name:u,status:l,dnd:f,dnd_text:p},(function(t,e){return void 0===t})),[4,this.httpClient.post("/v2/user/:id/settings",{urlParams:{id:t},data:n,files:e})];case 1:return o.sent(),[2,v({id:t},_&&_.preview?{avatarUrl:_.preview}:null)]}}))}))},n.prototype.updatePassword=function(t,e,n,r){return g(this,void 0,void 0,(function(){var o;return m(this,(function(i){switch(i.label){case 0:return o={Authorization:this.getSignInAuthHeader(r,t,e)},[4,this.httpClient.post("/v2/user/:id/password",{urlParams:{id:t},headers:o,data:{password:n}})];case 1:return[2,i.sent()]}}))}))},n.prototype.setAutoForward=function(t,e,n){var r=n.dnd,o=n.receiverId;return g(this,void 0,void 0,(function(){return m(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.post("/v2/user/:userId/organization/:organizationId",{urlParams:{userId:t,organizationId:e},data:{dnd:r,dnd_auto_forward_receiver:o}})];case 1:return[2,n.sent()]}}))}))},n.prototype.removeAutoForward=function(t,e){return g(this,void 0,void 0,(function(){return m(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.del("/v2/user/:userId/organization/:organizationId/dnd_auto_forward_receiver",{urlParams:{userId:t,organizationId:e}})];case 1:return[2,n.sent()]}}))}))},n.prototype.setAwayMessage=function(t,e,n){var r=n.dnd,o=n.dndText;return g(this,void 0,void 0,(function(){return m(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.post("/v5/user/:userId/organization/:organizationId",{urlParams:{userId:t,organizationId:e},data:{network:{patient:{dnd:r,dnd_text:o}}}})];case 1:return n.sent(),[2]}}))}))},n.prototype.setEulaAccepted=function(t,e,n){return g(this,void 0,void 0,(function(){return m(this,(function(r){switch(r.label){case 0:return[4,this.httpClient.post("/v2/user/:userId/organization/:organizationId",{urlParams:{userId:t,organizationId:e},data:{eula:!n}})];case 1:return[2,r.sent()]}}))}))},n.prototype.getPreferences=function(t){return g(this,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.get("/v2/user/:userId/preferences",{urlParams:{userId:t}})];case 1:return[2,e.sent().data]}}))}))},n.prototype.editPreferences=function(t){var e=t.organizationId,n=t.quickReplies,r=t.userId;return g(this,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,this.httpClient.post("/v2/user/:userId/preferences",{headers:{"TT-X-Organization-Key":e},data:h.a.underscoreObject({quickReplies:n}),urlParams:{userId:r}})];case 1:return[2,t.sent().data]}}))}))},y([Object(o.d)({httpStatusCodes:[400]})],n.prototype,"lookup",null),y([Object(o.d)()],n.prototype,"find",null),y([Object(o.d)()],n.prototype,"getPreferences",null),y([Object(o.d)()],n.prototype,"editPreferences",null),n}(o.c);e.a=O}).call(this,n(7))},function(t,e,n){var r=n(165),o=n(166),i=n(168),s=n(169),a=n(170);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=s,u.prototype.set=a,t.exports=u},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(75),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():o.call(e,n,1),--this.size,!0)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(75);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(75);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(75);t.exports=function(t,e){var n=this.__data__,o=r(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}},function(t,e,n){var r=n(327),o=n(175);t.exports=function t(e,n,i,s,a){return e===n||(null==e||null==n||!o(e)&&!o(n)?e!=e&&n!=n:r(e,n,i,s,t,a))}},function(t,e){t.exports=function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var r=n(113);t.exports=function(t){return t==t&&!r(t)}},function(t,e){t.exports=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}},function(t,e){t.exports=function(){return!1}},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(355);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var r=n(78);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(120),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){var r=n(19),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){"use strict";var r=n(190),o=n(46),i=n(372),s=n(47),a=n(77),u=n(60),c=n(373),l=n(123),d=n(376),f=n(20)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,v,y,g,m){c(n,e,v);var _,b,w,I=function(t){if(!h&&t in S)return S[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},O=e+" Iterator",E="values"==y,T=!1,S=t.prototype,A=S[f]||S["@@iterator"]||y&&S[y],C=A||I(y),R=y?E?I("entries"):C:void 0,P="Array"==e&&S.entries||A;if(P&&(w=d(P.call(new t)))!==Object.prototype&&w.next&&(l(w,O,!0),r||a(w,f)||s(w,f,p)),E&&A&&"values"!==A.name&&(T=!0,C=function(){return A.call(this)}),r&&!m||!h&&!T&&S[f]||s(S,f,C),u[e]=C,u[O]=p,y)if(_={values:E?C:I("values"),keys:g?C:I("keys"),entries:R},m)for(b in _)b in S||i(S,b,_[b]);else o(o.P+o.F*(h||T),e,_);return _}},function(t,e){t.exports=!0},function(t,e,n){var r=n(19).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(78),o=n(20)("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:i?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,n){var r=n(38),o=n(80),i=n(20)("species");t.exports=function(t,e){var n,s=r(t).constructor;return void 0===s||null==(n=r(s)[i])?e:o(n)}},function(t,e,n){var r,o,i,s=n(79),a=n(387),u=n(191),c=n(122),l=n(19),d=l.process,f=l.setImmediate,h=l.clearImmediate,p=l.MessageChannel,v=l.Dispatch,y=0,g={},m=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},_=function(t){m.call(t.data)};f&&h||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++y]=function(){a("function"==typeof t?t:Function(t),e)},r(y),y},h=function(t){delete g[t]},"process"==n(78)(d)?r=function(t){d.nextTick(s(m,t,1))}:v&&v.now?r=function(t){v.now(s(m,t,1))}:p?(i=(o=new p).port2,o.port1.onmessage=_,r=s(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",_,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(s(m,t,1),0)}),t.exports={set:f,clear:h}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(38),o=n(58),i=n(124);t.exports=function(t,e){if(r(t),o(e)&&e.constructor===t)return e;var n=i.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return null!==t&&"object"===r(t)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){var r=n(172);t.exports=function(t,e){return!!(null==t?0:t.length)&&r(t,e,0)>-1}},function(t,e){t.exports=function(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}},function(t,e,n){t.exports=n(457)},function(t,e,n){!function(e){var n=-1,r={onVisible:function(t){var e=r.isSupported();if(!e||!r.hidden())return t(),e;var n=r.change((function(e,o){r.hidden()||(r.unbind(n),t())}));return n},change:function(t){if(!r.isSupported())return!1;var e=n+=1;return r._callbacks[e]=t,r._listen(),e},unbind:function(t){delete r._callbacks[t]},afterPrerendering:function(t){var e=r.isSupported();if(!e||"prerender"!=r.state())return t(),e;var n=r.change((function(e,o){"prerender"!=o&&(r.unbind(n),t())}));return n},hidden:function(){return!(!r._doc.hidden&&!r._doc.webkitHidden)},state:function(){return r._doc.visibilityState||r._doc.webkitVisibilityState||"visible"},isSupported:function(){return void 0!==r._doc.hidden||void 0!==r._doc.webkitHidden},_doc:document||{},_callbacks:{},_change:function(t){var e=r.state();for(var n in r._callbacks)r._callbacks[n].call(r._doc,t,e)},_listen:function(){if(!r._init){var t="visibilitychange";r._doc.webkitVisibilityState&&(t="webkit"+t);var e=function(){r._change.apply(r,arguments)};r._doc.addEventListener?r._doc.addEventListener(t,e):r._doc.attachEvent(t,e),r._init=!0}}};t.exports?t.exports=r:e.Visibility=r}(this)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o;"undefined"!=typeof window?o=window:"undefined"==typeof self?(console.warn("Using browser-only version of superagent in non-browser environment"),o=void 0):o=self;var i=n(403),s=n(404),a=n(405),u=n(197),c=n(406),l=n(408);function d(){}t.exports=function(t,n){return"function"==typeof n?new e.Request("GET",t).end(n):1===arguments.length?new e.Request("GET",t):new e.Request(t,n)};var f=e=t.exports;e.Request=_,f.getXHR=function(){if(o.XMLHttpRequest&&(!o.location||"file:"!==o.location.protocol||!o.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}throw new Error("Browser-only version of superagent could not find XHR")};var h="".trim?function(t){return t.trim()}:function(t){return t.replace(/(^\s*|\s*$)/g,"")};function p(t){if(!u(t))return t;var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&v(e,n,t[n]);return e.join("&")}function v(t,e,n){if(void 0!==n)if(null!==n)if(Array.isArray(n))n.forEach((function(n){v(t,e,n)}));else if(u(n))for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&v(t,"".concat(e,"[").concat(r,"]"),n[r]);else t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));else t.push(encodeURIComponent(e))}function y(t){for(var e,n,r={},o=t.split("&"),i=0,s=o.length;i<s;++i)-1===(n=(e=o[i]).indexOf("="))?r[decodeURIComponent(e)]="":r[decodeURIComponent(e.slice(0,n))]=decodeURIComponent(e.slice(n+1));return r}function g(t){return/[/+]json($|[^-\w])/.test(t)}function m(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!==this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var e=this.xhr.status;1223===e&&(e=204),this._setStatusProperties(e),this.headers=function(t){for(var e,n,r,o,i=t.split(/\r?\n/),s={},a=0,u=i.length;a<u;++a)-1!==(e=(n=i[a]).indexOf(":"))&&(r=n.slice(0,e).toLowerCase(),o=h(n.slice(e+1)),s[r]=o);return s}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&t._responseType?this.body=this.xhr.response:this.body="HEAD"===this.req.method?null:this._parseBody(this.text?this.text:this.xhr.response)}function _(t,e){var n=this;this._query=this._query||[],this.method=t,this.url=e,this.header={},this._header={},this.on("end",(function(){var t,e=null,r=null;try{r=new m(n)}catch(t){return(e=new Error("Parser is unable to parse the response")).parse=!0,e.original=t,n.xhr?(e.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,e.status=n.xhr.status?n.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),n.callback(e)}n.emit("response",r);try{n._isResponseOK(r)||(t=new Error(r.statusText||"Unsuccessful HTTP response"))}catch(e){t=e}t?(t.original=e,t.response=r,t.status=r.status,n.callback(t,r)):n.callback(null,r)}))}function b(t,e,n){var r=f("DELETE",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}f.serializeObject=p,f.parseString=y,f.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},f.serialize={"application/x-www-form-urlencoded":p,"application/json":s},f.parse={"application/x-www-form-urlencoded":y,"application/json":JSON.parse},c(m.prototype),m.prototype._parseBody=function(t){var e=f.parse[this.type];return this.req._parser?this.req._parser(this,t):(!e&&g(this.type)&&(e=f.parse["application/json"]),e&&t&&(t.length>0||t instanceof Object)?e(t):null)},m.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,r="cannot ".concat(e," ").concat(n," (").concat(this.status,")"),o=new Error(r);return o.status=this.status,o.method=e,o.url=n,o},f.Response=m,i(_.prototype),a(_.prototype),_.prototype.type=function(t){return this.set("Content-Type",f.types[t]||t),this},_.prototype.accept=function(t){return this.set("Accept",f.types[t]||t),this},_.prototype.auth=function(t,e,n){1===arguments.length&&(e=""),"object"===r(e)&&null!==e&&(n=e,e=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});var o=function(t){if("function"==typeof btoa)return btoa(t);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(t,e,n,o)},_.prototype.query=function(t){return"string"!=typeof t&&(t=p(t)),t&&this._query.push(t),this},_.prototype.attach=function(t,e,n){if(e){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(t,e,n||e.name)}return this},_.prototype._getFormData=function(){return this._formData||(this._formData=new o.FormData),this._formData},_.prototype.callback=function(t,e){if(this._shouldRetry(t,e))return this._retry();var n=this._callback;this.clearTimeout(),t&&(this._maxRetries&&(t.retries=this._retries-1),this.emit("error",t)),n(t,e)},_.prototype.crossDomainError=function(){var t=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");t.crossDomain=!0,t.status=this.status,t.method=this.method,t.url=this.url,this.callback(t)},_.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},_.prototype.buffer=_.prototype.ca,_.prototype.ca=_.prototype.agent,_.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")},_.prototype.pipe=_.prototype.write,_.prototype._isHost=function(t){return t&&"object"===r(t)&&!Array.isArray(t)&&"[object Object]"!==Object.prototype.toString.call(t)},_.prototype.end=function(t){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=t||d,this._finalizeQueryString(),this._end()},_.prototype._setUploadTimeout=function(){var t=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout((function(){t._timeoutError("Upload timeout of ",t._uploadTimeout,"ETIMEDOUT")}),this._uploadTimeout))},_.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var t=this;this.xhr=f.getXHR();var e=this.xhr,n=this._formData||this._data;this._setTimeouts(),e.onreadystatechange=function(){var n=e.readyState;if(n>=2&&t._responseTimeoutTimer&&clearTimeout(t._responseTimeoutTimer),4===n){var r;try{r=e.status}catch(t){r=0}if(!r){if(t.timedout||t._aborted)return;return t.crossDomainError()}t.emit("end")}};var r=function(e,n){n.total>0&&(n.percent=n.loaded/n.total*100,100===n.percent&&clearTimeout(t._uploadTimeoutTimer)),n.direction=e,t.emit("progress",n)};if(this.hasListeners("progress"))try{e.addEventListener("progress",r.bind(null,"download")),e.upload&&e.upload.addEventListener("progress",r.bind(null,"upload"))}catch(t){}e.upload&&this._setUploadTimeout();try{this.username&&this.password?e.open(this.method,this.url,!0,this.username,this.password):e.open(this.method,this.url,!0)}catch(t){return this.callback(t)}if(this._withCredentials&&(e.withCredentials=!0),!this._formData&&"GET"!==this.method&&"HEAD"!==this.method&&"string"!=typeof n&&!this._isHost(n)){var o=this._header["content-type"],i=this._serializer||f.serialize[o?o.split(";")[0]:""];!i&&g(o)&&(i=f.serialize["application/json"]),i&&(n=i(n))}for(var s in this.header)null!==this.header[s]&&Object.prototype.hasOwnProperty.call(this.header,s)&&e.setRequestHeader(s,this.header[s]);this._responseType&&(e.responseType=this._responseType),this.emit("request",this),e.send(void 0===n?null:n)},f.agent=function(){return new l},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach((function(t){l.prototype[t.toLowerCase()]=function(e,n){var r=new f.Request(t,e);return this._setDefaults(r),n&&r.end(n),r}})),l.prototype.del=l.prototype.delete,f.get=function(t,e,n){var r=f("GET",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},f.head=function(t,e,n){var r=f("HEAD",t);return"function"==typeof e&&(n=e,e=null),e&&r.query(e),n&&r.end(n),r},f.options=function(t,e,n){var r=f("OPTIONS",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},f.del=b,f.delete=b,f.patch=function(t,e,n){var r=f("PATCH",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},f.post=function(t,e,n){var r=f("POST",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r},f.put=function(t,e,n){var r=f("PUT",t);return"function"==typeof e&&(n=e,e=null),e&&r.send(e),n&&r.end(n),r}},function(t,e,n){"use strict";var r=n(435);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";var r=n(464);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";var r=n(468);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";(function(t){var r=n(2),o=n.n(r),i=n(208),s=n.n(i),a=n(39),u=n.n(a),c=n(209),l=n.n(c),d=n(29),f=n.n(d),h=n(210),p=n.n(h),v=n(11),y=n.n(v),g=n(64),m=n.n(g),_=n(91),b=n.n(_),w=n(10),I=n.n(w),O=n(4),E=function(){return(E=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},T={computed:{},defaultValues:null,idAttribute:"id",methods:{},parseAttrs:o.a.identity,relations:{belongsTo:{},hasMany:{}}},S=Symbol("NOT_PROVIDED"),A=0;t.duplicateDebug={initRelations:{},outOfOrderElements:[],setHighestSortNumber:{conversationId:null},updateRelations:{}};var C={initRelations:!1,updateRelationsAdd:!1,updateRelationsRemove:!1};function R(t,e){return"organization"===t&&"conversations"===e}function P(t,e,n){for(var r=(void 0===n?{}:n).previousValue,o=[],i={},s=[],a=0,u=!1,c=1/0,l=0;l<t.length;l++){var d=t[l],f=d._origIndex,h=d.id,p=d.highestSortNumber,v={_origIndex:f,id:h,highestSortNumber:p,sortNumber:d.sortNumber};if(o.push(v),i[h]=(i[h]||0)+1,i[h]>1&&a++,r&&r.id===h&&r.highestSortNumber===p&&p>c||!r&&p>c){u=!0;var y=t[l-1],g=y._origIndex,m=y.id,_=y.highestSortNumber,b=y.sortNumber;s.push({_origIndex:g,id:m,highestSortNumber:_,sortNumber:b}),s.push(v)}c=p}return{copy:o,duplicateCount:a,outOfOrder:u,outOfOrderElements:s}}function j(t,e,n,r,o){for(var i=void 0===o?{}:o,s=i.action,a=i.previousValue,u=i.source,c=[],l={},d=0,f=0,h=n;f<h.length;f++){var p=h[f],v=p._origIndex,y=p.id,g=p.highestSortNumber,m=p.sortNumber;c.push({_origIndex:v,id:y,highestSortNumber:g,sortNumber:m}),l[y]=(l[y]||0)+1,l[y]>1&&d++}if(e>0||d>0){v=r._origIndex,y=r.id,g=r.highestSortNumber,m=r.sortNumber;return console.error(s+"\n"+u+"\nBefore duplicate count: "+e+"\nAfter duplicate count: "+d,"\nBefore elements ("+t.length+"): ",t,"\nAfter elements ("+c.length+"): ",c,"\nElement info: ",{_origIndex:v,id:y,highestSortNumber:g,sortNumber:m}),a&&console.error("Previous value",{_origIndex:a._origIndex,id:a.id,highestSortNumber:a.highestSortNumber,sortNumber:a.sortNumber}),console.log(new Error("Duplicate items stack trace")),{logged:!0,currCopy:c,counts:l}}return{logged:!1,currCopy:c,counts:l}}function x(e,n,r,o){var i=void 0===o?{}:o,s=i.action,a=i.previousValue,u=i.source,c=n._origIndex,l=n.id,d=n.highestSortNumber,f=n.sortNumber;0===A&&n.$entityClass.emit("displayInfoDialog","We have automatically corrected a Conversation Store problem, please reach out to Mike O to help us debug it further."),t.duplicateDebug.outOfOrderElements[A]=e,console.error(s+"\n"+u+"\n\nBefore elements (also saved in window.duplicateDebug.outOfOrderElements["+A+++"]): ",e,"\nOut of order elements: ",r,"\nElement info: ",{_origIndex:c,id:l,highestSortNumber:d,sortNumber:f}),a&&console.error("Previous value",{_origIndex:a._origIndex,id:a.id,highestSortNumber:a.highestSortNumber,sortNumber:a.sortNumber}),console.log(new Error("Elements out of order stack trace"))}var M=function(){function e(t,e,n){var r=this;void 0===n&&(n={}),this.get=function(t){return r.entitiesById[t]||r.entitiesByServerId[t]||null},this.options=o.a.defaultsDeep({},n,T),this.idAttribute=this.options.idAttribute,this.name=e,this.store=t,this.entitiesById={},this.entitiesByServerId={},this.entitiesList=[],this.hasManySortFields=null,this.previousHasManySortValues={},this.previousServerIds={},this.transientAttrsStore={},this.options.relations&&this.__initRelations(),this.__initTransientAttrs(),Object.assign(this.options.computed,{$entityType:{enumerable:!0,value:e,writable:!1},$entityClass:{enumerable:!1,value:this,writable:!1}}),this.options.computed=o.a.transform(this.options.computed,(function(t,e,n){t[n]="function"==typeof e?{get:e,enumerable:!1}:e}),{}),this._computedKeys=b.a.call(l.a.call(this.options.computed),"$entityType","$entityClass","$$transientAttrs"),this._writablePropertyKeys=f.a.call(s.a.call(p.a.call(this.options.computed),(function(t){return t[1].set})),o.a.first),this._relationKeys=u.a.call(f.a.call(m.a.call(this.options.relations),o.a.keys))}return e.create=function(t,e,n){return new this(t,e,n)},e.prototype.__initRelations=function(){var e=this,n=this,r=o.a.transform(this.options.relations.belongsTo,(function(t,e,r){t[r]={get:function(){return n.store.get(e.type,this[e.foreignKey])},set:function(t){this[e.foreignKey]=n.store.resolveId(e.type,t)}}}),{});Object.assign(this.options.computed,r);var i=o.a.transform(this.options.relations.hasMany,(function(r,i,s){var a=i.filter,u=i.foreignKey,c=i.sortBy,l=i.type,d=e.__getSorted(c),f=e.options;r[s]={get:function(){if(this.$$transientAttrs.relations||(this.$$transientAttrs.relations={}),this.$$transientAttrs.relations[s])return this.$$transientAttrs.relations[s];var e=[],r=n.store.models[l];if(r.hasManySortFields)for(var i=0,c=r.getAll();i<c.length;i++){var h=c[i];if(h[u]===this[n.idAttribute]&&(!a||a(h,this))){var p=o.a.has(this.previousHasManySortValues,h[this.idAttribute])?this.previousHasManySortValues[h[this.idAttribute]]:S;r.previousHasManySortValues[h[r.idAttribute]]=o.a.pick(h,r.hasManySortFields);var v=f.host,y=[],g=0;if(v.config.condensedReplays&&R(n.name,s)){var m=P(e,0,{previousValue:p===S?void 0:p}),_=m.copy,b=m.duplicateCount,w=m.outOfOrder,I=m.outOfOrderElements;y=_,g=b,w&&(x(y,h,I,{action:"__initRelations - "+(p===S?"sorted.add":"sorted.update"),previousValue:p===S?void 0:p,source:"Elements are out of order in "+n.name+"."+s}),e.sort(d.cmp))}if(p===S?d.add(e,h):d.update(e,h,{previousValue:p}),v.config.condensedReplays&&!C.initRelations&&R(n.name,s)){var O=j(y,g,e,h,{action:"__initRelations - "+(p===S?"sorted.add":"sorted.update"),previousValue:p===S?void 0:p,source:"There are duplicates in "+n.name+"."+s}),E=O.logged,T=O.currCopy,A=O.counts;C.initRelations=E,E&&(t.duplicateDebug.initRelations={beforeElements:y,afterElements:T,counts:A})}}}return this.$$transientAttrs.relations[s]=e,e},set:function(t){}}}),{});Object.assign(this.options.computed,i)},e.prototype.__getSorted=function(t){void 0===t&&(t=[[this.idAttribute,"asc"]]);var e=Object(O.j)(t);return new O.b(e)},e.prototype.__initTransientAttrs=function(){var e=this,n=this,r={$$transientAttrs:{enumerable:!1,get:function(){var t=this[n.idAttribute];return n.transientAttrsStore[t]||(n.transientAttrsStore[t]={})}}},o={};this.options.transientAttrs&&this.options.transientAttrs.forEach((function(n){e.options.defaultValues&&n in e.options.defaultValues&&(o[n]=Object(O.l)(e.options.defaultValues[n]),delete e.options.defaultValues[n]),r[n]={get:function(){return n in this.$$transientAttrs?this.$$transientAttrs[n]:n in o?this.$$transientAttrs[n]=o[n]:void 0},set:function(e){var r=t.duplicateDebug.setHighestSortNumber;"conversation"!==this.$entityType||"highestSortNumber"!==n||Object.isFrozen(r)||(r.conversationId=this.id,r.highestSortNumber=e,r.stackTrace=new Error("Set Conversation.highestSortNumber")),this.$$transientAttrs[n]=e}}})),Object.assign(this.options.computed,r)},e.prototype.createInstance=function(t,e){void 0===e&&(e=!0),e&&(t=this.parseAttrs(t));var n=t[this.idAttribute];if(this.entitiesById[n]||this.entitiesByServerId[n])throw new Error("called createInstance on an existing instance");return this.__wireInstance(t)},e.prototype.__wireInstance=function(t){var e=this;this.options.defaultValues&&o.a.defaults(t,Object(O.l)(this.options.defaultValues));var n={};this._writablePropertyKeys.forEach((function(e){Object(O.k)(t,e)&&(n[e]=t[e],delete t[e])})),Object.defineProperties(t,this.options.computed),Object.assign(t,n),this.options.instanceEvents&&Object.assign(t,I.a.prototype),Object.assign(t,this.options.methods),Object.assign(t,{toPlainObject:function(t){var n=this,r={};e._computedKeys.forEach((function(t){return r[t]=n[t]}));var o=Object.assign({},this,r);return delete o.setMaxListeners,delete o.emit,delete o.addListener,delete o.on,delete o.once,delete o.removeListener,delete o.removeAllListeners,delete o.listeners,delete o.listenerCount,delete o.off,delete o.toPlainObject,delete o._events,delete o._maxListeners,o}});var r=t[this.idAttribute];return r&&!("serverId"in t)&&(t.serverId=r),this.options.beforeCreateInstance&&this.options.beforeCreateInstance(t),t},e.prototype.inject=function(e){var n,r;if(this.is(e)){if(r=e,n=this.resolveId(r),this.entitiesById[n]){if(this.__beforeInject(r),this.__register(n,r),this.options.afterAssignment&&this.options.afterAssignment(r),this.__addToHasManyRelationships(r),this.options.afterInject&&this.options.afterInject(r),this.emit("afterInject",this,r),"conversation"===r.$entityType){var o=t.duplicateDebug.setHighestSortNumber;Object.isFrozen(o)||null===o.conversationId||(o.conversationId!==r.id?(Object.freeze(o),console.error("Injected a different conversation after setting Conversation.highestSortNumber.\nCheck `window.duplicateDebug.setHighestSortNumber` for details.")):o.conversationId=null)}return r}Object.isFrozen(t.duplicateDebug.setHighestSortNumber)||"conversation"!==r.$entityType||(t.duplicateDebug.setHighestSortNumber.conversationId=null)}if(!r&&(e=this.parseAttrs(e),n=this.resolveId(e),!this.isValidId(n)))throw new Error("'"+this.idAttribute+"' is required");var i=!1,s=this.entitiesById[n]||this.entitiesByServerId[n];return r?(s||(i=!0),this.__beforeInject(r)):s?(r=s,this.__beforeInject(e,r),Object.assign(r,e)):(i=!0,r=this.__wireInstance(e),this.__beforeInject(r)),this.__register(n,r),this.options.afterAssignment&&this.options.afterAssignment(r),this.__addToHasManyRelationships(r),this.options.afterInject&&this.options.afterInject(r),this.emit("afterInject",this,r),i&&(this.options.afterCreate&&this.options.afterCreate(r),this.emit("afterCreate",this,r)),r},e.prototype.__beforeInject=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e[0],o=e[1];o&&!("serverId"in r)&&(r.serverId=o.serverId),this.options.beforeInject&&(t=this.options).beforeInject.apply(t,e),this.emit("beforeInject",this,r)},e.prototype.replaceExisting=function(t,e){var n=(void 0===e?{}:e).instance,r=this.options.idAttribute;if(this.is(t))throw new Error("cannot call replaceExisting() on an instance; should be plain object");if(n&&!this.is(n))throw new Error("provided 'instance' option is not an instance of this model");t=this.parseAttrs(t);var o=this.resolveId(t);if(!this.isValidId(o))throw new Error("'"+r+"' is required");var i,s=o;if(n){var a=this.resolveId(n);if(s!==a)this.entitiesById[s]?(this.eject(n),n=null):s=a}if(n||(n=this.entitiesById[s]||this.entitiesByServerId[s])&&(s=n[r]),n){var u={};for(var c in t)u[c]=!0;this.__beforeInject(t,n);for(var l=0,d=Object.getOwnPropertyNames(n);l<d.length;l++){var f=d[l];!u[f]&&Object(O.k)(n,f)&&delete n[f]}Object.assign(n,t),n[r]=s,n.serverId=o,this.__wireInstance(n)}else i=!0,n=this.__wireInstance(t),this.__beforeInject(n);return this.__register(s,n),this.options.afterAssignment&&this.options.afterAssignment(n),this.__addToHasManyRelationships(n),this.options.afterInject&&this.options.afterInject(n),this.emit("afterInject",this,n),i&&(this.options.afterCreate&&this.options.afterCreate(n),this.emit("afterCreate",this,n)),n},e.prototype.eject=function(t){t=this.resolveId(t);var e=this.entitiesById[t]||this.entitiesByServerId[t];e&&(this.emit("beforeEject",this,e),this.__removeFromHasManyRelationships(e),this.__unregister(t,e),this.emit("afterEject",this,e))},e.prototype.__register=function(t,e){this.entitiesById[t]!==e&&(this.entitiesById[t]=e,this.entitiesList.push(e));var n=this.previousServerIds[t],r=e.serverId;n&&n!==r&&(delete this.entitiesByServerId[n],r===t?delete this.previousServerIds[t]:(this.entitiesByServerId[r]=e,this.previousServerIds[t]=r)),n||r===t||(this.entitiesByServerId[r]=e,this.previousServerIds[t]=r)},e.prototype.__unregister=function(t,e){delete this.entitiesById[t],o.a.pull(this.entitiesList,e),t in this.transientAttrsStore&&delete this.transientAttrsStore[t];var n=this.previousServerIds[t];n&&(delete this.entitiesByServerId[n],delete this.previousServerIds[t])},e.prototype.injectPlaceholder=function(t){var e=t.token||t[this.idAttribute];if(this.get(e))return this.inject(t);var n=this.createInstance(t);return Object.defineProperty(n,"$placeholder",{value:!0,configurable:!0}),this.inject(n)},e.prototype.removePlaceholder=function(t){var e=t.entity,n=t.attrs;e&&e.$placeholder&&(n?(delete e.$placeholder,delete e.$notFound,this.inject(e)):(Object.defineProperty(e,"$notFound",{value:!0,configurable:!0}),this.inject(e)))},e.prototype.touch=function(t){var e;t=this.resolveId(t),(this.entitiesById[t]||this.entitiesByServerId[t])&&this.inject(((e={})[this.idAttribute]=t,e))},e.prototype.__addToHasManyRelationships=function(t){this.__updateRelationsIfNeeded(t,"add")},e.prototype.__removeFromHasManyRelationships=function(t){this.__updateRelationsIfNeeded(t,"remove")},e.prototype.__updateRelationsIfNeeded=function(e,n){var r=this,i=this.store.getParentRelationshipsOfModel(this.name);if(i){this.hasManySortFields||(this.hasManySortFields=y.a.call(u.a.call(i.map((function(t){var e=t.sortBy;return e&&e.map((function(t){return t[0]}))})).filter(Boolean)).concat([this.idAttribute])));var s=o.a.has(this.previousHasManySortValues,e[this.idAttribute])?this.previousHasManySortValues[e[this.idAttribute]]:S;this.previousHasManySortValues[e[this.idAttribute]]=o.a.pick(e,this.hasManySortFields),i.forEach((function(o){var i=o.filter,a=o.foreignKey,u=o.relationKey,c=o.sortBy,l=o.sorted,d=r.store.get(o.parent,e[a]);if(d&&d.$$transientAttrs.relations&&d.$$transientAttrs.relations[u]){var f=!1;if("remove"===n||i&&!i(e,d))if(c){var h=[],p=0;if((T=r.options.host).config.condensedReplays&&R(o.parent,u)){var v=P(d[u],0,{previousValue:s===S?void 0:s}),y=v.copy,g=v.duplicateCount,m=v.outOfOrder,_=v.outOfOrderElements;h=y,p=g,m&&(x(h,e,_,{action:"__updateRelationsIfNeeded action:remove - sorted.remove",previousValue:s===S?void 0:s,source:"Elements are out of order in "+o.parent+"."+u}),d[u].sort(l.cmp))}if(f=s===S?l.remove(d[u],e):l.remove(d[u],e,{previousValue:s}),T.config.condensedReplays&&!C.updateRelationsRemove&&R(o.parent,u)){var b=j(h,p,d[u],e,{action:"__updateRelationsIfNeeded action:remove - sorted.remove",previousValue:s===S?void 0:s,source:"There are duplicates in "+o.parent+"."+u}),w=b.logged,I=b.currCopy,O=b.counts;C.updateRelationsRemove=w,w&&(t.duplicateDebug.updateRelations.remove={beforeElements:h,afterElements:I,counts:O})}}else{var E=d[u].indexOf(e);-1!==E&&(d[u].splice(E,1),f=!0)}else if("add"===n)if(c){var T;h=[],p=0;if((T=r.options.host).config.condensedReplays&&R(o.parent,u)){var A=P(d[u],0,{previousValue:s===S?void 0:s});y=A.copy,g=A.duplicateCount,m=A.outOfOrder,_=A.outOfOrderElements;h=y,p=g,m&&(x(h,e,_,{action:"__updateRelationsIfNeeded action:add - sorted.update",previousValue:s===S?void 0:s,source:"Elements are out of order in "+o.parent+"."+u}),d[u].sort(l.cmp))}if(f=s===S?l.update(d[u],e):l.update(d[u],e,{previousValue:s}),T.config.condensedReplays&&!C.updateRelationsAdd&&R(o.parent,u)){var M=j(h,p,d[u],e,{action:"__updateRelationsIfNeeded action:add - sorted.update",previousValue:s===S?void 0:s,source:"There are duplicates in "+o.parent+"."+u});w=M.logged,I=M.currCopy,O=M.counts;C.updateRelationsAdd=w,w&&(t.duplicateDebug.updateRelations.add={beforeElements:h,afterElements:I,counts:O})}}else d[u].includes(e)||(d[u].push(e),f=!0);d.$$transientAttrs.$$wasUpdatedByRelation||(d.$$transientAttrs.$$wasUpdatedByRelation=f)}}))}},e.prototype.ejectAll=function(){for(;this.entitiesList.length>0;)this.eject(this.entitiesList[0])},e.prototype.parseAttrs=function(t){var e=this,n=o.a.pickBy(t,(function(t){return e.store.isEntity(t)||e.store.isEntityArray(t)})),r=o.a.pick(t,this.options.transientAttrs),i=o.a.omit(t,Object.keys(n),this.options.transientAttrs),s=this.options.parseAttrs(Object(O.l)(i));return E(E(E({},s),n),r)},e.prototype.getAll=function(){return this.entitiesList},e.prototype.getMulti=function(t){return t.map(this.get)},e.prototype.resolveId=function(t){return this.isValidId(t)?t:t[this.idAttribute]},e.prototype.isValidId=function(t){return"string"==typeof t||"number"==typeof t},e.prototype.is=function(t){return t&&t.$entityClass===this},e}();Object.assign(M.prototype,I.a.prototype);var k=function(){function t(t){var e=this;void 0===t&&(t={}),this.options=t,this.models={},this.__relationsOfHasManyByContainedItem={};["filter","get","getAll","inject","injectPlaceholder","is","resolveId"].forEach((function(t){e[t]=function(n){for(var r,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return(r=e.models[n])[t].apply(r,o)}}))}return t.prototype.defineModel=function(t,e){var n=this;if(void 0===e&&(e={}),this.models[t])throw new Error(t+" already defined");e=E(E({},this.options),e),this.models[t]=M.create(this,t,e);var r=this.models[t].options.relations.hasMany;return o.a.isEmpty(r)||o.a.each(r,(function(e,r){var o=e.sortBy,i=e.type,s=n.models[t].__getSorted(o);n.__relationsOfHasManyByContainedItem[i]||(n.__relationsOfHasManyByContainedItem[i]=[]),n.__relationsOfHasManyByContainedItem[i].push(E(E({},e),{relationKey:r,sorted:s,parent:t}))})),this.models[t]},t.prototype.getParentRelationshipsOfModel=function(t){return this.__relationsOfHasManyByContainedItem[t]},t.prototype.isEntity=function(t){return t&&t.$entityClass&&t.$entityClass.constructor===M},t.prototype.isEntityArray=function(t){return t&&Array.isArray(t)&&t.some(this.isEntity)},t.prototype.clear=function(){o.a.values(this.models).forEach((function(t){return t.ejectAll()}))},t}();e.a=k}).call(this,n(7))},function(t,e,n){"use strict";var r=n(472);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";var r=n(55);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t,e,n){"use strict";var r=n(475);t.exports=function(){return r.apply(void 0,[this].concat(Array.prototype.slice.apply(arguments)))}},function(t){t.exports=JSON.parse('{"name":"tigerconnect","private":true,"version":"12.5.0beta2","description":"JS (web and node) SDK for TigerConnect","homepage":"https://tigerconnect.github.io/js-sdk/","repository":"tigerconnect/js-sdk","author":{"name":"TigerConnect Developers","email":"developersupport@tigerconnect.com","url":"https://tigerconnect.github.io/js-sdk/"},"main":"lib/index.js","keywords":["tigerconnect","tigertext","communications","messenger","sdk"],"scripts":{"build:clean":"shx rm -fr lib dist","build:js":"babel -d lib/ src/","build:travis":"run-s lint coverage:test build","build:webpack":"webpack","build:webpack:node":"webpack --target node","build":"run-p build:clean build:webpack","build:node":"run-s build:webpack:node","coverage":"run-s coverage:clean coverage:test coverage:report:html","coverage:check":"nyc check-coverage","coverage:clean":"shx rm -fr .nyc_output","coverage:open":"open-cli coverage/index.html","coverage:report":"run-s coverage:report:*","coverage:report:codecov":"nyc report --reporter=lcov > coverage.lcov && codecov","coverage:report:html":"shx rm -fr coverage && nyc report --reporter=html","coverage:test":"cross-env jest --collectCoverage test/**/*.test.ts  > coverage.lcov && codecov","coverage:travis":"run-s coverage:test coverage:report coverage:check","deploy:docs":"gulp npm:publish:docs:prepare","deps":"npm-check -s","deps:update":"npm-check -u","lint":"eslint ./src --ext .js,.ts,.tsx","lint:fix":"eslint ./src --ext .js,.ts,.tsx --fix","test":"mocha \\"test/**/*.test.js\\"","watch":"run-s build:clean && gulp build:js && run-p watch:js watch:webpack","watch:js":"gulp watch:js","watch:test":"npm test -- -w","watch:webpack":"webpack --watch","test:jest":"jest test/**/*.test.ts --watch","tsc":"tsc --project tsconfig.json"},"husky":{"hooks":{"pre-commit":"lint-staged","pre-push":"./hooks/pre-push"}},"lint-staged":{"*":["pretty-quick --staged"]},"jest":{"collectCoverageFrom":["src/**/*.ts","!<rootDir>/node_modules/**","!<rootDir>/src/**/*.d.ts"],"coverageThreshold":{"global":{"statements":10,"branches":3,"lines":11,"functions":12}}},"dependencies":{"@tigerconnect/node-fetch":"^2.6.0-tc1","abortcontroller-polyfill":"^1.3.0","btoa":"^1.1.2","events":"^3.1.0","file-saver":"^1.3.3","file-type":"^4.0.0","humanize-list":"^1.0.1","invariant":"^2.2.2","is-email":"^1.0.0","jshashes":"^1.0.7","lodash":"^4.17.15","lodash-bound":"^1.1.2","lodash.throttle":"^4.1.1","maltypart":"^1.5.0","mime":"^1.6.0","moment":"^2.24.0","promise":"^8.0.3","raf":"^3.4.0","request":"^2.88.0","reuse-promise":"^1.1.0","shallowequal":"^0.2.2","sorted-array-functions":"^1.1.0","superagent":"^5.1.0","superagent-prefix":"0.0.2","uuid":"^3.0.0","visibilityjs":"^2.0.2"},"devDependencies":{"@babel/core":"^7.11.6","@babel/plugin-proposal-class-properties":"^7.10.4","@babel/plugin-proposal-decorators":"^7.10.5","@babel/plugin-proposal-function-bind":"^7.11.5","@babel/plugin-proposal-object-rest-spread":"^7.11.0","@babel/plugin-syntax-flow":"^7.10.4","@babel/plugin-transform-flow-strip-types":"^7.10.4","@babel/plugin-transform-runtime":"^7.11.5","@babel/preset-env":"^7.11.5","@babel/preset-es2015":"^7.0.0-beta.53","@babel/preset-typescript":"^7.10.4","@babel/register":"^7.11.5","@types/events":"^3.0.0","@types/jest":"^26.0.14","@types/lodash":"^4.14.161","@types/node":"^14.11.5","@typescript-eslint/eslint-plugin":"^4.3.0","@typescript-eslint/parser":"^4.3.0","assets-webpack-plugin":"^4.0.0","awesome-typescript-loader":"^5.2.1","babel-eslint":"^10.1.0","babel-jest":"^26.3.0","babel-loader":"^8.1.0","babel-plugin-istanbul":"^6.0.0","busboy":"^0.2.14","chai":"^4.2.0","chai-as-promised":"^7.1.1","chai-deep-match":"^1.2.1","codecov":"^3.6.5","core-js":"^3.2.1","cross-env":"^3.2.4","decache":"^4.1.0","dom-storage":"^2.0.2","eslint":"^7.10.0","eslint-config-prettier":"^6.11.0","eslint-config-react-app":"^5.2.1","eslint-plugin-flowtype":"^5.2.0","eslint-plugin-import":"^2.22.0","eslint-plugin-jsx-a11y":"^6.3.1","eslint-plugin-prettier":"^3.1.4","eslint-plugin-react":"^7.21.2","eslint-plugin-react-hooks":"^4.1.2","gulp":"^4.0.2","gulp-babel":"^8.0.0","gulp-changed":"^4.0.1","gulp-debug":"^4.0.0","gulp-file":"^0.4.0","gulp-if":"^3.0.0","gulp-load-plugins":"^2.0.1","gulp-plumber":"^1.2.1","gulp-uglify":"^3.0.2","gulp-watch":"^5.0.1","husky":"^3.0.3","jest":"^26.4.2","jsdom":"^15.1.1","jsdom-global":"^3.0.2","json-loader":"^0.5.4","lint-staged":"^10.3.0","lodash-webpack-plugin":"^0.11.2","mocha":"^7.2.0","mocha-clean":"^1.0.0","nock":"^9.0.2","npm-check":"^5.9.0","npm-run-all":"^4.0.2","nyc":"^15.1.0","open-cli":"^5.0.0","performance-now":"^2.0.0","prettier":"^2.1.2","pretty-quick":"^3.0.2","promisify-child-process":"^3.1.1","shelljs":"^0.8.4","shx":"^0.3.3","sinon":"^7.4.1","sinon-chai":"^3.3.0","source-map-loader":"^1.1.0","strip-loader":"^0.1.2","timekeeper":"1.0.0","tslint":"^6.1.3","tslint-loader":"^3.5.4","typescript":"^4.0.3","watch":"^1.0.1","webpack":"^4.44.2","webpack-cli":"^3.3.12","webpack-node-externals":"^1.5.4","webpack-utf8-bom":"^1.2.0","yargs":"^6.4.0"},"eslintConfig":{"extends":["react-app","prettier"],"globals":{"__SDK_VERSION__":"readonly","__DEV__":"readonly"},"plugins":["react","prettier"],"rules":{"prettier/prettier":"error"}},"prettier":{"arrowParens":"always","bracketSpacing":true,"jsxBracketSameLine":false,"jsxSingleQuote":false,"printWidth":100,"proseWrap":"always","quoteProps":"as-needed","semi":true,"singleQuote":true,"tabWidth":2,"trailingComma":"es5","useTabs":false},"license":{"type":"Commercial","url":"https://tigerconnect.com/terms/end-user-terms-use-license-agreement/"}}')},function(t,e,n){"use strict";for(var r={},o=0,i=["\n","\r"," ",":"];o<i.length;o++){var s=i[o];r[s]=s.charCodeAt(0)}var a,u=r,c=function(t){this.type=t,this.target=void 0},l=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(e,n){var r=n.headers,o=n.message,i=n.status,s=n.statusText,a=t.call(this,e)||this;return a.headers=r,a.message=o,a.status=i,a.statusText=s,a}return l(e,t),e}(c),f=n(8),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t){function e(e,n){var r=t.call(this,e)||this;return r.data=n.data,r.lastEventId=n.lastEventId,r}return h(e,t),e}(c),v={AFTER_CR:-1,FIELD_START:0,FIELD:1,VALUE_START:2,VALUE:3},y=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},g=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},m=/^text\/event-stream?(\s*charset=utf-8)?$/i,_=function(){function t(t){var e=t.RequestClass,n=t.dispatchEvent,r=t.headers,o=t.lastEventId,i=void 0===o?"":o,s=t.onError,a=t.onMessage,u=t.onOpen,c=t.onReadyStateChange,l=t.url,d=t.withCredentials;this.RequestClass=e,this.dispatchEvent=n,this.headers=r,this.lastEventId=i,this.onError=s,this.onMessage=a,this.onOpen=u,this.onReadyStateChange=c,this.url=l,this.withCredentials=d,this.currentState=f.a.WAITING,this.parserState={dataBuffer:"",eventTypeBuffer:"",fieldStart:0,lastEventIdBuffer:i,state:v.FIELD_START,textBuffer:"",valueStart:0},this.request=void 0}return t.prototype.start=function(){return y(this,void 0,void 0,(function(){var t,e,n,r,o,i,s,a,u,c,l=this;return g(this,(function(d){switch(d.label){case 0:if(this.onReadyStateChange(f.a.CONNECTING),this.currentState=f.a.CONNECTING,e=(t=this).url,n=t.withCredentials,"data:"!==e.slice(0,5)&&"blob:"!==e.slice(0,5)&&(e+=-1===e.indexOf("?")?"?":"&",e+="lastEventId="+encodeURIComponent(this.lastEventId)),(r={}).Accept="text/event-stream",this.headers)for(o=0,i=Object.entries(this.headers);o<i.length;o++)s=i[o],a=s[0],u=s[1],r[a]=u;d.label=1;case 1:return d.trys.push([1,3,,4]),this.request=new this.RequestClass({headers:r,onProgress:function(t){return l.onProgress(t)},onStart:function(t){return l.onStart(t)},url:e,withCredentials:n}),[4,this.request.fetch()];case 2:throw d.sent(),new Error("Connection closed by server");case 3:return c=d.sent(),this.request.isAborted?[2]:(this.close(),this.onFinish(c),[3,4]);case 4:return[2]}}))}))},t.prototype.onStart=function(t){var e=t.contentType,n=t.headers,r=t.status,o=t.statusText;if(this.currentState===f.a.CONNECTING)if(200===r&&e&&m.test(e)){this.currentState=f.a.OPEN,this.onReadyStateChange(f.a.OPEN);var i=new d("open",{headers:n,status:r,statusText:o});this.dispatchEvent(i),this.onOpen(i)}else{var s="";200!==r?(o&&(o=o.replace(/\s+/g," ")),s="EventSource's response has a status "+r+" "+o+" that is not 200. Aborting the connection."):s="EventSource's response has a Content-Type specifying an unsupported type: "+(e?"-":e.replace(/\s+/g," "))+". Aborting the connection.";var a=new d("error",{headers:n,message:s,status:r,statusText:o});this.close(),this.dispatchEvent(a),this.onError(a)}},t.prototype.onProgress=function(t){if(this.currentState===f.a.OPEN){for(var e=this.parserState,n=e.dataBuffer,r=e.eventTypeBuffer,o=e.fieldStart,i=e.lastEventIdBuffer,s=e.state,a=e.textBuffer,c=e.valueStart,l=-1,d=0;d<t.length;d+=1){(g=t.charCodeAt(d))!==u["\n"]&&g!==u["\r"]||(l=d)}var h=(-1!==l?a:"")+t.slice(0,l+1);a=(-1===l?a:"")+t.slice(l+1);for(var y=0;y<h.length;y+=1){var g=h.charCodeAt(y);if(s!==v.AFTER_CR||g!==u["\n"])if(s===v.AFTER_CR&&(s=v.FIELD_START),g===u["\n"]||g===u["\r"]){if(s!==v.FIELD_START){s===v.FIELD&&(c=y+1);var m=h.slice(o,c-1),_=c<y&&h.charCodeAt(c)===u[" "]?1:0,b=h.slice(c+_,y);"data"===m?(n+="\n",n+=b):"id"===m?i=b:"event"===m&&(r=b)}if(s===v.FIELD_START){if(""!==n){this.lastEventId=i,""===r&&(r="message");var w=new p(r,{data:n.slice(1),lastEventId:i});if(this.dispatchEvent(w),"message"===r&&this.onMessage(w),this.currentState===f.a.CLOSED)return}n="",r=""}s=g===u["\r"]?v.AFTER_CR:v.FIELD_START}else s===v.FIELD_START&&(o=y,s=v.FIELD),s===v.FIELD?g===u[":"]&&(c=y+1,s=v.VALUE_START):s===v.VALUE_START&&(s=v.VALUE);else s=v.FIELD_START}this.parserState={dataBuffer:n,eventTypeBuffer:r,fieldStart:o,lastEventIdBuffer:i,state:s,textBuffer:a,valueStart:c}}},t.prototype.onFinish=function(t){var e=new c("error");t&&(e.message=t.message,e.stack=t.stack),this.dispatchEvent(e),this.onError(e)},t.prototype.close=function(){return y(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return this.currentState=f.a.CLOSED,this.onReadyStateChange(f.a.CLOSED),!this.request||this.request.isAborted?[3,2]:[4,this.request.abort()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t}();e.a=_},function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"Client",(function(){return r})),t._babelPolyfill||!1===t._tcShouldPolyfill?n(298):n(214);n(299)("./web");var r=n(480).TigerConnectClient}.call(this,n(7))},function(t,e,n){"use strict";var r=(0,n(215).getGlobals)();n(216),n(226),n(241),n(244),n(248),n(251),n(254),n(258),n(261),n(264),!(window&&window.navigator.userAgent.includes("Trident/"))&&"undefined"!=typeof Promise&&"finally"in Promise.prototype||(n(293).enable(),r.Promise=n(295)),n(296),n(297)},function(t,e,n){"use strict";(function(e){t.exports={getGlobals:function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}}}).call(this,n(7))},function(t,e,n){t.exports=n(217)},function(t,e,n){n(218);var r=n(51);t.exports=r("Array","find")},function(t,e,n){"use strict";var r=n(15),o=n(137).find,i=n(140),s=!0;"find"in[]&&Array(1).find((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("find")},function(t,e,n){var r=n(14),o=n(132),i=r.WeakMap;t.exports="function"==typeof i&&/native code/.test(o.call(i))},function(t,e,n){var r=n(134),o=n(100),i=n(103),s=n(33);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(s(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(101),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},function(t,e,n){var r=n(21),o=/#|\.prototype\./,i=function(t,e){var n=a[s(t)];return n==c||n!=u&&("function"==typeof e?r(e):!!e)},s=i.normalize=function(t){return String(t).replace(o,".").toLowerCase()},a=i.data={},u=i.NATIVE="N",c=i.POLYFILL="P";t.exports=i},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){var r=n(26),o=n(31),i=n(33),s=n(72);t.exports=r?Object.defineProperties:function(t,e){i(t);for(var n,r=s(e),a=r.length,u=0;a>u;)o.f(t,n=r[u++],e[n]);return t}},function(t,e,n){var r=n(134);t.exports=r("document","documentElement")},function(t,e,n){t.exports=n(227)},function(t,e,n){n(228),n(235);var r=n(34);t.exports=r.Array.from},function(t,e,n){"use strict";var r=n(229).charAt,o=n(98),i=n(230),s=o.set,a=o.getterFor("String Iterator");i(String,"String",(function(t){s(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=a(this),n=e.string,o=e.index;return o>=n.length?{value:void 0,done:!0}:(t=r(n,o),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(101),o=n(42),i=function(t){return function(e,n){var i,s,a=String(o(e)),u=r(n),c=a.length;return u<0||u>=c?t?"":void 0:(i=a.charCodeAt(u))<55296||i>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):i:t?a.slice(u,u+2):s-56320+(i-55296<<10)+65536}};t.exports={codeAt:i(!1),charAt:i(!0)}},function(t,e,n){"use strict";var r=n(15),o=n(231),i=n(142),s=n(233),a=n(52),u=n(30),c=n(68),l=n(12),d=n(69),f=n(73),h=n(141),p=h.IteratorPrototype,v=h.BUGGY_SAFARI_ITERATORS,y=l("iterator"),g=function(){return this};t.exports=function(t,e,n,l,h,m,_){o(n,e,l);var b,w,I,O=function(t){if(t===h&&C)return C;if(!v&&t in S)return S[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},E=e+" Iterator",T=!1,S=t.prototype,A=S[y]||S["@@iterator"]||h&&S[h],C=!v&&A||O(h),R="Array"==e&&S.entries||A;if(R&&(b=i(R.call(new t)),p!==Object.prototype&&b.next&&(d||i(b)===p||(s?s(b,p):"function"!=typeof b[y]&&u(b,y,g)),a(b,E,!0,!0),d&&(f[E]=g))),"values"==h&&A&&"values"!==A.name&&(T=!0,C=function(){return A.call(this)}),d&&!_||S[y]===C||u(S,y,C),f[e]=C,h)if(w={values:O("values"),keys:m?C:O("keys"),entries:O("entries")},_)for(I in w)(v||T||!(I in S))&&c(S,I,w[I]);else r({target:e,proto:!0,forced:v||T},w);return w}},function(t,e,n){"use strict";var r=n(141).IteratorPrototype,o=n(106),i=n(49),s=n(52),a=n(73),u=function(){return this};t.exports=function(t,e,n){var c=e+" Iterator";return t.prototype=o(r,{next:i(1,n)}),s(t,c,!1,!0),a[c]=u,t}},function(t,e,n){var r=n(21);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var r=n(33),o=n(234);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,i){return r(n),o(i),e?t.call(n,i):n.__proto__=i,n}}():void 0)},function(t,e,n){var r=n(22);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){var r=n(15),o=n(236);r({target:"Array",stat:!0,forced:!n(240)((function(t){Array.from(t)}))},{from:o})},function(t,e,n){"use strict";var r=n(104),o=n(44),i=n(237),s=n(238),a=n(43),u=n(143),c=n(239);t.exports=function(t){var e,n,l,d,f=o(t),h="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,y=void 0!==v,g=0,m=c(f);if(y&&(v=r(v,p>2?arguments[2]:void 0,2)),null==m||h==Array&&s(m))for(n=new h(e=a(f.length));e>g;g++)u(n,g,y?v(f[g],g):f[g]);else for(d=m.call(f),n=new h;!(l=d.next()).done;g++)u(n,g,y?i(d,v,[l.value,g],!0):l.value);return n.length=g,n}},function(t,e,n){var r=n(33);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&r(i.call(t)),e}}},function(t,e,n){var r=n(12),o=n(73),i=r("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||s[i]===t)}},function(t,e,n){var r=n(144),o=n(73),i=n(12)("iterator");t.exports=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(12)("iterator"),o=!1;try{var i=0,s={next:function(){return{done:!!i++}},return:function(){o=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(t){}return n}},function(t,e,n){t.exports=n(242)},function(t,e,n){n(243);var r=n(51);t.exports=r("Array","includes")},function(t,e,n){"use strict";var r=n(15),o=n(136).includes,i=n(140);r({target:"Array",proto:!0},{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("includes")},function(t,e,n){t.exports=n(245)},function(t,e,n){n(246);var r=n(34);t.exports=r.Object.assign},function(t,e,n){var r=n(15),o=n(247);r({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(t,e,n){"use strict";var r=n(26),o=n(21),i=n(72),s=n(103),a=n(65),u=n(44),c=n(96),l=Object.assign;t.exports=!l||o((function(){var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=l({},t)[n]||"abcdefghijklmnopqrst"!=i(l({},e)).join("")}))?function(t,e){for(var n=u(t),o=arguments.length,l=1,d=s.f,f=a.f;o>l;)for(var h,p=c(arguments[l++]),v=d?i(p).concat(d(p)):i(p),y=v.length,g=0;y>g;)h=v[g++],r&&!f.call(p,h)||(n[h]=p[h]);return n}:l},function(t,e,n){t.exports=n(249)},function(t,e,n){n(250);var r=n(34);t.exports=r.Object.entries},function(t,e,n){var r=n(15),o=n(145).entries;r({target:"Object",stat:!0},{entries:function(t){return o(t)}})},function(t,e,n){t.exports=n(252)},function(t,e,n){n(253);var r=n(34);t.exports=r.Object.values},function(t,e,n){var r=n(15),o=n(145).values;r({target:"Object",stat:!0},{values:function(t){return o(t)}})},function(t,e,n){t.exports=n(255)},function(t,e,n){n(256);var r=n(51);t.exports=r("String","endsWith")},function(t,e,n){"use strict";var r=n(15),o=n(43),i=n(107),s=n(42),a=n(108),u="".endsWith,c=Math.min;r({target:"String",proto:!0,forced:!a("endsWith")},{endsWith:function(t){var e=String(s(this));i(t);var n=arguments.length>1?arguments[1]:void 0,r=o(e.length),a=void 0===n?r:c(o(n),r),l=String(t);return u?u.call(e,l,a):e.slice(a-l.length,a)===l}})},function(t,e,n){var r=n(22),o=n(66),i=n(12)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==o(t))}},function(t,e,n){t.exports=n(259)},function(t,e,n){n(260);var r=n(51);t.exports=r("String","includes")},function(t,e,n){"use strict";var r=n(15),o=n(107),i=n(42);r({target:"String",proto:!0,forced:!n(108)("includes")},{includes:function(t){return!!~String(i(this)).indexOf(o(t),arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){t.exports=n(262)},function(t,e,n){n(263);var r=n(51);t.exports=r("String","startsWith")},function(t,e,n){"use strict";var r=n(15),o=n(43),i=n(107),s=n(42),a=n(108),u="".startsWith,c=Math.min;r({target:"String",proto:!0,forced:!a("startsWith")},{startsWith:function(t){var e=String(s(this));i(t);var n=o(c(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return u?u.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){t.exports=n(265),n(288),n(289),n(290),n(291),n(292)},function(t,e,n){n(266),n(268),n(270),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287);var r=n(34);t.exports=r.Symbol},function(t,e,n){"use strict";var r=n(15),o=n(21),i=n(105),s=n(22),a=n(44),u=n(43),c=n(143),l=n(138),d=n(267),f=n(12)("isConcatSpreadable"),h=!o((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),p=d("concat"),v=function(t){if(!s(t))return!1;var e=t[f];return void 0!==e?!!e:i(t)};r({target:"Array",proto:!0,forced:!h||!p},{concat:function(t){var e,n,r,o,i,s=a(this),d=l(s,0),f=0;for(e=-1,r=arguments.length;e<r;e++)if(v(i=-1===e?s:arguments[e])){if(f+(o=u(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,f++)n in i&&c(d,f,i[n])}else{if(f>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(d,f++,i)}return d.length=f,d}})},function(t,e,n){var r=n(21),o=n(12)("species");t.exports=function(t){return!r((function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},function(t,e,n){var r=n(68),o=n(269),i=Object.prototype;o!==i.toString&&r(i,"toString",o,{unsafe:!0})},function(t,e,n){"use strict";var r=n(144),o={};o[n(12)("toStringTag")]="z",t.exports="[object z]"!==String(o)?function(){return"[object "+r(this)+"]"}:o.toString},function(t,e,n){"use strict";var r=n(15),o=n(14),i=n(69),s=n(26),a=n(139),u=n(21),c=n(17),l=n(105),d=n(22),f=n(33),h=n(44),p=n(41),v=n(67),y=n(49),g=n(106),m=n(72),_=n(100),b=n(271),w=n(103),I=n(95),O=n(31),E=n(65),T=n(30),S=n(68),A=n(50),C=n(70),R=n(71),P=n(99),j=n(12),x=n(146),M=n(9),k=n(52),N=n(98),z=n(137).forEach,D=C("hidden"),U=j("toPrimitive"),L=N.set,F=N.getterFor("Symbol"),B=Object.prototype,q=o.Symbol,V=o.JSON,G=V&&V.stringify,H=I.f,W=O.f,Y=b.f,K=E.f,$=A("symbols"),X=A("op-symbols"),Q=A("string-to-symbol-registry"),Z=A("symbol-to-string-registry"),J=A("wks"),tt=o.QObject,et=!tt||!tt.prototype||!tt.prototype.findChild,nt=s&&u((function(){return 7!=g(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=H(B,e);r&&delete B[e],W(t,e,n),r&&t!==B&&W(B,e,r)}:W,rt=function(t,e){var n=$[t]=g(q.prototype);return L(n,{type:"Symbol",tag:t,description:e}),s||(n.description=e),n},ot=a&&"symbol"==typeof q.iterator?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof q},it=function(t,e,n){t===B&&it(X,e,n),f(t);var r=v(e,!0);return f(n),c($,r)?(n.enumerable?(c(t,D)&&t[D][r]&&(t[D][r]=!1),n=g(n,{enumerable:y(0,!1)})):(c(t,D)||W(t,D,y(1,{})),t[D][r]=!0),nt(t,r,n)):W(t,r,n)},st=function(t,e){f(t);var n=p(e),r=m(n).concat(lt(n));return z(r,(function(e){s&&!at.call(n,e)||it(t,e,n[e])})),t},at=function(t){var e=v(t,!0),n=K.call(this,e);return!(this===B&&c($,e)&&!c(X,e))&&(!(n||!c(this,e)||!c($,e)||c(this,D)&&this[D][e])||n)},ut=function(t,e){var n=p(t),r=v(e,!0);if(n!==B||!c($,r)||c(X,r)){var o=H(n,r);return!o||!c($,r)||c(n,D)&&n[D][r]||(o.enumerable=!0),o}},ct=function(t){var e=Y(p(t)),n=[];return z(e,(function(t){c($,t)||c(R,t)||n.push(t)})),n},lt=function(t){var e=t===B,n=Y(e?X:p(t)),r=[];return z(n,(function(t){!c($,t)||e&&!c(B,t)||r.push($[t])})),r};a||(S((q=function(){if(this instanceof q)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=P(t),n=function(t){this===B&&n.call(X,t),c(this,D)&&c(this[D],e)&&(this[D][e]=!1),nt(this,e,y(1,t))};return s&&et&&nt(B,e,{configurable:!0,set:n}),rt(e,t)}).prototype,"toString",(function(){return F(this).tag})),E.f=at,O.f=it,I.f=ut,_.f=b.f=ct,w.f=lt,s&&(W(q.prototype,"description",{configurable:!0,get:function(){return F(this).description}}),i||S(B,"propertyIsEnumerable",at,{unsafe:!0})),x.f=function(t){return rt(j(t),t)}),r({global:!0,wrap:!0,forced:!a,sham:!a},{Symbol:q}),z(m(J),(function(t){M(t)})),r({target:"Symbol",stat:!0,forced:!a},{for:function(t){var e=String(t);if(c(Q,e))return Q[e];var n=q(e);return Q[e]=n,Z[n]=e,n},keyFor:function(t){if(!ot(t))throw TypeError(t+" is not a symbol");if(c(Z,t))return Z[t]},useSetter:function(){et=!0},useSimple:function(){et=!1}}),r({target:"Object",stat:!0,forced:!a,sham:!s},{create:function(t,e){return void 0===e?g(t):st(g(t),e)},defineProperty:it,defineProperties:st,getOwnPropertyDescriptor:ut}),r({target:"Object",stat:!0,forced:!a},{getOwnPropertyNames:ct,getOwnPropertySymbols:lt}),r({target:"Object",stat:!0,forced:u((function(){w.f(1)}))},{getOwnPropertySymbols:function(t){return w.f(h(t))}}),V&&r({target:"JSON",stat:!0,forced:!a||u((function(){var t=q();return"[null]"!=G([t])||"{}"!=G({a:t})||"{}"!=G(Object(t))}))},{stringify:function(t){for(var e,n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=e=r[1],(d(e)||void 0!==t)&&!ot(t))return l(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!ot(e))return e}),r[1]=e,G.apply(V,r)}}),q.prototype[U]||T(q.prototype,U,q.prototype.valueOf),k(q,"Symbol"),R[D]=!0},function(t,e,n){var r=n(41),o=n(100).f,i={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==i.call(t)?function(t){try{return o(t)}catch(t){return s.slice()}}(t):o(r(t))}},function(t,e,n){n(9)("asyncIterator")},function(t,e,n){"use strict";var r=n(15),o=n(26),i=n(14),s=n(17),a=n(22),u=n(31).f,c=n(133),l=i.Symbol;if(o&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var d={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new l(t):void 0===t?l():l(t);return""===t&&(d[e]=!0),e};c(f,l);var h=f.prototype=l.prototype;h.constructor=f;var p=h.toString,v="Symbol(test)"==String(l("test")),y=/^Symbol\((.*)\)[^)]+$/;u(h,"description",{configurable:!0,get:function(){var t=a(this)?this.valueOf():this,e=p.call(t);if(s(d,t))return"";var n=v?e.slice(7,-1):e.replace(y,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:f})}},function(t,e,n){n(9)("hasInstance")},function(t,e,n){n(9)("isConcatSpreadable")},function(t,e,n){n(9)("iterator")},function(t,e,n){n(9)("match")},function(t,e,n){n(9)("matchAll")},function(t,e,n){n(9)("replace")},function(t,e,n){n(9)("search")},function(t,e,n){n(9)("species")},function(t,e,n){n(9)("split")},function(t,e,n){n(9)("toPrimitive")},function(t,e,n){n(9)("toStringTag")},function(t,e,n){n(9)("unscopables")},function(t,e,n){n(52)(Math,"Math",!0)},function(t,e,n){var r=n(14);n(52)(r.JSON,"JSON",!0)},function(t,e,n){n(9)("asyncDispose")},function(t,e,n){n(9)("dispose")},function(t,e,n){n(9)("observable")},function(t,e,n){n(9)("patternMatch")},function(t,e,n){n(9)("replaceAll")},function(t,e,n){"use strict";var r=n(147),o=[ReferenceError,TypeError,RangeError],i=!1;function s(){i=!1,r._l=null,r._m=null}function a(t,e){return e.some((function(e){return t instanceof e}))}e.disable=s,e.enable=function(t){t=t||{},i&&s();i=!0;var e=0,n=0,u={};function c(e){(t.allRejections||a(u[e].error,t.whitelist||o))&&(u[e].displayId=n++,t.onUnhandled?(u[e].logged=!0,t.onUnhandled(u[e].displayId,u[e].error)):(u[e].logged=!0,function(t,e){console.warn("Possible Unhandled Promise Rejection (id: "+t+"):"),((e&&(e.stack||e))+"").split("\n").forEach((function(t){console.warn("  "+t)}))}(u[e].displayId,u[e].error)))}r._l=function(e){2===e._i&&u[e._o]&&(u[e._o].logged?function(e){u[e].logged&&(t.onHandled?t.onHandled(u[e].displayId,u[e].error):u[e].onUnhandled||(console.warn("Promise Rejection Handled (id: "+u[e].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+u[e].displayId+".")))}(e._o):clearTimeout(u[e._o].timeout),delete u[e._o])},r._m=function(t,n){0===t._h&&(t._o=e++,u[t._o]={displayId:null,error:n,timeout:setTimeout(c.bind(null,t._o),a(n,o)?100:2e3),logged:!1})}}},function(t,e,n){"use strict";(function(e){function n(t){o.length||(r(),!0),o[o.length]=t}t.exports=n;var r,o=[],i=0;function s(){for(;i<o.length;){var t=i;if(i+=1,o[t].call(),i>1024){for(var e=0,n=o.length-i;e<n;e++)o[e]=o[e+i];o.length-=i,i=0}}o.length=0,i=0,!1}var a,u,c,l=void 0!==e?e:self,d=l.MutationObserver||l.WebKitMutationObserver;function f(t){return function(){var e=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(e),clearInterval(n),t()}}}"function"==typeof d?(a=1,u=new d(s),c=document.createTextNode(""),u.observe(c,{characterData:!0}),r=function(){a=-a,c.data=a}):r=f(s),n.requestFlush=r,n.makeRequestCallFromTimer=f}).call(this,n(7))},function(t,e,n){"use strict";var r=n(147);t.exports=r;var o=l(!0),i=l(!1),s=l(null),a=l(void 0),u=l(0),c=l("");function l(t){var e=new r(r._n);return e._i=1,e._j=t,e}r.resolve=function(t){if(t instanceof r)return t;if(null===t)return s;if(void 0===t)return a;if(!0===t)return o;if(!1===t)return i;if(0===t)return u;if(""===t)return c;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new r(e.bind(t))}catch(t){return new r((function(e,n){n(t)}))}return l(t)},r.all=function(t){var e=Array.prototype.slice.call(t);return new r((function(t,n){if(0===e.length)return t([]);var o=e.length;function i(s,a){if(a&&("object"==typeof a||"function"==typeof a)){if(a instanceof r&&a.then===r.prototype.then){for(;3===a._i;)a=a._j;return 1===a._i?i(s,a._j):(2===a._i&&n(a._j),void a.then((function(t){i(s,t)}),n))}var u=a.then;if("function"==typeof u)return void new r(u.bind(a)).then((function(t){i(s,t)}),n)}e[s]=a,0==--o&&t(e)}for(var s=0;s<e.length;s++)i(s,e[s])}))},r.reject=function(t){return new r((function(e,n){n(t)}))},r.race=function(t){return new r((function(e,n){t.forEach((function(t){r.resolve(t).then(e,n)}))}))},r.prototype.catch=function(t){return this.then(null,t)}},function(t,e,n){(function(r){var o,i;void 0===(i="function"==typeof(o=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}var u=function(){function e(){t(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(e,[{key:"addEventListener",value:function(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"removeEventListener",value:function(t,e){if(t in this.listeners)for(var n=this.listeners[t],r=0,o=n.length;r<o;r++)if(n[r]===e)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(t){var e=this;if(t.type in this.listeners){for(var n=function(n){setTimeout((function(){return n.call(e,t)}))},r=this.listeners[t.type],o=0,i=r.length;o<i;o++)n(r[o]);return!t.defaultPrevented}}}]),e}(),c=function(e){function r(){var e;return t(this,r),(e=function(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?s(t):e}(this,o(r).call(this))).listeners||u.call(s(e)),Object.defineProperty(s(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(s(e),"onabort",{value:null,writable:!0,configurable:!0}),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(r,e),n(r,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(t){"abort"===t.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,t)),a(o(r.prototype),"dispatchEvent",this).call(this,t)}}]),r}(u),l=function(){function e(){t(this,e),Object.defineProperty(this,"signal",{value:new c,writable:!0,configurable:!0})}return n(e,[{key:"abort",value:function(){var t;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(l.prototype[Symbol.toStringTag]="AbortController",c.prototype[Symbol.toStringTag]="AbortSignal"),function(t){(function(t){return t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof t.Request&&!t.Request.prototype.hasOwnProperty("signal")||!t.AbortController})(t)&&(t.AbortController=l,t.AbortSignal=c)}("undefined"!=typeof self?self:r)})?o.call(e,n,e,t):o)||(t.exports=i)}).call(this,n(7))},function(t,e,n){"use strict";!function(t){!function(e){var n={};if(n.searchParams="URLSearchParams"in t,n.iterable="Symbol"in t&&"iterator"in Symbol,n.blob="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),n.formData="FormData"in t,n.arrayBuffer="ArrayBuffer"in t,n.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(t){return t&&r.indexOf(Object.prototype.toString.call(t))>-1};function i(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function s(t){return"string"!=typeof t&&(t=String(t)),t}function a(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n.iterable&&(e[Symbol.iterator]=function(){return e}),e}function u(t){this.map={},t instanceof u?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function c(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function l(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function d(t){var e=new FileReader,n=l(e);return e.readAsArrayBuffer(t),n}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:n.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:n.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():n.arrayBuffer&&n.blob&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||o(t))?this._bodyArrayBuffer=f(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var t=c(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t,e,n,r=c(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=l(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(t,e){t=i(t),e=s(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},u.prototype.delete=function(t){delete this.map[i(t)]},u.prototype.get=function(t){return t=i(t),this.has(t)?this.map[t]:null},u.prototype.has=function(t){return this.map.hasOwnProperty(i(t))},u.prototype.set=function(t,e){this.map[i(t)]=s(e)},u.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},u.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),a(t)},u.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),a(t)},u.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),a(t)},n.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(t,e){var n,r,o=(e=e||{}).body;if(t instanceof v){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new u(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new u(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),p.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function y(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}})),e}function g(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new u(e.headers),this.url=e.url||"",this._initBody(t)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},h.call(v.prototype),h.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var m=[301,302,303,307,308];g.redirect=function(t,e){if(-1===m.indexOf(e))throw new RangeError("Invalid status code");return new g(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function _(t,r){return new Promise((function(o,i){var s=new v(t,r);if(s.signal&&s.signal.aborted)return i(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new u,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}})),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;o(new g(r,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&n.blob&&(a.responseType="blob"),s.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}_.polyfill=!0,t.fetch||(t.fetch=_,t.Headers=u,t.Request=v,t.Response=g),e.Headers=u,e.Request=v,e.Response=g,e.fetch=_}({})}("undefined"!=typeof self?self:this)},function(t,e,n){"use strict";if(!("find"in Array.prototype))throw new Error("Missing polyfill for Array.find");if(!("from"in Array))throw new Error("Missing polyfill for Array.from");if(!("includes"in Array.prototype))throw new Error("Missing polyfill for Array.includes");if(!("assign"in Object))throw new Error("Missing polyfill for Object.assign");if(!("entries"in Object))throw new Error("Missing polyfill for Object.entries");if(!("values"in Object))throw new Error("Missing polyfill for Object.values");if(!("endsWith"in String.prototype))throw new Error("Missing polyfill for String.endsWith");if(!("includes"in String.prototype))throw new Error("Missing polyfill for String.includes");if("undefined"==typeof Symbol)throw new Error("Missing polyfill for Symbol");if("undefined"==typeof Promise)throw new Error("Missing polyfill for Promise");if(!("finally"in Promise.prototype))throw new Error("Missing polyfill for Promise.finally");if("undefined"==typeof AbortController)throw new Error("Missing polyfill for AbortController");if("undefined"==typeof fetch)throw new Error("Missing polyfill for fetch");if("undefined"==typeof Headers)throw new Error("Missing polyfill for Headers (part of fetch polyfill)");if("undefined"==typeof Request)throw new Error("Missing polyfill for Request (part of fetch polyfill)");if("undefined"==typeof Response)throw new Error("Missing polyfill for Response (part of fetch polyfill)")},function(t,e,n){var r={"./node":148,"./node.ts":148,"./web":149,"./web.ts":149};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=299},function(t,e,n){(function(t){var r=n(301),o=n(152),i=n(313),s=n(314),a=n(315),u=e;u.request=function(e,n){e="string"==typeof e?a.parse(e):i(e);var o=-1===t.location.protocol.search(/^https?:$/)?"http:":"",s=e.protocol||o,u=e.hostname||e.host,c=e.port,l=e.path||"/";u&&-1!==u.indexOf(":")&&(u="["+u+"]"),e.url=(u?s+"//"+u:"")+(c?":"+c:"")+l,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var d=new r(e);return n&&d.on("response",n),d},u.get=function(t,e){var n=u.request(t,e);return n.end(),n},u.ClientRequest=r,u.IncomingMessage=o.IncomingMessage,u.Agent=function(){},u.Agent.defaultMaxSockets=4,u.globalAgent=new u.Agent,u.STATUS_CODES=s,u.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,n(7))},function(t,e,n){(function(e,r,o){var i=n(151),s=n(37),a=n(152),u=n(153),c=n(312),l=a.IncomingMessage,d=a.readyStates;var f=t.exports=function(t){var n,r=this;u.Writable.call(r),r._opts=t,r._body=[],r._headers={},t.auth&&r.setHeader("Authorization","Basic "+new e(t.auth).toString("base64")),Object.keys(t.headers).forEach((function(e){r.setHeader(e,t.headers[e])}));var o=!0;if("disable-fetch"===t.mode||"requestTimeout"in t&&!i.abortController)o=!1,n=!0;else if("prefer-streaming"===t.mode)n=!1;else if("allow-wrong-content-type"===t.mode)n=!i.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");n=!0}r._mode=function(t,e){return i.fetch&&e?"fetch":i.mozchunkedarraybuffer?"moz-chunked-arraybuffer":i.msstream?"ms-stream":i.arraybuffer&&t?"arraybuffer":i.vbArray&&t?"text:vbarray":"text"}(n,o),r._fetchTimer=null,r.on("finish",(function(){r._onFinish()}))};s(f,u.Writable),f.prototype.setHeader=function(t,e){var n=t.toLowerCase();-1===h.indexOf(n)&&(this._headers[n]={name:t,value:e})},f.prototype.getHeader=function(t){var e=this._headers[t.toLowerCase()];return e?e.value:null},f.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},f.prototype._onFinish=function(){var t=this;if(!t._destroyed){var n=t._opts,s=t._headers,a=null;"GET"!==n.method&&"HEAD"!==n.method&&(a=i.arraybuffer?c(e.concat(t._body)):i.blobConstructor?new r.Blob(t._body.map((function(t){return c(t)})),{type:(s["content-type"]||{}).value||""}):e.concat(t._body).toString());var u=[];if(Object.keys(s).forEach((function(t){var e=s[t].name,n=s[t].value;Array.isArray(n)?n.forEach((function(t){u.push([e,t])})):u.push([e,n])})),"fetch"===t._mode){var l=null;if(i.abortController){var f=new AbortController;l=f.signal,t._fetchAbortController=f,"requestTimeout"in n&&0!==n.requestTimeout&&(t._fetchTimer=r.setTimeout((function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()}),n.requestTimeout))}r.fetch(t._opts.url,{method:t._opts.method,headers:u,body:a||void 0,mode:"cors",credentials:n.withCredentials?"include":"same-origin",signal:l}).then((function(e){t._fetchResponse=e,t._connect()}),(function(e){r.clearTimeout(t._fetchTimer),t._destroyed||t.emit("error",e)}))}else{var h=t._xhr=new r.XMLHttpRequest;try{h.open(t._opts.method,t._opts.url,!0)}catch(e){return void o.nextTick((function(){t.emit("error",e)}))}"responseType"in h&&(h.responseType=t._mode.split(":")[0]),"withCredentials"in h&&(h.withCredentials=!!n.withCredentials),"text"===t._mode&&"overrideMimeType"in h&&h.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in n&&(h.timeout=n.requestTimeout,h.ontimeout=function(){t.emit("requestTimeout")}),u.forEach((function(t){h.setRequestHeader(t[0],t[1])})),t._response=null,h.onreadystatechange=function(){switch(h.readyState){case d.LOADING:case d.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(h.onprogress=function(){t._onXHRProgress()}),h.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{h.send(a)}catch(e){return void o.nextTick((function(){t.emit("error",e)}))}}}},f.prototype._onXHRProgress=function(){(function(t){try{var e=t.status;return null!==e&&0!==e}catch(t){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},f.prototype._connect=function(){var t=this;t._destroyed||(t._response=new l(t._xhr,t._fetchResponse,t._mode,t._fetchTimer),t._response.on("error",(function(e){t.emit("error",e)})),t.emit("response",t._response))},f.prototype._write=function(t,e,n){this._body.push(t),n()},f.prototype.abort=f.prototype.destroy=function(){this._destroyed=!0,r.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},f.prototype.end=function(t,e,n){"function"==typeof t&&(n=t,t=void 0),u.Writable.prototype.end.call(this,t,e,n)},f.prototype.flushHeaders=function(){},f.prototype.setTimeout=function(){},f.prototype.setNoDelay=function(){},f.prototype.setSocketKeepAlive=function(){};var h=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,n(35).Buffer,n(7),n(36))},function(t,e,n){"use strict";e.byteLength=function(t){return 3*t.length/4-c(t)},e.toByteArray=function(t){var e,n,r,s,a,u,l=t.length;a=c(t),u=new i(3*l/4-a),r=a>0?l-4:l;var d=0;for(e=0,n=0;e<r;e+=4,n+=3)s=o[t.charCodeAt(e)]<<18|o[t.charCodeAt(e+1)]<<12|o[t.charCodeAt(e+2)]<<6|o[t.charCodeAt(e+3)],u[d++]=s>>16&255,u[d++]=s>>8&255,u[d++]=255&s;2===a?(s=o[t.charCodeAt(e)]<<2|o[t.charCodeAt(e+1)]>>4,u[d++]=255&s):1===a&&(s=o[t.charCodeAt(e)]<<10|o[t.charCodeAt(e+1)]<<4|o[t.charCodeAt(e+2)]>>2,u[d++]=s>>8&255,u[d++]=255&s);return u},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i="",s=[],a=0,u=n-o;a<u;a+=16383)s.push(l(t,a,a+16383>u?u:a+16383));1===o?(e=t[n-1],i+=r[e>>2],i+=r[e<<4&63],i+="=="):2===o&&(e=(t[n-2]<<8)+t[n-1],i+=r[e>>10],i+=r[e>>4&63],i+=r[e<<2&63],i+="=");return s.push(i),s.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function l(t,e,n){for(var o,i,s=[],a=e;a<n;a+=3)o=(t[a]<<16)+(t[a+1]<<8)+t[a+2],s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,l=-7,d=n?o-1:0,f=n?-1:1,h=t[e+d];for(d+=f,i=h&(1<<-l)-1,h>>=-l,l+=a;l>0;i=256*i+t[e+d],d+=f,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+t[e+d],d+=f,l-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),i-=c}return(h?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,a,u,c=8*i-o-1,l=(1<<c)-1,d=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,p=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(s++,u/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(e*u-1)*Math.pow(2,o),s+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;t[n+h]=255&a,h+=p,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+h]=255&s,h+=p,s/=256,c-=8);t[n+h-p]|=128*v}},function(t,e){},function(t,e,n){"use strict";var r=n(109).Buffer,o=n(306);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e,n,o,i=r.allocUnsafe(t>>>0),s=this.head,a=0;s;)e=s.data,n=i,o=a,e.copy(n,o),a+=s.data.length,s=s.next;return i},t}(),o&&o.inspect&&o.inspect.custom&&(t.exports.prototype[o.inspect.custom]=function(){var t=o.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(308),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(7))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,o,i,s,a,u=1,c={},l=!1,d=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){i.port2.postMessage(t)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,r=function(t){var e=d.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&p(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return c[u]=o,r(u),u++},f.clearImmediate=h}function h(t){delete c[t]}function p(t){if(l)setTimeout(p,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{h(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(7),n(36))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(7))},function(t,e,n){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var r=n(35),o=r.Buffer;function i(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return o(t,e,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=s),s.prototype=Object.create(o.prototype),i(o,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return o(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=o(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return o(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){"use strict";t.exports=i;var r=n(159),o=n(53);function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}o.inherits=n(37),o.inherits(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){var r=n(35).Buffer;t.exports=function(t){if(t instanceof Uint8Array){if(0===t.byteOffset&&t.byteLength===t.buffer.byteLength)return t.buffer;if("function"==typeof t.buffer.slice)return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}if(r.isBuffer(t)){for(var e=new Uint8Array(t.length),n=t.length,o=0;o<n;o++)e[o]=t[o];return e.buffer}throw new Error("Argument must be a Buffer")}},function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var o in r)n.call(r,o)&&(t[o]=r[o])}return t};var n=Object.prototype.hasOwnProperty},function(t,e){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(t,e,n){"use strict";var r=n(316),o=n(317);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=_,e.resolve=function(t,e){return _(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?_(t,!1,!0).resolveObject(e):e},e.format=function(t){o.isString(t)&&(t=_(t));return t instanceof i?t.format():i.prototype.format.call(t)},e.Url=i;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),d=["%","/","?",";","#"].concat(l),f=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=n(318);function _(t,e,n){if(t&&o.isObject(t)&&t instanceof i)return t;var r=new i;return r.parse(t,e,n),r}i.prototype.parse=function(t,e,n){if(!o.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),a=-1!==i&&i<t.indexOf("#")?"?":"#",c=t.split(a);c[0]=c[0].replace(/\\/g,"/");var _=t=c.join(a);if(_=_.trim(),!n&&1===t.split("#").length){var b=u.exec(_);if(b)return this.path=_,this.href=_,this.pathname=b[1],b[2]?(this.search=b[2],this.query=e?m.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var w=s.exec(_);if(w){var I=(w=w[0]).toLowerCase();this.protocol=I,_=_.substr(w.length)}if(n||w||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var O="//"===_.substr(0,2);!O||w&&y[w]||(_=_.substr(2),this.slashes=!0)}if(!y[w]&&(O||w&&!g[w])){for(var E,T,S=-1,A=0;A<f.length;A++){-1!==(C=_.indexOf(f[A]))&&(-1===S||C<S)&&(S=C)}-1!==(T=-1===S?_.lastIndexOf("@"):_.lastIndexOf("@",S))&&(E=_.slice(0,T),_=_.slice(T+1),this.auth=decodeURIComponent(E)),S=-1;for(A=0;A<d.length;A++){var C;-1!==(C=_.indexOf(d[A]))&&(-1===S||C<S)&&(S=C)}-1===S&&(S=_.length),this.host=_.slice(0,S),_=_.slice(S),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var P=this.hostname.split(/\./),j=(A=0,P.length);A<j;A++){var x=P[A];if(x&&!x.match(h)){for(var M="",k=0,N=x.length;k<N;k++)x.charCodeAt(k)>127?M+="x":M+=x[k];if(!M.match(h)){var z=P.slice(0,A),D=P.slice(A+1),U=x.match(p);U&&(z.push(U[1]),D.unshift(U[2])),D.length&&(_="/"+D.join(".")+_),this.hostname=z.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=r.toASCII(this.hostname));var L=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+L,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!v[I])for(A=0,j=l.length;A<j;A++){var B=l[A];if(-1!==_.indexOf(B)){var q=encodeURIComponent(B);q===B&&(q=escape(B)),_=_.split(B).join(q)}}var V=_.indexOf("#");-1!==V&&(this.hash=_.substr(V),_=_.slice(0,V));var G=_.indexOf("?");if(-1!==G?(this.search=_.substr(G),this.query=_.substr(G+1),e&&(this.query=m.parse(this.query)),_=_.slice(0,G)):e&&(this.search="",this.query={}),_&&(this.pathname=_),g[I]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){L=this.pathname||"";var H=this.search||"";this.path=L+H}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(s=m.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+i+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r},i.prototype.resolve=function(t){return this.resolveObject(_(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if(o.isString(t)){var e=new i;e.parse(t,!1,!0),t=e}for(var n=new i,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(n[l]=t[l])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!g[t.protocol]){for(var d=Object.keys(t),f=0;f<d.length;f++){var h=d[f];n[h]=t[h]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||y[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var v=n.pathname||"",m=n.search||"";n.path=v+m}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var _=n.pathname&&"/"===n.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),w=b||_||n.host&&t.pathname,I=w,O=n.pathname&&n.pathname.split("/")||[],E=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(E&&(n.hostname="",n.port=null,n.host&&(""===O[0]?O[0]=n.host:O.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),w=w&&(""===p[0]||""===O[0])),b)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,O=p;else if(p.length)O||(O=[]),O.pop(),O=O.concat(p),n.search=t.search,n.query=t.query;else if(!o.isNullOrUndefined(t.search)){if(E)n.hostname=n.host=O.shift(),(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift());return n.search=t.search,n.query=t.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!O.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var T=O.slice(-1)[0],S=(n.host||t.host||O.length>1)&&("."===T||".."===T)||""===T,A=0,C=O.length;C>=0;C--)"."===(T=O[C])?O.splice(C,1):".."===T?(O.splice(C,1),A++):A&&(O.splice(C,1),A--);if(!w&&!I)for(;A--;A)O.unshift("..");!w||""===O[0]||O[0]&&"/"===O[0].charAt(0)||O.unshift(""),S&&"/"!==O.join("/").substr(-1)&&O.push("");var R,P=""===O[0]||O[0]&&"/"===O[0].charAt(0);E&&(n.hostname=n.host=P?"":O.length?O.shift():"",(R=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=R.shift(),n.host=n.hostname=R.shift()));return(w=w||n.host&&O.length)&&!P&&O.unshift(""),O.length?n.pathname=O.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){(function(t,r){var o;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,u=2147483647,c=/^xn--/,l=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,p=String.fromCharCode;function v(t){throw new RangeError(f[t])}function y(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function g(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+y((t=t.replace(d,".")).split("."),e).join(".")}function m(t){for(var e,n,r=[],o=0,i=t.length;o<i;)(e=t.charCodeAt(o++))>=55296&&e<=56319&&o<i?56320==(64512&(n=t.charCodeAt(o++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--):r.push(e);return r}function _(t){return y(t,(function(t){var e="";return t>65535&&(e+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=p(t)})).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function w(t,e,n){var r=0;for(t=n?h(t/700):t>>1,t+=h(t/e);t>455;r+=36)t=h(t/35);return h(r+36*t/(t+38))}function I(t){var e,n,r,o,i,s,a,c,l,d,f,p=[],y=t.length,g=0,m=128,b=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&v("not-basic"),p.push(t.charCodeAt(r));for(o=n>0?n+1:0;o<y;){for(i=g,s=1,a=36;o>=y&&v("invalid-input"),((c=(f=t.charCodeAt(o++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:36)>=36||c>h((u-g)/s))&&v("overflow"),g+=c*s,!(c<(l=a<=b?1:a>=b+26?26:a-b));a+=36)s>h(u/(d=36-l))&&v("overflow"),s*=d;b=w(g-i,e=p.length+1,0==i),h(g/e)>u-m&&v("overflow"),m+=h(g/e),g%=e,p.splice(g++,0,m)}return _(p)}function O(t){var e,n,r,o,i,s,a,c,l,d,f,y,g,_,I,O=[];for(y=(t=m(t)).length,e=128,n=0,i=72,s=0;s<y;++s)(f=t[s])<128&&O.push(p(f));for(r=o=O.length,o&&O.push("-");r<y;){for(a=u,s=0;s<y;++s)(f=t[s])>=e&&f<a&&(a=f);for(a-e>h((u-n)/(g=r+1))&&v("overflow"),n+=(a-e)*g,e=a,s=0;s<y;++s)if((f=t[s])<e&&++n>u&&v("overflow"),f==e){for(c=n,l=36;!(c<(d=l<=i?1:l>=i+26?26:l-i));l+=36)I=c-d,_=36-d,O.push(p(b(d+I%_,0))),c=h(I/_);O.push(p(b(c,0))),i=w(n,g,r==o),n=0,++r}++n,++e}return O.join("")}a={version:"1.4.1",ucs2:{decode:m,encode:_},decode:I,encode:O,toASCII:function(t){return g(t,(function(t){return l.test(t)?"xn--"+O(t):t}))},toUnicode:function(t){return g(t,(function(t){return c.test(t)?I(t.slice(4).toLowerCase()):t}))}},void 0===(o=function(){return a}.call(e,n,e,t))||(t.exports=o)}()}).call(this,n(110)(t),n(7))},function(t,e,n){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,n){"use strict";e.decode=e.parse=n(319),e.encode=e.stringify=n(320)},function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,i){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var d,f,h,p,v=t[l].replace(a,"%20"),y=v.indexOf(n);y>=0?(d=v.substr(0,y),f=v.substr(y+1)):(d=v,f=""),h=decodeURIComponent(d),p=decodeURIComponent(f),r(s,h)?o(s[h])?s[h].push(p):s[h]=[s[h],p]:s[h]=p}return s};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?i(s(t),(function(s){var a=encodeURIComponent(r(s))+n;return o(t[s])?i(t[s],(function(t){return a+encodeURIComponent(r(t))})).join(e):a+encodeURIComponent(r(t[s]))})).join(e):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},function(t,e,n){(function(e){(function(){var n,r,o,i,s,a;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:null!=e&&e.hrtime?(t.exports=function(){return(n()-s)/1e6},r=e.hrtime,i=(n=function(){var t;return 1e9*(t=r())[0]+t[1]})(),a=1e9*e.uptime(),s=i-a):Date.now?(t.exports=function(){return Date.now()-o},o=Date.now()):(t.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,n(36))},function(t,e,n){var r=n(160),o=n(161),i=r(),s=[1|i[0],i[1],i[2],i[3],i[4],i[5]],a=16383&(i[6]<<8|i[7]),u=0,c=0;t.exports=function(t,e,n){var r=e&&n||0,i=e||[],l=void 0!==(t=t||{}).clockseq?t.clockseq:a,d=void 0!==t.msecs?t.msecs:(new Date).getTime(),f=void 0!==t.nsecs?t.nsecs:c+1,h=d-u+(f-c)/1e4;if(h<0&&void 0===t.clockseq&&(l=l+1&16383),(h<0||d>u)&&void 0===t.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=d,c=f,a=l;var p=(1e4*(268435455&(d+=122192928e5))+f)%4294967296;i[r++]=p>>>24&255,i[r++]=p>>>16&255,i[r++]=p>>>8&255,i[r++]=255&p;var v=d/4294967296*1e4&268435455;i[r++]=v>>>8&255,i[r++]=255&v,i[r++]=v>>>24&15|16,i[r++]=v>>>16&255,i[r++]=l>>>8|128,i[r++]=255&l;for(var y=t.node||s,g=0;g<6;++g)i[r+g]=y[g];return e||o(i)}},function(t,e,n){var r=n(160),o=n(161);t.exports=function(t,e,n){var i=e&&n||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[i+a]=s[a];return e||o(s)}},function(t,e,n){var r=n(54),o=n(350),i=n(351);t.exports=function(t,e){return i(t,o(r(e)))}},function(t,e,n){var r=n(326),o=n(335),i=n(177);t.exports=function(t){var e=o(t);return 1==e.length&&e[0][2]?i(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},function(t,e,n){var r=n(164),o=n(171);t.exports=function(t,e,n,i){var s=n.length,a=s,u=!i;if(null==t)return!a;for(t=Object(t);s--;){var c=n[s];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++s<a;){var l=(c=n[s])[0],d=t[l],f=c[1];if(u&&c[2]){if(void 0===d&&!(l in t))return!1}else{var h=new r;if(i)var p=i(d,f,l,t,e,h);if(!(void 0===p?o(f,d,3,i,h):p))return!1}}return!0}},function(t,e,n){var r=n(164),o=n(328),i=n(330),s=n(331),a=n(174),u=n(18),c=n(333),l=n(334),d="[object Object]",f=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,h,p,v){var y=u(t),g=u(e),m=y?"[object Array]":a(t),_=g?"[object Array]":a(e),b=(m="[object Arguments]"==m?d:m)==d,w=(_="[object Arguments]"==_?d:_)==d,I=m==_;if(I&&c(t)){if(!c(e))return!1;y=!0,b=!1}if(I&&!b)return v||(v=new r),y||l(t)?o(t,e,n,h,p,v):i(t,e,m,n,h,p,v);if(!(1&n)){var O=b&&f.call(t,"__wrapped__"),E=w&&f.call(e,"__wrapped__");if(O||E){var T=O?t.value():t,S=E?e.value():e;return v||(v=new r),p(T,S,n,h,v)}}return!!I&&(v||(v=new r),s(t,e,n,h,p,v))}},function(t,e,n){var r=n(111),o=n(329),i=n(112);t.exports=function(t,e,n,s,a,u){var c=1&n,l=t.length,d=e.length;if(l!=d&&!(c&&d>l))return!1;var f=u.get(t);if(f&&u.get(e))return f==e;var h=-1,p=!0,v=2&n?new r:void 0;for(u.set(t,e),u.set(e,t);++h<l;){var y=t[h],g=e[h];if(s)var m=c?s(g,y,h,e,t,u):s(y,g,h,t,e,u);if(void 0!==m){if(m)continue;p=!1;break}if(v){if(!o(e,(function(t,e){if(!i(v,e)&&(y===t||a(y,t,n,s,u)))return v.push(e)}))){p=!1;break}}else if(y!==g&&!a(y,g,n,s,u)){p=!1;break}}return u.delete(t),u.delete(e),p}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(332),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,i,s,a){var u=1&n,c=r(t),l=c.length;if(l!=r(e).length&&!u)return!1;for(var d=l;d--;){var f=c[d];if(!(u?f in e:o.call(e,f)))return!1}var h=a.get(t);if(h&&a.get(e))return h==e;var p=!0;a.set(t,e),a.set(e,t);for(var v=u;++d<l;){var y=t[f=c[d]],g=e[f];if(i)var m=u?i(g,y,f,e,t,a):i(y,g,f,t,e,a);if(!(void 0===m?y===g||s(y,g,n,i,a):m)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var _=t.constructor,b=e.constructor;_==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(p=!1)}return a.delete(t),a.delete(e),p}},function(t,e,n){var r=n(173)(Object.keys,Object);t.exports=r},function(t,e){t.exports=function(){return!1}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(176),o=n(55);t.exports=function(t){for(var e=o(t),n=e.length;n--;){var i=e[n],s=t[i];e[n]=[i,s,r(s)]}return e}},function(t,e,n){var r=n(171),o=n(337),i=n(344),s=n(115),a=n(176),u=n(177),c=n(56);t.exports=function(t,e){return s(t)&&a(e)?u(c(t),e):function(n){var s=o(n,t);return void 0===s&&s===e?i(n,t):r(e,s,3)}}},function(t,e,n){var r=n(114);t.exports=function(t,e,n){var o=null==t?void 0:r(t,e);return void 0===o?n:o}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(340),o=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,a=r((function(t){var e=[];return o.test(t)&&e.push(""),t.replace(i,(function(t,n,r,o){e.push(r?o.replace(s,"$1"):n||t)})),e}));t.exports=a},function(t,e,n){var r=n(341);t.exports=function(t){var e=r(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var r=n(342);function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},function(t,e,n){var r=n(165),o=n(166),i=n(168),s=n(169),a=n(170);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=s,u.prototype.set=a,t.exports=u},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(345),o=n(346);t.exports=function(t,e){return null!=t&&o(t,e,r)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var r=n(76),o=n(178),i=n(18),s=n(179),a=n(180),u=n(56);t.exports=function(t,e,n){for(var c=-1,l=(e=r(e,t)).length,d=!1;++c<l;){var f=u(e[c]);if(!(d=null!=t&&n(t,f)))break;t=t[f]}return d||++c!=l?d:!!(l=null==t?0:t.length)&&a(l)&&s(f,l)&&(i(t)||o(t))}},function(t,e,n){var r=n(348),o=n(349),i=n(115),s=n(56);t.exports=function(t){return i(t)?r(s(t)):o(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,n){var r=n(114);t.exports=function(t){return function(e){return r(e,t)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}},function(t,e,n){var r=n(57),o=n(54),i=n(352),s=n(357);t.exports=function(t,e){if(null==t)return{};var n=r(s(t),(function(t){return[t]}));return e=o(e),i(t,n,(function(t,n){return e(t,n[0])}))}},function(t,e,n){var r=n(114),o=n(353),i=n(76);t.exports=function(t,e,n){for(var s=-1,a=e.length,u={};++s<a;){var c=e[s],l=r(t,c);n(l,c)&&o(u,i(c,t),l)}return u}},function(t,e,n){var r=n(354),o=n(76),i=n(179),s=n(113),a=n(56);t.exports=function(t,e,n,u){if(!s(t))return t;for(var c=-1,l=(e=o(e,t)).length,d=l-1,f=t;null!=f&&++c<l;){var h=a(e[c]),p=n;if(c!=d){var v=f[h];void 0===(p=u?u(v,h,f):void 0)&&(p=s(v)?v:i(e[c+1])?[]:{})}r(f,h,p),f=f[h]}return t}},function(t,e,n){var r=n(182),o=n(167),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var s=t[e];i.call(t,e)&&o(s,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(356),o=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){t.exports={default:n(359),__esModule:!0}},function(t,e,n){n(360),t.exports=n(23).Object.keys},function(t,e,n){var r=n(116),o=n(118);n(364)("keys",(function(){return function(t){return o(r(t))}}))},function(t,e,n){var r=n(77),o=n(119),i=n(362)(!1),s=n(121)("IE_PROTO");t.exports=function(t,e){var n,a=o(t),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;e.length>u;)r(a,n=e[u++])&&(~i(c,n)||c.push(n));return c}},function(t,e,n){var r=n(119),o=n(184),i=n(363);t.exports=function(t){return function(e,n,s){var a,u=r(e),c=o(u.length),l=i(s,c);if(t&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var r=n(120),o=Math.max,i=Math.min;t.exports=function(t,e){return(t=r(t))<0?o(t+e,0):i(t,e)}},function(t,e,n){var r=n(46),o=n(23),i=n(82);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],s={};s[t]=e(n),r(r.S+r.F*i((function(){n(1)})),"Object",s)}},function(t,e,n){t.exports=!n(59)&&!n(82)((function(){return 7!=Object.defineProperty(n(122)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(58);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){t.exports={default:n(368),__esModule:!0}},function(t,e,n){n(369),n(370),n(377),n(381),n(392),n(393),t.exports=n(23).Promise},function(t,e){},function(t,e,n){"use strict";var r=n(371)(!0);n(189)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(120),o=n(117);t.exports=function(t){return function(e,n){var i,s,a=String(o(e)),u=r(n),c=a.length;return u<0||u>=c?t?"":void 0:(i=a.charCodeAt(u))<55296||i>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):i:t?a.slice(u,u+2):s-56320+(i-55296<<10)+65536}}},function(t,e,n){t.exports=n(47)},function(t,e,n){"use strict";var r=n(374),o=n(188),i=n(123),s={};n(47)(s,n(20)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(s,{next:o(1,n)}),i(t,e+" Iterator")}},function(t,e,n){var r=n(38),o=n(375),i=n(187),s=n(121)("IE_PROTO"),a=function(){},u=function(){var t,e=n(122)("iframe"),r=i.length;for(e.style.display="none",n(191).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[i[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=r(t),n=new a,a.prototype=null,n[s]=t):n=u(),void 0===e?n:o(n,e)}},function(t,e,n){var r=n(81),o=n(38),i=n(118);t.exports=n(59)?Object.defineProperties:function(t,e){o(t);for(var n,s=i(e),a=s.length,u=0;a>u;)r.f(t,n=s[u++],e[n]);return t}},function(t,e,n){var r=n(77),o=n(116),i=n(121)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){n(378);for(var r=n(19),o=n(47),i=n(60),s=n(20)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],l=r[c],d=l&&l.prototype;d&&!d[s]&&o(d,s,c),i[c]=i.Array}},function(t,e,n){"use strict";var r=n(379),o=n(380),i=n(60),s=n(119);t.exports=n(189)(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):o(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r,o,i,s,a=n(190),u=n(19),c=n(79),l=n(192),d=n(46),f=n(58),h=n(80),p=n(382),v=n(383),y=n(193),g=n(194).set,m=n(388)(),_=n(124),b=n(195),w=n(196),I=u.TypeError,O=u.process,E=u.Promise,T="process"==l(O),S=function(){},A=o=_.f,C=!!function(){try{var t=E.resolve(1),e=(t.constructor={})[n(20)("species")]=function(t){t(S,S)};return(T||"function"==typeof PromiseRejectionEvent)&&t.then(S)instanceof e}catch(t){}}(),R=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},P=function(t,e){if(!t._n){t._n=!0;var n=t._c;m((function(){for(var r=t._v,o=1==t._s,i=0,s=function(e){var n,i,s=o?e.ok:e.fail,a=e.resolve,u=e.reject,c=e.domain;try{s?(o||(2==t._h&&M(t),t._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&c.exit()),n===e.promise?u(I("Promise-chain cycle")):(i=R(n))?i.call(n,a,u):a(n)):u(r)}catch(t){u(t)}};n.length>i;)s(n[i++]);t._c=[],t._n=!1,e&&!t._h&&j(t)}))}},j=function(t){g.call(u,(function(){var e,n,r,o=t._v,i=x(t);if(i&&(e=b((function(){T?O.emit("unhandledRejection",o,t):(n=u.onunhandledrejection)?n({promise:t,reason:o}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",o)})),t._h=T||x(t)?2:1),t._a=void 0,i&&e.e)throw e.v}))},x=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,r=0;n.length>r;)if((e=n[r++]).fail||!x(e.promise))return!1;return!0},M=function(t){g.call(u,(function(){var e;T?O.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})}))},k=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),P(e,!0))},N=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw I("Promise can't be resolved itself");(e=R(t))?m((function(){var r={_w:n,_d:!1};try{e.call(t,c(N,r,1),c(k,r,1))}catch(t){k.call(r,t)}})):(n._v=t,n._s=1,P(n,!1))}catch(t){k.call({_w:n,_d:!1},t)}}};C||(E=function(t){p(this,E,"Promise","_h"),h(t),r.call(this);try{t(c(N,this,1),c(k,this,1))}catch(t){k.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(389)(E.prototype,{then:function(t,e){var n=A(y(this,E));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=T?O.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r;this.promise=t,this.resolve=c(N,t,1),this.reject=c(k,t,1)},_.f=A=function(t){return t===E||t===s?new i(t):o(t)}),d(d.G+d.W+d.F*!C,{Promise:E}),n(123)(E,"Promise"),n(390)("Promise"),s=n(23).Promise,d(d.S+d.F*!C,"Promise",{reject:function(t){var e=A(this);return(0,e.reject)(t),e.promise}}),d(d.S+d.F*(a||!C),"Promise",{resolve:function(t){return w(a&&this===s?E:this,t)}}),d(d.S+d.F*!(C&&n(391)((function(t){E.all(t).catch(S)}))),"Promise",{all:function(t){var e=this,n=A(e),r=n.resolve,o=n.reject,i=b((function(){var n=[],i=0,s=1;v(t,!1,(function(t){var a=i++,u=!1;n.push(void 0),s++,e.resolve(t).then((function(t){u||(u=!0,n[a]=t,--s||r(n))}),o)})),--s||r(n)}));return i.e&&o(i.v),n.promise},race:function(t){var e=this,n=A(e),r=n.reject,o=b((function(){v(t,!1,(function(t){e.resolve(t).then(n.resolve,r)}))}));return o.e&&r(o.v),n.promise}})},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(79),o=n(384),i=n(385),s=n(38),a=n(184),u=n(386),c={},l={};(e=t.exports=function(t,e,n,d,f){var h,p,v,y,g=f?function(){return t}:u(t),m=r(n,d,e?2:1),_=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(i(g)){for(h=a(t.length);h>_;_++)if((y=e?m(s(p=t[_])[0],p[1]):m(t[_]))===c||y===l)return y}else for(v=g.call(t);!(p=v.next()).done;)if((y=o(v,m,p.value,e))===c||y===l)return y}).BREAK=c,e.RETURN=l},function(t,e,n){var r=n(38);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&r(i.call(t)),e}}},function(t,e,n){var r=n(60),o=n(20)("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},function(t,e,n){var r=n(192),o=n(20)("iterator"),i=n(60);t.exports=n(23).getIteratorMethod=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[r(t)]}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(19),o=n(194).set,i=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,u="process"==n(78)(s);t.exports=function(){var t,e,n,c=function(){var r,o;for(u&&(r=s.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){s.nextTick(c)};else if(i){var l=!0,d=document.createTextNode("");new i(c).observe(d,{characterData:!0}),n=function(){d.data=l=!l}}else if(a&&a.resolve){var f=a.resolve();n=function(){f.then(c)}}else n=function(){o.call(r,c)};return function(r){var o={fn:r,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}},function(t,e,n){var r=n(47);t.exports=function(t,e,n){for(var o in e)n&&t[o]?t[o]=e[o]:r(t,o,e[o]);return t}},function(t,e,n){"use strict";var r=n(19),o=n(23),i=n(81),s=n(59),a=n(20)("species");t.exports=function(t){var e="function"==typeof o[t]?o[t]:r[t];s&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(20)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i=[7],s=i[r]();s.next=function(){return{done:n=!0}},i[r]=function(){return s},t(i)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(46),o=n(23),i=n(19),s=n(193),a=n(196);r(r.P+r.R,"Promise",{finally:function(t){var e=s(this,o.Promise||i.Promise),n="function"==typeof t;return this.then(n?function(n){return a(e,t()).then((function(){return n}))}:t,n?function(n){return a(e,t()).then((function(){throw n}))}:t)}})},function(t,e,n){"use strict";var r=n(46),o=n(124),i=n(195);r(r.S,"Promise",{try:function(t){var e=o.f(this),n=i(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){"use strict";e.__esModule=!0;var r,o=n(395),i=(r=o)&&r.__esModule?r:{default:r};e.default=i.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}},function(t,e,n){t.exports={default:n(396),__esModule:!0}},function(t,e,n){n(397),t.exports=n(23).Object.assign},function(t,e,n){var r=n(46);r(r.S+r.F,"Object",{assign:n(398)})},function(t,e,n){"use strict";var r=n(118),o=n(399),i=n(400),s=n(116),a=n(183),u=Object.assign;t.exports=!u||n(82)((function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r}))?function(t,e){for(var n=s(t),u=arguments.length,c=1,l=o.f,d=i.f;u>c;)for(var f,h=a(arguments[c++]),p=l?r(h).concat(l(h)):r(h),v=p.length,y=0;v>y;)d.call(h,f=p[y++])&&(n[f]=h[f]);return n}:u},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){t.exports={default:n(402),__esModule:!0}},function(t,e,n){var r=n(23),o=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<r.length;o++)if((n=r[o])===e||n.fn===e){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){t.exports=r,r.default=r,r.stable=i,r.stableStringify=i;var n=[];function r(t,e,r){!function t(e,r,o,i){var s;if("object"==typeof e&&null!==e){for(s=0;s<o.length;s++)if(o[s]===e)return i[r]="[Circular]",void n.push([i,r,e]);if(o.push(e),Array.isArray(e))for(s=0;s<e.length;s++)t(e[s],s,o,e);else{var a=Object.keys(e);for(s=0;s<a.length;s++){var u=a[s];t(e[u],u,o,e)}}o.pop()}}(t,"",[],void 0);for(var o=JSON.stringify(t,e,r);0!==n.length;){var i=n.pop();i[0][i[1]]=i[2]}return o}function o(t,e){return t<e?-1:t>e?1:0}function i(t,e,r){for(var i=function t(e,r,i,s){var a;if("object"==typeof e&&null!==e){for(a=0;a<i.length;a++)if(i[a]===e)return s[r]="[Circular]",void n.push([s,r,e]);if("function"==typeof e.toJSON)return;if(i.push(e),Array.isArray(e))for(a=0;a<e.length;a++)t(e[a],a,i,e);else{var u={},c=Object.keys(e).sort(o);for(a=0;a<c.length;a++){var l=c[a];t(e[l],l,i,e),u[l]=e[l]}if(void 0===s)return u;n.push([s,r,e]),s[r]=u}i.pop()}}(t,"",[],void 0)||t,s=JSON.stringify(i,e,r);0!==n.length;){var a=n.pop();a[0][a[1]]=a[2]}return s}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n(197);function i(t){if(t)return function(t){for(var e in i.prototype)Object.prototype.hasOwnProperty.call(i.prototype,e)&&(t[e]=i.prototype[e]);return t}(t)}t.exports=i,i.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},i.prototype.parse=function(t){return this._parser=t,this},i.prototype.responseType=function(t){return this._responseType=t,this},i.prototype.serialize=function(t){return this._serializer=t,this},i.prototype.timeout=function(t){if(!t||"object"!==r(t))return this._timeout=t,this._responseTimeout=0,this._uploadTimeout=0,this;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(e){case"deadline":this._timeout=t.deadline;break;case"response":this._responseTimeout=t.response;break;case"upload":this._uploadTimeout=t.upload;break;default:console.warn("Unknown timeout option",e)}return this},i.prototype.retry=function(t,e){return 0!==arguments.length&&!0!==t||(t=1),t<=0&&(t=0),this._maxRetries=t,this._retries=0,this._retryCallback=e,this};var s=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];i.prototype._shouldRetry=function(t,e){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(t,e);if(!0===n)return!0;if(!1===n)return!1}catch(t){console.error(t)}if(e&&e.status&&e.status>=500&&501!==e.status)return!0;if(t){if(t.code&&-1!==s.indexOf(t.code))return!0;if(t.timeout&&"ECONNABORTED"===t.code)return!0;if(t.crossDomain)return!0}return!1},i.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},i.prototype.then=function(t,e){var n=this;if(!this._fullfilledPromise){var r=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((function(t,e){r.on("abort",(function(){var t=new Error("Aborted");t.code="ABORTED",t.status=n.status,t.method=n.method,t.url=n.url,e(t)})),r.end((function(n,r){n?e(n):t(r)}))}))}return this._fullfilledPromise.then(t,e)},i.prototype.catch=function(t){return this.then(void 0,t)},i.prototype.use=function(t){return t(this),this},i.prototype.ok=function(t){if("function"!=typeof t)throw new Error("Callback required");return this._okCallback=t,this},i.prototype._isResponseOK=function(t){return!!t&&(this._okCallback?this._okCallback(t):t.status>=200&&t.status<300)},i.prototype.get=function(t){return this._header[t.toLowerCase()]},i.prototype.getHeader=i.prototype.get,i.prototype.set=function(t,e){if(o(t)){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.set(n,t[n]);return this}return this._header[t.toLowerCase()]=e,this.header[t]=e,this},i.prototype.unset=function(t){return delete this._header[t.toLowerCase()],delete this.header[t],this},i.prototype.field=function(t,e){if(null==t)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(o(t)){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.field(n,t[n]);return this}if(Array.isArray(e)){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&this.field(t,e[r]);return this}if(null==e)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof e&&(e=String(e)),this._getFormData().append(t,e),this},i.prototype.abort=function(){return this._aborted||(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort")),this},i.prototype._auth=function(t,e,n,r){switch(n.type){case"basic":this.set("Authorization","Basic ".concat(r("".concat(t,":").concat(e))));break;case"auto":this.username=t,this.password=e;break;case"bearer":this.set("Authorization","Bearer ".concat(t))}return this},i.prototype.withCredentials=function(t){return void 0===t&&(t=!0),this._withCredentials=t,this},i.prototype.redirects=function(t){return this._maxRedirects=t,this},i.prototype.maxResponseSize=function(t){if("number"!=typeof t)throw new TypeError("Invalid argument");return this._maxResponseSize=t,this},i.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},i.prototype.send=function(t){var e=o(t),n=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(e&&!this._data)Array.isArray(t)?this._data=[]:this._isHost(t)||(this._data={});else if(t&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(e&&o(this._data))for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(this._data[r]=t[r]);else"string"==typeof t?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"===n?this._data?"".concat(this._data,"&").concat(t):t:(this._data||"")+t):this._data=t;return!e||this._isHost(t)||n||this.type("json"),this},i.prototype.sortQuery=function(t){return this._sort=void 0===t||t,this},i.prototype._finalizeQueryString=function(){var t=this._query.join("&");if(t&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+t),this._query.length=0,this._sort){var e=this.url.indexOf("?");if(e>=0){var n=this.url.substring(e+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,e)+"?"+n.join("&")}}},i.prototype._appendQueryString=function(){console.warn("Unsupported")},i.prototype._timeoutError=function(t,e,n){if(!this._aborted){var r=new Error("".concat(t+e,"ms exceeded"));r.timeout=e,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},i.prototype._setTimeouts=function(){var t=this;this._timeout&&!this._timer&&(this._timer=setTimeout((function(){t._timeoutError("Timeout of ",t._timeout,"ETIME")}),this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout((function(){t._timeoutError("Response timeout of ",t._responseTimeout,"ETIMEDOUT")}),this._responseTimeout))}},function(t,e,n){"use strict";var r=n(407);function o(t){if(t)return function(t){for(var e in o.prototype)Object.prototype.hasOwnProperty.call(o.prototype,e)&&(t[e]=o.prototype[e]);return t}(t)}t.exports=o,o.prototype.get=function(t){return this.header[t.toLowerCase()]},o.prototype._setHeaderProperties=function(t){var e=t["content-type"]||"";this.type=r.type(e);var n=r.params(e);for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(this[o]=n[o]);this.links={};try{t.link&&(this.links=r.parseLinks(t.link))}catch(t){}},o.prototype._setStatusProperties=function(t){var e=t/100|0;this.statusCode=t,this.status=this.statusCode,this.statusType=e,this.info=1===e,this.ok=2===e,this.redirect=3===e,this.clientError=4===e,this.serverError=5===e,this.error=(4===e||5===e)&&this.toError(),this.created=201===t,this.accepted=202===t,this.noContent=204===t,this.badRequest=400===t,this.unauthorized=401===t,this.notAcceptable=406===t,this.forbidden=403===t,this.notFound=404===t,this.unprocessableEntity=422===t}},function(t,e,n){"use strict";e.type=function(t){return t.split(/ *; */).shift()},e.params=function(t){return t.split(/ *; */).reduce((function(t,e){var n=e.split(/ *= */),r=n.shift(),o=n.shift();return r&&o&&(t[r]=o),t}),{})},e.parseLinks=function(t){return t.split(/ *, */).reduce((function(t,e){var n=e.split(/ *; */),r=n[0].slice(1,-1);return t[n[1].split(/ *= */)[1].slice(1,-1)]=r,t}),{})},e.cleanHeader=function(t,e){return delete t["content-type"],delete t["content-length"],delete t["transfer-encoding"],delete t.host,e&&(delete t.authorization,delete t.cookie),t}},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach((function(t){o.prototype[t]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this._defaults.push({fn:t,args:n}),this}})),o.prototype._setDefaults=function(t){this._defaults.forEach((function(e){t[e.fn].apply(t,r(e.args))}))},t.exports=o},function(t,e,n){var r=n(410),o=n(424);t.exports=function(t,e){for(var n=0,i=(e=r(e,t)).length;null!=t&&n<i;)t=t[o(e[n++])];return n&&n==i?t:void 0}},function(t,e,n){var r=n(198),o=n(411),i=n(413),s=n(423);t.exports=function(t,e){return r(t)?t:o(t,e)?[t]:i(s(t))}},function(t,e,n){var r=n(198),o=n(412),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||(s.test(t)||!i.test(t)||null!=e&&t in Object(e))}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(414),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(o,(function(t,n,r,o){e.push(r?o.replace(i,"$1"):n||t)})),e}));t.exports=s},function(t,e,n){var r=n(415);t.exports=function(t){var e=r(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var r=n(416);function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=t.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},function(t,e,n){var r=n(417),o=n(418),i=n(420),s=n(421),a=n(422);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=s,u.prototype.set=a,t.exports=u},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(83),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():o.call(e,n,1),--this.size,!0)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(83);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(83);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(83);t.exports=function(t,e){var n=this.__data__,o=r(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}},function(t,e){t.exports=function(t){return t}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r,o=o||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},r=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,i=/constructor/i.test(t.HTMLElement)||t.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},u=function(t){setTimeout((function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()}),4e4)},c=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},l=function(e,l,d){d||(e=c(e));var f,h=this,p="application/octet-stream"===e.type,v=function(){!function(t,e,n){for(var r=(e=[].concat(e)).length;r--;){var o=t["on"+e[r]];if("function"==typeof o)try{o.call(t,n||t)}catch(t){a(t)}}}(h,"writestart progress write writeend".split(" "))};if(h.readyState=h.INIT,o)return f=n().createObjectURL(e),void setTimeout((function(){var t,e;r.href=f,r.download=l,t=r,e=new MouseEvent("click"),t.dispatchEvent(e),v(),u(f),h.readyState=h.DONE}));!function(){if((s||p&&i)&&t.FileReader){var r=new FileReader;return r.onloadend=function(){var e=s?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,h.readyState=h.DONE,v()},r.readAsDataURL(e),void(h.readyState=h.INIT)}(f||(f=n().createObjectURL(e)),p)?t.location.href=f:t.open(f,"_blank")||(t.location.href=f);h.readyState=h.DONE,v(),u(f)}()},d=l.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=c(t)),navigator.msSaveOrOpenBlob(t,e)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(t,e,n){return new l(t,e||t.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */t.exports?t.exports.saveAs=o:null!==n(426)&&null!==n(427)&&(void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r))},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){var r=n(429);t.exports=function(t){return(null==t?0:t.length)?r(t,1):[]}},function(t,e,n){var r=n(430),o=n(431);t.exports=function t(e,n,i,s,a){var u=-1,c=e.length;for(i||(i=o),a||(a=[]);++u<c;){var l=e[u];n>0&&i(l)?n>1?t(l,n-1,i,s,a):r(a,l):s||(a[a.length]=l)}return a}},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},function(t,e,n){var r=n(432),o=n(178),i=n(18),s=r?r.isConcatSpreadable:void 0;t.exports=function(t){return i(t)||o(t)||!!(s&&t&&t[s])}},function(t,e,n){var r=n(433).Symbol;t.exports=r},function(t,e,n){var r=n(434),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(7))},function(t,e,n){var r=n(436);t.exports=function(t){return(null==t?0:t.length)?r(t,0,-1):[]}},function(t,e){t.exports=function(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}},function(t,e,n){var r=n(57),o=n(54),i=n(438),s=n(18);t.exports=function(t,e){return(s(t)?r:i)(t,o(e,3))}},function(t,e,n){var r=n(84),o=n(125);t.exports=function(t,e){var n=-1,i=o(t)?Array(t.length):[];return r(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}},function(t,e,n){var r=n(440),o=n(55);t.exports=function(t,e){return t&&r(t,e,o)}},function(t,e,n){var r=n(441)();t.exports=r},function(t,e){t.exports=function(t){return function(e,n,r){for(var o=-1,i=Object(e),s=r(e),a=s.length;a--;){var u=s[t?a:++o];if(!1===n(i[u],u,i))break}return e}}},function(t,e,n){var r=n(125);t.exports=function(t,e){return function(n,o){if(null==n)return n;if(!r(n))return t(n,o);for(var i=n.length,s=e?i:-1,a=Object(n);(e?s--:++s<i)&&!1!==o(a[s],s,a););return n}}},function(t,e,n){var r=n(444),o=n(113);t.exports=function(t){if(!o(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r=n(446);t.exports=function(t){return t&&t.length?r(t):[]}},function(t,e,n){var r=n(111),o=n(199),i=n(200),s=n(112),a=n(447),u=n(448);t.exports=function(t,e,n){var c=-1,l=o,d=t.length,f=!0,h=[],p=h;if(n)f=!1,l=i;else if(d>=200){var v=e?null:a(t);if(v)return u(v);f=!1,l=s,p=new r}else p=e?[]:h;t:for(;++c<d;){var y=t[c],g=e?e(y):y;if(y=n||0!==y?y:0,f&&g==g){for(var m=p.length;m--;)if(p[m]===g)continue t;e&&p.push(g),h.push(y)}else l(p,g,n)||(p!==h&&p.push(g),h.push(y))}return h}},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(450),o=n(452),i=n(456),s=o((function(t,e){return i(t)?r(t,e):[]}));t.exports=s},function(t,e,n){var r=n(111),o=n(199),i=n(200),s=n(57),a=n(451),u=n(112);t.exports=function(t,e,n,c){var l=-1,d=o,f=!0,h=t.length,p=[],v=e.length;if(!h)return p;n&&(e=s(e,a(n))),c?(d=i,f=!1):e.length>=200&&(d=u,f=!1,e=new r(e));t:for(;++l<h;){var y=t[l],g=null==n?y:n(y);if(y=c||0!==y?y:0,f&&g==g){for(var m=v;m--;)if(e[m]===g)continue t;p.push(y)}else d(e,g,c)||p.push(y)}return p}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){var r=n(181),o=n(453),i=n(455);t.exports=function(t,e){return i(o(t,e,r),t+"")}},function(t,e,n){var r=n(454),o=Math.max;t.exports=function(t,e,n){return e=o(void 0===e?t.length-1:e,0),function(){for(var i=arguments,s=-1,a=o(i.length-e,0),u=Array(a);++s<a;)u[s]=i[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=i[s];return c[e]=n(u),r(t,this,c)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(125),o=n(175);t.exports=function(t){return o(t)&&r(t)}},function(t,e,n){!function(e){var r=-1,o=function(t){return t.every=function(e,n,o){t._time(),o||(o=n,n=null);var i=r+=1;return t._timers[i]={visible:e,hidden:n,callback:o},t._run(i,!1),t.isSupported()&&t._listen(),i},t.stop=function(e){return!!t._timers[e]&&(t._stop(e),delete t._timers[e],!0)},t._timers={},t._time=function(){t._timed||(t._timed=!0,t._wasHidden=t.hidden(),t.change((function(){t._stopRun(),t._wasHidden=t.hidden()})))},t._run=function(n,r){var o,i=t._timers[n];if(t.hidden()){if(null===i.hidden)return;o=i.hidden}else o=i.visible;var s=function(){i.last=new Date,i.callback.call(e)};if(r){var a=new Date-i.last;o>a?i.delay=setTimeout((function(){i.id=setInterval(s,o),s()}),o-a):(i.id=setInterval(s,o),s())}else i.id=setInterval(s,o)},t._stop=function(e){var n=t._timers[e];clearInterval(n.id),clearTimeout(n.delay),delete n.id,delete n.delay},t._stopRun=function(e){var n=t.hidden(),r=t._wasHidden;if(n&&!r||!n&&r)for(var o in t._timers)t._stop(o),t._run(o,!n)},t};t.exports?t.exports=o(n(202)):o(e.Visibility||n(202))}(window)},function(t,e,n){var r=n(459),o=n(460),i=n(461),s=/^\d+$/,a=Object.prototype.hasOwnProperty,u=r(Object,"keys");var c,l=(c="length",function(t){return null==t?void 0:t[c]});function d(t,e){return e=null==e?9007199254740991:e,(t="number"==typeof t||s.test(t)?+t:-1)>-1&&t%1==0&&t<e}function f(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function h(t){for(var e=function(t){if(null==t)return[];p(t)||(t=Object(t));var e=t.length;e=e&&f(e)&&(i(t)||o(t))&&e||0;var n=t.constructor,r=-1,s="function"==typeof n&&n.prototype===t,u=Array(e),c=e>0;for(;++r<e;)u[r]=r+"";for(var l in t)c&&d(l,e)||"constructor"==l&&(s||!a.call(t,l))||u.push(l);return u}(t),n=e.length,r=n&&t.length,s=!!r&&f(r)&&(i(t)||o(t)),u=-1,c=[];++u<n;){var l=e[u];(s&&d(l,r)||a.call(t,l))&&c.push(l)}return c}function p(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var v=u?function(t){var e,n=null==t?void 0:t.constructor;return"function"==typeof n&&n.prototype===t||"function"!=typeof t&&(null!=(e=t)&&f(l(e)))?h(t):p(t)?u(t):[]}:h;t.exports=v},function(t,e){var n=/^\[object .+?Constructor\]$/;var r=Object.prototype,o=Function.prototype.toString,i=r.hasOwnProperty,s=r.toString,a=RegExp("^"+o.call(i).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t,e){var r=null==t?void 0:t[e];return function(t){if(null==t)return!1;if(function(t){return function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)&&"[object Function]"==s.call(t)}(t))return a.test(o.call(t));return function(t){return!!t&&"object"==typeof t}(t)&&n.test(t)}(r)?r:void 0}},function(t,e){var n=Object.prototype,r=n.hasOwnProperty,o=n.toString,i=n.propertyIsEnumerable;t.exports=function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?o.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}(t)}(t)}(t)&&r.call(t,"callee")&&(!i.call(t,"callee")||"[object Arguments]"==o.call(t))}},function(t,e){var n=/^\[object .+?Constructor\]$/;function r(t){return!!t&&"object"==typeof t}var o,i,s,a=Object.prototype,u=Function.prototype.toString,c=a.hasOwnProperty,l=a.toString,d=RegExp("^"+u.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),f=(i="isArray",function(t){return null!=t&&(function(t){return function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)&&"[object Function]"==l.call(t)}(t)?d.test(u.call(t)):r(t)&&n.test(t))}(s=null==(o=Array)?void 0:o[i])?s:void 0);var h=f||function(t){return r(t)&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}(t.length)&&"[object Array]"==l.call(t)};t.exports=h},function(t,e,n){var r=n(463),o=n(55);t.exports=function(t){return null==t?[]:r(t,o(t))}},function(t,e,n){var r=n(57);t.exports=function(t,e){return r(e,(function(e){return t[e]}))}},function(t,e,n){var r=n(182),o=n(465)((function(t,e,n){r(t,n,e)}));t.exports=o},function(t,e,n){var r=n(466),o=n(467),i=n(54),s=n(18);t.exports=function(t,e){return function(n,a){var u=s(n)?r:o,c=e?e():{};return u(n,t,i(a,2),c)}}},function(t,e){t.exports=function(t,e,n,r){for(var o=-1,i=null==t?0:t.length;++o<i;){var s=t[o];e(r,s,n(s),t)}return r}},function(t,e,n){var r=n(84);t.exports=function(t,e,n,o){return r(t,(function(t,r,i){e(o,t,n(t),i)})),o}},function(t,e,n){t.exports=n(469)},function(t,e,n){var r=n(470),o=n(84),i=n(471),s=n(18);t.exports=function(t,e){return(s(t)?r:o)(t,i(e))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(473),o=n(474),i=n(54),s=n(18);t.exports=function(t,e){return(s(t)?r:o)(t,i(e,3))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var s=t[n];e(s,n,t)&&(i[o++]=s)}return i}},function(t,e,n){var r=n(84);t.exports=function(t,e){var n=[];return r(t,(function(t,r,o){e(t,r,o)&&n.push(t)})),n}},function(t,e,n){var r=n(476)(n(55));t.exports=r},function(t,e,n){var r=n(477),o=n(174),i=n(478),s=n(479);t.exports=function(t){return function(e){var n=o(e);return"[object Map]"==n?i(e):"[object Set]"==n?s(e):r(e,t(e))}}},function(t,e,n){var r=n(57);t.exports=function(t,e){return r(e,(function(e){return[e,t[e]]}))}},function(t,e){t.exports=function(){return[]}},function(t,e){t.exports=function(){return[]}},function(t,e,n){"use strict";n.r(e),n.d(e,"TigerConnectClient",(function(){return uc}));var r={};n.r(r),n.d(r,"Calls",(function(){return T})),n.d(r,"Conversations",(function(){return R})),n.d(r,"DistributionLists",(function(){return z})),n.d(r,"Entities",(function(){return V})),n.d(r,"Escalations",(function(){return X})),n.d(r,"Events",(function(){return rt})),n.d(r,"Groups",(function(){return pt})),n.d(r,"Messages",(function(){return At})),n.d(r,"MessageTemplates",(function(){return Mt})),n.d(r,"Metadata",(function(){return Lt})),n.d(r,"Mute",(function(){return Wt})),n.d(r,"Notifications",(function(){return Xt})),n.d(r,"Organizations",(function(){return oe})),n.d(r,"Patients",(function(){return ue})),n.d(r,"QRCode",(function(){return he})),n.d(r,"Reporting",(function(){return Ie})),n.d(r,"Roles",(function(){return Re})),n.d(r,"RoleTags",(function(){return ke})),n.d(r,"Roster",(function(){return qe})),n.d(r,"Scheduler",(function(){return Ye})),n.d(r,"ScheduledMessages",(function(){return Je})),n.d(r,"Search",(function(){return sn})),n.d(r,"Teams",(function(){return vn})),n.d(r,"Twilio",(function(){return _n})),n.d(r,"TypingStatus",(function(){return On})),n.d(r,"UserRoles",(function(){return Cn})),n.d(r,"Users",(function(){return Rn.a})),n.d(r,"VirtualWaitingRoom",(function(){return Nn}));var o={};n.r(o),n.d(o,"AllowedSendersReason",(function(){return Xn})),n.d(o,"ConversationAnchorPoints",(function(){return Qn})),n.d(o,"EscalationChangeAction",(function(){return Zn})),n.d(o,"EscalationStatus",(function(){return Jn})),n.d(o,"GroupType",(function(){return tr})),n.d(o,"MessagePriority",(function(){return er})),n.d(o,"MessageRecipientStatus",(function(){return or})),n.d(o,"MessageSenderStatus",(function(){return ir})),n.d(o,"MessageSubType",(function(){return sr})),n.d(o,"MessageType",(function(){return ar})),n.d(o,"Networks",(function(){return ur})),n.d(o,"PatientCareCardActionType",(function(){return cr})),n.d(o,"PatientCareCardType",(function(){return lr})),n.d(o,"PatientCareCardUIType",(function(){return dr})),n.d(o,"PresenceStatus",(function(){return fr})),n.d(o,"ProcessingActionTypes",(function(){return hr})),n.d(o,"SearchType",(function(){return pr})),n.d(o,"TypingContext",(function(){return vr})),n.d(o,"VisibilityType",(function(){return yr}));var i={};n.r(i),n.d(i,"Calls",(function(){return uo})),n.d(i,"Conversations",(function(){return Go})),n.d(i,"DistributionLists",(function(){return Zo})),n.d(i,"Entities",(function(){return ri})),n.d(i,"Escalations",(function(){return ui})),n.d(i,"EventRouter",(function(){return fi})),n.d(i,"Events",(function(){return Si})),n.d(i,"Forums",(function(){return xi})),n.d(i,"Groups",(function(){return Li})),n.d(i,"Messages",(function(){return Xi})),n.d(i,"MessageTemplates",(function(){return ns})),n.d(i,"Metadata",(function(){return cs})),n.d(i,"Mute",(function(){return ys})),n.d(i,"NotificationRouter",(function(){return ms})),n.d(i,"Notifications",(function(){return Ts})),n.d(i,"Organizations",(function(){return ks})),n.d(i,"Patients",(function(){return Bs})),n.d(i,"Presence",(function(){return Hs})),n.d(i,"Products",(function(){return Xs})),n.d(i,"Roles",(function(){return oa})),n.d(i,"RoleTags",(function(){return la})),n.d(i,"ScheduledMessages",(function(){return ya})),n.d(i,"Search",(function(){return La})),n.d(i,"Teams",(function(){return Ga})),n.d(i,"TypingStatus",(function(){return Za})),n.d(i,"UserRoles",(function(){return ou})),n.d(i,"Users",(function(){return hu})),n.d(i,"VirtualWaitingRoom",(function(){return mu}));var s={};n.r(s),n.d(s,"Call",(function(){return bu})),n.d(s,"CallLogEntry",(function(){return wu})),n.d(s,"Conversation",(function(){return Iu})),n.d(s,"DistributionList",(function(){return Ou})),n.d(s,"EscalationExecution",(function(){return Eu})),n.d(s,"EscalationExecutionChange",(function(){return Tu})),n.d(s,"EscalationPolicy",(function(){return Su})),n.d(s,"Group",(function(){return Au})),n.d(s,"GroupMembersChange",(function(){return Cu})),n.d(s,"Message",(function(){return Ru})),n.d(s,"MessageStatusPerRecipient",(function(){return Pu})),n.d(s,"MessageTemplate",(function(){return ju})),n.d(s,"Metadata",(function(){return xu})),n.d(s,"Mute",(function(){return Mu})),n.d(s,"Organization",(function(){return Lu})),n.d(s,"Patient",(function(){return Fu})),n.d(s,"PatientContact",(function(){return Bu})),n.d(s,"Product",(function(){return qu})),n.d(s,"ProductRoles",(function(){return Gu})),n.d(s,"Role",(function(){return Hu})),n.d(s,"RoleTag",(function(){return Wu})),n.d(s,"ScheduledMessage",(function(){return Yu})),n.d(s,"Team",(function(){return Ku})),n.d(s,"TeamRequest",(function(){return $u})),n.d(s,"User",(function(){return Pa})),n.d(s,"UserRoles",(function(){return Xu})),n.d(s,"VirtualWaitingRoom",(function(){return Qu})),n.d(s,"VirtualWaitingRoomVisit",(function(){return Zu}));var a,u=n(10),c=n.n(u),l=n(48),d=n.n(l),f=n(2),h=n.n(f),p=n(127),v=n.n(p),y=n(16),g=n.n(y),m=n(1),_=n(5),b=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),w=function(){return(w=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},I=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},O=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return b(e,t),e.prototype.start=function(t){return I(this,void 0,void 0,(function(){var e,n,r;return O(this,(function(o){switch(o.label){case 0:return[4,this.httpClient.post("/v2/voip_call",{data:_.a.underscoreObject(t),headers:{"TT-X-Organization-Key":t.organizationId}})];case 1:return e=o.sent(),n=Object(f.get)(e,"data.disabled_participants",{}),(r=_.a.camelizeObject(e.data)).disabledParticipants=n,[2,r]}}))}))},e.prototype.end=function(t,e,n){var r=n.callId,o=n.payload,i=n.reason;return I(this,void 0,void 0,(function(){var n,s;return O(this,(function(a){switch(a.label){case 0:return n=Object(f.get)(o,"disabledParticipants",{}),(s=_.a.underscoreObject({payload:o,reason:i,callId:r})).payload.disabled_participants=n,[4,this.httpClient.post("/v2/voip_call/"+t+"/end",{data:s,headers:{"TT-X-Organization-Key":e}})];case 1:return a.sent(),[2]}}))}))},e.prototype.decline=function(t,e,n){var r=n.callId,o=n.payload;return I(this,void 0,void 0,(function(){var n,i;return O(this,(function(s){switch(s.label){case 0:return n=Object(f.get)(o,"disabledParticipants",{}),"declined",(i=_.a.underscoreObject({payload:w(w({},o),{reason:"declined",callId:r}),reason:"declined",callId:r,type:"call_ended",roomName:t})).payload.disabled_participants=n,[4,this.httpClient.post("/v2/voip_call/"+t+"/end",{data:i,headers:{"TT-X-Organization-Key":e}})];case 1:return s.sent(),[2]}}))}))},e.prototype.join=function(t,e){return I(this,void 0,void 0,(function(){return O(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.get("/v2/voip_call/"+t,{headers:{"TT-X-Organization-Key":e}})];case 1:return[2,n.sent().data]}}))}))},e.prototype.answer=function(t,e,n){var r=n.callId,o=n.payload;return I(this,void 0,void 0,(function(){var n,i;return O(this,(function(s){switch(s.label){case 0:return n=Object(f.get)(o,"disabledParticipants",{}),"answered",(i=_.a.underscoreObject({callId:r,payload:w(w({},o),{reason:"answered",callId:r}),reason:"answered",type:"call_answered",roomName:t})).payload.disabled_participants=n,[4,this.httpClient.post("/v2/voip_call/"+t+"/answer",{data:i,headers:{"TT-X-Organization-Key":e}})];case 1:return s.sent(),[2]}}))}))},e.prototype.invite=function(t,e,n){var r=n.callId,o=n.payload,i=n.recipients;return I(this,void 0,void 0,(function(){var n,s;return O(this,(function(a){switch(a.label){case 0:return n=Object(f.get)(o,"disabledParticipants",{}),(s=_.a.underscoreObject({callId:r,payload:o,recipients:i})).payload.disabled_participants=n,[4,this.httpClient.post("/v2/voip_call/"+t+"/add_participants",{data:s,headers:{"TT-X-Organization-Key":e}})];case 1:return a.sent(),[2]}}))}))},e.prototype.state=function(t,e,n){var r=n.callId,o=n.payload;return I(this,void 0,void 0,(function(){var n,i;return O(this,(function(s){switch(s.label){case 0:return n=Object(f.get)(o,"disabledParticipants",{}),(i=_.a.underscoreObject({callId:r,payload:w(w({},o),{callId:r})})).payload.disabled_participants=n,[4,this.httpClient.post("/v2/voip_call/"+t+"/state",{data:i,headers:{"TT-X-Organization-Key":e}})];case 1:return s.sent(),[2]}}))}))},e.prototype.log=function(t){var e=t.network,n=t.organizationId,r=t.page;return I(this,void 0,void 0,(function(){var t,o;return O(this,(function(i){switch(i.label){case 0:return t={network:e,size:10},r&&(t.page=r),[4,this.httpClient.get("/v2/call_log",{headers:{"TT-X-Organization-Key":n},query:t})];case 1:return o=i.sent(),[2,_.a.camelizeObject(o.data)]}}))}))},e}(m.c),T=E,S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),A=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},C=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return S(e,t),e.prototype.find=function(t){return A(this,void 0,void 0,(function(){return C(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.get("/v5/conversation/:id",{urlParams:{id:t}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.updateConversationStatus=function(t,e,n){var r=void 0===n?{}:n,o=r.highestSortNumber,i=r.lowestSortNumber;return A(this,void 0,void 0,(function(){var n;return C(this,(function(r){switch(r.label){case 0:return n={status:e},o&&(n.highest_sort_number=o),i&&(n.lowest_sort_number=i),[4,this.httpClient.post("/v5/conversation/:id/status",{urlParams:{id:t},data:n})];case 1:return[2,r.sent().data]}}))}))},e.prototype.fetchTimeline=function(t,e,n,r){var o=r.continuation,i=r.markAsDelivered,s=void 0===i||i;return A(this,void 0,void 0,(function(){return C(this,(function(r){switch(r.label){case 0:return[4,this.httpClient.post("/v5/conversation/:id/timeline",{urlParams:{id:t},data:{anchor_point:e,continuation:o,mark_as_delivered:s,max_items:n}})];case 1:return[2,r.sent().data]}}))}))},e}(m.c),P=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},x=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},M=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},k=m.b.VERSION_TWO,N=m.a.DISTRIBUTION_LIST_FIND,z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.batch=function(t){var e=t.ids,n=t.operation,r=t.organizationId;return x(this,void 0,void 0,(function(){var t;return M(this,(function(o){switch(o.label){case 0:return t={"TT-X-Organization-Key":r},[4,this.httpClient.patch("/v5/dist_list",{data:{ids:e,operation:n},headers:t})];case 1:return o.sent(),[2]}}))}))},e.prototype.create=function(t){var e=t.adminOnly,n=t.members,r=t.name,o=t.network,i=t.organizationId;return x(this,void 0,void 0,(function(){var t;return M(this,(function(s){switch(s.label){case 0:return t={"TT-X-Organization-Key":i},[4,this.httpClient.post("/v5/dist_list",{data:{admin_only:e,members:n,name:r,network:o},headers:t})];case 1:return[2,s.sent().data]}}))}))},e.prototype.delete=function(t,e){return x(this,void 0,void 0,(function(){var n;return M(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.del("/v5/dist_list/:id",{headers:n,urlParams:{id:t}})];case 1:return r.sent(),[2]}}))}))},e.prototype.find=function(e,n){var r=(void 0===n?{}:n).organizationId;return x(this,void 0,void 0,(function(){var n,o,i;return M(this,(function(s){switch(s.label){case 0:return n=t.prototype.getVersion.call(this,N).version,o=void 0===n?k:n,i={},r&&(i["TT-X-Organization-Key"]=r),[4,this.httpClient.get("/:version/dist_list/:id",{headers:i,urlParams:{id:e,version:o}})];case 1:return[2,s.sent().data]}}))}))},e.prototype.findMemberIds=function(e,n,r){var o=(void 0===r?{}:r).continuation;return x(this,void 0,void 0,(function(){var r,i,s,a;return M(this,(function(u){switch(u.label){case 0:return r=t.prototype.getVersion.call(this,N).version,i=void 0===r?k:r,s={"TT-X-Organization-Key":n},a="/:version/dist_list/:id/members",o&&(a+="/?continuation=:continuation"),[4,this.httpClient.get(a,{headers:s,urlParams:{continuation:o,id:e,version:i}})];case 1:return[2,u.sent().data]}}))}))},e.prototype.membersBatch=function(t){var e=t.id,n=t.members,r=t.operation,o=t.organizationId;return x(this,void 0,void 0,(function(){var t;return M(this,(function(i){switch(i.label){case 0:return t={"TT-X-Organization-Key":o},[4,this.httpClient.patch("/v5/dist_list/:id/members",{data:{members:n,operation:r},headers:t,urlParams:{id:e}})];case 1:return[2,i.sent().data]}}))}))},e.prototype.update=function(t){var e=t.adminOnly,n=t.id,r=t.name,o=t.organizationId;return x(this,void 0,void 0,(function(){var t;return M(this,(function(i){switch(i.label){case 0:return t={"TT-X-Organization-Key":o},[4,this.httpClient.put("/v5/dist_list/:id",{data:{admin_only:e,name:r},headers:t,urlParams:{id:n}})];case 1:return[2,i.sent().data]}}))}))},j([Object(m.d)()],e.prototype,"delete",null),j([Object(m.d)()],e.prototype,"find",null),j([Object(m.d)()],e.prototype,"findMemberIds",null),j([Object(m.d)()],e.prototype,"membersBatch",null),j([Object(m.d)()],e.prototype,"update",null),e}(m.c),D=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),U=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},L=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},F=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},B=m.b.VERSION_TWO,q=m.a.ENTITIES_FIND_ALL,V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return D(e,t),e.prototype.findMulti=function(e){var n=e.users,r=e.metadata,o=e.organizationId;return L(this,void 0,void 0,(function(){var e,i,s,a;return F(this,(function(u){switch(u.label){case 0:return e=t.prototype.getVersion.call(this,q).version,i=void 0===e?B:e,s={"TT-X-Organization-Key":o},a={render_owner_object:"true"},[4,this.httpClient.post("/:version/entities_bulk",{urlParams:{version:i},data:{users:n,metadata:r},headers:s,query:a})];case 1:return[2,u.sent().data]}}))}))},U([Object(m.d)()],e.prototype,"findMulti",null),e}(m.c),G=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),H=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},W=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Y=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},K=m.b.VERSION_TWO,$=m.a.ESCALATION,X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return G(e,t),e.prototype.escalateMessage=function(e){return W(this,void 0,void 0,(function(){var n,r;return Y(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,$).version,r=void 0===n?K:n,[4,this.httpClient.post("/:version/message/:messageId/escalation",{urlParams:{version:r,messageId:e}})];case 1:return[2,o.sent().data]}}))}))},e.prototype.acknowledge=function(e,n){var r=n.messageId,o=n.userTokens;return W(this,void 0,void 0,(function(){var n,i;return Y(this,(function(s){switch(s.label){case 0:return n=t.prototype.getVersion.call(this,$).version,i=void 0===n?K:n,[4,this.httpClient.post("/:version/message/:messageId/escalation/:escalationId/confirm",{urlParams:{version:i,escalationId:e,messageId:r},data:{confirm_as:o}})];case 1:return[2,s.sent().data]}}))}))},e.prototype.cancel=function(e){return W(this,void 0,void 0,(function(){var n,r;return Y(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,$).version,r=void 0===n?K:n,[4,this.httpClient.del("/:version/message/:messageId/escalation",{urlParams:{version:r,messageId:e}})];case 1:return o.sent(),[2]}}))}))},e.prototype.skip=function(e,n){var r=n.messageId,o=n.userTokens;return W(this,void 0,void 0,(function(){var n,i;return Y(this,(function(s){switch(s.label){case 0:return n=t.prototype.getVersion.call(this,$).version,i=void 0===n?K:n,[4,this.httpClient.post("/:version/message/:messageId/escalation/:escalationId/skip",{urlParams:{version:i,escalationId:e,messageId:r},data:{skip_as:o}})];case 1:return[2,s.sent().data]}}))}))},H([Object(m.d)()],e.prototype,"escalateMessage",null),H([Object(m.d)()],e.prototype,"acknowledge",null),H([Object(m.d)()],e.prototype,"cancel",null),H([Object(m.d)()],e.prototype,"skip",null),e}(m.c),Q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Z=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},J=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},tt=m.b.VERSION_TWO,et=m.a.EVENTS_ACK,nt=m.a.EVENTS_CLOSE_ALL_CONNECTIONS,rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Q(e,t),e.prototype.ack=function(e){return Z(this,void 0,void 0,(function(){var n,r;return J(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,et).version,r=void 0===n?tt:n,[4,this.httpClient.post("/:version/events/ack",{urlParams:{version:r},data:{events:e}})];case 1:return o.sent(),[2]}}))}))},e.prototype.closeAllConnections=function(){return Z(this,void 0,void 0,(function(){var e,n;return J(this,(function(r){switch(r.label){case 0:return e=t.prototype.getVersion.call(this,nt).version,n=void 0===e?tt:e,[4,this.httpClient.del("/:version/events",{urlParams:{version:n}})];case 1:return r.sent(),[2]}}))}))},e}(m.c),ot=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},st=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},at=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ut=m.b.VERSION_TWO,ct=m.a.GROUP_ADD_MEMBERS,lt=m.a.GROUP_CREATE,dt=m.a.GROUP_DESTROY,ft=m.a.GROUP_FIND,ht=m.a.GROUP_UPDATE,pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ot(e,t),e.prototype.create=function(e){var n=e.avatarFile,r=e.description,o=e.excludeCreator,i=e.isPublic,s=void 0!==i&&i,a=e.memberIds,u=void 0===a?[]:a,c=e.metadata,l=e.name,d=e.organizationId,f=e.renderEntity,h=void 0===f||f,p=e.replayHistory,v=void 0!==p&&p;return st(this,void 0,void 0,(function(){var e,i,a,f,p,y;return at(this,(function(g){switch(g.label){case 0:return e=t.prototype.getVersion.call(this,lt).version,i=void 0===e?ut:e,a={},f={is_public:s,members:u.join(","),metadata:c,name:l,replay_history:v},p={},y={exclude_creator:o,render_entity:h},n&&(p.avatar=n),r&&(f.description=r),d&&(a["TT-X-Organization-Key"]=d),[4,this.httpClient.post("/:version/group",{urlParams:{version:i},query:y,headers:a,data:f,files:p})];case 1:return[2,g.sent().data]}}))}))},e.prototype.update=function(e,n){var r=n.name,o=void 0===r?void 0:r,i=n.avatarFile,s=void 0===i?void 0:i,a=n.replayHistory,u=void 0===a?void 0:a,c=n.memberIds;return st(this,void 0,void 0,(function(){var n,r,i,a,l,d;return at(this,(function(f){switch(f.label){case 0:return n=t.prototype.getVersion.call(this,ht).version,r=void 0===n?ut:n,i={},a={},void 0!==o&&(i.name=o),void 0!==c&&(i.members=c.join(",")),void 0!==u&&(i.replay_history=u),s&&(a.avatar=s),[4,this.httpClient.post("/:version/group/:id",{urlParams:{id:e,version:r},data:i,files:a})];case 1:return l=f.sent(),d=l.getHeader("TT-X-Group-Avatar"),[2,{id:e,avatarUrl:d}]}}))}))},e.prototype.find=function(e){return st(this,void 0,void 0,(function(){var n,r;return at(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,ft).version,r=void 0===n?ut:n,[4,this.httpClient.get("/:version/group/:id",{urlParams:{id:e,version:r},query:{render_metadata:"true"}})];case 1:return[2,o.sent().data]}}))}))},e.prototype.findAllMemberIds=function(t){return st(this,void 0,void 0,(function(){return at(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.get("/:version/group/:id/members",{urlParams:{id:t,version:ut}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.destroy=function(e){return st(this,void 0,void 0,(function(){var n,r;return at(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,dt).version,r=void 0===n?ut:n,[4,this.httpClient.del("/:version/group/:id",{urlParams:{id:e,version:r}})];case 1:return o.sent(),[2,!0]}}))}))},e.prototype.addMembers=function(e,n){return st(this,void 0,void 0,(function(){var r,o;return at(this,(function(i){switch(i.label){case 0:return r=t.prototype.getVersion.call(this,ct).version,o=void 0===r?ut:r,[4,this.httpClient.post("/:version/group/:id/members",{urlParams:{id:e,version:o},data:{members:n}})];case 1:return[2,i.sent().data]}}))}))},e.prototype.removeMembers=function(t,e){return st(this,void 0,void 0,(function(){return at(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.post("/v2/group/:id/members/remove",{urlParams:{id:t},data:{members:e}})];case 1:return n.sent(),[2]}}))}))},it([Object(m.d)()],e.prototype,"find",null),it([Object(m.d)()],e.prototype,"findAllMemberIds",null),it([Object(m.d)()],e.prototype,"destroy",null),e}(m.c),vt=n(13),yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(){return(gt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},mt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_t=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},bt=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},wt=m.b.VERSION_FIVE,It=m.b.VERSION_TWO,Ot=m.a.MESSAGE_FIND,Et=m.a.MESSAGE_FORWARD,Tt=m.a.MESSAGE_SEND,St=m.a.MESSAGE_UPDATE_RECIPIENT_STATUS_MULTI,At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return yt(e,t),e.prototype.send=function(e){var n=e.attachment,r=e.body,o=e.conversationId,i=e.counterPartyId,s=e.deleteOnRead,a=e.escalate,u=e.localId,c=e.metadata,l=e.priority,d=e.recipientOrganizationId,f=e.senderOrganizationId,h=e.ttl;return _t(this,void 0,void 0,(function(){var e,p,v,y,g,m,_,b,w,I;return bt(this,(function(O){switch(O.label){case 0:e=t.prototype.getVersion.call(this,Tt).version,v={body:r},y={},g={},(p=void 0===e?It:e)===It?(Object(vt.isEmail)(i)&&(i=i.toLowerCase()),v.recipient=i,y.response_format="message",d||(d=f),f&&(v.sender_organization=f),d&&(v.recipient_organization=d)):p===wt&&(v.conversation_id=o),c&&(v.data=c.map((function(t){return gt(gt({},t),{payload:JSON.stringify(t.payload)})}))),n&&(g.attachment=n),s&&(v.dor=s),a&&(v.escalate=a),void 0!==l&&(v.priority=l),h&&(v.ttl=h),O.label=1;case 1:return O.trys.push([1,5,,6]),[4,this.httpClient.post("/:version/message",{urlParams:{version:p},data:v,files:g,query:y,requestId:u,timeout:!n})];case 2:return m=O.sent(),_=m.headers["tt-x-message-id"],this.config.condensedReplays&&m.data.last_message&&_!==m.data.last_message.message_id?[4,this.host.api.messages.find(_)]:[3,4];case 3:(b=O.sent())&&(m.data.last_message=b.message),O.label=4;case 4:return[2,m.data];case 5:return 304!==(w=O.sent()).status?[2,Promise.reject(w)]:(I=w.response.headers["TT-X-Message-Id".toLowerCase()])?[2,{message_id:I}]:[2,Promise.reject(w)];case 6:return[2]}}))}))},e.prototype.destroy=function(t){return _t(this,void 0,void 0,(function(){return bt(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.httpClient.del("/v2/message/:id",{urlParams:{id:t}})];case 1:return e.sent(),[2,!0];case 2:return e.sent(),[2,!1];case 3:return[2]}}))}))},e.prototype.forward=function(e,n,r){var o=r.conversationId,i=r.localId,s=r.metadata,a=r.priority,u=r.recipientOrganizationId,c=r.senderOrganizationId;return _t(this,void 0,void 0,(function(){var r,l,d,f;return bt(this,(function(h){switch(h.label){case 0:return r=t.prototype.getVersion.call(this,Et).version,d={},(l=void 0===r?It:r)===It?(d.recipient=n,u||(u=c),c&&(d.sender_organization=c),u&&(d.recipient_organization=u)):l===wt&&(d.conversation_id=o),s&&(d.data=s.map((function(t){return gt(gt({},t),{payload:JSON.stringify(t.payload)})}))),void 0!==a&&(d.priority=a),[4,this.httpClient.post("/:version/message/:id/forward",{urlParams:{id:e,version:l},data:d,requestId:i})];case 1:return f=h.sent(),l===It?[2,{message_id:f.getHeader("TT-X-Message-Id")}]:[2,f.data]}}))}))},e.prototype.find=function(e){return _t(this,void 0,void 0,(function(){var n,r;return bt(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,Ot).version,r=void 0===n?It:n,[4,this.httpClient.get("/:version/message/:id",{urlParams:{id:e,version:r}})];case 1:return[2,o.sent().data]}}))}))},e.prototype.findRecipientStatus=function(t){return _t(this,void 0,void 0,(function(){return bt(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.get("/:version/message/:id/status",{urlParams:{id:t,version:It}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.findRecipientStatusMulti=function(t){return _t(this,void 0,void 0,(function(){return bt(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/:version/get_bulk_message_status",{urlParams:{version:It},data:{messages:t}})];case 1:return[2,e.sent().data.bulk_message_statuses]}}))}))},e.prototype.updateRecipientStatusMulti=function(e){return _t(this,void 0,void 0,(function(){var n,r;return bt(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,St).version,r=void 0===n?It:n,[4,this.httpClient.post("/:version/message/status",{urlParams:{version:r},data:e})];case 1:return[2,o.sent().data]}}))}))},e.prototype.createAttachmentTokens=function(t){return void 0===t&&(t=20),_t(this,void 0,void 0,(function(){return bt(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v5/attachment_tokens_bulk",{data:{count:t,expire_after_sec:43200,expire_after_used_sec:5}})];case 1:return[2,e.sent().data]}}))}))},mt([Object(m.d)()],e.prototype,"find",null),mt([Object(m.d)()],e.prototype,"findRecipientStatus",null),e}(m.c),Ct=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(){return(Rt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Pt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},jt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},xt=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ct(e,t),e.prototype.batch=function(t){var e=t.ids,n=t.operation,r=t.organizationId;return jt(this,void 0,void 0,(function(){var t;return xt(this,(function(o){switch(o.label){case 0:return t={"TT-X-Organization-Key":r},[4,this.httpClient.patch("/v5/message_template",{data:{ids:e,operation:n},headers:t})];case 1:return o.sent(),[2]}}))}))},e.prototype.create=function(t){var e=t.attachment,n=t.body,r=t.network,o=t.organizationId,i=t.repository,s=t.title;return jt(this,void 0,void 0,(function(){var t,a;return xt(this,(function(u){switch(u.label){case 0:return t={},a={"TT-X-Organization-Key":o},e&&(t.attachment=e),[4,this.httpClient.post("/v5/message_template",{files:t,data:{body:n,network:r,repository:i,template_label:s},headers:a,timeout:!e})];case 1:return[2,u.sent().data]}}))}))},e.prototype.delete=function(t,e){return jt(this,void 0,void 0,(function(){var n;return xt(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.del("/v5/message_template/:id",{headers:n,urlParams:{id:t}})];case 1:return r.sent(),[2]}}))}))},e.prototype.downloadTemplateFile=function(t){var e=t.templateId,n=t.fileName,r=t.organizationId;return jt(this,void 0,void 0,(function(){var t,o;return xt(this,(function(i){return t={"TT-X-Organization-Key":r},o="/v5/message_template/"+e+"/attachment/"+n,[2,this.httpClient.downloadFileBlob(o,{headers:t})]}))}))},e.prototype.find=function(t,e){return jt(this,void 0,void 0,(function(){var n;return xt(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.get("/v5/message_template/:id",{headers:n,urlParams:{id:t}})];case 1:return[2,r.sent().data]}}))}))},e.prototype.update=function(t){var e=t.attachment,n=t.body,r=t.id,o=t.organizationId,i=t.repository,s=t.title;return jt(this,void 0,void 0,(function(){var t,a;return xt(this,(function(u){switch(u.label){case 0:return t={},a={"TT-X-Organization-Key":o},e&&(t.attachment=e),[4,this.httpClient.put("/v5/message_template/:id",{files:t,data:Rt(Rt({},t.attachment?null:{attachment:e}),{body:n,repository:i,template_label:s}),headers:a,timeout:!e,urlParams:{id:r}})];case 1:return[2,u.sent().data]}}))}))},Pt([Object(m.d)()],e.prototype,"delete",null),Pt([Object(m.d)()],e.prototype,"downloadTemplateFile",null),Pt([Object(m.d)()],e.prototype,"find",null),Pt([Object(m.d)()],e.prototype,"update",null),e}(m.c),kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},zt=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Dt=m.b.VERSION_TWO,Ut=m.a.METADATA_FIND,Lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.update=function(t,e,n){return Nt(this,void 0,void 0,(function(){return zt(this,(function(r){switch(r.label){case 0:return[4,this.httpClient.post("/v2/metadata/:id",{urlParams:{id:t},data:e,headers:{"TT-X-Organization-Key":n}})];case 1:return r.sent(),[2]}}))}))},e.prototype.find=function(e,n){return Nt(this,void 0,void 0,(function(){var r,o;return zt(this,(function(i){switch(i.label){case 0:return r=t.prototype.getVersion.call(this,Ut).version,o=void 0===r?Dt:r,[4,this.httpClient.get("/:version/metadata/:id",{urlParams:{id:e,version:o},headers:{"TT-X-Organization-Key":n}})];case 1:return[2,i.sent().data]}}))}))},e}(m.c),Ft=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},qt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Vt=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Gt=m.b.VERSION_TWO,Ht=m.a.MUTE_FIND_ALL,Wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ft(e,t),e.prototype.findAll=function(){return qt(this,void 0,void 0,(function(){var e,n;return Vt(this,(function(r){switch(r.label){case 0:return e=t.prototype.getVersion.call(this,Ht).version,n=void 0===e?Gt:e,[4,this.httpClient.get("/:version/mute",{urlParams:{version:n}})];case 1:return[2,r.sent().data]}}))}))},e.prototype.unmuteAll=function(){return qt(this,void 0,void 0,(function(){return Vt(this,(function(t){switch(t.label){case 0:return[4,this.httpClient.del("/v2/mute")];case 1:return t.sent(),[2]}}))}))},e.prototype.muteUser=function(t,e,n,r){var o=(void 0===r?{}:r).recipientOrganizationId,i=void 0===o?n:o;return qt(this,void 0,void 0,(function(){return Vt(this,(function(r){switch(r.label){case 0:return[4,this.httpClient.post("/v2/mute/p2p",{data:{sender_token:t,sender_organization:n,receiver_organization:i,duration:e.toString()}})];case 1:return r.sent(),[2]}}))}))},e.prototype.unmuteUser=function(t,e,n){var r=(void 0===n?{}:n).recipientOrganizationId,o=void 0===r?e:r;return qt(this,void 0,void 0,(function(){return Vt(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.del("/v2/mute/p2p",{headers:{"TT-X-Sender-Token":t,"TT-X-Sender-Organization":e,"TT-X-Receiver-Organization":o}})];case 1:return n.sent(),[2]}}))}))},e.prototype.muteGroup=function(t,e,n){return qt(this,void 0,void 0,(function(){return Vt(this,(function(r){switch(r.label){case 0:return[4,this.httpClient.post("/v2/mute/group/:groupId",{urlParams:{groupId:t},data:{duration:e.toString(),receiver_organization:n}})];case 1:return r.sent(),[2]}}))}))},e.prototype.unmuteGroup=function(t,e){return qt(this,void 0,void 0,(function(){return Vt(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.del("/v2/mute/group/:groupId",{urlParams:{groupId:t},headers:{"TT-X-Receiver-Organization":e}})];case 1:return n.sent(),[2]}}))}))},e.prototype.muteOrganization=function(t,e){return qt(this,void 0,void 0,(function(){return Vt(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.post("/v2/mute/organization/:organizationId",{urlParams:{organizationId:t},data:{duration:e.toString(),receiver_organization:t}})];case 1:return n.sent(),[2]}}))}))},e.prototype.unmuteOrganization=function(t){return qt(this,void 0,void 0,(function(){return Vt(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.del("/v2/mute/organization/:organizationId",{urlParams:{organizationId:t},headers:{"TT-X-Receiver-Organization":t}})];case 1:return e.sent(),[2]}}))}))},Bt([Object(m.d)()],e.prototype,"muteUser",null),Bt([Object(m.d)()],e.prototype,"unmuteUser",null),Bt([Object(m.d)()],e.prototype,"muteGroup",null),Bt([Object(m.d)()],e.prototype,"unmuteGroup",null),Bt([Object(m.d)()],e.prototype,"muteOrganization",null),Bt([Object(m.d)()],e.prototype,"unmuteOrganization",null),e}(m.c),Yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},$t=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yt(e,t),e.prototype.closeAllConnections=function(t,e){return Kt(this,void 0,void 0,(function(){var n;return $t(this,(function(r){switch(r.label){case 0:return n=this.httpClient.getAuthHeaders({key:t,secret:e}),[4,this.httpClient.del("/v2/events/simple_notifications",{headers:n})];case 1:return r.sent(),[2]}}))}))},e.prototype.signIn=function(){return Kt(this,void 0,void 0,(function(){var t,e,n;return $t(this,(function(r){switch(r.label){case 0:return[4,this.host.httpClient.post("/v2/events/simple_notifications/key")];case 1:return t=r.sent(),e=t.getHeader("TT-X-Api-Key"),n=t.getHeader("TT-X-Api-Secret"),[2,{key:e,secret:n}]}}))}))},e.prototype.signOut=function(t,e){return Kt(this,void 0,void 0,(function(){var n;return $t(this,(function(r){return n=this.httpClient.getAuthHeaders({key:t,secret:e}),[2,this.httpClient.post("/v2/logout",{headers:n})]}))}))},e}(m.c),Qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zt=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Jt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},te=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ee=m.b.VERSION_TWO,ne=m.a.ORGANIZATION_FIND_ALL_OF_USER,re=m.a.ORGANIZATION_FIND,oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qt(e,t),e.prototype.find=function(e,n){return Jt(this,void 0,void 0,(function(){var r,o;return te(this,(function(i){switch(i.label){case 0:return r=t.prototype.getVersion.call(this,re).version,o=void 0===r?ee:r,[4,this.httpClient.get("/:version/user/:userId/organization/:id",{urlParams:{version:o,userId:e,id:n}})];case 1:return[2,i.sent().data]}}))}))},e.prototype.findAllOfUser=function(e){return Jt(this,void 0,void 0,(function(){var n,r;return te(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,ne).version,r=void 0===n?ee:n,[4,this.httpClient.get("/:version/user/:userId/organization",{urlParams:{version:r,userId:e}})];case 1:return[2,o.sent().data]}}))}))},e.prototype.getPreferences=function(t){return Jt(this,void 0,void 0,(function(){return te(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.get("/v2/organization/:organizationId/preferences",{urlParams:{organizationId:t}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.editPreferences=function(t){var e=t.organizationId,n=t.quickReplies;return Jt(this,void 0,void 0,(function(){return te(this,(function(t){switch(t.label){case 0:return[4,this.httpClient.post("/v2/organization/:organizationId/preferences",{headers:{"TT-X-Organization-Key":e},data:_.a.underscoreObject({network:{patient:{quickReplies:n}}}),urlParams:{organizationId:e}})];case 1:return[2,t.sent().data]}}))}))},Zt([Object(m.d)()],e.prototype,"find",null),Zt([Object(m.d)()],e.prototype,"findAllOfUser",null),Zt([Object(m.d)()],e.prototype,"getPreferences",null),Zt([Object(m.d)()],e.prototype,"editPreferences",null),e}(m.c),ie=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),se=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ae=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ie(e,t),e.prototype.create=function(t){return se(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v5/patient",{data:_.a.underscoreObject(Object(f.omit)(t,"organizationId")),headers:{"TT-X-Organization-Key":t.organizationId}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.delete=function(t,e){return se(this,void 0,void 0,(function(){return ae(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.del("/v5/patient/:id",{urlParams:{id:t},headers:{"TT-X-Organization-Key":e}})];case 1:return[2,n.sent().data]}}))}))},e.prototype.update=function(t){return se(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v5/patient/:id",{data:_.a.underscoreObject(Object(f.omit)(t,["organizationId","patientId"])),headers:{"TT-X-Organization-Key":t.organizationId},urlParams:{id:t.patientId}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.createContact=function(t){return se(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v5/patient/:patient_id/contact",{data:_.a.underscoreObject(Object(f.omit)(t,["organizationId","patientId"])),headers:{"TT-X-Organization-Key":t.organizationId},urlParams:{patient_id:t.patientId}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.deleteContact=function(t){return se(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.del("/v5/patient/:patient_id/contact/:contact_id",{urlParams:{contact_id:t.contactId,patient_id:t.patientId},headers:{"TT-X-Organization-Key":t.organizationId}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.updateContact=function(t){return se(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v5/patient/:patient_id/contact/:contact_id",{data:_.a.underscoreObject(Object(f.omit)(t,["organizationId","patientId","contactId"])),headers:{"TT-X-Organization-Key":t.organizationId},urlParams:{patient_id:t.patientId,contact_id:t.contactId}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.login=function(t,e,n,r){return se(this,void 0,void 0,(function(){var o,i,s,a,u,c,l;return ae(this,(function(d){switch(d.label){case 0:return o={want_condensed_replays:this.config.wantCondensedReplays,want_processing_events:this.config.wantCondensedReplays},e?(o.auth={access_token:e},n&&(o.auth.dob=n)):n&&(o.auth={dob:n}),Array.isArray(r)&&(o.session_tokens=_.a.underscoreObject(r)),[4,this.httpClient.post("/v5/patient/login/:linkToken",{urlParams:{linkToken:t},data:o})];case 1:return(i=d.sent()).data&&(s=i.data,a=s.condensed_replays,u=void 0!==a&&a,c=s.processing_events,l=void 0!==c&&c,this.host.configure({condensedReplays:u,processingEvents:l})),[2,i.data]}}))}))},e.prototype.loginCheck=function(t,e){return se(this,void 0,void 0,(function(){var n;return ae(this,(function(r){switch(r.label){case 0:return n={},Array.isArray(e)&&(n.session_tokens=_.a.underscoreObject(e)),[4,this.httpClient.post("/v5/patient/login_check/:linkToken",{urlParams:{linkToken:t},data:n})];case 1:return[2,r.sent().data]}}))}))},e.prototype.requestAccessToken=function(t){return se(this,void 0,void 0,(function(){return ae(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v5/patient/request_access_token/:linkToken",{urlParams:{linkToken:t},data:{}})];case 1:return[2,e.sent().data]}}))}))},e.prototype.csvUpload=function(t,e){return se(this,void 0,void 0,(function(){return ae(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.post("/v5/patient/csv/upload",{data:e,headers:{"TT-X-Organization-Key":t}})];case 1:return[2,n.sent().data]}}))}))},e.prototype.getWhiteLabel=function(t){return se(this,void 0,void 0,(function(){var e;return ae(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.get("/v5/patient/white_label/:organizationId",{urlParams:{organizationId:t},headers:{"TT-X-Organization-Key":t}})];case 1:return e=n.sent(),[2,_.a.camelizeObject(e.data)]}}))}))},e.prototype.setWhiteLabel=function(t,e){return se(this,void 0,void 0,(function(){return ae(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.post("/v5/patient/white_label/:organizationId",{urlParams:{organizationId:t},headers:{"TT-X-Organization-Key":t},data:_.a.underscoreObject(e)})];case 1:return[2,n.sent()]}}))}))},e}(m.c),ce=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),le=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},de=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},fe=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},he=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ce(e,t),e.prototype.create=function(){return de(this,void 0,void 0,(function(){var t;return fe(this,(function(e){switch(e.label){case 0:return t=this.httpClient.getAuthHeaders(),[4,this.httpClient.get("/v2/qr_login_code/",{headers:t})];case 1:return[2,e.sent().data.qr_key]}}))}))},le([Object(m.d)()],e.prototype,"create",null),e}(m.c),pe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ve=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ye=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ge=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},me=["messageId","sender.name","sender.title","sender.department","sender.mrn","senderRoleDisplayName","recipient.name","recipient.title","recipient.department","recipient.mrn","recipientRoleDisplayName","group.name","distributionList.name","sentTimestamp","attachment.hasAttachment","recalledTimestamp","forwardedMessageId","expireTimestamp","dndAutoForwardedFrom"],_e={script:"(doc['deliveredTimestamp'].empty ? '' : _source.deliveredTimestamp < _source.sentTimestamp ? _source.sentTimestamp : _source.deliveredTimestamp)"},be={script:"(doc['readTimestamp'].empty ? '' :_source.readTimestamp < _source.sentTimestamp ? _source.sentTimestamp : _source.readTimestamp)"},we=["sender.title","recipient.title","sender.department","sender.mrn","recipient.mrn","senderRoleDisplayName","recipient.department","recipientRoleDisplayName","sender.username","recipient.username","sender.verifiedEmails","recipient.verifiedEmails","sender.unverifiedEmails","recipient.unverifiedEmails","sender.verifiedPhones","recipient.verifiedPhones","sender.unverifiedPhones","recipient.unverifiedPhones","group.groupId","group.name","distributionList.distributionListId","distributionList.name","forwardedMessageId","messageId"],Ie=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.generateLookerEmbed=function(t,n){return ye(e,void 0,void 0,(function(){var e,r;return ge(this,(function(o){switch(o.label){case 0:return e={"TT-X-Organization-Key":t},[4,this.httpClient.post("/v2/looker",{headers:e,data:{dashboard_type:n}})];case 1:return[2,(r=o.sent().data)&&r.looker_url]}}))}))},e}return pe(e,t),e.prototype.fetchTransactions=function(t,e){var n=e.page,r=e.size,o=e.startDate,i=e.endDate,s=e.query;return ye(this,void 0,void 0,(function(){var e,a,u,c,l,d;return ge(this,(function(f){switch(f.label){case 0:return e={"TT-X-Organization-Key":t},a=n*r-r,u=t,l=(c=s)&&s.split(" ").join("*"),d=[{range:{sentTimestamp:{from:o,to:i}}},{match:{"sender.organization.orgId":u}},{constant_score:{filter:{missing:{field:"message.hideMessage"}}}},{bool:{should:[{query_string:{query:"*"+l+"*",fields:["sender.name","recipient.name"]}},{multi_match:{query:c,fields:we}}]}}],[4,this.httpClient.post("/v2/report/messages",{headers:e,data:{from:a,size:r,fields:me,script_fields:{deliveredTimestamp:_e,readTimestamp:be},sort:{sentTimestamp:{order:"desc"}},query:{bool:{must:d}}}})];case 1:return[2,f.sent()]}}))}))},ve([Object(m.d)()],e.prototype,"fetchTransactions",null),e}(m.c),Oe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ee=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Te=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Se=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ae=m.b.VERSION_TWO,Ce=m.a.ROLES_CREATE_P2P_GROUP,Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Oe(e,t),e.prototype.createP2PGroup=function(e){var n=e.createdByUserId,r=e.name,o=e.replayHistory,i=void 0!==o&&o,s=e.memberIds,a=void 0===s?[]:s,u=e.organizationId;return Te(this,void 0,void 0,(function(){var e,o,s,c,l,d,f,h,p;return Se(this,(function(v){switch(v.label){case 0:return e=t.prototype.getVersion.call(this,Ce).version,o=void 0===e?Ae:e,s={"TT-X-Organization-Key":u},c={created_by:n,members:a,name:r,replay_history:i},[4,this.httpClient.post("/:version/role_group",{urlParams:{version:o},headers:s,data:c})];case 1:return l=v.sent(),d=l.data,f=d.conversation_id,h=d.metadata,p=l.data.token,[2,{conversationId:f,memberIds:a,metadata:h,name:r,organizationId:u,token:p}]}}))}))},e.prototype.find=function(t,e){return Te(this,void 0,void 0,(function(){var n;return Se(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.get("/v2/role/:id",{urlParams:{id:t},headers:n})];case 1:return[2,r.sent().data]}}))}))},e.prototype.createRole=function(t){var e=t.description,n=t.escalationPolicy,r=t.name,o=t.noOwnersMessage,i=t.openAssignment,s=t.organizationId,a=t.ownerRequired,u=t.owners,c=t.replayHistory,l=t.tagColor,d=t.tagName,f=t.tagToken;return Te(this,void 0,void 0,(function(){var t,h,p;return Se(this,(function(v){switch(v.label){case 0:return t={"TT-X-Organization-Key":s},h={display_name:r,open_assignment:i?"1":"0",replay_history:c},void 0!==e&&(h.description=e),void 0!==n&&(h.escalation_policy=n),void 0!==o&&(h.no_owners_message=o),void 0!==a&&(h.owner_required=a?"1":"0"),void 0!==u&&(h.owners=u),void 0!==l&&(h.tag_color=l),void 0!==d&&(h.tag_name=d),void 0!==f&&(h.tag_id=f),[4,this.httpClient.post("/v2/role",{headers:t,data:h})];case 1:return(p=v.sent()).token=p.headers["tt-x-role-token"],[2,p]}}))}))},e.prototype.updateRole=function(t,e){var n=e.description,r=e.name,o=e.noOwnersMessage,i=e.openAssignment,s=e.organizationId,a=e.ownerRequired,u=e.owners,c=e.replayHistory,l=e.tagColor,d=e.tagName,f=e.tagToken,h=e.escalationPolicy;return Te(this,void 0,void 0,(function(){var e,p,v;return Se(this,(function(y){switch(y.label){case 0:return e={"TT-X-Organization-Key":s},p={},void 0!==n&&(p.description=n),void 0!==r&&(p.display_name=r),void 0!==o&&(p.no_owners_message=o),void 0!==h&&(p.escalation_policy=h),void 0!==i&&(p.open_assignment=i?"1":"0"),void 0!==a&&(p.owner_required=a?"1":"0"),void 0!==u&&(p.owners=u),void 0!==c&&(p.replay_history=c),void 0!==l&&(p.tag_color=l),void 0!==f&&(p.tag_id=f),void 0!==d&&(p.tag_name=d),[4,this.httpClient.put("/v2/role/:token",{urlParams:{token:t},headers:e,data:p})];case 1:return(v=y.sent()).token=t,[2,v]}}))}))},e.prototype.deleteRole=function(t,e){return Te(this,void 0,void 0,(function(){var n;return Se(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":t},[4,this.httpClient.del("/v2/role/:token",{urlParams:{token:e},headers:n})];case 1:return[2,r.sent()]}}))}))},e.prototype.findSavedRoles=function(t,e){return Te(this,void 0,void 0,(function(){var n;return Se(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.get("/v2/user/:userId/saved_roles",{urlParams:{userId:t},headers:n})];case 1:return[2,r.sent().data]}}))}))},e.prototype.saveRole=function(t,e,n){return Te(this,void 0,void 0,(function(){var r;return Se(this,(function(o){switch(o.label){case 0:return r={"TT-X-Organization-Key":n},[4,this.httpClient.post("/v2/user/:userId/saved_roles",{urlParams:{userId:e},data:{role_id:t},headers:r})];case 1:return[2,o.sent()]}}))}))},e.prototype.removeSavedRole=function(t,e,n){return Te(this,void 0,void 0,(function(){var r;return Se(this,(function(o){switch(o.label){case 0:return r={"TT-X-Organization-Key":n},[4,this.httpClient.del("/v2/user/:userId/saved_roles/:roleId",{urlParams:{userId:e,roleId:t},headers:r})];case 1:return[2,o.sent()]}}))}))},e.prototype.optIn=function(t,e,n){return Te(this,void 0,void 0,(function(){var r;return Se(this,(function(o){switch(o.label){case 0:return r={"TT-X-Organization-Key":n},[4,this.httpClient.post("/v2/role/:roleId/members/:userId",{urlParams:{roleId:t,userId:e},headers:r})];case 1:return[2,o.sent()]}}))}))},e.prototype.optOut=function(t,e,n){return Te(this,void 0,void 0,(function(){var r;return Se(this,(function(o){switch(o.label){case 0:return r={"TT-X-Organization-Key":n},[4,this.httpClient.del("/v2/role/:roleId/members/:userId",{urlParams:{roleId:t,userId:e},headers:r})];case 1:return[2,o.sent()]}}))}))},e.prototype.saveAwayResponse=function(t,e,n){return Te(this,void 0,void 0,(function(){var r;return Se(this,(function(o){switch(o.label){case 0:return r={"TT-X-Organization-Key":e},[4,this.httpClient.post("/v2/role/:roleId/away",{urlParams:{roleId:t},headers:r,data:{status:n}})];case 1:return[2,o.sent()]}}))}))},e.prototype.removeAwayResponse=function(t,e){return Te(this,void 0,void 0,(function(){var n;return Se(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.del("/v2/role/:roleId/away",{urlParams:{roleId:t},headers:n})];case 1:return[2,r.sent()]}}))}))},Ee([Object(m.d)()],e.prototype,"find",null),Ee([Object(m.d)()],e.prototype,"findSavedRoles",null),e}(m.c),Pe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),je=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xe=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Me=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),e.prototype.findAll=function(t){return xe(this,void 0,void 0,(function(){var e;return Me(this,(function(n){switch(n.label){case 0:return e={"TT-X-Organization-Key":t},[4,this.httpClient.get("/v2/role/tags",{headers:e})];case 1:return[2,n.sent().data]}}))}))},e.prototype.createOrUpdateTag=function(t,e,n,r){return xe(this,void 0,void 0,(function(){var o,i;return Me(this,(function(s){switch(s.label){case 0:return o={color:t,name:e,organizationId:n},r?[4,this.updateTag(r,o)]:[3,2];case 1:return i=s.sent(),[3,4];case 2:return[4,this.createTag(o)];case 3:i=s.sent(),s.label=4;case 4:return[2,i]}}))}))},e.prototype.createTag=function(t){var e=t.color,n=t.name,r=t.organizationId;return xe(this,void 0,void 0,(function(){var t,o;return Me(this,(function(i){switch(i.label){case 0:return t={"TT-X-Organization-Key":r},[4,this.httpClient.post("/v2/tags",{data:{color:e,name:n},headers:t})];case 1:return(o=i.sent()).token=o.headers["tt-x-tag-id"],[2,o]}}))}))},e.prototype.updateTag=function(t,e){var n=e.color,r=e.name,o=e.organizationId;return xe(this,void 0,void 0,(function(){var e,i;return Me(this,(function(s){switch(s.label){case 0:return e={"TT-X-Organization-Key":o},[4,this.httpClient.put("/v2/tags/:token",{urlParams:{token:t},data:{color:n,name:r},headers:e})];case 1:return(i=s.sent()).token=t,[2,i]}}))}))},e.prototype.destroy=function(t,e){return xe(this,void 0,void 0,(function(){var n;return Me(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":t},[4,this.httpClient.del("/v2/tags/:token",{urlParams:{token:e},headers:n})];case 1:return[2,r.sent().data]}}))}))},e.prototype.findColors=function(t){return xe(this,void 0,void 0,(function(){var e;return Me(this,(function(n){switch(n.label){case 0:return e={"TT-X-Organization-Key":t},[4,this.httpClient.get("/v2/tag/color_list/:organizationId",{urlParams:{organizationId:t},headers:e})];case 1:return[2,n.sent().data]}}))}))},e.prototype.findTag=function(t,e){return xe(this,void 0,void 0,(function(){var n;return Me(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":t},[4,this.httpClient.get("/v2/tags/:tagId",{urlParams:{tagId:e},headers:n})];case 1:return[2,r.sent().data]}}))}))},je([Object(m.d)()],e.prototype,"findAll",null),e}(m.c),Ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ze=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},De=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ue=m.b.VERSION_TWO,Le=m.b.VERSION_FIVE,Fe=["user","distributionList"],Be=m.a.CONVERSATION_FIND_ALL,qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ne(e,t),e.prototype.findAll=function(e){return void 0===e&&(e={organizationId:null}),ze(this,void 0,void 0,(function(){var n,r,o,i,s;return De(this,(function(a){switch(a.label){case 0:return n=t.prototype.getVersion.call(this,Be).version,i={render_metadata:"true"},(r=void 0===n?Ue:n)===Le&&(o=e.organizationId,i.mark_as_delivered="true",i.paginated="true",i.organization_id=o||void 0),[4,this.httpClient.get("/:version/roster",{query:i,urlParams:{version:r}})];case 1:return(s=a.sent()).data.continuation?[4,this._findAllPaginated(s.data.continuation,o,s.data.items)]:[3,3];case 2:return[2,a.sent()];case 3:return[2,s.data.items||s.data]}}))}))},e.prototype._findAllPaginated=function(t,e,n){return ze(this,void 0,void 0,(function(){var r;return De(this,(function(o){switch(o.label){case 0:return null===t?[2,n]:[4,this.httpClient.get("/v5/roster",{query:{render_metadata:"true",mark_as_delivered:"true",paginated:"true",continuation:encodeURI(t),organization_id:e||void 0}})];case 1:return r=o.sent(),n=n.concat(r.data.items),[2,this._findAllPaginated(r.data.continuation,e,n)]}}))}))},e.prototype.add=function(t,e,n){return ze(this,void 0,void 0,(function(){var r,o;return De(this,(function(i){switch(i.label){case 0:return h.a.includes(Fe,t)?(r={},n&&(r["TT-X-Organization-Key"]=n),o=this.__typeToNS(t),[4,this.httpClient.post("/v2/roster",{headers:r,data:{entity:e,type:o}})]):[2];case 1:return i.sent(),[2]}}))}))},e.prototype.remove=function(t,e,n){return ze(this,void 0,void 0,(function(){var r,o;return De(this,(function(i){switch(i.label){case 0:return h.a.includes(Fe,t)?(r={},o=this.__typeToNS(t),n&&(r["TT-X-Organization-Key"]=n,r["TT-X-Type"]=o),[4,this.httpClient.del("/v2/roster/:counterPartyId",{headers:r,urlParams:{counterPartyId:e},data:{type:o}})]):[2];case 1:return i.sent(),[2]}}))}))},e.prototype.__typeToNS=function(t){return Ve[t]},e}(m.c),Ve={user:"tigertext:entity:account",distributionList:"tigertext:entity:list"},Ge=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),He=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},We=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ge(e,t),e.prototype.findIntegrationIds=function(t){return He(this,void 0,void 0,(function(){var e;return We(this,(function(n){switch(n.label){case 0:return e={Accept:"*/*","TT-X-Organization-Key":t},[4,this.httpClient.post("/v1/integrations/scheduler/configs/info/org",{headers:e,data:{org:t}})];case 1:return[2,n.sent().data]}}))}))},e.prototype.sendCsvSchedule=function(t,e,n,r){return He(this,void 0,void 0,(function(){var o,i,s,a,u;return We(this,(function(c){switch(c.label){case 0:o={"Content-Type":"text/csv","TT-X-Organization-Key":n,"TT-X-Integration-Id":t,"TT-X-Timezone":r},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.httpClient.post("/v1/integrations/scheduler/webhook/csv",{data:e,headers:o})];case 2:return a=c.sent(),i=a.data,s=a.status,[3,4];case 3:return 400!==(u=c.sent()).status?[2,Promise.reject(u)]:(i=u.response&&(u.response.body||u.response.text),s=u.status,[3,4]);case 4:return[2,{json:i,status:s}]}}))}))},e.prototype.findCsv=function(t,e){return He(this,void 0,void 0,(function(){var n;return We(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":t},[4,this.httpClient.post("/v1/integrations/scheduler/webhook/csv/download",{headers:n,data:{org:t,id:e},resFormat:"text"})];case 1:return[2,r.sent()]}}))}))},e.prototype.clearSchedule=function(t,e){return He(this,void 0,void 0,(function(){var n;return We(this,(function(r){switch(r.label){case 0:return n={Accept:"*/*","TT-X-Organization-Key":t},[4,this.httpClient.post("/v1/integrations/scheduler/configs/truncate",{headers:n,data:{id:e}})];case 1:return[2,r.sent().status]}}))}))},e}(m.c),Ke=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$e=function(){return($e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xe=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Qe=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Ze=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ke(e,t),e.prototype.batch=function(t){var e=t.ids,n=t.operation,r=t.organizationId;return Qe(this,void 0,void 0,(function(){var t;return Ze(this,(function(o){switch(o.label){case 0:return t={"TT-X-Organization-Key":r},[4,this.httpClient.patch("/v5/schedule_message",{data:{ids:e,operation:n},headers:t})];case 1:return o.sent(),[2]}}))}))},e.prototype.create=function(t){var e=t.attachment,n=t.body,r=t.end_date,o=t.network,i=t.no_reply,s=t.organizationId,a=t.recipients,u=t.repeating,c=t.send_now,l=t.start_date,d=t.start_time,f=t.template_id,h=t.timezone_name;return Qe(this,void 0,void 0,(function(){var t,p;return Ze(this,(function(v){switch(v.label){case 0:return t={},p={"TT-X-Organization-Key":s},e&&(t.attachment=e),[4,this.httpClient.post("/v5/schedule_message",{files:t,data:$e($e($e($e($e($e($e($e({},t.attachment?null:{attachment:e}),{body:n}),u?{end_date:r}:null),{network:o,no_reply:i,recipients:a}),u?{repeating:u}:null),{send_now:c,start_date:l,start_time:d}),f?{template_id:f}:null),{timezone_name:h}),headers:p,timeout:!(e||f)})];case 1:return[2,v.sent().data]}}))}))},e.prototype.delete=function(t,e){return Qe(this,void 0,void 0,(function(){var n;return Ze(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.del("/v5/schedule_message/:id",{headers:n,urlParams:{id:t}})];case 1:return r.sent(),[2]}}))}))},e.prototype.downloadScheduledMessageFile=function(t){var e=t.scheduleId,n=t.fileName,r=t.organizationId;return Qe(this,void 0,void 0,(function(){var t,o;return Ze(this,(function(i){return t={"TT-X-Organization-Key":r},o="/v5/schedule_message/"+e+"/attachment/"+n,[2,this.httpClient.downloadFileBlob(o,{headers:t})]}))}))},e.prototype.find=function(t){var e=t.id,n=t.organizationId,r=t.isHistoryCategory;return Qe(this,void 0,void 0,(function(){var t;return Ze(this,(function(o){switch(o.label){case 0:return t={"TT-X-Organization-Key":n},[4,this.httpClient.get("/v5/schedule_message/:id?history="+r,{headers:t,urlParams:{id:e}})];case 1:return[2,o.sent().data]}}))}))},e.prototype.findCoarseTimezone=function(t,e){return Qe(this,void 0,void 0,(function(){var n;return Ze(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.get("/v5/timezone/:timezone",{headers:n,urlParams:{timezone:t}})];case 1:return[2,r.sent().data]}}))}))},e.prototype.update=function(t){var e=t.attachment,n=t.body,r=t.end_date,o=t.id,i=t.organizationId,s=t.repeating,a=t.start_date,u=t.start_time,c=t.template_id,l=t.timezone_name;return Qe(this,void 0,void 0,(function(){var t,d;return Ze(this,(function(f){switch(f.label){case 0:return t={},d={"TT-X-Organization-Key":i},e&&(t.attachment=e),[4,this.httpClient.put("/v5/schedule_message/:id",{files:t,data:$e($e($e($e($e($e($e({},t.attachment?null:{attachment:e}),{body:n}),s?{end_date:r}:null),s?{repeating:s}:null),{start_date:a,start_time:u}),c?{template_id:c}:null),{timezone_name:l}),headers:d,timeout:!(e||c),urlParams:{id:o}})];case 1:return[2,f.sent().data]}}))}))},Xe([Object(m.d)()],e.prototype,"delete",null),Xe([Object(m.d)()],e.prototype,"downloadScheduledMessageFile",null),Xe([Object(m.d)()],e.prototype,"find",null),Xe([Object(m.d)()],e.prototype,"update",null),e}(m.c),tn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),en=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},nn=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},rn=m.b.VERSION_TWO,on=m.a.SEARCH_QUERY,sn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return tn(e,t),e.prototype.query=function(e){return en(this,void 0,void 0,(function(){var n,r;return nn(this,(function(o){switch(o.label){case 0:return n=t.prototype.getVersion.call(this,on).version,r=void 0===n?rn:n,[4,this.httpClient.post("/:version/search",{data:e,urlParams:{version:r}})];case 1:return[2,o.sent().data]}}))}))},e.prototype.patientQuery=function(t){return en(this,void 0,void 0,(function(){return nn(this,(function(e){switch(e.label){case 0:return[4,this.httpClient.post("/v5/patient/search",{data:t})];case 1:return[2,e.sent().data]}}))}))},e}(m.c),an=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),un=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},cn=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ln=m.b.VERSION_TWO,dn=m.a.TEAMS_CREATE,fn=m.a.TEAMS_FIND,hn=m.a.TEAMS_LEAVE,pn=m.a.TEAMS_UPDATE,vn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return an(e,t),e.prototype.find=function(e,n){var r=n.organizationId;return un(this,void 0,void 0,(function(){var n,o;return cn(this,(function(i){switch(i.label){case 0:return n=t.prototype.getVersion.call(this,fn).version,o=void 0===n?ln:n,[4,this.httpClient.get("/:version/team/:team_id",{headers:{"TT-X-Organization-Key":r},urlParams:{team_id:e,version:o}})];case 1:return[2,i.sent().data]}}))}))},e.prototype.create=function(e){var n=e.avatar,r=e.canMembersLeave,o=void 0===r||r,i=e.canRequestToJoin,s=void 0===i||i,a=e.description,u=e.displayName,c=e.memberIds,l=void 0===c?[]:c,d=e.organizationId;return un(this,void 0,void 0,(function(){var e,r,i,c,f;return cn(this,(function(h){switch(h.label){case 0:return e=t.prototype.getVersion.call(this,dn).version,r=void 0===e?ln:e,i={},c={can_members_leave:o,can_request_to_join:s,display_name:u,members:l},f={},n&&(f.avatar=n),a&&(c.description=a),d&&(i["TT-X-Organization-Key"]=d),[4,this.httpClient.post("/:version/team",{urlParams:{version:r},headers:i,data:c,files:f})];case 1:return[2,h.sent().data]}}))}))},e.prototype.update=function(e){var n=e.avatar,r=e.canMembersLeave,o=void 0===r||r,i=e.canRequestToJoin,s=void 0===i||i,a=e.description,u=e.displayName,c=e.id,l=e.memberIds,d=void 0===l?[]:l,f=e.organizationId;return un(this,void 0,void 0,(function(){var e,r,i,l,h;return cn(this,(function(p){switch(p.label){case 0:return e=t.prototype.getVersion.call(this,pn).version,r=void 0===e?ln:e,i={},l={can_members_leave:o,can_request_to_join:s,display_name:u,members:d},h={},n&&(h.avatar=n),a&&(l.description=a),f&&(i["TT-X-Organization-Key"]=f),[4,this.httpClient.post("/:version/team/:id",{urlParams:{id:c,version:r},headers:i,data:l,files:h})];case 1:return[2,p.sent().data]}}))}))},e.prototype.delete=function(e,n){var r=n.organizationId;return un(this,void 0,void 0,(function(){var n,o;return cn(this,(function(i){switch(i.label){case 0:return n=t.prototype.getVersion.call(this,dn).version,o=void 0===n?ln:n,[4,this.httpClient.del("/:version/team/:id",{headers:{"TT-X-Organization-Key":r},urlParams:{version:o,id:e}})];case 1:return[2,i.sent().status]}}))}))},e.prototype.requestToJoin=function(e,n){var r=n.organizationId,o=n.requestedById;return un(this,void 0,void 0,(function(){var n,i;return cn(this,(function(s){switch(s.label){case 0:return n=t.prototype.getVersion.call(this,dn).version,i=void 0===n?ln:n,[4,this.httpClient.post("/:version/team/:id/request",{headers:{"TT-X-Organization-Key":r},urlParams:{id:e,version:i},data:{requested_by:o}})];case 1:return[2,s.sent().status]}}))}))},e.prototype.updateJoinRequest=function(e,n){var r=n.organizationId,o=n.teamId,i=n.handledAsId,s=n.status;return un(this,void 0,void 0,(function(){var n,a;return cn(this,(function(u){switch(u.label){case 0:return n=t.prototype.getVersion.call(this,dn).version,a=void 0===n?ln:n,[4,this.httpClient.post("/:version/team/:team_id/request/:request_id",{headers:{"TT-X-Organization-Key":r},urlParams:{version:a,team_id:o,request_id:e},data:{handled_as:i,status:s}})];case 1:return[2,u.sent()]}}))}))},e.prototype.leave=function(e,n){var r=n.organizationId;return un(this,void 0,void 0,(function(){var n,o;return cn(this,(function(i){switch(i.label){case 0:return n=t.prototype.getVersion.call(this,hn).version,o=void 0===n?ln:n,[4,this.httpClient.post("/:version/team/:team_id/leave",{headers:{"TT-X-Organization-Key":r},urlParams:{team_id:e,version:o},data:{}})];case 1:return[2,i.sent().status]}}))}))},e}(m.c),yn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},mn=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},_n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return yn(e,t),e.prototype.getTwilioNumbers=function(t,e){return gn(this,void 0,void 0,(function(){var n;return mn(this,(function(r){switch(r.label){case 0:return n={"TT-X-Organization-Key":t},[4,this.httpClient.post("/v2/twilio/numbers",{headers:n,data:{area_code:e}})];case 1:return[2,r.sent().data]}}))}))},e.prototype.assignPagerNumber=function(t,e,n){return gn(this,void 0,void 0,(function(){var r;return mn(this,(function(o){switch(o.label){case 0:return r={"TT-X-Organization-Key":t},[4,this.httpClient.post("/v2/user/:roleToken/organization/:organizationId/pagers?process_number=true",{headers:r,urlParams:{organizationId:t,roleToken:n},data:{pager_numbers:e}})];case 1:return[2,o.sent()]}}))}))},e.prototype.removePagerNumber=function(t,e,n){return gn(this,void 0,void 0,(function(){var r;return mn(this,(function(o){switch(o.label){case 0:return r={"TT-X-Organization-Key":t},[4,this.httpClient.del("/v2/user/:roleToken/organization/:organizationId/pagers/:number?process_number=true",{headers:r,urlParams:{organizationId:t,roleToken:n,number:e}})];case 1:return[2,o.sent()]}}))}))},e}(m.c),bn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},In=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},On=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return bn(e,t),e.prototype.startTyping=function(t,e,n){return wn(this,void 0,void 0,(function(){var r;return In(this,(function(o){switch(o.label){case 0:return r={recipient:t},e&&e!==this.host.currentUserId&&(r.proxy_token=e),[4,this.httpClient.post("/v2/message/typing",{data:r,headers:{"TT-X-Organization-Key":n}})];case 1:return o.sent(),[2]}}))}))},e.prototype.stopTyping=function(t,e){return wn(this,void 0,void 0,(function(){return In(this,(function(n){switch(n.label){case 0:return e?[4,this.httpClient.del("/v2/message/typing/:recipientId/:senderId",{urlParams:{recipientId:t,senderId:e}})]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,this.httpClient.del("/v2/message/typing/:recipientId",{urlParams:{recipientId:t}})];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},e}(m.c),En=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tn=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Sn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},An=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Cn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return En(e,t),e.prototype.findAll=function(t,e){return Sn(this,void 0,void 0,(function(){return An(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.get("/v2/user/:userId/organization/:organizationId/roles",{urlParams:{userId:t,organizationId:e}})];case 1:return[2,n.sent().data.roles]}}))}))},Tn([Object(m.d)()],e.prototype,"findAll",null),e}(m.c),Rn=n(163),Pn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jn=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},xn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Mn=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},kn=window.location.href.includes("FAKE-VISIT"),Nn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pn(e,t),e.prototype.findAll=function(t){return xn(this,void 0,void 0,(function(){var e;return Mn(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.get("/vwr/v1/rooms",{headers:{"TT-X-Organization-Key":t}})];case 1:return e=n.sent(),[2,_.a.camelizeObject(e.data)]}}))}))},e.prototype.find=function(t,e){return xn(this,void 0,void 0,(function(){var n,r;return Mn(this,(function(o){switch(o.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.get("/vwr/v1/room/:id",{headers:n,urlParams:{id:t}})];case 1:return r=o.sent(),[2,_.a.camelizeObject(r.data)]}}))}))},e.prototype.create=function(t,e){var n=e.staff,r=e.name;return xn(this,void 0,void 0,(function(){var e,o,i;return Mn(this,(function(s){switch(s.label){case 0:return e={"TT-X-Organization-Key":t},o=_.a.underscoreObject({staff:n,name:r}),[4,this.httpClient.post("/vwr/v1/room",{headers:e,data:o})];case 1:return i=s.sent(),[2,_.a.camelizeObject(i.data)]}}))}))},e.prototype.update=function(t,e,n){var r=n.staff,o=n.name,i=n.status,s=n.version;return xn(this,void 0,void 0,(function(){var n,a,u;return Mn(this,(function(c){switch(c.label){case 0:return n={"TT-X-Organization-Key":e},a=_.a.underscoreObject({staff:r,name:o,status:i,version:s}),[4,this.httpClient.put("/vwr/v1/room/:id",{headers:n,urlParams:{id:t},data:a})];case 1:return u=c.sent(),[2,_.a.camelizeObject(u.data)]}}))}))},e.prototype.delete=function(t,e){return xn(this,void 0,void 0,(function(){var n,r;return Mn(this,(function(o){switch(o.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.del("/vwr/v1/room/:id",{headers:n,urlParams:{id:t}})];case 1:return r=o.sent(),[2,_.a.camelizeObject(r.data)]}}))}))},e.prototype.getVisitInfo=function(t){return xn(this,void 0,void 0,(function(){var e;return Mn(this,(function(n){switch(n.label){case 0:return[4,this.httpClient.get("/vwr/v1/visit/join?join_id=:joinId",{urlParams:{joinId:t}})];case 1:return e=n.sent(),[2,_.a.camelizeObject(e.data)]}}))}))},e.prototype.createVisit=function(t){var e=t.firstName,n=t.lastName,r=t.mobilePhone,o=t.visitReason,i=t.joinId;return xn(this,void 0,void 0,(function(){var t;return Mn(this,(function(s){switch(s.label){case 0:return[4,this.httpClient.post("/vwr/v1/visit/join?join_id=:joinId",{data:_.a.underscoreObject({firstName:e,lastName:n,mobilePhone:r,visitReason:o,processingEvents:!0,condensedReplays:!0}),urlParams:{joinId:i}})];case 1:return t=s.sent(),[2,_.a.camelizeObject(t.data)]}}))}))},e.prototype.editVisit=function(t){var e=t.visitId,n=t.firstName,r=t.lastName,o=t.mobilePhone,i=t.visitReason,s=t.createResources;return xn(this,void 0,void 0,(function(){var t,a;return Mn(this,(function(u){switch(u.label){case 0:return kn?[2,{groupId:"g123456",conversationId:"c123456",accountId:"a123456"}]:(t=_.a.underscoreObject({visitId:e,firstName:n,lastName:r,mobilePhone:o,visitReason:i,createResources:s}),[4,this.httpClient.put("/vwr/v1/room/join",{data:t})]);case 1:return a=u.sent(),[2,_.a.camelizeObject(a.data)]}}))}))},e.prototype.cleanupVisits=function(t){var e=t.type,n=t.roomId,r=t.organizationId;return xn(this,void 0,void 0,(function(){var t;return Mn(this,(function(o){switch(o.label){case 0:return t={"TT-X-Organization-Key":r},[4,this.httpClient.put("/vwr/v1/room/:roomId/cleanup",{headers:t,data:{type:e},urlParams:{roomId:n}})];case 1:return o.sent(),[2]}}))}))},e.prototype.findAllVisits=function(t,e){return xn(this,void 0,void 0,(function(){var n,r;return Mn(this,(function(o){switch(o.label){case 0:return n={"TT-X-Organization-Key":e},[4,this.httpClient.get("/vwr/v1/room/:roomId/visits",{headers:n,urlParams:{roomId:t}})];case 1:return r=o.sent(),[2,_.a.camelizeObject(r.data)]}}))}))},e.prototype.informProvider=function(t,e){var n=e.roomId,r=e.visitId,o=e.accountToken;return xn(this,void 0,void 0,(function(){var e,i;return Mn(this,(function(s){switch(s.label){case 0:return e={"TT-X-Organization-Key":t},[4,this.httpClient.post("/vwr/v1/room/:roomId/visit/:visitId/provider/:accountToken",{headers:e,urlParams:{roomId:n,visitId:r,accountToken:o}})];case 1:return i=s.sent(),[2,_.a.camelizeObject(i.data)]}}))}))},jn([Object(m.d)()],e.prototype,"findAll",null),jn([Object(m.d)()],e.prototype,"find",null),jn([Object(m.d)()],e.prototype,"create",null),jn([Object(m.d)()],e.prototype,"update",null),jn([Object(m.d)()],e.prototype,"delete",null),jn([Object(m.d)()],e.prototype,"getVisitInfo",null),jn([Object(m.d)()],e.prototype,"createVisit",null),jn([Object(m.d)()],e.prototype,"editVisit",null),jn([Object(m.d)()],e.prototype,"informProvider",null),e}(m.c),zn=n(0),Dn={CONSUMER_ORGANIZATION_ID:"UpM28mnfW65vJkbqEATtKvxm",BASE_URLS:{local:"http://localhost:8888",productionOauth:"http://52.41.133.15:8000/tigertextapi"},ADMIN_URLS:{},CN_URLS:{},FORGOT_PASSWORD_URLS:{},ROLES_URLS:{},CLOUDFRONT:{development:{d1n6bomzxlt9xn:"tigertext/production/avatar",d18oyzjkq5093g:"tigertext/production/avatar-group"},production:{d1n6bomzxlt9xn:"tigertext/production/avatar",d18oyzjkq5093g:"tigertext/production/avatar-group"},tt:{d1n6bomzxlt9xn:"tigertext/production/avatar",d18oyzjkq5093g:"tigertext/production/avatar-group"},ihis:{avatar:"",groupAvatar:""}},CONFIG_DEFAULT:{adminFeatureBranch:null,apiEnv:"production",assetDomain:"assets.tigerconnect.com",autoAckSuccessfullyHandledEvents:!0,autoSignOutOnBrowserUnload:!0,baseUrl:null,botUsers:[],clearTypingStatusThrottleDelay:2e3,clearTypingStatusTimeout:8e3,cloudfrontDomain:"cloudfront.net",cloudfront:{},condensedReplays:!1,consumerOrganizationId:"UpM28mnfW65vJkbqEATtKvxm",detectBangReplayTimeout:1e3,events:{autoAck:!1,autoDeliver:!1,canConfirm:!0,closeAfterMessages:!1,heartbeat:!0,hidden:!1,includeDistributionListEvents:!0,isTyping:!0,keepAlive:!1,msgDeliveryDelay:0,multiOrg:!0,noOfflineMessages:!1,renderMetadata:!0},eventCollectionInterval:50,eventDrainTimeout:4e3,eventsAutoReconnect:!0,eventsAutoReconnectDelay:2e3,eventsAutoReconnectMaxDelay:16e3,eventsClearRetryHistoryInterval:6e4,eventsDebugging:!1,eventsHeartbeatIntervalVisible:12e3,eventsHeartbeatIntervalInvisible:3e4,eventsOpenTimeout:6e3,flushAckInterval:1e3,flushAckMaxConnections:2,flushAckMaxEvents:50,flushFindRecipientStatusInterval:150,flushFindRecipientStatusMaxCount:20,flushSetMessageStatusInterval:1e3,flushSetMessageStatusMaxCount:500,keepConversationsForAllForums:!1,localAdminUrl:null,localCnUrl:null,localRolesUrl:null,logLevel:"error",manuallyRequestEventQueueBatch:!1,maxEventBatch:50,maxMetadataKeyCount:11,organizationRostersChangeThrottleDelay:500,placeholderEntityAllowLoading:!0,placeholderEntityDelayBeforeRefreshing:100,processingEvents:!1,productKey:"bc1oOf3DZXbnaNZ2LCWZGvSg",pushAgent:"consumer",rolesFeatureBranch:null,serviceLogLevels:{},signUpHashKey:"21d2ff3ffbf",signUpHashSalt:"%(xx*&x$&*%&",ttRoute:null,version:"1.0",wantCondensedReplays:!0}};["stag","uat"].forEach((function(t){Dn.BASE_URLS[t]="https://"+t+"-devapi.tigertext.me",Dn.FORGOT_PASSWORD_URLS[t]="https://"+t+"-forget.tigertext.com",Dn.CN_URLS[t]="https://"+t+"-console.tigertext.me",Dn.ADMIN_URLS[t]="https://"+t+"-console.tigertext.me/app/admin",Dn.ROLES_URLS[t]="/"+t+"/app/roles/index.html"}));["ihis","prod","prod-a","prod-c","production","tt"].forEach((function(t){Dn.BASE_URLS[t]="https://api.tigertext.me",Dn.FORGOT_PASSWORD_URLS[t]="https://forget.tigertext.com",Dn.CN_URLS[t]="https://home.tigertext.com",Dn.ADMIN_URLS[t]="https://home.tigertext.com/app/admin",Dn.ROLES_URLS[t]="/app/roles/index.html"}));["prod-a","prod-c"].forEach((function(t){var e=t.replace("prod-","");Dn.BASE_URLS[t]="https://"+e+"-api.tigertext.me"}));["ihis"].forEach((function(t){Dn.CN_URLS[t]="https://"+t+".tigertext.com",Dn.ADMIN_URLS[t]="https://"+t+".tigertext.com/app/admin"}));["prod-dr"].forEach((function(t){Dn.BASE_URLS[t]="https://"+t+"-api.tigertext.me",Dn.CN_URLS[t]="https://"+t+".tigertext.com",Dn.ADMIN_URLS[t]="https://"+t+".tigertext.com/app/admin",Dn.ROLES_URLS[t]="/"+t+"/app/roles/index.html"}));var Un=Dn,Ln=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},Fn=function(){function t(t){var e=t.name,n=t.level;this.name=e,this.level=n}return t.prototype.setLevel=function(t){this.level=t.toLowerCase()},t}(),Bn=Fn,qn=["debug","log","info","warn","error"],Vn=qn.reduce((function(t,e,n){return t[e]=n,t}),{});qn.forEach((function(t){var e=Vn[t];Fn.prototype[t]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e>=Vn[this.level]&&(n=Ln(["["+this.name+"]"],n),Function.prototype.apply.call(console[t],console,n))}}));var Gn,Hn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wn=function(){return(Wn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yn=function(){function t(t,e){for(var n in void 0===e&&(e={}),Array.isArray(t)&&(t=t.reduce((function(t,e){return t[e]={},t}),{})),this.keys=[],this.entries=[],this.entriesByKey={},this.defaultValue=e.defaultValue||null,t){this[n]=e.valueFn?e.valueFn(n):n;var r=Wn({key:n},t[n]);this.entriesByKey[n]=r,this.entries.push(r),this.keys.push(n)}Object.freeze(this.keys),Object.freeze(this.entries),Object.freeze(this.entriesByKey)}return t.prototype.resolve=function(t){return t||this.defaultValue},t.prototype.isValid=function(t){return!!this.entriesByKey[t]},t}(),Kn=Yn,$n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Hn(e,t),e.prototype.mapEnumKeyToServerValue=function(){return this._mapEnumKeyToServerValue||(this._mapEnumKeyToServerValue=h.a.transform(this.entries,(function(t,e){return t[e.key]=e.serverValue}),{}))},e.prototype.mapServerValueToEnumKey=function(){return this._mapServerValueToEnumKey||(this._mapServerValueToEnumKey=h.a.invert(this.mapEnumKeyToServerValue()))},e.prototype.fromServer=function(t){return this.mapServerValueToEnumKey()[t]},e.prototype.toServer=function(t){return this.mapEnumKeyToServerValue()[this.resolve(t)]},e.prototype.resolve=function(t){return(this.isValid(t)?t:this.fromServer(t))||this.defaultValue},e}(Yn),Xn=new Kn(["CONTACTS_MESSAGING_BLOCKED_BY_ADMIN","CONVERSATION_NOT_FULLY_LOADED","CONVERSATION_WITH_ROLE_YOU_ARE_CURRENTLY_IN","COUNTER_PARTY_IS_TIGERPAGE","COUNTER_PARTY_NOT_FULLY_LOADED","COUNTER_PARTY_TYPE_NOT_SUPPORTED","GROUP_HAS_NO_MEMBERS","GROUP_MEMBERS_NOT_LOADED","IS_ROLE_ASSIGNMENT_GROUP","NO_COUNTER_PARTY","ORGANIZATION_DOES_NOT_EXIST","USER_IS_NOT_IN_THIS_ROLE_CONVERSATION","USER_IS_NOT_MEMBER_OF_GROUP","NONE"]),Qn=new $n({CONTINUATION:{serverValue:"continuation"},CONVERSATION_END:{serverValue:"conversation_end"},FIRST_UNREAD_ITEM:{serverValue:"first_unread_item"}}),Zn=new $n({ACKNOWLEDGED:{serverValue:"escalation_acknowledged"},CANCELLED:{serverValue:"escalation_cancelled"},INITIATED:{serverValue:"escalation_initiated"},MEMBER_ADDED:{serverValue:"escalation_member_added"},NO_RESPONSE:{serverValue:"escalation_no_response"}}),Jn=new $n({ACKNOWLEDGED:{serverValue:"confirmed"},CANCELLED:{serverValue:"cancelled"},IN_PROGRESS:{serverValue:"in_progress"},NO_RESPONSE:{serverValue:"no_response"}}),tr=new Kn(["ACTIVATED_TEAM","ESCALATION","FORUM","GROUP","INTRA_TEAM","PATIENT_CARE","PATIENT_MESSAGING","ROLE_ASSIGNMENT","ROLE_P2P"]),er=new $n({LOW:{serverValue:-1},NORMAL:{serverValue:0},HIGH:{serverValue:1}},{defaultValue:"NORMAL"}),nr=new $n({NA:{key:"NA"},NEW:{serverValue:"New"},DELIVERED:{serverValue:"Delivered"},READ:{serverValue:"Read"},ACKNOWLEDGED:{serverValue:"Confirmed"}},{defaultValue:"NA"}),rr=((Gn={})[nr.NA]=0,Gn[nr.NEW]=1,Gn[nr.DELIVERED]=2,Gn[nr.READ]=3,Gn[nr.ACKNOWLEDGED]=4,Gn),or=nr,ir=new Kn(["SENDING","SENT","FAILED","RETRYING","NEW","NA"]),sr=new $n({EMPTY_ROLE_NOTIFICATION:{serverValue:"empty_role_notification"},NA:{key:"NA"},ROLE_AWAY_NOTIFICATION:{serverValue:"role_away_notification"},SCHEDULE_MESSAGE:{serverValue:"schedule_message"},SMS_OPT_IN_NOTIFICATION:{serverValue:"sms_optin_notification"},SMS_OPT_OUT_NOTIFICATION:{serverValue:"sms_optout_notification"},SYSTEM:{serverValue:"system"},TEAM_REQUEST:{serverValue:"team_request"},USER_AWAY_NOTIFICATION:{serverValue:"user_away_notification"}},{defaultValue:"NA"}),ar=new Kn(["CALL_CHANGE","ESCALATION_EXECUTION_CHANGE","GROUP_MEMBERSHIP_CHANGE","HIGHER_CONTINUATION","LOWER_CONTINUATION","USER_SENT"]),ur=new Kn(["PATIENT","PROVIDER"]),cr=new $n({ADD_MEMBERS:{serverValue:"add_members"}},{defaultValue:"NA"}),lr=new $n({ADMIT:{serverValue:"admit"},DISCHARGE:{serverValue:"discharge"},LAB:{serverValue:"lab"},TRANSFER:{serverValue:"transfer"}},{defaultValue:"NA"}),dr=new $n({ACTION:{serverValue:"ehr_action_item"},HEADER:{serverValue:"ehr_header"},ITEM:{serverValue:"table_item"},TEXT:{serverValue:"ehr_text_view"}},{defaultValue:"NA"}),fr=new $n({UNKNOWN:{serverValue:"unknown"},AVAILABLE:{serverValue:"available"},UNAVAILABLE:{serverValue:"unavailable"}}),hr=new $n({CONVERSATION_MESSAGE_STATUS:{serverValue:"conversation_message_status"},GROUP_REPLAY:{serverValue:"group_replay"},MESSAGE_REPLAY:{serverValue:"message_replay"},OFFLINE:{serverValue:"offline"},ORGANIZATION_MESSAGE_STATUS:{serverValue:"organization_message_status"},ORGANIZATION_REPLAY:{serverValue:"organization_replay"},ROLE_OPT_IN:{serverValue:"optin"},ROLE_OPT_OUT:{serverValue:"optout"}}),pr=new $n({DISTRIBUTION_LIST_MEMBER:{serverValue:"dist_list_member"},DISTRIBUTION_LIST:{serverValue:"distribution_list"},FORUM:{serverValue:"public_group"},GROUP:{serverValue:"group"},MESSAGE_TEMPLATE:{serverValue:"message_template"},ORGANIZATION:{serverValue:"organization"},PATIENT_DISTRIBUTION_LIST:{serverValue:"patient_distribution_list"},PATIENT:{serverValue:"patient_account"},SCHEDULED_MESSAGE:{serverValue:"schedule_message"},TAG:{serverValue:"tag"},TEAM:{serverValue:"team"},USER:{serverValue:"account"}}),vr=new Kn(["GLOBAL","GROUP","ORGANIZATION"],{valueFn:function(t){return t.toLowerCase()}}),yr=new Kn(["VISIBLE","HIDDEN","PRERENDER"]),gr=n(126).a,mr=new Kn(["ONLINE","OFFLINE","CONNECTING","UNREACHABLE"]),_r=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),br=function(t){function e(e){var n=e.config,r=e.httpClient,o=e.logger,i=t.call(this)||this;return i.config=n,i.httpClient=r,i.logger=o,i}return _r(e,t),e.prototype.createEventSource=function(t,e){var n=this,r=e.auth,o=void 0===r?this.httpClient.getAuth():r,i=e.features,s=e.onOpen,a=e.onMessage,u=e.onError,c=/https?:/.test(t)?t:this.config.baseUrl+t,l=this.httpClient.getAuthHeaders(o,i);"TT-Route-Xmpp"===this.config.ttRoute&&(l["TT-Route-Xmpp"]="true"),i&&(l["TT-X-Features"]=i);var d=new gr(c,{headers:l}),f=!1,h=!1,p=!1,v=function(){p||(p=!0,d.removeEventListener("open",v),s&&s())},y=function(e){if(!f){f=!0,d.removeEventListener("error",y);var r,o=e?e.status:void 0;if(401===o)r=new zn.WrongCredentialsError,n.emit("auth:invalid");else if(403===o){r=new zn.PermissionDeniedError(t,"403","get"),n.emit("auth:invalid")}else e&&e.message&&e.stack?(r=new Error(e.message)).stack=e.stack:r=h?new Error("EventSource connection closed"+(o?": status "+o:"")):new Error("Could not establish EventSource connection"+(o?": status "+o:""));o&&(r.status=o),n.httpClient.networkStatus!==mr.OFFLINE&&n.httpClient._setNetworkStatus(mr.UNREACHABLE),u&&u(r)}};return d.addEventListener("open",v),d.addEventListener("error",y),d.addEventListener("message",(function(t){var e=!h;h||(h=!0,n.httpClient._setNetworkStatus(mr.ONLINE)),a&&a(t,{isFirstMessage:e})})),d},e}(c.a),wr=n(61),Ir=n.n(wr),Or=n(3),Er=n(203),Tr=n.n(Er),Sr=n(128),Ar=n.n(Sr),Cr=n(129),Rr=n(27),Pr=n(86),jr=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n};function xr(t){var e=t.provideDefault,n=void 0!==e&&e;return function(t){var e=t.mime;var n=Object(Pr.getMimeEntryByContentType)(e);if(n){var r=n[0];return{ext:r="."+r,mime:e}}}(jr(t,["provideDefault"]))||(n?{ext:".bin",mime:"application/octet-stream"}:void 0)}var Mr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},kr=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};function Nr(t){var e=this;return Promise.resolve().then((function(){return Mr(e,void 0,void 0,(function(){var e,n,r,o,i,s,a,u,c,l,d;return kr(this,(function(f){switch(f.label){case 0:e=[],n=0,r=0,(s=new FileReader).addEventListener("load",(function(){return o&&o(s.result)}),!1),s.addEventListener("error",(function(t){return i&&i(t)}),!1),a=function(){var a,u,c;return kr(this,(function(l){switch(l.label){case 0:return r>0?[4,new Promise((function(t){return setTimeout(t,100)}))]:[3,2];case 1:l.sent(),l.label=2;case 2:return a=r+1048576,u=t.slice(r,a),r=a,[4,new Promise((function(t,e){o=t,i=e,s.readAsArrayBuffer(u)}))];case 3:return c=l.sent(),e.push(c),n+=c.byteLength,[2]}}))},f.label=1;case 1:return r<t.size?[5,a()]:[3,3];case 2:return f.sent(),[3,1];case 3:for(u=new Uint8Array(n),r=0,c=0,l=e;c<l.length;c++)d=l[c],u.set(new Uint8Array(d),r),r+=d.byteLength;return[2,{fieldValue:Object(Rr.a)(u.buffer),mimetype:t.type||"application/octet-stream",filename:t.name}]}}))}))}))}for(var zr,Dr,Ur=function(t,e){return Mr(this,void 0,void 0,(function(){var e;return kr(this,(function(n){switch(n.label){case 0:return e="",[3,2];case 1:return e=n.sent(),[3,4];case 2:return[4,Nr(t)];case 3:e=n.sent(),n.label=4;case 4:return[2,e]}}))}))},Lr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Fr=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Br=["application/json","text/plain"],qr=function(){function t(){this.body=new Cr.RequestBody,this.fileIdx=0,this.body.setType("multipart")}return t.prototype.appendField=function(t,e){return void 0===e&&(e=""),Lr(this,void 0,void 0,(function(){var n,r,o,i,s,a,u,c,l,d;return Fr(this,(function(f){if(Array.isArray(e))for(n=0,r=0,o=e;r<o.length;r++){if(i=o[r],"data"===t&&"object"==typeof i){if(s=i.mimetype,a=void 0===s?"application/json":s,u=i.namespace,c=i.payload,l=void 0===c?"":c,!u)throw new Error("Missing namespace on data["+n+"] object");null,d={"TT-X-Namespace":u},this._appendParsedField(t,{fieldValue:String(l),mimetype:a,filename:null,headers:d})}else this.appendField(t,i);n++}else e&&e.nodeType&&e.nodeName&&e.getAttribute&&(e=e.value),"object"==typeof e?this._appendParsedField(t,{fieldValue:JSON.stringify(e),mimetype:"application/json"}):this._appendParsedField(t,{fieldValue:String(e),mimetype:"text/plain"});return[2]}))}))},t.prototype._appendParsedField=function(t,e){var n=e.fieldValue,r=e.filename,o=e.headers,i=e.mimetype,s=this.body.fields;r?r=Object(Rr.c)(r):n=Object(Rr.c)(n),Br.includes(i)&&(i+='; charset="utf-8"');var a=new Cr.RequestField(n,i,r,o);s.hasOwnProperty(t)?(Array.isArray(s[t])||(s[t]=[s[t]]),s[t].push(a)):s[t]=a},t.prototype.appendFile=function(t,e){return Lr(this,void 0,void 0,(function(){var n;return Fr(this,(function(r){switch(r.label){case 0:return n="",e?[4,Ur(e,{idx:this.fileIdx++})]:[3,2];case 1:n=r.sent(),r.label=2;case 2:return this._appendParsedField(t,n),[2]}}))}))},t.prototype.getContentType=function(){return this.body.getContentType()},t.prototype.getPayload=function(){return Lr(this,void 0,void 0,(function(){var t;return Fr(this,(function(e){return t=this.body.getData(),[2,new Blob([t])]}))}))},t}(),Vr=function(){return(Vr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Gr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Hr=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Wr=[zn.PermissionDeniedError.CODE,zn.WrongCredentialsError.CODE],Yr=function(){function t(t){var e=this,n=t.config,r=t.logger;this.downloadFileBlobAndUrl=function(t){return Gr(e,void 0,void 0,(function(){var e;return Hr(this,(function(n){switch(n.label){case 0:return[4,this.downloadFileBlob(t)];case 1:return[2,{blob:e=n.sent(),get url(){return this._url||(this._url=URL.createObjectURL(e))}}]}}))}))},this.config=n,this.logger=r,this._prefixBaseUrl=Ar()(this.config.baseUrl),this._watchNetworkConnection()}return t.prototype.mounted=function(){this._prefixBaseUrl=Ar()(this.config.baseUrl)},t.prototype._contentType=function(t){switch(t){case"json":return"application/json";case"event-stream":return"text/event-stream";case"text":default:return"plain/text"}},t.prototype.getAuth=function(t){return this._auth},t.prototype.setAuth=function(t){this._auth=t},t.prototype.removeAuth=function(){this._auth=null},Object.defineProperty(t.prototype,"isSignedIn",{get:function(){return!!this._auth},enumerable:!1,configurable:!0}),t.prototype.getAuthForKeyAndSecret=function(t,e){return t&&e?Ir()(t+":"+e):null},t.prototype.getAuthHeaders=function(t){if(void 0===t&&(t=this._auth),!t)return{};var e={};if(t.key&&t.secret)e.Authorization="Basic "+this.getAuthForKeyAndSecret(t.key,t.secret);else{if(!t.bearerToken||!t.udid)return{};e.Authorization="Bearer "+t.bearerToken,e["X-Device-ID"]=t.udid}return e},t.prototype.isUnauthorizedError=function(t){return t&&Wr.includes(t.code)},t.prototype.downloadFileBlob=function(t,e){var n=this,r=(void 0===e?{}:e).headers,o=void 0===r?{}:r;return new Promise((function(e,r){var i=new XMLHttpRequest,s=n.config.baseUrl+t;i.open("GET",s,!0);for(var a=0,u=Object.entries(n.getAuthHeaders());a<u.length;a++){var c=u[a],l=c[0],d=c[1];i.setRequestHeader(l,d)}for(var f=0,h=Object.entries(o);f<h.length;f++){var p=h[f];l=p[0],d=p[1];i.setRequestHeader(l,d)}i.responseType="blob",i.onreadystatechange=function(){4===i.readyState&&(i.status<200||i.status>299?r(new Error("Failed downloading "+s+". Status = "+i.status)):e(i.response))},i.send(null)}))},t.prototype.downloadToFile=function(t,e){zn.TargetNotSupportedError.raise()},t.prototype._watchNetworkConnection=function(){var t=this;this.networkStatus=navigator.onLine?mr.ONLINE:mr.OFFLINE,window.addEventListener("online",(function(){t.config.eventsAutoReconnect?t._setNetworkStatus(mr.CONNECTING):t._setNetworkStatus(mr.ONLINE)})),window.addEventListener("offline",(function(){t._setNetworkStatus(mr.OFFLINE)}))},t.prototype._setNetworkStatus=function(t){var e=this.networkStatus;t!==e&&(this.networkStatus=t,this.emit("networkStatus:change",{networkStatus:t,previousStatus:e}))},t}(),Kr=function(t){Yr.prototype[t]=function(e,n){return void 0===n&&(n={}),Gr(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,p,v,y,g,m,_=this;return Hr(this,(function(b){switch(b.label){case 0:if((n=h.a.defaults(n||{},{reqFormat:"json",resFormat:"json",withCredentials:!0,withHeaders:!0})).urlParams&&(e=e.replace(/:([\w-]+)/g,(function(t,e){var r=n.urlParams[e];return void 0!==r?encodeURIComponent(r):":"+e}))),this.logger&&this.logger.info("start",t.toUpperCase(),e,n),(r=Vr(Vr({},n.headers),"TT-Route-Xmpp"===this.config.ttRoute?{"TT-Route-Xmpp":"true"}:null)).Accept=r.Accept||this._contentType(n.resFormat),n.requestId&&(r["Request-ID"]=n.requestId),"Authorization"in r||Object.assign(r,this.getAuthHeaders(n.auth)),o=Tr.a[t](e).use(this._prefixBaseUrl).query(n.query||{}),n.withCredentials&&(o=o.withCredentials()),!1!==n.retry&&(o=o.retry(n.retryCount||3)),!1!==n.timeout&&(o=o.timeout(!0===n.timeout?1e4:n.timeout)),(s=n.files&&Object.entries(n.files))&&s.length>0?(i=new qr,r["Content-Type"]=i.getContentType()):r["Content-Type"]=r["Content-Type"]||this._contentType(n.reqFormat),n.withHeaders&&(o=o.set(r)),!i)return[3,3];if(a=[],n.data)for(u=0,c=Object.entries(n.data);u<c.length;u++)l=c[u],y=l[0],d=l[1],a.push(i.appendField(y,d));for(f=0,p=s;f<p.length;f++)v=p[f],y=v[0],g=v[1],a.push(i.appendFile(y,g));return[4,Promise.all(a)];case 1:return b.sent(),[4,i.getPayload(i)];case 2:return m=b.sent(),o=o.send(m),[3,4];case 3:o=o.send(n.data),b.label=4;case 4:return[2,new Promise((function(r,i){o.end((function(o,s){var a=(s||{}).headers;if(o)if(_.logger&&_.logger.info("error",t.toUpperCase(),e,o),o.status)if(401===o.status)i(new zn.WrongCredentialsError(a));else if(403===o.status){var u=(n.urlParams||{}).userId,c=void 0===u?"403":u;i(new zn.PermissionDeniedError(e,c,t,h.a.get(s,"body.error.message")))}else i(o);else i(new zn.ConnectionUnavailableError);else switch(n.resFormat){case"json":var l=s.body||{};"reply"in l&&(l=l.reply);var d={data:l,headers:a,getHeader:function(t){return a[t.toLowerCase()]},status:s.status};_.logger&&_.logger.info("success",t.toUpperCase(),e,d),r(d);break;default:_.logger&&_.logger.info("success",t.toUpperCase(),e,s.text?s.text.substr(0,80)+"...":"[null]"),r(s.text)}}))}))]}}))}))}},$r=0,Xr=["get","post","put","patch","del"];$r<Xr.length;$r++){Kr(Xr[$r])}zr=Yr.prototype.get,Dr=Object(Or.decorator)(zr),Yr.prototype.get=function(t,e){return void 0===e&&(e={}),e.reusePromise?Dr.call(this,t,e):zr.call(this,t,e)},Object.assign(Yr.prototype,c.a.prototype);var Qr=Yr,Zr=n(25),Jr=n.n(Zr),to=n(4),eo=function(){function t(t,e){this._resolveModelId=function(t){return"string"==typeof t?t:t&&(t.serverId||t.id)||null},Object.assign(this,e),this.host=t,this.config=t.config,this.httpClient=t.httpClient}return t.prototype._resolveModelIdWithTypes=function(t,e){if(!t)return null;if("string"==typeof t){var n=this._resolveEntity(t);if(!n)return t;t=n}return to.c.oneOf("thing",t.$entityType,Object(to.d)(e)),t.serverId||t.id||null},t.prototype._resolveEntity=function(t,e){e=e?Object(to.d)(e):this.host.allModelEntityTypes,"object"==typeof t&&(t.$entityType&&(to.c.oneOf("thing",t.$entityType,e),e=[t.$entityType]),t=t.id);for(var n=0,r=e;n<r.length;n++){var o=r[n],i=this.host.modelsByEntityType[o].get(t);if(i)return i}return null},t.prototype.mounted=function(){},t.prototype.dispose=function(){},t}(),no=eo;Object.assign(eo.prototype,c.a.prototype);var ro,oo,io=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),so=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ao=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},uo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return io(e,t),e.prototype.start=function(t){var e=t.organizationId,n=t.recipients,r=t.payload,o=t.context;return so(this,void 0,void 0,(function(){var t,i,s,a,u,c,l,d,f,h,p,v,y,g,m,b,w,I;return ao(this,(function(O){switch(O.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");if(!n)throw new zn.ValidationError("recipients","required");if(!r)throw new zn.ValidationError("payload","required");if(!n.length)throw new zn.ValidationError("recipients array","required");if(t=r.callId,i=r.callerId,s=r.date,a=r.groupId,u=r.identity,c=r.isVideo,l=r.name,d=r.networkType,f=r.orgId,h=r.participantsTokens,p=r.recipientToken,v=r.roleTokens,!t)throw new zn.ValidationError("payload.callId","required");if(!i)throw new zn.ValidationError("payload.callerId","required");if(!s)throw new zn.ValidationError("payload.date","required");if(!a)throw new zn.ValidationError("payload.groupId","required");if(!u)throw new zn.ValidationError("payload.identity","required");if(!c)throw new zn.ValidationError("payload.isVideo","required");if(!l)throw new zn.ValidationError("payload.name","required");if(!d)throw new zn.ValidationError("payload.networkType","required");if(!f)throw new zn.ValidationError("payload.orgId","required");if(!h)throw new zn.ValidationError("payload.participantsTokens","required");if(!p)throw new zn.ValidationError("payload.recipientToken","required");if(!v)throw new zn.ValidationError("payload.roleTokens","required");return[4,this.host.api.calls.start({organization:e,recipients:n,payload:_.a.underscoreObject(r),context:o||{}})];case 1:return y=O.sent(),g=y.accessToken,m=y.roomName,b=y.disabledParticipants,w=void 0===b?{}:b,I={},m?(I=this.host.models.Call.inject({id:m,payload:r,accessToken:g,roomName:m}),"patient"===d&&Object.keys(w).length?[4,this.host.api.calls.state(m,f,{callId:t,payload:{callState:"disabled_participants",disabledParticipants:w}})]:[3,3]):[3,3];case 2:O.sent(),O.label=3;case 3:return[2,I]}}))}))},e.prototype.decline=function(t,e){var n=e.payload;return so(this,void 0,void 0,(function(){var e,r,o,i,s;return ao(this,(function(a){switch(a.label){case 0:if(e=this._resolveModelId(t),r=this._resolveEntity(e,"call"),o=r.callId,i=r.organizationId,s=r.id,!i)throw new zn.ValidationError("organizationId","required");if(!n)throw new zn.ValidationError("payload","required");if(!s)throw new zn.ValidationError("roomName","required");if(!o)throw new zn.ValidationError("callId","required");return[4,this.host.api.calls.decline(s,i,{callId:o,payload:n})];case 1:return a.sent(),[2]}}))}))},e.prototype.end=function(t,e){var n=e.payload,r=e.reason;return so(this,void 0,void 0,(function(){var e,o,i,s,a;return ao(this,(function(u){switch(u.label){case 0:if(e=this._resolveModelId(t),o=this._resolveEntity(e,"call"),i=o.callId,s=o.organizationId,a=o.id,!s)throw new zn.ValidationError("organizationId","required");if(!n)throw new zn.ValidationError("payload","required");if(!r)throw new zn.ValidationError("reason","required");if(!a)throw new zn.ValidationError("roomName","required");if(!i)throw new zn.ValidationError("callId","required");return[4,this.host.api.calls.end(a,s,{callId:i,payload:n,reason:r})];case 1:return u.sent(),[2]}}))}))},e.prototype.join=function(t){return so(this,void 0,void 0,(function(){var e,n,r,o,i;return ao(this,(function(s){switch(s.label){case 0:if(e=this._resolveModelId(t),n=this._resolveEntity(e,"call"),r=n.organizationId,o=n.id,!r)throw new zn.ValidationError("organizationId","required");if(!o)throw new zn.ValidationError("roomName","required");return[4,this.host.api.calls.join(o,r)];case 1:return i=s.sent(),[2,_.a.camelizeObject(i)]}}))}))},e.prototype.answer=function(t,e){var n=e.payload;return so(this,void 0,void 0,(function(){var e,r,o,i,s,a;return ao(this,(function(u){switch(u.label){case 0:if(e=this._resolveModelId(t),r=this._resolveEntity(e,"call"),o=r.callId,i=r.organizationId,!(s=r.id))throw new zn.ValidationError("roomName","required");if(!i)throw new zn.ValidationError("organizationId","required");if(!n)throw new zn.ValidationError("payload","required");if(!o)throw new zn.ValidationError("callId","required");return[4,this.host.api.calls.answer(s,i,{payload:n,callId:o})];case 1:return a=u.sent(),[2,_.a.camelizeObject(a)]}}))}))},e.prototype.invite=function(t,e){var n=e.currentUserId,r=e.payload,o=e.recipients;return so(this,void 0,void 0,(function(){var e,i,s,a,u;return ao(this,(function(c){switch(c.label){case 0:if(e=this._resolveModelId(t),i=this._resolveEntity(e,"call"),s=i.callId,a=i.organizationId,u=i.id,!a)throw new zn.ValidationError("organizationId","required");if(!u)throw new zn.ValidationError("roomName","required");if(!r)throw new zn.ValidationError("payload","required");if(!o)throw new zn.ValidationError("recipients","required");if(!s)throw new zn.ValidationError("callId","required");if(!n)throw new zn.ValidationError("currentUserId","required");return[4,this.host.api.calls.invite(u,a,{callId:s,payload:r,recipients:o})];case 1:return c.sent(),[4,this.host.api.calls.state(u,a,{callId:s,payload:{callState:"participants_updated",inviteInitiator:n,newParticipants:o,roleTokens:{}}})];case 2:return c.sent(),[2]}}))}))},e.prototype.log=function(t){var e=t.network,n=t.organizationId,r=t.page;return so(this,void 0,void 0,(function(){var t,o,i,s=this;return ao(this,(function(a){switch(a.label){case 0:if(!n)throw new zn.ValidationError("organizationId","required");if(!e)throw new zn.ValidationError("network","required");return[4,this.host.api.calls.log({network:e,organizationId:n,page:r})];case 1:return t=a.sent(),o=t.metadata,i=t.results,[2,{metadata:o,results:i.map((function(t){return s.host.models.CallLogEntry.inject(t)}))}]}}))}))},e.prototype.reactToVoipSSE=function(t){var e=t.data,n=t.type;if("provider"!==Jr()(e,"payload.network_type")){e=Object(to.l)(e);var r=n.split(":")[1],o=this.host.models.Call.inject(Object.assign(e,{callStatus:r}));this.emit(r,o)}},e}(no),co=n(39),lo=n.n(co),fo=n(204),ho=n.n(fo),po=n(29),vo=n.n(po),yo=n(11),go=n.n(yo),mo=n(91),_o=n.n(mo),bo=n(24),wo=n.n(bo),Io=n(90),Oo=n.n(Io),Eo=n(6),To=n(32),So=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ao=function(){return(Ao=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Co=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ro=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Po=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},jo=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},xo=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},Mo=new Oo.a.MD5,ko=[ar.ESCALATION_EXECUTION_CHANGE,ar.GROUP_MEMBERSHIP_CHANGE],No=or.toServer(or.DELIVERED),zo=((ro={})[Zn.ACKNOWLEDGED]="Acknowledged",ro[Zn.CANCELLED]="Cancelled",ro[Zn.INITIATED]="Initiated",ro[Zn.MEMBER_ADDED]="Added",ro[Zn.NO_RESPONSE]="ended with No Response",ro),Do=[tr.GROUP,tr.FORUM,tr.ROLE_ASSIGNMENT,tr.ROLE_P2P],Uo={ADD:"added",JOIN:"joined",LEAVE:"left",REMOVE:"removed",DENY:"declined"},Lo={ADD:"to",REMOVE:"from",DENY:"to join"},Fo=((oo={})[tr.ACTIVATED_TEAM]="group",oo[tr.ESCALATION]="escalation",oo[tr.FORUM]="forum",oo[tr.GROUP]="group",oo[tr.PATIENT_CARE]="care team",oo[tr.ROLE_P2P]="conversation",oo[tr.PATIENT_MESSAGING]="group",oo[tr.INTRA_TEAM]="team",oo),Bo=[or.NEW,or.DELIVERED],qo=or.toServer(or.READ),Vo={OPT_IN:"opted into",OPT_OUT:"opted out of"},Go=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__injectCounterParty=function(t){var n=t.conversationId,r=t.entityAttrs,o=t.entityType,i=t.groupType,s=t.hasCurrentUser,a=void 0!==s&&s,u=t.isPlaceholder,c=void 0!==u&&u,l=t.organizationId,d=r.id,f=r.metadata;if(d||(d=r.token),!o&&r.type&&(o=e.host.modelNameByEntityType(r.type)),n&&(r.conversationId=n),l&&(r.organizationId=l),"group"!==o||i||(i=e.host.groups.__extractGroupTypeFromAttrs(r)),f&&d&&l&&e.host.metadata.__injectMetadata(d,l,f),"group"===o){if(f){if(f.created_by){var h=e.__injectCreatedByEntity(f,l),p=h.role,v=void 0===p?null:p,y=h.user,g=void 0===y?null:y;(v||g)&&(r.createdByRole=v,r.createdByUser=g)}else if(r.created_by){g=e.host.models.User.injectPlaceholder({id:r.created_by});r.createdByUser=g}if(f.target_id){var m=e.__injectTargetEntity(f,l),_=m.role,b=(v=void 0===_?null:_,m.user);g=void 0===b?null:b;(v||g)&&(r.targetRole=v,r.targetUser=g)}if("role_assignment"===f.meta_type){var w=r.display_name||r.name;e.host.roles.__injectRoleAssignmentEntity(w,f,l)}}i===tr.FORUM&&a&&(r.hasCurrentUser=!0)}else if("user"===o){var I=r.dnd_auto_forward_receiver;I&&"undefined"!==I&&e.host.models.User.injectPlaceholder({id:I})}else if("distributionList"===o)r.created_by&&e.host.injectPlaceholderModel({displayName:r.created_by_display_name,id:r.created_by},"user"),r.updated_by&&e.host.injectPlaceholderModel({displayName:r.updated_by_display_name,id:r.updated_by},"user");else if("messageTemplate"===o)r.created_by&&e.host.injectPlaceholderModel({displayName:r.created_by_display_name,id:r.created_by},"user"),r.updated_by&&e.host.injectPlaceholderModel({displayName:r.updated_by_display_name,id:r.updated_by},"user");else if("scheduledMessage"===o){if(r.event_id&&(r.scheduled_message_id=r.token,r.token=r.event_id,d=r.event_id),r.recipient)if("account"===r.recipient_type){for(var O={},E=0,T=["feature_service","is_patient_contact","patient_display_name","patient_dob","patient_gender","patient_id","patient_mrn","phone_number","relation_name"];E<T.length;E++){var S=T[E];O[S]=r[S]}O.patient_id||O.is_patient_contact||(O.patient_id=r.recipient),e.host.metadata.__injectMetadata(r.recipient,l,O),e.host.injectPlaceholderModel(Ao(Ao({},O),{displayName:r.recipient_display_name,id:r.recipient}),"user")}else"distribution_list"!==r.recipient_type&&"list"!==r.recipient_type||e.host.injectPlaceholderModel({id:r.recipient,name:r.recipient_display_name,totalMembers:r.total_members},"distributionList");r.sender_token&&e.host.injectPlaceholderModel({displayName:r.sender_display_name,id:r.sender_token},"user"),r.template_id&&e.host.injectPlaceholderModel({title:r.template_label,id:r.template_id},"messageTemplate"),r.updated_by&&e.host.injectPlaceholderModel({displayName:r.updated_by_display_name,id:r.updated_by},"user")}return d?c?e.host.injectPlaceholderModel(r,o):e.host.injectModel(r,o):null},e.__injectCreatedByEntity=function(t,n){var r={};if(void 0!==t.created_by_tag_id)r.role=e.host.roles.__injectRoleFromMetadata({metadata:{token:t.created_by,display_name:t.created_by_display_name,tag_color:t.created_by_tag_color,tag_id:t.created_by_tag_id,tag_name:t.created_by_tag_name},organizationId:n,replaceExisting:!1});else{var o=e.host.models.User.get(t.created_by);if(o)r.user=o;else{var i={id:t.created_by};"created_by_display_name"in t&&(i.displayName=t.created_by_display_name),r.user=e.host.models.User.injectPlaceholder(i)}}return r},e.__injectTargetEntity=function(t,n){var r={};if(void 0!==t.target_tag_id)r.role=e.host.roles.__injectRoleFromMetadata({metadata:{display_name:t.target_display_name,tag_color:t.target_tag_color,tag_id:t.target_tag_id,tag_name:t.target_tag_name,token:t.target_id},organizationId:n,replaceExisting:!1});else{var o=e.host.models.User.get(t.target_id);if(o)r.user=o;else{var i={id:t.target_id};"target_display_name"in t&&(i.displayName=t.target_display_name),r.user=e.host.models.User.injectPlaceholder(i)}}return r},e.__removeFriend=function(t){var n,r=t.attrs,o=t.entityType,i=t.id,s=t.organizationId,a=t.conversation||e.get(o,i,s),u="group"===o?e.host.models.Group.get(i):null,c=!(!u||u.groupType!==tr.FORUM);if(n="user"===o||e.config.condensedReplays?a&&a.content.slice():a&&a.messages.slice(),c&&(r.hasCurrentUser=!1,r.members=null,e.host.models.Group.inject(r)),e.config.keepConversationsForAllForums&&c||(a&&e.__ejectConversation(a.id),u&&e.config.condensedReplays&&e.host.models.Group.eject(u)),Array.isArray(n))for(var l=0,d=n;l<d.length;l++){var f=d[l];e.host.ejectModel(f,f.$entityType)}},e._sanitizeGroupAttrs=function(t){var n=t.members;e.host.groups.__extractGroupTypeFromAttrs(t)===tr.FORUM&&n&&0===n.length&&delete t.members},e._onSendingMessage=function(t){var n;if(n=e.config.condensedReplays?t.conversation:e.ensureConversation(t.counterPartyType,t.counterPartyId,t.senderOrganizationId,{ensureEntities:{counterParty:"full",organization:"placeholder",messageCounterParties:"full",groupMembers:"full",touchOnRelatedEntityLoad:!0}})){var r=!1;e.host.config.condensedReplays&&t&&t.sortNumber&&(void 0===n.highestSortNumber||n.highestSortNumber<t.sortNumber)&&(n.highestSortNumber=t.sortNumber,r=!0),void 0===n.highestSortNumber&&(n.highestSortNumber=e.host.messages.__getNextSortNumber(n.organizationId),r=!0),r&&e.host.models.Conversation.inject(n),e.__addConversationCounterPartyToServerRosterIfShould(n)}},e._onSentMessage=function(t){var n=!1,r=e.ensureConversation(t.counterPartyType,t.counterPartyId,t.senderOrganizationId);r&&(e.host.config.condensedReplays&&(t&&t.sortNumber&&(void 0===r.highestSortNumber||r.highestSortNumber<t.sortNumber)?(r.highestSortNumber=t.sortNumber,n=!0):void 0===r.highestSortNumber&&(r.highestSortNumber=e.host.messages.__getNextSortNumber(r.organizationId),n=!0)),n&&e.host.models.Conversation.inject(r),r.emit("message",t))},e._onChangeMessage=function(t,n){n.conversation&&e.__queueReload(n.conversation)},e._onRemoveMessage=function(t,n){var r=n.conversation;if(r){if(e.config.condensedReplays){var o=r.firstExpiringUnreadMessage,i=r.id,s=r.lastMessage,a=r.timeline;if(!(r=e.getById(i)))return;var u=s===n,c=o===n,l=1===a.length&&u;(u||c)&&e.find(r.id),l&&(r.lastMessage=null)}e.__queueReload(r)}},e._onRemoveGroup=function(t,n){var r=n.conversationId?n.conversationId:e.getConversationKey("group",n.id,n.organizationId);e.__ejectConversation(r)},e._onRemoveTeam=function(t,n){var r=e.getConversationKey("team",n.id,n.organizationId);e.__ejectConversation(r)},e._onChangeGroup=function(t,n){n.conversationId&&e.host.models.Conversation.touch(n.conversationId)},e._onChangeOrganization=function(t,n){var r=n.conversations,o=e.__escalationEnabledOrganizations.indexOf(n),i=o>-1;if(i!==n.canEscalateMessages&&(i?e.__escalationEnabledOrganizations.splice(o,1):e.__escalationEnabledOrganizations.push(n),r))for(var s=0,a=r;s<a.length;s++){var u=a[s];e.__queueReload(u)}},e.__flushConversationsToReload=function(){if(!e.host.currentlyServingOfflineMessages&&e.__queuedConversationsToReload.length>0){var t=[];e.host.organizations._deferConversationChanges=!0;for(var n=0,r=e.__queuedConversationsToReload;n<r.length;n++){var o=r[n],i=o.organizationId;e.__reloadConversation(o),t.includes(i)||t.push(i)}e.host.organizations._deferConversationChanges=!1;for(var s=0,a=t;s<a.length;s++){i=a[s];var u=e.host.organizations.getById(i);u&&e.host.organizations.__reloadConversations(u)}e.__queuedConversationsToReload.length=0}},e}return So(e,t),e.prototype.mounted=function(){this.__escalationEnabledOrganizations=[],this.__queuedConversationsToReload=[],this._convByConvHandle={},this._fetched=!1,this._roleConversationsProcessingEvent={},this._rolesFriendsEventPromise=null,this.host.on("message:sending",this._onSendingMessage),this.host.on("message:sent",this._onSentMessage),this.host.models.Group.on("afterEject",this._onRemoveGroup),this.host.models.Group.on("afterInject",this._onChangeGroup),this.host.models.Team.on("afterEject",this._onRemoveTeam),this.host.models.Message.on("afterInject",this._onChangeMessage),this.host.models.Message.on("afterEject",this._onRemoveMessage),this.host.models.Organization.on("afterInject",this._onChangeOrganization)},e.prototype.dispose=function(){this._convByConvHandle={},this._fetched=!1,this._rolesFriendsEventPromise=null,this.__escalationEnabledOrganizations=[],this.__queuedConversationsToReload=[],this.host.removeListener("message:sending",this._onSendingMessage),this.host.removeListener("message:sent",this._onSentMessage),this.host.models.Group.removeListener("afterEject",this._onRemoveGroup),this.host.models.Group.removeListener("afterInject",this._onChangeGroup),this.host.models.Team.removeListener("afterEject",this._onRemoveTeam),this.host.models.Message.removeListener("afterInject",this._onChangeMessage),this.host.models.Message.removeListener("afterEject",this._onRemoveMessage),this.host.models.Organization.removeListener("afterInject",this._onChangeOrganization)},e.prototype.clearTimeline=function(t,e){var n=(void 0===e?{}:e).emit,r=void 0===n||n,o=this._resolveEntity(t,"conversation");if(!o)throw new zn.NotFoundError(this.host.models.Conversation.name,t);t=this._resolveModelId(t),this.clearMessageStatuses(o,{emit:!1});for(var i=o.higherContinuation,s=o.lowerContinuation,a=0,u=0,c=o.timeline;u<c.length;u++){var l=c[u];l.isEphemeral||(l.inTimeline=!1,a+=1)}return o.isLive=!1,i.itemsEstimate=null,s.itemsEstimate=null,r&&this.emit("clearTimeline",t),this.config.condensedReplays?this.host.models.Conversation.inject(o):this.__reloadConversation(o,{notify:!1}),a},e.prototype.fetchTimeline=function(t,e){var n=void 0===e?{}:e,r=n.anchorPoint,o=void 0===r?Qn.CONVERSATION_END:r,i=n.continuation,s=n.fetchAllItems,a=void 0!==s&&s,u=n.markAsDelivered,c=void 0===u||u,l=n.maxItems,d=void 0===l?15:l;return Ro(this,void 0,void 0,(function(){var e,n,r,s,u,l,f,h,p,v,y,g,m,_,b,w,I,O,E,T;return Po(this,(function(S){switch(S.label){case 0:if(!(e=this._resolveEntity(t,"conversation")))throw new zn.NotFoundError(this.host.models.Conversation.name,t);return t=this._resolveModelId(t),this.config.condensedReplays?[4,this._fetchTimelineCR(t,{anchorPoint:o,continuation:i,conversation:e,fetchAllItems:a,markAsDelivered:c,maxItems:d})]:[3,2];case 1:return[2,S.sent()];case 2:if(o!==Qn.CONTINUATION&&e.isLive&&(!a&&e.timeline.length>=d||e.lowerContinuation&&0===e.lowerContinuation.itemsEstimate))return[2,0];if(n=e.content,r=e.timeline,s=e.firstUnreadMessage,u=n.length,l=0,f=[],h=u-d,p=u,o===Qn.CONVERSATION_END)this.clearTimeline(e,{emit:!1});else if(o===Qn.FIRST_UNREAD_ITEM){for(this.clearTimeline(e,{emit:!1}),b=-1,v=0,y=n;v<y.length&&(T=y[v],b++,p=b,s!==T);v++);p<n.length&&(p=Math.min(p+d,n.length))}else if(o===Qn.CONTINUATION)if(g=r[0]?r[0].sortNumber:1/0,m=r[r.length-1]?r[r.length-1].sortNumber:0,0===(_="LOWER"===i?g:m))p-=d;else for(b=-1,w=0,I=n;w<I.length&&(T=I[w],b++,p=b,!("HIGHER"===i&&T.sortNumber>_))&&!("LOWER"===i&&T.sortNumber>=_);w++);for(o!==Qn.CONVERSATION_END&&(o===Qn.CONTINUATION&&"HIGHER"===i?u=(h=p)+d:(p===n.length-1&&(p+=1),u=p,h=p-d)),u=Math.min(u,n.length+1),h=Math.max(h,0),f.push.apply(f,n.slice(h,u)),O=0,E=f;O<E.length;O++)(T=E[O]).inTimeline||(T.inTimeline=!0,this.host.models.Message.inject(T),l+=1);return[2,l]}}))}))},e.prototype._fetchTimelineCR=function(t,e){var n=void 0===e?{}:e,r=n.anchorPoint,o=void 0===r?Qn.CONVERSATION_END:r,i=n.continuation,s=n.conversation,a=n.fetchAllItems,u=void 0!==a&&a,c=n.markAsDelivered,l=void 0===c||c,d=n.maxItems,f=void 0===d?15:d;return Ro(this,void 0,void 0,(function(){var e,n,r,a,c,d,h,p,v,y,g,m,_,b,w,I,O,E,T,S,A;return Po(this,(function(C){switch(C.label){case 0:return o!==Qn.CONTINUATION&&s.isLive&&(!u&&s.timeline.length>=f||s.lowerContinuation&&0===s.lowerContinuation.itemsEstimate)?[2,0]:(o===Qn.CONVERSATION_END?this.clearTimeline(s,{emit:!1}):o===Qn.FIRST_UNREAD_ITEM&&(s.firstUnreadMessage=null,this.clearTimeline(s,{emit:!1})),[4,this.host.api.conversations.fetchTimeline(t,Qn.toServer(o),f,{continuation:i,markAsDelivered:l})]);case 1:for(e=C.sent(),n=e.direction,r=e.higher_continuation,a=e.lower_continuation,c=e.max_items,d=e.timeline,h=s.higherContinuation,p=s.lowerContinuation,v=null,c&&(f=c),y=0,g=d;y<g.length;y++)m=g[y],"tigertext:iq:bang"===(_=m.xmlns)?(b=m.bang_id||""+m.sort_number)?this.host.groups.__handleBang({data:m,eventId:b,alwaysAddToTimeline:!0}):this.logger.warn("Skipping bang with no event id"):"tigertext:iq:message"===_||"tigertext:iq:group_message"===_?(m.conversation_id||(m.conversation_id=t),(w=this._reactToMessageEventCR({data:m,injectConversation:!1}).message).inTimeline=!0,w.isOutgoing||(I={id:w.id+":"+w.counterPartyId,messageId:w.id,status:or.resolve(m.status),userId:this.host.currentUserId},this.host.models.MessageStatusPerRecipient.inject(I)),w.senderStatus=ir.SENT,O=this.host.models.Message.inject(w),v||(v=O)):this.logger.warn("Skipping timeline entry with unrecognized xmlns: "+_);return"Higher"!==n&&"Initial"!==n||(S=0===d.length||d.length<f?0:1,o===Qn.CONVERSATION_END&&(S=0),1===S&&"Initial"===n&&(E=d[d.length-1],T=s.lastMessage,o===Qn.FIRST_UNREAD_ITEM&&v&&!v.isUnread?S=0:T&&E.message_id===T.id&&(S=T.isUnread?1:0)),h={continuation:{higher_continuation:r},itemsEstimate:S}),"Lower"!==n&&"Initial"!==n||(S=0===d.length||d.length<f?0:1,p={continuation:{lower_continuation:a},itemsEstimate:S}),A=d.length,s.isLive=0===h.itemsEstimate,s.higherContinuation=h,s.lowerContinuation=p,this.host.models.Conversation.inject(s),o===Qn.CONTINUATION||void 0===s.lowestSortNumber?[3,3]:[4,this.markAsDelivered(s.id)];case 2:C.sent(),C.label=3;case 3:return[2,A]}}))}))},e.prototype.findAll=function(t){return void 0===t&&(t={}),Ro(this,void 0,void 0,(function(){var e;return Po(this,(function(n){switch(n.label){case 0:return t=h.a.defaults(t,{includeMutes:!0}),this.config.condensedReplays&&(t.includeMutes=!1),this._fetched?[2,this.getAll()]:[4,Promise.all([this.host.api.roster.findAll(),t.includeMutes?this.host.mute.findAll():Promise.resolve()])];case 1:return e=n.sent()[0],this.config.condensedReplays?[2,this._processFindAllCR(e)]:[2,this._processFindAll(e)]}}))}))},e.prototype.findAllForOrganization=function(t){return Ro(this,void 0,void 0,(function(){var e;return Po(this,(function(n){switch(n.label){case 0:if(t=this._resolveModelIdWithTypes(t,"organization"),!this.config.condensedReplays)throw new zn.NotSupportedError("findAllForOrganization() may not be called if this.config.condensedReplays=false");return this._fetched?[2,this.getAllForOrganization(t)]:[4,this.host.api.roster.findAll({organizationId:t})];case 1:return e=n.sent(),[2,this._processFindAllCR(e)]}}))}))},e.prototype._processFindAllCR=function(t){for(var e=[],n=[],r={counterParty:"full",groupMembers:"full",organization:"placeholder"},o=0;o<t.length;o++){var i=(c=t[o]).entity;if(i){var s=this.host.modelNameByEntityType(i.type);"user"===s?n.push({rawConversation:c,origIndex:o}):s&&e.push({rawConversation:c,origIndex:o})}}for(var a=0,u=n;a<u.length;a++){var c=(h=u[a]).rawConversation;o=h.origIndex;h.conversation=this.__injectConversation(c,{origIndex:o})}for(var l=0,d=e;l<d.length;l++){c=(h=d[l]).rawConversation,o=h.origIndex;h.conversation=this.__injectConversation(c,{hasCurrentUser:!0,origIndex:o})}for(var f=[];e.length>0||n.length>0;){var h,p=(h=0===e.length?n.shift():0===n.length||e[0].origIndex<n[0].origIndex?e.shift():n.shift()).conversation;this.__ensureEntities(p,r),f.push(p)}return this._fetched=!0,f},e.prototype._processFindAll=function(t){for(var e=[],n=[],r=[],o=0;o<t.length;o++){var i=(g=t[o]).organization_key,s=g.type,a=jo(g,["organization_key","type"]),u=this.host.modelNameByTypeNS(s);if(a.organizationId=i,"user"===(g={entityAttrs:a,entityType:u,organizationId:i,origIndex:o}).entityType)g.counterParty=this.__injectCounterParty(g),r.push(g);else if(g.entityType){if("group"===u&&(g.groupType=this.host.groups.__extractGroupTypeFromAttrs(a)),g.groupType===tr.FORUM)delete a.members;else if(g.groupType===tr.PATIENT_MESSAGING&&g.entityAttrs&&g.entityAttrs.metadata){var c=g.entityAttrs,l=c.avatar,d=c.metadata,f=d.patient_id,h=d.patient_contact_id;this.host.models.User.injectPlaceholder({id:h||f,avatar:l,metadata:d})}n.push(g)}}for(var p=0,v=n;p<v.length;p++){(g=v[p]).counterParty=this.__injectCounterParty(Ao(Ao({},g),{hasCurrentUser:!0})),e.push(g)}for(var y=[];e.length>0||r.length>0;){var g,m=(g=0===e.length?r.shift():0===r.length||e[0].origIndex<r[0].origIndex?e.shift():r.shift()).conversationId,_=g.counterParty,b=g.lastMessage,w=g.muted,I=(i=g.organizationId,u=g.entityType,g.groupType),O="group"===u&&I&&"PATIENT_MESSAGING"===I?ur.PATIENT:ur.PROVIDER;delete _.$placeholder;var E=void 0;this.host.config.condensedReplays&&b&&b.sort_number&&(E=b.sort_number);var T=this.ensureConversation(_.$entityType,_.id,i,{conversationId:m,ensureEntities:{counterParty:"full",groupMembers:"full",organization:"placeholder"},highestSortNumber:E,muted:w,network:O});T._counterPartyAddedOnServer=!0,y.push(T)}return this._fetched=!0,y},e.prototype.find=function(t,e){return void 0===e&&(e={}),Ro(this,void 0,void 0,(function(){var n,r,o,i,s,a;return Po(this,(function(u){switch(u.label){case 0:return e=h.a.defaultsDeep(e,{ensureEntities:{counterParty:"full",escalationExecution:"full",groupMembers:"placeholder",messageCounterParties:"full",organization:"placeholder",touchOnRelatedEntityLoad:!1}}),this.config.condensedReplays?(n=this.getById(t))&&n.$localOnly?[3,2]:[4,this.host.api.conversations.find(t)]:[3,3];case 1:if(!(r=u.sent()))throw new zn.NotFoundError(this.host.models.Conversation.name,t);if(!(n=this.__injectConversation(r)))throw new zn.NotFoundError(this.host.models.Conversation.name,t);u.label=2;case 2:return[3,6];case 3:return o=e.groupId,i=e.organizationId,s=e.includeMutes,a=o&&i?this.getConversationKey("group",o,i):t,(n=this.getById(a))?[3,5]:[4,this.findAll({includeMutes:s})];case 4:u.sent(),n=this.getById(a),u.label=5;case 5:if(!n)throw new zn.NotFoundError(this.host.models.Conversation.name,t);u.label=6;case 6:return e.ensureEntities?[4,this.__ensureEntities(n,e.ensureEntities)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[2,n]}}))}))},e.prototype.__injectConversation=function(t,e){var n,r=void 0===e?{}:e,o=r.hasCurrentUser,i=r.highestSortNumber,s=r.origIndex,a=void 0===s?this.host.models.Conversation.getAll().length:s,u=t.conversation_id,c=t.entity,l=t.first_expiring_unread_message,d=t.in_progress_escalation_count,f=t.last_message,h=t.lowest_sort_number,p=t.muted,v=t.organization_id,y=t.unread_message_count,g=t.unread_priority_message_count,m=this.getById(u);if(m)n=m.counterParty,v=m.organizationId;else{if(v||(v=t.organization_key),!p&&c&&c.muted&&(p=c.muted,delete c.muted),c&&(n=this.__injectCounterParty({conversationId:u,entityAttrs:c,entityType:c.$entityType,hasCurrentUser:o,organizationId:v})),!n)return null;delete n.$placeholder,m||(m=this.host.models.Conversation.createInstance({id:u,counterParty:n,organizationId:v,_origIndex:a}))}var _=n.id,b=n.$entityType,w=n.groupType;if("group"!==b||w!==tr.FORUM||n.hasCurrentUser||(f=null),l?(f&&(f.message_id===l.message_id?l=f:(l.senderId=f.sender_token,l.senderOrganizationId=f.sender_organization)),m.firstExpiringUnreadMessage=this._ensureFirstExpiringUnreadMessage({rawFirstExpiringUnreadMessage:l,conversationId:u,counterParty:n})):null===l&&(m.firstExpiringUnreadMessage=null),void 0!==f){var I=f?this._ensureLastMessage({rawLastMessage:f,conversationId:u,counterParty:n}):null;if(I&&I.isEphemeral)(!(O=m.lastEphemeralMessage)||I.sortNumber>O.sortNumber)&&(m.lastEphemeralMessage=I);if(m.lastEphemeralMessage){var O=m.lastEphemeralMessage;(!I||O.sortNumber>I.sortNumber)&&(I=O)}m.lastMessage=I,void 0===i&&f&&f.sort_number&&(i=f.sort_number)}m._counterPartyAddedOnServer=!0,c&&c.metadata&&(m.metadata=c.metadata),void 0!==i&&i>m.highestSortNumber&&(m.highestSortNumber=i),void 0!==h&&0!==h&&(m.lowestSortNumber=h),void 0!==d&&(m.inProgressEscalationCount=d),void 0!==p&&(m.muted=p),m._markingAsRead&&(void 0===i||i<=m._markingAsReadSortNumber)||(void 0!==y&&(m.unreadCount=y),void 0!==g&&(m.unreadPriorityCount=g)),this.host.models.Conversation.inject(m);var E=this.getConversationKey(b,_,v);return this._convByConvHandle[E]=m,m},e.prototype.refetch=function(){return Ro(this,void 0,void 0,(function(){return Po(this,(function(t){return this._fetched=!1,[2,this.findAll()]}))}))},e.prototype._ensureLastMessage=function(t){var e=t.rawLastMessage,n=t.conversationId,r=t.counterParty,o=e.message_id,i=jo(e,["message_id"]);if(!o)return null;var s=this.host.messages.getById(o);return s?(s.shouldEnsureRecipientStatus=!0,s.senderStatus=ir.SENT,this.host.models.Message.inject(s)):(i.senderStatus=ir.SENT,i.id=o,i.shouldEnsureRecipientStatus=!0,i.conversationId=n,i.counterParty=r,s=this.host.models.Message.injectPlaceholder(i)),s},e.prototype._ensureFirstExpiringUnreadMessage=function(t){var e=t.rawFirstExpiringUnreadMessage,n=t.conversationId,r=t.counterParty,o=e.expire_in,i=e.message_id,s=jo(e,["expire_in","message_id"]);if(i){var a=this.host.messages.getById(i);return a?(a.shouldEnsureRecipientStatus=!0,a.expireIn=o,this.host.models.Message.inject(a)):(s.id=i,s.shouldEnsureRecipientStatus=!0,s.expireIn=o,s.conversationId=n,s.counterParty=r,a=this.host.models.Message.injectPlaceholder(s)),a}return null},e.prototype.markAsDelivered=function(t){return Ro(this,void 0,void 0,(function(){var e,n,r;return Po(this,(function(o){switch(o.label){case 0:if(!(e=this._resolveEntity(t,"conversation")))throw new zn.NotFoundError(this.host.models.Conversation.name,t);if(t=this._resolveModelId(t),!this.config.condensedReplays)return[3,5];n=e.highestSortNumber,r=e.lowestSortNumber,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.host.api.conversations.updateConversationStatus(t,No,{highestSortNumber:n,lowestSortNumber:r})];case 2:return o.sent(),e.lowestSortNumber=null,[3,4];case 3:return o.sent(),this.logger.warn("failed to mark conversation "+t+" as delivered"),[3,4];case 4:return this.host.models.Conversation.inject(e),[3,6];case 5:return[2,this.host.messages.markAsDelivered(e.messages)];case 6:return[2]}}))}))},e.prototype.markAsRead=function(t,e){return void 0===e&&(e={}),Ro(this,void 0,void 0,(function(){var n,r,o;return Po(this,(function(i){switch(i.label){case 0:if(!(n=this._resolveEntity(t,"conversation")))throw new zn.NotFoundError(this.host.models.Conversation.name,t);if(t=this._resolveModelId(t),!this.config.condensedReplays)return[3,5];if(r=n.highestSortNumber,o=n.unreadCount,!n._markingAsRead){if(0===o)return[2];n._markingAsRead=!0,n._markingAsReadSortNumber=r,n._markingAsReadExpiration=(new Date).getTime()+3e4,this.__reloadConversation(n)}if(e.localOnly)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.host.api.conversations.updateConversationStatus(t,qo,{highestSortNumber:r})];case 2:return i.sent(),[3,4];case 3:return i.sent(),this.logger.warn("failed to mark conversation "+t+" as read"),[3,4];case 4:return[3,6];case 5:return[2,this.host.messages.markAsRead(n.markableAsReadMessages,e)];case 6:return[2]}}))}))},e.prototype.add=function(t,e,n){return Ro(this,void 0,void 0,(function(){var r,o;return Po(this,(function(i){switch(i.label){case 0:r=this.ensureConversation(t,e,n),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.host.api.roster.add(t,e,n)];case 2:return i.sent(),[3,4];case 3:return o=i.sent(),this.logger.warn("can't add "+e+" "+t,o),[3,4];case 4:return r._counterPartyAddedOnServer=!0,[2]}}))}))},e.prototype.remove=function(t){return Ro(this,void 0,void 0,(function(){var e,n,r,o;return Po(this,(function(i){switch(i.label){case 0:if(t=this._resolveModelId(t),!(e=this._resolveEntity(t,"conversation")))throw new zn.NotFoundError(this.host.models.Conversation.name,t);n=e.counterPartyId,r=e.counterPartyType,o=e.organizationId,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.host.api.roster.remove(r,n,o)];case 2:return i.sent(),[3,4];case 3:return i.sent(),this.logger.warn("can't remove conversation "+t),[3,4];case 4:return[2]}}))}))},e.prototype.ensureConversation=function(t,e,n,r){void 0===r&&(r={});var o=(r=h.a.defaultsDeep(r,{ensureEntities:{counterParty:!1,organization:!1,messageCounterParties:!1,groupMembers:!1,touchOnRelatedEntityLoad:!0}})).conversationId,i=this.getConversationKey(t,e,n);if(this.config.condensedReplays&&!o){var s=this._convByConvHandle[i];s&&(o=s.id)}o||(o=i);var a=this.getById(o);if(a){this.__ensureEntities(a,r.ensureEntities);var u=!1;return this.config.condensedReplays&&void 0!==r.highestSortNumber&&(a.highestSortNumber=r.highestSortNumber,u=!0),this.config.condensedReplays&&void 0!==r.muted&&(a.muted=r.muted,u=!0),this._convByConvHandle[i]=a,u&&this.host.models.Conversation.inject(a),a}var c={id:o,counterPartyType:t,counterPartyId:e,organizationId:n,_origIndex:this.host.models.Conversation.getAll().length};r.highestSortNumber&&(c.highestSortNumber=r.highestSortNumber),r.muted&&(c.muted=r.muted),r.network&&(c.network=r.network);var l=this.host.models.Group.get(e);l&&l.groupType===tr.PATIENT_MESSAGING&&(c.network=ur.PATIENT);var d=this.host.metadata.get(e,n);if(d){var f=d.data;c.metadata=f}return a=this.host.models.Conversation.createInstance(c),this.__ensureEntities(a,r.ensureEntities),this.host.models.Conversation.inject(a),this._convByConvHandle[i]=a,a},e.prototype.__ejectConversation=function(t){var e=this.getById(t);if(e){var n=e.counterPartyType,r=e.counterPartyId,o=e.organizationId,i=this.getConversationKey(n,r,o);delete this._convByConvHandle[i],this.host.models.Conversation.eject(e),this.__queuedConversationsToReload=this.__queuedConversationsToReload.filter((function(t){return t.id!==e.id}))}return e},e.prototype.reactToMessageEvent=function(t){var e=t.data;if(this.config.condensedReplays)this.reactToMessageEventCR({data:e});else{var n=this._reactToMessageEvent({data:e}),r=n.message,o=n.conversation;this.host.models.Message.inject(r),this.emit("message",r),o&&(this.__addConversationCounterPartyToServerRosterIfShould(o),o.emit("message",r),this.config.condensedReplays&&o._markingAsRead&&r.sortNumber>o._markingAsReadSortNumber&&this.__clearOptimisticStatus([o]));rr[r.markedRecipientStatus]<rr[or.DELIVERED]&&this.host.messages.markAsReceived(r,{})}},e.prototype.reactToMessageEventCR=function(t){var e=t.data,n={},r=this._reactToMessageEventCR({data:e}),o=r.message,i=r.conversation;this.emit("message",o),i&&(this.__addConversationCounterPartyToServerRosterIfShould(i),i.emit("message",o)),n.queue=!0,this.host.messages.markAsReceived(o,n)},e.prototype._reactToMessageEvent=function(t){var e=t.data,n=t.conversationId,r=void 0===n?null:n;e=Object(to.l)(e);var o=this.host.currentUserId,i=e.recipient_status;i||(i=[]);var s={status:e.status,timestamp:e.created_time};e.team_request&&this.host.teams.__injectTeamRequest(e.team_request);var a=this.host.models.Message.parseAttrs(e);a.messageType=ar.USER_SENT;var u=!0;if(a.groupId)a.counterPartyType="group",a.counterPartyId=a.groupId;else if(a.recipientId){if(this.host.distributionLists.getById(a.recipientId))a.counterPartyType="distributionList";else if(this.host.users.getById(a.recipientId))a.counterPartyType="user";else{u=!1;var c=this.host.messages._looksLikeDistributionListMessage(a);a.counterPartyType=c?"distributionList":"user"}a.counterPartyId="distributionList"===a.counterPartyType||a.senderId===o?a.recipientId:a.senderId}var l=this.host.messages._isMessageOutgoing(a);"distributionList"!==a.counterPartyType&&(s.account_id=l?a.recipientId:this.host.currentUserId,s.account_id&&i.push(s)),a.senderStatus=ir.SENT;var d=u&&this.ensureConversation(a.counterPartyType,a.counterPartyId,a.recipientOrganizationId,{conversationId:r,ensureEntities:{counterParty:"placeholder",groupMembers:"placeholder",organization:"placeholder"}});a.conversationId=d?d.id:null;var f=this.host.models.Message.get(a.id);if(f){var h=a.body,p=a.escalationExecutionId,v=a.isForwardedFromPatientNetwork,y=a.originalSender,g=a.patientDetails,m=a.priority,_=a.sortNumber,b=a.sortSeries;f.body=h,f.escalationExecutionId=p||null,f.isForwardedFromPatientNetwork=v,f.originalSender=y,f.patientDetails=g,f.priority=m,f.shouldEscalate=!1,f.sortNumber=_,f.sortSeries=b}else f=this.host.models.Message.createInstance(a,!1);var w=f.senderId===o?f.recipientId:f.senderId;w&&"distributionList"!==f.counterPartyType&&this.__ensureMessageCounterParty(d,w,{messageCounterParties:this.host.currentlyServingOfflineMessages?"placeholder":"full",touchOnRelatedEntityLoad:!0});for(var I=0,O=i;I<O.length;I++){var E=O[I];this.config.condensedReplays||this.host.messages.__injectMessageStatus(f,E)}return("group"===a.counterPartyType||this.config.condensedReplays)&&(f.shouldEnsureRecipientStatus=!0),f.inTimeline=!(!d||!d.isLive),{message:f,conversation:d}},e.prototype._reactToMessageEventCR=function(t){var e=void 0===t?{}:t,n=e.data,r=void 0===n?{}:n,o=e.injectConversation,i=void 0===o||o;r=Object(to.l)(r);var s,a=this.host.currentUserId,u=r.first_expiring_unread_message,c=r.last_message,l=(r.type,r.unread_message_count),d=r.unread_priority_message_count,f=(r.xmlns,jo(r,["first_expiring_unread_message","last_message","type","unread_message_count","unread_priority_message_count","xmlns"]));f.team_request&&this.host.teams.__injectTeamRequest(f.team_request),c&&(c.conversation_id=f.conversation_id,s=c.sort_number,c.is_group&&!c.group_token&&(c.group_token=c.recipient_token),c.message_id===f.client_id&&(f.attachmentName=c.attachment_name)),f.is_group&&!f.group_token&&(f.group_token=f.recipient_token);var h=this.host.models.Message.parseAttrs(f);if(h.messageType=ar.USER_SENT,h.groupId)h.counterPartyType="group",h.counterPartyId=h.groupId;else if(h.recipientId){if(this.host.distributionLists.getById(h.recipientId))h.counterPartyType="distributionList";else if(this.host.users.getById(h.recipientId))h.counterPartyType="user";else{var p=this.host.messages._looksLikeDistributionListMessage(h);h.counterPartyType=p?"distributionList":"user"}h.counterPartyId="distributionList"===h.counterPartyType||h.senderId===a?h.recipientId:h.senderId}h.senderStatus=ir.SENT;var v,y=this.host.models.Message.get(h.id);if(y?this.host.models.Message.inject(Ao({shouldEscalate:!1},h)):y=this.host.models.Message.inject(h),i){var g={conversation_id:y.conversationId,entity:this._resolveEntity(h.counterPartyId,h.counterPartyType),first_expiring_unread_message:u,last_message:c,organization_id:y.__organizationId,unread_message_count:l,unread_priority_message_count:d};if(c&&c.sort_number<y.sortNumber?(s=y.sortNumber,g.last_message={message_id:y.id},(v=this.__injectConversation(g,{highestSortNumber:s}))&&this._ensureLastMessage({rawLastMessage:c,conversationId:v.id,counterParty:v.counterParty})):v=this.__injectConversation(g,{highestSortNumber:s}),c&&c.message_id&&v&&v.isLive){var m=this.host.models.Message.get(c.message_id);m&&!m.inTimeline&&(m.inTimeline=!0,this.host.models.Message.inject(m))}}else v=this.host.conversations.getById(f.conversation_id);var _=y.senderId===a?y.recipientId:y.senderId,b="group"!==y.counterPartyType||y.counterParty&&"FORUM"===y.counterParty.groupType;return _&&"distributionList"!==y.counterPartyType&&b&&this.__ensureMessageCounterParty(v,_,{messageCounterParties:this.host.currentlyServingOfflineMessages?"placeholder":"full",touchOnRelatedEntityLoad:!0}),y.inTimeline=!!y.isEphemeral||!(!v||!v.isLive),y.shouldEnsureRecipientStatus=!0,this.host.models.Message.inject(y),{conversation:v,message:y}},e.prototype.reactToFriendsEventCR=function(t){var e=t.data,n=t.eventId,r=(e=Object(to.l)(e)).action,o=(e.xmlns,jo(e,["action","xmlns"])),i=o.entity,s=o.organization_id||o.organization_key,a=i.metadata,u=i.id||i.token;if("group"===i&&"del"===r&&!a){var c=this.host.models.Group.get(o.token),l=this.getById(c.conversation.id);return this.__removeFriend({conversation:l,entityType:i,id:o.token,organizationId:s}),l&&this.__clearOptimisticStatus([l]),void this.emit("friends",Ao(Ao({action:r},l.entity),{organizationId:s}))}if(i.type){var d=this.host.modelNameByEntityType(i.type);if(a&&"patient_messaging"===a.feature_service&&"string"==typeof a.is_patient_contact&&(a.is_patient_contact="true"===a.is_patient_contact),i.organizationId=s,"group"===d&&a&&"role"===a.feature_service&&"role_assignment"===a.meta_type)this._rolesFriendsEventPromise=this.host.roles.reactToFriendsEventCR({action:r,attrs:i,id:n});else{var f=o.conversation_id,p=o.last_message,v=o.lowest_sort_number,y=this.getById(f);if("add"===r||"update"===r){y&&"update"===r&&this.clearMessageStatuses(y);var g=p&&p.sort_number?p.sort_number:void 0,m=!1,_=h.a.get(e,"entity.is_public")||h.a.get(e,"entity.metadata.team");if((void 0===g||_)&&"add"===r)if("group"===d){if(i.proxied_members&&i.proxied_members[this.host.currentUserId])for(var b=this.host.models.Product.getAll()[0],w=0,I=i.proxied_members[this.host.currentUserId];w<I.length;w++){var O=I[w];if(b.rolesOptingIn.includes(O.token)){m=!0;break}}g=m?1:this.host.messages.__getNextSortNumber(s)}else g=y?y.highestSortNumber:1;var E=y&&y.lastMessage;if("add"===r){var T="group"===d&&this.host.groups.__extractGroupTypeFromAttrs(i);T!==tr.GROUP&&T!==tr.FORUM||(i.members=null),this.__injectCounterParty({entityAttrs:i,entityType:d,groupType:T,hasCurrentUser:!0,isPlaceholder:!0,organizationId:s}),y=this.__injectConversation(o,{highestSortNumber:g}),E&&!p&&this.find(f),this.clearTimeline(y)}else"update"===r&&(y=this.__injectConversation(o,{highestSortNumber:g}),E&&!p&&this.find(f));v&&this.markAsDelivered(y)}else"del"===r?this.__removeFriend({attrs:i,entityType:d,id:u,organizationId:s}):this.logger.error("friends action not implemented",r,e);y&&this.__clearOptimisticStatus([y]),this.emit("friends",Ao({action:r},i))}}},e.prototype.reactToFriendsEvent=function(t){var e=t.data,n=t.id;if(this.config.condensedReplays)this.reactToFriendsEventCR({data:e,eventId:n});else{var r=(e=Object(to.l)(e)).friend,o=r.action,i=r.organization_id,s=jo(r,["action","organization_id"]),a=s.metadata,u=s.token,c=this.host.modelNameByTypeNS(s.xmlns);if(c)if("group"===c&&a&&"role"===a.feature_service&&"role_assignment"===a.meta_type)this._rolesFriendsEventPromise=this.host.roles.reactToFriendsEvent({data:e,id:n});else{if("add"===o){var l="group"===c&&this.host.groups.__extractGroupTypeFromAttrs(s);l!==tr.GROUP&&l!==tr.FORUM||(s.members=null);var d=l===tr.PATIENT_MESSAGING?"PATIENT":"PROVIDER";this.__injectCounterParty({entityAttrs:s,entityType:c,groupType:l,hasCurrentUser:!0,isPlaceholder:!0,organizationId:i});var f="group"===c?this.host.messages.__getNextSortNumber(i):1;this.ensureConversation(c,u,i,{highestSortNumber:f,network:d})}else"del"===o?this.__removeFriend({attrs:s,entityType:c,id:u,organizationId:i}):this.logger.error("friends action not implemented",o,e);this.emit("friends",Ao({action:o},s))}}},e.prototype.reactToUpdateTeamRequestEvent=function(t){var e=t.data,n=(e=Object(to.l)(e)).team_request;n&&this.host.teams.__injectTeamRequest(n)},e.prototype.reactToUpdateEventCR=function(t){var e=t.data,n=(e=Object(to.l)(e)).entity,r=e.organization_id,o=n.metadata,i=n.token,s=n.type;n.organizationId=r,this._sanitizeGroupAttrs(n);var a=this.host.modelNameByEntityType(s),u=this.host.groups.__extractGroupTypeFromAttrs(n);if(o&&r&&i&&Do.includes(u)&&this.host.metadata.__injectMetadata(i,r,o),o&&o.feature_service&&"role"===o.feature_service){if("group"===a&&o.target_id)return this.__injectTargetEntity(o,r);this.host.roles.reactToUpdateEventCR({entity:n})}this.host.injectModel(n,s)},e.prototype.reactToUpdateEvent=function(t){var e=t.data;if(this.config.condensedReplays)this.reactToUpdateEventCR({data:e});else{var n=(e=Object(to.l)(e)).metadata,r=e.organization_key,o=e.token,i=e.type;this._sanitizeGroupAttrs(e);var s=this.host.modelNameByTypeNS(i),a=this.host.groups.__extractGroupTypeFromAttrs(e);if(n&&r&&o&&Do.includes(a)&&this.host.metadata.__injectMetadata(o,r,n),n&&n.feature_service&&"role"===n.feature_service){if("group"===s&&n.target_id)return this.__injectTargetEntity(n,r);this.host.roles.reactToUpdateEvent({data:e})}var u=jo(e,[]);this.host.injectModel(u,i)}},e.prototype.__queueReload=function(t){this.__queuedConversationsToReload.includes(t)||this.__queuedConversationsToReload.push(t),this.__flushConversationsToReload()},e.prototype.hasPendingReloads=function(){return this.__queuedConversationsToReload&&this.__queuedConversationsToReload.length>0},e.prototype.__updateTimeline=function(t){var e=t.content,n=t.timeline;n.length=0;for(var r=0,o=e;r<o.length;r++){var i=o[r];i.inTimeline&&n.push(i)}this.host.models.Conversation.inject(t)},e.prototype.__reloadConversation=function(t,e){var n=(void 0===e?{}:e).notify,r=void 0===n||n;if(this.config.condensedReplays)return this.__reloadConversationCR(t);var o=t.content,i=t.higherContinuation,s=t.lowerContinuation,a=t.markableAsReadMessages,u=t.messages,c=t.timeline,l=[],d=[],f=0,p=null,v=null,y=null;a.length=0,u.length=0,c.length=0;for(var g=-1,m=0,_=o;m<_.length;m++){var b=_[m];g++;var w=b.escalationExecution,I=b.inTimeline,O=b.isOutgoing,E=b.isUnread,T=b.markedRecipientStatus,S=b.messageType,A=b.priority;I&&(null===p&&(p=g),v=g,c.push(b)),S===ar.USER_SENT?(u.push(b),O||!E||y||(y=b),w&&"IN_PROGRESS"===w.status&&f++,Bo.includes(T)&&a.push(b),O||(E&&(l.push(b),A===er.HIGH&&d.push(b)),t.lastIncomingMessageSortNumber=b.sortNumber)):ko.includes(S)&&(t.lastBangMessageSortNumber=b.sortNumber)}s.itemsEstimate=p,i.itemsEstimate=null===v?null:o.length-1-v,t.isLive=0===i.itemsEstimate||0===o.length;var C=u.length>0?u[u.length-1]:null,R=C||h.a.last(o.filter((function(t){return t.messageType===ar.GROUP_MEMBERSHIP_CHANGE&&t.groupMembersChange&&"ADD"===t.groupMembersChange.action})));if(t.firstUnreadMessage=y,t.inProgressEscalationCount=f,t.lastMessage=C,t.unreadCount=l.length,t.unreadPriorityCount=d.length,t.highestSortNumber=R&&R.sortNumber||t.lastConversationSortNumber||0,r){var P=t.counterPartyType,j=t.counterPartyId,x=t.organizationId,M=this.getConversationKey(P,j,x);this._convByConvHandle[M]=t,this.host.models.Conversation.inject(t)}},e.prototype.__reloadConversationCR=function(t){var e=t._markingAsRead,n=t._markingAsReadSortNumber,r=t.content,o=t.higherContinuation,i=t.messages,s=t.timeline,a=[],u=[],c=null;i.length=0,s.length=0;for(var l=0,d=r;l<d.length;l++){var f=d[l],h=f.inTimeline,p=f.isOutgoing,v=f.isUnread,y=f.messageType,g=f.priority,m=f.sortNumber;h&&s.push(f),y===ar.USER_SENT?(i.push(f),!p&&v&&(c||(c=f),e&&m<=n||(a.push(f),g===er.HIGH&&u.push(f)))):ko.includes(y)&&(t.lastBangMessageSortNumber=f.sortNumber)}t.firstUnreadMessage=c,t.highestSortNumber=t.highestSortNumber||0,t.isLive=0===o.itemsEstimate||0===r.length,e&&(t.unreadCount=a.length,t.unreadPriorityCount=u.length);var _=t.counterPartyType,b=t.counterPartyId,w=t.organizationId,I=this.getConversationKey(_,b,w);this._convByConvHandle[I]=t,this.host.models.Conversation.inject(t)},e.prototype.__addConversationCounterPartyToServerRosterIfShould=function(t){if(t&&!t._counterPartyAddedOnServer){var e=t.organization;e&&!e.$placeholder&&this.add(t.counterPartyType,t.counterPartyId,t.organizationId)}},e.prototype.addMembershipChangeLog=function(t){var e,n,r=t.action,o=t.actionTime,i=t.actor,s=t.alwaysAddToTimeline,a=t.createdAt,u=t.group,c=t.id,l=t.memberIds,d=t.members,f=t.removedFromGroup,h=void 0!==f&&f,p=t.sortNumber,v=i.id,y=u.id,g=u.organizationId,m=this.host.currentUser,_=this.get("group",y,g);if(this.config.condensedReplays){if(!_)return;e=_.id}else e=this.getConversationKey("group",y,g);n=!!s||!h&&(!!_&&_.isLive);var b=this.host.models.GroupMembersChange.inject({id:"groupMembersChange:"+c,action:r,actionTime:o,actor:i,memberIds:l,members:d});this.host.models.Message.inject({body:this.__generateGroupMembershipChangeBody(t),conversationId:e,counterPartyId:y,counterPartyType:"group",createdAt:a,groupId:y,groupMembersChange:b,id:"bang:"+c,inTimeline:n,isOutgoing:!1,messageType:ar.GROUP_MEMBERSHIP_CHANGE,recipient:m,senderId:v,sortNumber:p}),"OPT_IN"!==r&&"OPT_OUT"!==r||this.host.roles.refresh(g)},e.prototype.__generateGroupMembershipChangeBody=function(t){var e=this,n=t.action,r=t.actor,o=t.group,i=t.members,s=o.groupType,a=Uo[n]||Vo[n],u=r.id===this.host.currentUserId?"You":r.displayName,c=Lo[n]||"",l=null;return(n in Lo||n in Vo)&&(l=ho.a.call(lo.a.call(i.map((function(t,n){return[t.id===e.host.currentUserId?"You":t.displayName,(n===i.length-2?" and":",")+" "]})))).join("")),n in Vo?[l,a,u].filter(Boolean).join(" "):[u,a,l,c,"this",Fo[s]].filter(Boolean).join(" ")},e.prototype.addCallChangeLog=function(t){var e=t.caller,n=t.callee.id,r=t.conversationId,o=t.createdAt,i=t.duration,s=t.group.id,a=t.id,u=t.organizationId,c=t.sortNumber,l=t.userStartTime,d=this.config.condensedReplays?r:this.getConversationKey("group",s,u),f=l?wo()(l).format("h:mm A"):"",h=e.id===this.host.currentUser.id;this.host.models.Message.inject({body:(h?"Outgoing":"Incoming")+" Video Call "+f+" ("+Object(To.secondsToDurationFormat)(i)+")",conversationId:d,counterPartyId:n,counterPartyType:"group",createdAt:o,groupId:n,id:"bang:"+a,inTimeline:!0,isOutgoing:!1,messageType:ar.CALL_CHANGE,recipient:this.host.currentUser,senderId:e?e.id:null,sortNumber:c})},e.prototype.addEscalationExecutionChangeLog=function(t){var e,n=t.action,r=t.actionTime,o=t.actor,i=t.alwaysAddToTimeline,s=t.createdAt,a=t.escalationExecution,u=t.group,c=t.members,l=t.id,d=t.sortNumber,f=u.id,h=u.organizationId,p=this.host.currentUser,v=this.get("group",f,h),y=v?v.id:null;if(!v){if(this.config.condensedReplays)return;y=this.getConversationKey("group",f,h)}e=!!i||!!v&&v.isLive;var g=this.host.models.EscalationExecutionChange.inject({id:"escalationExecutionChange:"+l,action:n,actionTime:r,actor:o,members:c});this.host.models.Message.inject({body:this.__generateGroupEscalationChangeBody(t,a),conversationId:y,counterPartyId:f,counterPartyType:"group",createdAt:s,escalationExecutionChange:g,escalationExecutionId:a?a.id:null,groupId:f,id:"bang:"+l,inTimeline:e,isOutgoing:!1,messageType:ar.ESCALATION_EXECUTION_CHANGE,recipient:p,senderId:o?o.id:null,sortNumber:d})},e.prototype.__generateGroupEscalationChangeBody=function(t,e){var n=t.action,r=t.actor,o=t.members,i=zo[n],s=e&&e.displayId||"";return s.startsWith("#")&&(s=s.slice(1,s.length)),""!==s&&(s+=" "),n===Zn.MEMBER_ADDED?i+" "+o[0].displayName+" to this escalation":n!==Zn.INITIATED&&r&&r.displayName?"Escalation "+s+i+" by "+r.displayName:"Escalation "+s+i},e.prototype.getMessageConversationKey=function(t){if(t.groupId)return this.conversationHashForListEntityId(t.groupId);if(t.distributionListId)return this.conversationHashForListEntityId(t.distributionListId);var e=t.senderId===this.host.currentUserId?t.recipientId:t.senderId;return this.conversationHashForUserMessage(e,t.senderOrganizationId,t.recipientOrganizationId)},e.prototype.getConversationKey=function(t,e,n,r){switch(void 0===r&&(r=n),t){case"user":return this.conversationHashForUserMessage(e,n,r);case"distributionList":case"group":case"team":return this.conversationHashForListEntityId(e);default:throw new Error("type "+t+" not supported in conversation")}},e.prototype.conversationHashForUserMessage=function(t,e,n){void 0===n&&(n=e);var r=[t,e,n].join(":");return Mo.b64(r)},e.prototype.conversationHashForListEntityId=function(t){return Mo.b64(t)},e.prototype.conversationHashForGroupId=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.conversationHashForListEntityId.apply(this,t)},e.prototype.conversationHashForDistributionListId=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.conversationHashForListEntityId.apply(this,t)},e.prototype.looksLikeConversationHandle=function(t){return/^[a-zA-Z0-9/+=]{24}$/.test(t)},e.prototype.findConversationWithUser=function(t,e){return Ro(this,void 0,void 0,(function(){return Po(this,(function(n){return[2,this.get(this.host.models.User.name,t,e)]}))}))},e.prototype.findConversationWithGroup=function(t,e){return Ro(this,void 0,void 0,(function(){return Po(this,(function(n){return[2,this.get(this.host.models.Group.name,t,e)]}))}))},e.prototype.findAllGroupConversationsWithMembers=function(t,e,n){var r=void 0===n?{}:n,o=r.exact,i=void 0===o||o,s=r.includeCurrentUser,a=void 0===s||s,u=r.includeForums,c=void 0===u||u,l=r.includeRoles,d=void 0===l||l,f=r.localOnly,h=void 0!==f&&f,p=r.senderId,v=void 0===p?null:p;return Ro(this,void 0,void 0,(function(){var n,r,o,s,u,l;return Po(this,(function(f){switch(f.label){case 0:return[4,this.resolveMembers(Object(to.d)(t))];case 1:return t=(t=f.sent()).map(this._resolveModelId),[4,this.host.groups.findAllWithSpecificMembers(t,e,{exact:i,includeCurrentUser:a,includeForums:c,includeRoles:d,localOnly:h,senderId:v})];case 2:for(n=f.sent(),r=[],o=0,s=n;o<s.length;o++)u=s[o],(l=this.get(this.host.models.Group.name,u.id,e))&&r.push(l);return[2,r]}}))}))},e.prototype.findLocalRoleP2PConversation=function(t,e){var n,r;t=this.host.roles.__resolveRoleId(t),e=this.host.roles.__resolveRoleId(e);var o=this.host.models.User.get(t),i=this.host.models.User.get(e);if(i&&i.isRoleBot&&i.botRole)r=this.host.roles._roleP2PConversations[e];else{if(!(o&&o.isRoleBot&&o.botRole))return null;r=this.host.roles._roleP2PConversations[t]}if(r)for(var s=0,a=r;s<a.length;s++){var u=a[s],c=u.$lastModified,l=u.counterParty,d=l.p2pRecipient,f=l.p2pSender;if(d&&f){var h=this.host.roles.__resolveRoleId(d.id),p=this.host.roles.__resolveRoleId(f.id);(h===t&&p===e||h===e&&p===t)&&(!n||n.$lastModified<c)&&(n=u)}}return n},e.prototype.resolveMembers=function(t){return Ro(this,void 0,void 0,(function(){var e=this;return Po(this,(function(n){switch(n.label){case 0:return[4,Promise.all(t.map((function(t){return Ro(e,void 0,void 0,(function(){return Po(this,(function(e){switch(e.label){case 0:if(!Object(vt.isEmail)(t)&&!Object(Eo.isPhone)(t))return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.host.users.find(t)];case 2:return[2,e.sent().id];case 3:return e.sent(),[2,t];case 4:return[2,t]}}))}))})))];case 1:return[2,n.sent()]}}))}))},e.prototype.selectConversation=function(t,e){var n=void 0===e?{}:e,r=n.anchorPoint,o=void 0===r?Qn.CONVERSATION_END:r,i=n.fetchAllItems,s=void 0!==i&&i,a=n.markAsDelivered,u=void 0===a||a,c=n.markAsRead,l=void 0===c||c,d=n.maxItemsPerBatch,f=n.minItemsToFetch,h=void 0===f?20:f;return Ro(this,void 0,void 0,(function(){var e,n,r,i;return Po(this,(function(a){switch(a.label){case 0:if(t=this._resolveModelId(t),!(e=this._resolveEntity(t,"conversation")))throw new zn.NotFoundError(this.host.models.Conversation.name,t);if(o===Qn.CONTINUATION)throw new Error("Cannot call selectConversation() with anchorPoint='CONTINUATION'");return this.config.condensedReplays?[4,this._selectConversationCR(t,{anchorPoint:o,conversation:e,fetchAllItems:s,markAsDelivered:u,markAsRead:l,maxItemsPerBatch:d,minItemsToFetch:h})]:[3,2];case 1:return[2,a.sent()];case 2:return r=n=0,[4,this.fetchTimeline(t,{anchorPoint:o,markAsDelivered:u,maxItems:h})];case 3:return n=r+a.sent(),e.markableAsReadMessages.length>0?e.firstUnreadMessage=e.markableAsReadMessages[0]:e.firstUnreadMessage=null,i=e.firstUnreadMessage,l&&e.unreadCount>0&&this.markAsRead(t,{localOnly:!0}),[4,this._fetchContinuations(t,{addedMessages:n,conversation:e,fetchAllItems:s,markAsDelivered:u,minItemsToFetch:h})];case 4:return n=a.sent(),l&&this.markAsRead(t),[2,{addedMessages:n,previousFirstUnreadMessage:i}]}}))}))},e.prototype._selectConversationCR=function(t,e){var n=e.anchorPoint,r=e.conversation,o=e.fetchAllItems,i=void 0!==o&&o,s=e.markAsDelivered,a=e.markAsRead,u=e.minItemsToFetch,c=e.maxItemsPerBatch,l=void 0===c?u:c;return Ro(this,void 0,void 0,(function(){var e,o,c,d;return Po(this,(function(f){switch(f.label){case 0:return e=a&&r.unreadCount>0,o=0,e&&this.markAsRead(t,{localOnly:!0}),c=o,[4,this.fetchTimeline(t,{anchorPoint:n,fetchAllItems:i,markAsDelivered:s,maxItems:l})];case 1:return o=c+f.sent(),[4,this._fetchContinuations(t,{addedMessages:o,conversation:r,fetchAllItems:i,markAsDelivered:s,maxItemsPerBatch:l,minItemsToFetch:u})];case 2:return o=f.sent(),d=r.firstUnreadMessage,e&&this.markAsRead(t),this.__ensureEntities(r,{messageCounterParties:"full"}),[2,{addedMessages:o,previousFirstUnreadMessage:d}]}}))}))},e.prototype._fetchContinuations=function(t,e){var n=void 0===e?{}:e,r=n.addedMessages,o=void 0===r?0:r,i=n.conversation,s=n.fetchAllItems,a=void 0!==s&&s,u=n.markAsDelivered,c=void 0===u||u,l=n.minItemsToFetch,d=void 0===l?20:l;n.maxItemsPerBatch;return Ro(this,void 0,void 0,(function(){var e,n;return Po(this,(function(r){switch(r.label){case 0:if(0===o)return[2,0];r.label=1;case 1:return(a||o<d)&&i.higherContinuation.itemsEstimate>0?(e=o,[4,this.fetchTimeline(t,{anchorPoint:Qn.CONTINUATION,markAsDelivered:c,continuation:i.higherContinuation.continuation,fetchAllItems:a})]):[3,3];case 2:return o=e+r.sent(),[3,1];case 3:return(a||o<d)&&i.lowerContinuation.itemsEstimate>0?(n=o,[4,this.fetchTimeline(t,{anchorPoint:Qn.CONTINUATION,markAsDelivered:c,continuation:i.lowerContinuation.continuation,fetchAllItems:a})]):[3,5];case 4:return o=n+r.sent(),[3,3];case 5:return[2,o]}}))}))},e.prototype.getWithUser=function(t,e,n){var r,o=(void 0===n?{}:n).createIfNotFound,i=void 0!==o&&o;if(t=this._resolveModelId(t),e=this._resolveModelId(e),this.config.condensedReplays){var s=this.host.users.getById(t);if(s&&s.profileByOrganizationId&&s.profileByOrganizationId[e]){var a=s.profileByOrganizationId[e].conversationId;a&&(r=this.getById(a))}}else{var u=this.conversationHashForUserMessage(t,e);r=this.getById(u)}return!r&&i&&(r=this.ensureConversation("user",t,e)),r||null},e.prototype.getWithListEntity=function(t,e,n){var r,o=void 0===n?{createIfNotFound:!1}:n,i=o.createIfNotFound,s=void 0!==i&&i,a=o.organizationId,u=o.conversationId,c=void 0===u?null:u;if(e=this._resolveModelId(e),this.config.condensedReplays)c&&(r=this.getById(c));else{var l=this.conversationHashForListEntityId(e);r=this.getById(l)}if(!r&&s){var d=this._resolveEntity(e,t);if(!d)throw new Error("Entity required when using createIfNotFound");a=d.organizationId,r=this.ensureConversation(t,e,a,{conversationId:c}),this.config.condensedReplays&&!c&&(r.$localOnly=!0)}return r},e.prototype.getWithGroup=function(t){return this.getWithListEntity("group",t)},e.prototype.getWithDistributionList=function(t){return this.getWithListEntity("distributionList",t)},e.prototype.get=function(t,e,n){var r=this.getConversationKey(t,e,n);return(this.config.condensedReplays?this._convByConvHandle[r]:this.host.models.Conversation.get(r))||null},e.prototype.getAll=function(){return this.host.models.Conversation.getAll()},e.prototype.getById=function(t){return this.host.models.Conversation.get(t)},e.prototype.getMultiById=function(t){return this.host.models.Conversation.getMulti(t)},e.prototype.getAllForOrganization=function(t){var e=this._resolveEntity(t,"organization");return e?e.conversations:null},e.prototype.__ensureEntities=function(t,e){return void 0===e&&(e={}),Ro(this,void 0,void 0,(function(){var n,r,o;return Po(this,(function(i){switch(i.label){case 0:if(n=[],r=Promise.resolve(),e.counterParty&&(r=this.__ensureCounterParty(t,e),n.push(r)),e.escalationExecution&&n.push(this.__ensureEscalationExecution(t,r,e)),e.messageCounterParties&&n.push(this.__ensureMessageCounterParties(t,e)),e.organization&&n.push(this.__ensureOrganization(t,e)),0===(n=n.filter(Boolean)).length)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Promise.all(n)];case 2:return i.sent(),e.onLoad&&e.onLoad(),this.host.models.Conversation.inject(t),[3,4];case 3:return o=i.sent(),console.error(o),[3,4];case 4:return[2]}}))}))},e.prototype.__ensureOrganization=function(t,e){return void 0===e&&(e={}),Ro(this,void 0,void 0,(function(){var n=this;return Po(this,(function(r){switch(r.label){case 0:return[4,this.host.organizations._findAll()];case 1:return r.sent(),this.host.models.Organization.shouldEnsure(t.organization,"full"!==e.organization)?[4,new Promise((function(r,o){n.host.models.Organization.ensureEntity(t.organizationId,{onlyPlaceholder:"placeholder"===e.organization,onMissing:function(){n.logger.info("org "+t.organizationId+" not found, created placeholder org"),t.$loadingOrganization=!0,r()},onLoad:function(){n.logger.info("org "+t.organizationId+" loaded"),t.$loadingOrganization=!1,e.touchOnRelatedEntityLoad&&n.host.models.Conversation.inject(t)},onFinish:r})}))]:[2,null];case 2:return r.sent(),[2]}}))}))},e.prototype.__ensureCounterParty=function(t,e){return void 0===e&&(e={}),Ro(this,void 0,void 0,(function(){var n,r,o,i=this;return Po(this,(function(s){if(e=Ao({},e),"group"===t.counterPartyType&&t.counterParty&&t.counterParty.groupType===tr.ROLE_P2P&&(e.counterParty="full",e.groupMembers="full"),n=this.host.modelsByEntityType[t.counterPartyType],!n.shouldEnsure(t.counterParty,"full"!==e.counterParty,{groupMembersOnlyPlaceholder:"full"!==e.groupMembers}))return[2,null];switch(r={},t.counterPartyType){case"user":break;case"group":case"distributionList":r.organizationId=t.organizationId;break;default:throw new Error("unsupported counterPartyType",t.counterPartyType)}return o=function(t){if("group"===n.name&&"placeholder"!==e.counterParty&&e.groupMembers)return i.host.groups.ensureMembers(t,{onlyPlaceholder:"placeholder"===e.groupMembers})},[2,new Promise((function(s,a){n.ensureEntity(t.counterPartyId,{attrs:r,onlyPlaceholder:"placeholder"===e.counterParty,onMissing:function(){i.logger.info("entry "+t.counterPartyId+" not found, created placeholder on org "+t.organizationId),t.$loadingCounterParty=!0},onLoad:function(){t.$loadingCounterParty=!1,e.touchOnRelatedEntityLoad&&i.host.models.Conversation.inject(t)},onFinish:function(t){t&&o(t),s()}})}))]}))}))},e.prototype.__ensureEscalationExecution=function(t,e,n){return void 0===n&&(n={}),Ro(this,void 0,void 0,(function(){var n,r,o;return Po(this,(function(i){switch(i.label){case 0:return[4,e];case 1:return i.sent(),n=t.counterPartyType,(r=t.counterParty)&&"group"===n?(o=r.escalationExecution,r.groupType===tr.ESCALATION&&o?[4,this.host.escalations.ensureEscalationExecution(o)]:[2]):[2];case 2:return i.sent(),[2]}}))}))},e.prototype.__ensureMessageCounterParties=function(t,e){var n=this;void 0===e&&(e={});var r=_o.a.call(go.a.call(vo.a.call(t.messages,"senderId").filter(Boolean)),this.host.currentUserId,t.counterPartyId);return Promise.all(r.map((function(r){return n.__ensureMessageCounterParty(t,r,e)})))},e.prototype.__ensureMessageCounterParty=function(t,e,n){var r=this;void 0===n&&(n={});var o=this.host.models.User.get(e);return this.host.models.User.shouldEnsure(o,"full"!==n.messageCounterParties)?new Promise((function(o,i){r.host.models.User.ensureEntity(e,{onlyPlaceholder:"placeholder"===n.messageCounterParties,onMissing:function(){var n=t?"entry "+t.counterPartyId+" not found, created placeholder on org "+t.organizationId:"counterParty "+e+" not found";r.logger.info(n)},onLoad:function(){t&&n.touchOnRelatedEntityLoad&&r.host.models.Conversation.inject(t)},onFinish:o})})):null},e.prototype._setAllowedSenders=function(t){var e=t.counterParty,n=t.counterPartyType,r=t.organization,o=this.host.currentUser,i=[o];if(!r)return t.allowedSenders=[],void(t.allowedSendersReason=Xn.ORGANIZATION_DOES_NOT_EXIST);if(o.contactsMessagingBlocked&&r.isContacts)return t.allowedSenders=[],void(t.allowedSendersReason=Xn.CONTACTS_MESSAGING_BLOCKED_BY_ADMIN);if(!n)return t.allowedSenders=i,void(t.allowedSendersReason=Xn.CONVERSATION_NOT_FULLY_LOADED);if(!e)return t.allowedSenders=[],void(t.allowedSendersReason=Xn.NO_COUNTER_PARTY);switch(n){case"user":return e.$placeholder?(t.allowedSenders=[],void(t.allowedSendersReason=Xn.COUNTER_PARTY_NOT_FULLY_LOADED)):"TigerPage"===e.displayName?(t.allowedSenders=[],void(t.allowedSendersReason=Xn.COUNTER_PARTY_IS_TIGERPAGE)):(t.allowedSenders=i,void(t.allowedSendersReason=Xn.NONE));case"distributionList":return t.allowedSenders=i,void(t.allowedSendersReason=Xn.NONE);case"group":var s=e.createdByRole,a=e.createdByUser,u=e.groupType,c=e.p2pRecipient,l=e.p2pSender,d=e.targetRole,f=e.targetUser,h=e.members,p=e.proxiedMembers,v=r.allowedSenders;if(u===tr.FORUM)return t.allowedSenders=i,void(t.allowedSendersReason=Xn.NONE);if(u===tr.ROLE_ASSIGNMENT)return t.allowedSenders=[],void(t.allowedSendersReason=Xn.IS_ROLE_ASSIGNMENT_GROUP);if(u===tr.ROLE_P2P&&c&&l){var y=[],g=s&&s.botUser,m=d&&d.botUser;!g||h&&h.includes(g)?!a||h&&h.includes(a)||y.push(a):y.push(g),!m||h&&h.includes(m)?!f||h&&h.includes(f)||y.push(f):y.push(m),y.length>0&&(h=xo(h||[],y))}else if(e.$placeholder)return t.allowedSenders=[],void(t.allowedSendersReason=Xn.COUNTER_PARTY_NOT_FULLY_LOADED);if(!h)return t.allowedSenders=[],void(t.allowedSendersReason=Xn.GROUP_MEMBERS_NOT_LOADED);if(0===h.length)return t.allowedSenders=[],void(t.allowedSendersReason=Xn.GROUP_HAS_NO_MEMBERS);for(var _=[],b=0,w=v;b<w.length;b++){var I=w[b],O="role"===I.$entityType?I.botUser:I;if(h.includes(O)){var E=O.id,T=p&&p[E];if(T){for(var S=!1,A=0,C=T;A<C.length;A++){C[A].token===E&&(S=!0)}if(!S)continue}_.push(I)}}return 0===_.length?(t.allowedSenders=_,void(t.allowedSendersReason=Xn.USER_IS_NOT_MEMBER_OF_GROUP)):u!==tr.ROLE_P2P?(t.allowedSenders=_,void(t.allowedSendersReason=Xn.NONE)):l&&_.includes(l)?c===o||o.roles.includes(c)?(t.allowedSenders=[],void(t.allowedSendersReason=Xn.CONVERSATION_WITH_ROLE_YOU_ARE_CURRENTLY_IN)):(t.allowedSenders=[l],void(t.allowedSendersReason=Xn.NONE)):(t.allowedSenders=[],void(t.allowedSendersReason=Xn.USER_IS_NOT_IN_THIS_ROLE_CONVERSATION));default:return t.allowedSenders=[],void(t.allowedSendersReason=Xn.COUNTER_PARTY_TYPE_NOT_SUPPORTED)}},e.prototype.reactToProcessingStart=function(t){var e=t.data,n=(e=Object(to.l)(e)).action_type,r=e.conversation_id,o=e.entity,i=e.organization_id,s=o.token||o.id,a=hr.resolve(n);if(this.host.products._addProcessingEvent({actionType:a,entity:Ao({id:s},o)}),a===hr.ROLE_OPT_OUT)this._roleConversationsProcessingEvent[s]=this.host.roles._roleConversations[s];else if(a===hr.ORGANIZATION_MESSAGE_STATUS||a===hr.ORGANIZATION_REPLAY){var u=this.host.organizations.getById(i);if(!u)return;u._markingAsReadConversations&&this.__clearOptimisticStatus(u._markingAsReadConversations)}else if(a===hr.GROUP_REPLAY){var c=void 0;if(r&&(c=this.getById(r)),!c)return;this.__clearOptimisticStatus([c])}else if(a===hr.ROLE_OPT_IN||a===hr.ROLE_OPT_OUT){var l=this.host.roles._roleConversations[s];if(!l)return;this.__clearOptimisticStatus(l)}},e.prototype.reactToProcessingStop=function(t){var e=t.data,n=(e=Object(to.l)(e)).action_type,r=e.conversation_id,o=e.entity,i=e.organization_id;!r&&o.conversation_id&&(r=o.conversation_id,delete o.conversation_id),!i&&o.organization_key&&(i=o.organization_key,delete o.organization_key);var s=o.token||o.id,a=hr.resolve(n);if(a===hr.GROUP_REPLAY){var u=void 0;if(r&&(u=this.getById(r)),!u)return;this.clearTimeline(u),this.__clearOptimisticStatus([u])}else if(a===hr.ROLE_OPT_IN||a===hr.ROLE_OPT_OUT){this.clearTimelineForAllRoleConversations(a,s);var c=this.host.roles._roleConversations[s];if(!c)return void this.host.products._removeProcessingEvent({actionType:a,entity:Ao({id:s},o)});this.__clearOptimisticStatus(c)}else if(a===hr.ORGANIZATION_MESSAGE_STATUS)this.clearMessageStatusesForOrganization(i);else if(a===hr.CONVERSATION_MESSAGE_STATUS){u=void 0;if(r&&(u=this.getById(r)),!u)return;this.clearMessageStatuses(u)}if(a===hr.ORGANIZATION_MESSAGE_STATUS||a===hr.ORGANIZATION_REPLAY){var l=this.host.organizations.getById(i);if(!l)return;l._markingAsReadConversations&&this.__clearOptimisticStatus(l._markingAsReadConversations)}this.host.products._removeProcessingEvent({actionType:a,entity:Ao({id:s},o)})},e.prototype.__clearOptimisticStatus=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];r._markingAsRead&&(r._markingAsRead=!1,r._markingAsReadSortNumber=null,r._markingAsReadExpiration=null,this.host.models.Conversation.inject(r))}},e.prototype.clearTimelineForAllRoleConversations=function(t,e){var n;if(n=t===hr.ROLE_OPT_OUT?this._roleConversationsProcessingEvent[e]:this.host.roles._roleConversations[e])for(var r=0,o=n;r<o.length;r++){var i=o[r];this.clearTimeline(i)}},e.prototype.clearMessageStatusesForOrganization=function(t){var e=this.host.organizations.getById(t);if(e){var n=e.conversations;if(n)for(var r=0,o=n;r<o.length;r++){var i=o[r];this.clearMessageStatuses(i)}}},e.prototype.clearMessageStatuses=function(t,e){for(var n=this,r=(void 0===e?{}:e).emit,o=void 0===r||r,i=t.timeline,s=0,a=i;s<a.length;s++){var u=a[s];u.shouldEnsureRecipientStatus=!0,this.host.models.Message.inject(u)}return setTimeout((function(){for(var t=0,e=i;t<e.length;t++){var r=e[t];if(!n.host.messages._pendingFindRecipientStatuses)return;var o=n.host.messages._pendingFindRecipientStatuses[r.id];o&&o()}}),0),o&&this.emit("clearMessageStatuses",i),i.length},e.prototype.mute=function(t,e){return Ro(this,void 0,void 0,(function(){return Po(this,(function(n){switch(n.label){case 0:return[4,this.host.mute.muteConversation(t,e)];case 1:return n.sent(),[2]}}))}))},e.prototype.unmute=function(t){return Ro(this,void 0,void 0,(function(){return Po(this,(function(e){switch(e.label){case 0:return[4,this.host.mute.unmuteConversation(t)];case 1:return e.sent(),[2]}}))}))},e.prototype.unmuteAll=function(){return Ro(this,void 0,void 0,(function(){return Po(this,(function(t){switch(t.label){case 0:return[4,this.host.mute.unmuteAll()];case 1:return t.sent(),[2]}}))}))},Co([Object(Or.decorator)()],e.prototype,"findAll",null),Co([Object(Or.decorator)()],e.prototype,"add",null),Co([Object(Or.decorator)()],e.prototype,"remove",null),e}(no),Ho=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wo=function(){return(Wo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yo=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ko=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},$o=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Xo=["display_name"].join(","),Qo=["name"].join(","),Zo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ho(e,t),e.prototype.mounted=function(){this._fetched=!1},e.prototype.dispose=function(){this._fetched=!1},e.prototype.addMembers=function(t){var e=t.id,n=t.members,r=t.organizationId;return Ko(this,void 0,void 0,(function(){return $o(this,(function(t){switch(t.label){case 0:if(!e)throw new zn.ValidationError("id","required");if(!Array.isArray(n))throw new zn.ValidationError("members","required","members must be an array");if(!r)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.distributionLists.membersBatch({id:e,members:n,operation:"add",organizationId:r})];case 1:return t.sent(),[2]}}))}))},e.prototype.batchDelete=function(t){var e=t.ids,n=t.organizationId;return Ko(this,void 0,void 0,(function(){var t=this;return $o(this,(function(r){switch(r.label){case 0:if(!Array.isArray(e))throw new zn.ValidationError("ids","required","ids must be an array");if(!n)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.distributionLists.batch({ids:e,operation:"destroy",organizationId:n})];case 1:return r.sent(),[2,e.map((function(e){return t.host.models.DistributionList.inject({$deleted:!0,id:e})}))]}}))}))},e.prototype.create=function(t){var e=t.adminOnly,n=t.members,r=t.name,o=t.network,i=void 0===o?"patient":o,s=t.organizationId;return Ko(this,void 0,void 0,(function(){var t;return $o(this,(function(o){switch(o.label){case 0:if(this._validate({adminOnly:e,members:n,name:r,organizationId:s,shouldCheckId:!1}),!1===["patient"].includes(i))throw new zn.ValidationError("network","invalid",'network must be "patient"');return[4,this.host.api.distributionLists.create({adminOnly:e,members:n,name:r,network:i,organizationId:s})];case 1:return t=o.sent(),[2,this.host.models.DistributionList.inject(Wo({conversationId:t.conversation_id,organizationId:t.organization_id},t.entity))]}}))}))},e.prototype.delete=function(t,e){return Ko(this,void 0,void 0,(function(){return $o(this,(function(n){switch(n.label){case 0:return this._validate({id:t,organizationId:e,shouldCheckInvalid:!1}),[4,this.host.api.distributionLists.delete(t,e)];case 1:return n.sent(),[2,this.host.models.DistributionList.inject({$deleted:!0,id:t})]}}))}))},e.prototype.find=function(t,e){return void 0===e&&(e={}),Ko(this,void 0,void 0,(function(){var n,r;return $o(this,(function(o){switch(o.label){case 0:return e=h.a.defaults(e,{ignoreNotFound:!1,bypassCache:!1,includeMembers:!1,includeMetadata:!1}),this.host.requireUser(),n=null,!e.bypassCache&&(n=this.host.models.DistributionList.get(t))?[2,n]:[4,this.host.api.distributionLists.find(t,{organizationId:e.organizationId})];case 1:if(r=o.sent())delete(n=this.config.condensedReplays||r.entity?this.host.models.DistributionList.inject(Wo({conversationId:r.conversation_id,organizationId:r.organization_id},r.entity)):this.host.models.DistributionList.inject(r)).$placeholder;else if(!e.ignoreNotFound)throw new zn.NotFoundError(this.host.models.DistributionList.name,t);return[2,n]}}))}))},e.prototype.findAll=function(){return Ko(this,void 0,void 0,(function(){var t,e,n;return $o(this,(function(r){switch(r.label){case 0:return this._fetched?[2,this.getAll()]:0!==(t=this.host.models.Organization.getAll()).length?[3,2]:[4,this.host.organizations.findAll()];case 1:t=r.sent(),r.label=2;case 2:return[4,this.host.search.query({types:["distributionList"],organizationIds:t.map((function(t){return t.id})),query:{displayName:""},followContinuations:!0})];case 3:return e=r.sent().results,n=e.map((function(t){return t.entity})),this._fetched=!0,[2,n]}}))}))},e.prototype.getAll=function(){return this.host.models.DistributionList.getAll()},e.prototype.getById=function(t){return this.host.models.DistributionList.get(t)},e.prototype.getMultiById=function(t){return this.host.models.DistributionList.getMulti(t)},e.prototype.removeMembers=function(t){var e=t.id,n=t.members,r=t.organizationId;return Ko(this,void 0,void 0,(function(){return $o(this,(function(t){switch(t.label){case 0:if(!e)throw new zn.ValidationError("id","required");if(!Array.isArray(n))throw new zn.ValidationError("members","required","members must be an array");if(!r)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.distributionLists.membersBatch({id:e,members:n,operation:"remove",organizationId:r})];case 1:return t.sent(),[2]}}))}))},e.prototype.search=function(t){var e=t.continuation,n=t.network,r=void 0===n?"patient":n,o=t.organizationId,i=t.query,s=void 0===i?"":i,a=t.sortBy,u=void 0===a?"name":a,c=t.sortOrder,l=void 0===c?"asc":c,d=t.types,f=void 0===d?[pr.PATIENT_DISTRIBUTION_LIST]:d;return Ko(this,void 0,void 0,(function(){var t,n,i,a;return $o(this,(function(c){switch(c.label){case 0:return[4,this.host.search.query({continuation:e,network:r,organizationId:o,query:(i={},i[Qo]=s,i),returnFields:[],sort:(a={},a[u]=l,a),types:f})];case 1:return t=c.sent(),n=this._processSearchResults(t.results),[2,{metadata:t.metadata,results:n}]}}))}))},e.prototype.findMembers=function(t,e){var n=void 0===e?{}:e,r=n.continuation,o=n.network,i=void 0===o?"patient":o,s=n.organizationId,a=n.query,u=void 0===a?"":a,c=n.sortBy,l=void 0===c?["display_name"]:c,d=n.sortOrder,f=void 0===d?["asc"]:d;return Ko(this,void 0,void 0,(function(){var e,n,o,a,c;return $o(this,(function(d){switch(d.label){case 0:if(!t)throw new zn.ValidationError("id","required");if(!s)throw new zn.ValidationError("organizationId","required");if(l.length!==f.length)throw new zn.ValidationError("sortBy","invalid","sortBy and sortOrder must be the same length");for(e={},n=0;n<l.length;n++)e[l[n]]=f[n];return[4,this.host.search.query({continuation:r,network:i,organizationId:s,query:(c={},c[Xo]=u,c.dist_list_token=t,c),returnFields:[],sort:e,types:[pr.DISTRIBUTION_LIST_MEMBER]})];case 1:return o=d.sent(),a=this._processSearchResults(o.results),[2,{metadata:o.metadata,results:a}]}}))}))},e.prototype.findMemberIds=function(t,e,n){var r=(void 0===n?{}:n).continuation;return Ko(this,void 0,void 0,(function(){var n,o,i,s,a;return $o(this,(function(u){switch(u.label){case 0:if(!t)throw new zn.ValidationError("id","required");if(!e)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.distributionLists.findMemberIds(t,e,{continuation:r})];case 1:return n=u.sent(),o=n.members,i=void 0===o?[]:o,s=n.metadata,a=i.map((function(t){return t.token})),[2,{metadata:s,results:a}]}}))}))},e.prototype.update=function(t){var e=t.adminOnly,n=t.id,r=t.name,o=t.organizationId;return Ko(this,void 0,void 0,(function(){var t;return $o(this,(function(i){switch(i.label){case 0:return this._validate({adminOnly:e,name:r,id:n,organizationId:o}),[4,this.host.api.distributionLists.update({adminOnly:e,id:n,name:r,organizationId:o})];case 1:return t=i.sent(),[2,this.host.models.DistributionList.inject(Wo({conversationId:t.conversation_id,organizationId:t.organization_id},t.entity))]}}))}))},e.prototype._processSearchResults=function(t){return t.map((function(t){return t.entity})).filter((function(t){return!t.$deleted}))},e.prototype._validate=function(t){var e=t.adminOnly,n=t.id,r=(t.members,t.name),o=t.organizationId,i=t.shouldCheckId,s=void 0===i||i,a=t.shouldCheckInvalid,u=void 0===a||a;if(s&&!n)throw new zn.ValidationError("id","required");if(!o)throw new zn.ValidationError("organizationId","required");if(u){if(void 0!==e&&"boolean"!=typeof e)throw new zn.ValidationError("adminOnly","invalid","adminOnly must be a boolean value");if(r&&(0===r.length||r.length>60))throw new zn.ValidationError("name","invalid","name must be less than 60 alphanumeric characters")}},Yo([Object(Or.decorator)()],e.prototype,"find",null),Yo([Object(Or.decorator)()],e.prototype,"findAll",null),Yo([Object(Or.decorator)()],e.prototype,"search",null),e}(no),Jo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ti=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ei=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ni=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jo(e,t),e.prototype.findMulti=function(t,e){return ei(this,void 0,void 0,(function(){var n,r,o,i,s,a,u,c,l,d,f,p,v,y,g,m,_,b,w,I,O,E,T,S,A,C=this;return ni(this,(function(R){switch(R.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");return t=h.a.uniq(Object(to.d)(t).map(this._resolveModelId)),n=h.a.chunk(t,10),r=n.map((function(t){return C.host.api.entities.findMulti({users:t,metadata:t,organizationId:e})})),[4,Promise.all(r)];case 1:for(o=R.sent(),i={},s=0,a=o;s<a.length;s++){if(u=a[s],c=u.users,l=u.metadata,c)for(d=0,f=c;d<f.length;d++)for(p=f[d],v=0,y=Object.entries(p);v<y.length;v++)g=y[v],T=g[0],m=g[1],i[T]={entity:m};if(l)for(_=0,b=l;_<b.length;_++)for(w=b[_],I=0,O=Object.entries(w);I<O.length;I++)E=O[I],T=E[0],S=E[1],(A=i[T])&&(A.metadata=S)}return[2,Object.values(i)]}}))}))},ti([Object(Or.decorator)()],e.prototype,"findMulti",null),e}(no),oi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ii=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},si=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ai=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oi(e,t),e.prototype.escalateMessage=function(t){return si(this,void 0,void 0,(function(){var e,n,r;return ai(this,(function(o){switch(o.label){case 0:if(!(e=this._resolveEntity(t,"message")))throw new zn.NotFoundError(this.host.models.Message.name,t);return[4,this.host.api.escalations.escalateMessage(e.serverId)];case 1:return n=o.sent(),r=(n||{}).escalation,[2,this._updateEscalation(r)]}}))}))},e.prototype.acknowledge=function(t){return si(this,void 0,void 0,(function(){var e,n,r,o,i,s,a;return ai(this,(function(u){switch(u.label){case 0:if(!(e=this._resolveEntity(t,"escalationExecution")))throw new zn.NotFoundError(this.host.models.EscalationExecution.name,t);return t=e.id,n=e.originalMessageId,r=this.host,o=r.currentUser,i=r.currentUserId,(s=o.roles.map((function(t){return t.botUserId}))).push(i),[4,this.host.api.escalations.acknowledge(t,{messageId:n,userTokens:s})];case 1:return a=u.sent(),[2,this.host.models.EscalationExecution.inject(a)]}}))}))},e.prototype.cancel=function(t){return si(this,void 0,void 0,(function(){var e,n;return ai(this,(function(r){switch(r.label){case 0:if(!(e=this._resolveEntity(t,"escalationExecution")))throw new zn.NotFoundError(this.host.models.EscalationExecution.name,t);return n=e.originalMessageId,[4,this.host.api.escalations.cancel(n)];case 1:return r.sent(),[2]}}))}))},e.prototype.ensureEscalationExecution=function(t){return si(this,void 0,void 0,(function(){var e,n,r,o;return ai(this,(function(i){switch(i.label){case 0:if(!(e=this._resolveEntity(t,"escalationExecution")))throw new zn.NotFoundError(this.host.models.EscalationExecution.name,t);return n=e.carbonCopyMessageId,r=e.originalMessageId,o=[],n&&o.push(n),r&&o.push(r),[4,this.host.messages.ensureRecipientStatusMulti(o)];case 1:return i.sent(),[2]}}))}))},e.prototype.skip=function(t){return si(this,void 0,void 0,(function(){var e,n,r,o,i,s,a;return ai(this,(function(u){switch(u.label){case 0:if(!(e=this._resolveEntity(t,"escalationExecution")))throw new zn.NotFoundError(this.host.models.EscalationExecution.name,t);return t=e.id,n=e.originalMessageId,r=this.host,o=r.currentUser,i=r.currentUserId,(s=o.roles.map((function(t){return t.botUserId}))).push(i),[4,this.host.api.escalations.skip(t,{messageId:n,userTokens:s})];case 1:return a=u.sent(),[2,this.host.models.EscalationExecution.inject(a)]}}))}))},e.prototype.removeEscalationGroup=function(t){return si(this,void 0,void 0,(function(){var e,n;return ai(this,(function(r){switch(r.label){case 0:if(!(e=this._resolveEntity(t,"escalationExecution")))throw new zn.NotFoundError(this.host.models.EscalationExecution.name,t);return n=e.groupId,[4,this.host.api.groups.destroy(n)];case 1:if(!r.sent())throw new zn.NotFoundError(this.host.models.Group.name,n);return[2]}}))}))},e.prototype.reactToEscalationsEvent=function(t){var e=t.data;this._updateEscalation(e.escalation)},e.prototype._updateEscalation=function(t,e){var n=(void 0===e?{}:e).inGroupInject,r=void 0!==n&&n,o={};t&&t.display_name&&(o=this.host.models.EscalationExecution.inject(t));var i=o.id,s=o.carbonCopyMessage,a=o.groupId,u=o.organizationId,c=o.originalMessage;return c&&this.host.models.Message.inject({escalationExecutionId:i,id:c.id}),s&&this.host.models.Message.inject({escalationExecutionId:i,id:s.id}),a&&!r&&this.host.models.Group.inject({id:a,escalationExecutionId:i,organizationId:u}),o},e.prototype.getAll=function(){return this.host.models.EscalationExecution.getAll()},e.prototype.getById=function(t){return this.host.models.EscalationExecution.get(t)},ii([Object(Or.decorator)()],e.prototype,"escalateMessage",null),ii([Object(Or.decorator)()],e.prototype,"acknowledge",null),ii([Object(Or.decorator)()],e.prototype,"cancel",null),ii([Object(Or.decorator)()],e.prototype,"skip",null),ii([Object(Or.decorator)()],e.prototype,"removeEscalationGroup",null),e}(no),ci=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),li=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},di=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},fi=function(t){function e(e,n){var r=t.call(this,e,n)||this;r.EVENTS={bang:function(t){this.host.groups.reactToBangEvent(t)},client_advisory:function(t){switch(t.data.advisory.name){case"replay_start":this.host.reactToAdvisoryEvent("replayStart",{replayMessageCount:t.data.advisory.replay_message_count});break;case"replay_stop":this.host.reactToAdvisoryEvent("replayStop")}},escalations:function(t){this.host.escalations.reactToEscalationsEvent(t)},friends:function(t){this.host.conversations.reactToFriendsEvent(t)},"message|group_message":function(t){this.host.conversations.reactToMessageEvent(t)},"message:status|group:message:status":function(t){this.host.messages.reactToMessageStatusEvent(t)},user_preferences:function(t){this.host.users.reactToUserPreferencesEvent(t)},org_preferences:function(t){this.host.organizations.reactToOrganizationPreferencesEvent(t)},presence:function(t){this.host.presence.reactToPresenceEvent(t)},update:function(t){this.host.conversations.reactToUpdateEvent(t)},"update:tag":function(t){this.host.roleTags.reactToUpdateEvent(t)},"update:team_request":function(t){this.host.conversations.reactToUpdateTeamRequestEvent(t)},"account:settings":function(t){var e=this;t.data.services.forEach((function(n){switch(n.xmlns){case"tigertext:iq:update:account":var r=n.account||t.data.token;e.host.users.refresh(r);break;case"tigertext:iq:update:org_settings":e.host.organizations.refreshAll();break;default:e.logger.warn("unhandled account:settings service type "+n.xmlns)}}))},"message:is_typing":function(t){this.host.typingStatus.reactToIsTypingEvent(t)},"processing:start":function(t){this.host.conversations.reactToProcessingStart(t)},"processing:stop":function(t){this.host.conversations.reactToProcessingStop(t)},remote_wipe:function(t){return li(this,void 0,void 0,(function(){return di(this,(function(t){switch(t.label){case 0:return this.host.notifications.disconnect({source:"remote_wipe event"}),[4,this.host.notifications.signOut({fromServer:!0})];case 1:return t.sent(),this.host.signOut({fromServer:!0}),[2]}}))}))},validated:function(t){this.logger.warn("validated not implemented")},"msg:metadata_update":function(t){this.logger.warn("msg:metadata_update not implemented")},conversation_mute:function(t){this.host.mute.reactToMuteEvent(t)},reconnect:function(t){this.host.events.reconnect()},"vwr:joinablecall":function(t){this.host.virtualWaitingRooms.reactToJoinableCallSSE(t)},"voip:incoming|voip:ended|voip:answered|voip:state":function(t){this.host.calls.reactToVoipSSE(t)},"push:credentials":function(){return null},"sse:heartbeat":function(){return null},"sse:keepalive":function(){return null}};for(var o=0,i=Object.entries(r.EVENTS);o<i.length;o++){var s=i[o],a=s[0],u=s[1];if(a.includes("|")){for(var c=0,l=a.split("|");c<l.length;c++){var d=l[c];r.EVENTS[d]=u}delete r.EVENTS[a]}}return r}return ci(e,t),e.prototype.emit=function(t){this.EVENTS[t.type]?this.EVENTS[t.type].call(this,t):this.logger.info("unhandled event: "+t.type,t.data)},e}(no),hi=n(62),pi=n.n(hi),vi=function(){function t(t,e,n){this.id=t,this.type=e,this.data=n}return t.is=function(t){return t instanceof this},t}(),yi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gi=function(){return(gi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},mi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},_i=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},bi=["message:is_typing","presence","remote_wipe","sse:heartbeat"],wi=["message:is_typing","presence","sse:heartbeat"],Ii=["00000000-0000-0000-0000-000000000001"],Oi=["remote_wipe"],Ei={autoDeliver:"auto-deliver",canConfirm:"can-confirm",closeAfterMessages:"close-after-messages",heartbeat:"heartbeat_5",hidden:"hidden",includeDistributionListEvents:"dl_sender_event",isTyping:"is-typing",keepAlive:"keep_alive_15_1",msgDeliveryDelay:"msg_delivery_delay",multiOrg:"multi-org",noOfflineMessages:"no-offline-messages",renderMetadata:"render_metadata",singleConversation:"single_conversation"},Ti={events:{allowManualRequestBatch:!0,basicAuthParam:"auth_basic",features:null,requiresBasicAuth:!1,routerName:"eventRouter",url:"/events"},simpleNotifications:{allowManualRequestBatch:!1,basicAuthParam:"auth",features:{heartbeat:!0},requiresBasicAuth:!0,routerName:"notificationRouter",url:"/events/simple_notifications"}},Si=function(t){function e(e,n){var r=t.call(this,e,n)||this;r.onNetworkStatusChanged=function(t){var e=t.networkStatus,n=t.previousStatus;if(r.__allEvents.push({networkStatusChange:{previousStatus:n,networkStatus:e,timestamp:new Date}}),e===mr.CONNECTING){if(r._reconnectIfHeartbeatIntervalPassed()&&r.eventSource)return;r._connectionRetryCount=1,r._disconnectAndRetry()}else e===mr.OFFLINE&&(r._connectionRetryCount=0,r.disconnect({unwatchNetwork:!1,source:"Network went offline"}))},r._closeAllConnections=function(){return mi(r,void 0,void 0,(function(){var t,e,n;return _i(this,(function(r){switch(r.label){case 0:if(this.eventSource)throw new Error("Existing connections must be closed first");if("simpleNotifications"!==this.endpointType)return[3,2];if(t=this._auth,e=t.key,n=t.secret,!e||!n)throw new zn.RequiresBasicAuthError;return[4,this.host.api.notifications.closeAllConnections(e,n)];case 1:return r.sent(),[3,4];case 2:return[4,this.host.api.events.closeAllConnections()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},r._processImmediateEvent=function(t,e){return mi(r,void 0,void 0,(function(){return _i(this,(function(n){switch(n.label){case 0:return this._eventQueue=[e],this._eventQueueDeferred=!1,this._autoAck?[4,this.ack([t])]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.processEventQueue(),[2]}}))}))},r._scheduleEventQueue=function(t){var e=(void 0===t?{}:t).immediate,n=void 0!==e&&e;if(r.allowManualRequestBatch&&r.config.manuallyRequestEventQueueBatch&&(r._eventQueueIsManual=!0),n&&(clearTimeout(r._eventQueueTimeout),r._eventQueueTimeout=null),null===r._eventQueueTimeout){var o=r.config.eventCollectionInterval;if(n||null===o)r._eventQueueIsManual?r._emitBatch({immediate:n}):r.processEventQueue(r._eventQueue.length);else{var i=r._eventQueueIsManual?r._emitBatch:r.processEventQueue;r._eventQueueTimeout=setTimeout(i,o)}}},r._emitBatch=function(t){var e=(void 0===t?{}:t).immediate,n=void 0!==e&&e;r._eventQueueTimeout=null,r.emit("batch:available",{maxEventBatch:r._eventQueue.length,immediate:n})},r.deferEventQueue=function(){r._eventQueueDeferred=!0,r._eventQueueTimeout&&(clearTimeout(r._eventQueueTimeout),r._eventQueueTimeout=null)},r.resumeEventQueue=function(){r._eventQueueDeferred=!1,r._eventQueueTimeout&&(clearTimeout(r._eventQueueTimeout),r._eventQueueTimeout=null),r._eventQueue.length>0&&r._scheduleEventQueue()},r.processEventQueue=function(t){var e,n,o;if(void 0===t&&(t=r.config.maxEventBatch),r._eventQueueIsManual||(r._eventQueueTimeout=null),!r._eventQueueDeferred&&0!==r._eventQueue.length)try{for(var i=r._eventQueue.splice(0,t),s=0,a=i;s<a.length;s++)e=a[s],n=!1,o=JSON.parse(e),n=!0,r._handleEvent(o);r._eventQueue.length>0?r._scheduleEventQueue():r._reconnectWhenQueuesAreEmpty&&0===r._queuedAcks.length&&0===r._pendingAckConnections&&r._scheduleConnectRetry()}catch(t){n?(r.logger.error("error while processing SSE payload",t,t.stack,{data:o}),r.disconnect({isRecoverable:!1,source:"Error processing SSE payload"})):(r.logger.error("error parsing SSE payload: <"+e+">"),r._disconnectAndRetry())}},r._flushQueuedAcks=function(){return mi(r,void 0,void 0,(function(){var t,e;return _i(this,(function(n){switch(n.label){case 0:return 0===this._queuedAcks.length?[2]:this._pendingAckConnections>=this.config.flushAckMaxConnections?(this._throttled_flushQueuedAcks(),[2]):(t=this._queuedAcks.splice(0,this.config.flushAckMaxEvents),e=this.ack(t),this._queuedAcks.length>0?(this._throttled_flushQueuedAcks(),[3,5]):[3,1]);case 1:return n.trys.push([1,3,,4]),[4,e];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:this._reconnectWhenQueuesAreEmpty&&0===this._eventQueue.length&&0===this._pendingAckConnections&&this._scheduleConnectRetry(),n.label=5;case 5:return[2]}}))}))},r._onVisibilityChange=function(t,e){e=e.toUpperCase();var n=r._visibilityState;r._visibilityState=e,r.isConnected&&(r.__allEvents.push({visibilityChange:{previousState:n,state:e,timestamp:new Date}}),e===yr.HIDDEN?(r.host.configure({eventCollectionInterval:null}),r._setHeartbeatTimeout(r.config.eventsHeartbeatIntervalInvisible)):e===yr.VISIBLE&&(r.host.configure({eventCollectionInterval:Un.eventCollectionInterval}),r._setHeartbeatTimeout(r.config.eventsHeartbeatIntervalVisible))),n===yr.HIDDEN&&e===yr.VISIBLE&&r.httpClient.networkStatus===mr.CONNECTING&&r._reconnectIfHeartbeatIntervalPassed(),r.emit("visibilityChange",t,e)},r._reconnectIfHeartbeatIntervalPassed=function(){return null!==r._lastHeartbeatTime&&(Date.now()-r._lastHeartbeatTime>=r._heartbeatInterval&&(r._lastHeartbeatTime=null,r.reconnect(),!0))},r.endpointType||(r.endpointType="events");for(var o=0,i=Object.entries(Ti[r.endpointType]);o<i.length;o++){var s=i[o],a=s[0],u=s[1];"url"!==a&&(r[a]=u)}return r}return yi(e,t),e.prototype.mounted=function(){this._throttled_flushQueuedAcks=pi()(this._flushQueuedAcks,this.config.flushAckInterval,{leading:!1}),this.__allEvents=[],this._connectionRetryCount=0,this._eventQueue=[],this._eventQueueDeferred=!1,this._eventQueueIsManual=!1,this._eventQueueTimeout=null,this._heartbeatInterval=this.config.eventsHeartbeatIntervalVisible,this._heartbeatTimeout=null,this._lastHeartbeatTime=null,this._openTimeout=null,this._pendingAckConnections=0,this._processedEventIds={},this._queuedAcks=[],this._reconnectWhenQueuesAreEmpty=!1,this._reconnectWhenQueuesAreEmpty=!1,this._retryHistoryTimeout=null,this._visibilityState=yr.VISIBLE,this.isConnected=!1,this.isOpen=!1;var t=n(201);this.visibilityListenerId=t.change(this._onVisibilityChange)},e.prototype.dispose=function(){(this._throttled_flushQueuedAcks.cancel&&this._throttled_flushQueuedAcks.cancel(),this.disconnect({source:"EventsService cleanup"}),null!==this.visibilityListenerId)&&(n(201).unbind(this.visibilityListenerId),this.visibilityListenerId=null)},Object.defineProperty(e.prototype,"_autoAck",{get:function(){return"events"===this.endpointType&&this.config.autoAckSuccessfullyHandledEvents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasConnection",{get:function(){return!!this.eventSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSignedIn",{get:function(){return!!this._auth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"router",{get:function(){return this.host[this.routerName]},enumerable:!1,configurable:!0}),e.prototype.setAuth=function(t){this._auth=gi({basicAuthParam:this.basicAuthParam},t)},e.prototype.removeAuth=function(){this._auth=null},e.prototype.getAuth=function(){return this._auth},e.prototype.connect=function(){var t=this;if(!this.isSignedIn)throw this._cancelSessionTimers({source:"Connection attempt while not signed in"}),new zn.NotSignedInError;if(this.requiresBasicAuth&&(!this._auth.key||!this._auth.secret))throw this._cancelSessionTimers({source:"Connection attempt without valid authorization"}),new zn.RequiresBasicAuthError;if(this.eventSource)throw new Error("Already connected to EventSource");for(var e=[],n=0,r=Object.entries(this.features||this.config.events);n<r.length;n++){var o=r[n],i=o[0],s=o[1];if(s||0===s){var a=Ei[i],u=!0===s?a:a+":"+s;e.push(u)}}var c=e.join(",");this.logger.info("connecting "+this.endpointType+". networkStatus="+this.httpClient.networkStatus+" features="+c);var l,d=!this._watchingNetworkConnection;if(this.httpClient.networkStatus!==mr.OFFLINE&&d&&this.httpClient._setNetworkStatus(mr.CONNECTING),this._watchNetworkConnection(),this.httpClient.networkStatus===mr.OFFLINE)throw new Error("Cannot connect while network is offline, but will autoconnect when online");this._isClosed=!1,this._isHeartbeatTimeout=!1,this._reconnectWhenQueuesAreEmpty=!1,this._requestedClose=!1;var f=!1,h=!1;this._openTimeout=setTimeout((function(){t._openTimeout=null,h=!0,l.close()}),this.config.eventsOpenTimeout),this.eventSource=l=this.host.eventSourceClient.createEventSource(this.url,{auth:this._auth,features:c,onOpen:function(){t.logger.info("open"),t._cancelSessionTimers({source:"Event source opened"}),t._setHeartbeatTimeout(),f=!0,t.isOpen=!0,t.emit("opened")},onMessage:function(e,n){var r=n.isFirstMessage;t._setHeartbeatTimeout(),r&&(t._setRetryHistoryTimeout(),t.isConnected=!0,t.emit("connected")),t._queueEvent(e)},onError:function(e){var n=!!e&&t.httpClient.isUnauthorizedError(e),r=t._isHeartbeatTimeout,o=t.httpClient.networkStatus,i=t._requestedClose;r?e=new Error("No activity within "+t._heartbeatInterval+" milliseconds; reconnecting"):h&&(e=new Error("Open timed out after "+t.config.eventsOpenTimeout+" milliseconds; reconnecting")),t.logger.info("error",e,e.message||"",e.code||"",void 0!==e.status?e.status:""),t.__allEvents.push({clientDisconnect:{error:{code:e.code,message:e.message,status:e.status},hasConnected:f,isHeartbeatTimeout:r,isUnauthorized:n,networkStatus:o,openTimedOut:h,requestedClose:i,timestamp:new Date}}),i||(n?t.disconnect({isRecoverable:!1,source:"Unauthorized during eventSource error handling"}):o!==mr.OFFLINE&&(f||0!==t._connectionRetryCount||(t._connectionRetryCount=1),t._disconnectAndRetry()))}}),this.eventSource.start()},e.prototype._scheduleConnectRetry=function(){var t=this;this._cancelSessionTimers({source:"Scheduling connection retry"}),this.logger.info("scheduleConnectRetry",this._connectionRetryCount);var e=Math.min(this.config.eventsAutoReconnectDelay*this._connectionRetryCount,this.config.eventsAutoReconnectMaxDelay);this._scheduleConnectRetryTimeout=setTimeout((function(){return t.connect()}),e),this._connectionRetryCount++},e.prototype._watchNetworkConnection=function(){this._watchingNetworkConnection||(this._watchingNetworkConnection=!0,this.host.on("networkStatus:change",this.onNetworkStatusChanged))},e.prototype._unwatchNetworkConnection=function(){this._watchingNetworkConnection&&(this.host.removeListener("networkStatus:change",this.onNetworkStatusChanged),this._watchingNetworkConnection=!1)},e.prototype._cancelSessionTimers=function(t){var e=(void 0===t?{}:t).source;this._heartbeatTimeout&&(clearTimeout(this._heartbeatTimeout),this._heartbeatTimeout=null),this._openTimeout&&(clearTimeout(this._openTimeout),this._openTimeout=null),this._scheduleConnectRetryTimeout&&(this.__allEvents.push({cancelSessionTimer:{source:e,timestamp:new Date}}),clearTimeout(this._scheduleConnectRetryTimeout),this._scheduleConnectRetryTimeout=null),null!==this._eventQueueTimeout&&(clearTimeout(this._eventQueueTimeout),this._eventQueueTimeout=null)},e.prototype._setHeartbeatTimeout=function(t){var e=this;this._heartbeatTimeout&&clearTimeout(this._heartbeatTimeout),void 0!==t&&(this._heartbeatInterval=t),this._heartbeatTimeout=setTimeout((function(){e._heartbeatTimeout=null,e._isHeartbeatTimeout=!0,0===e._connectionRetryCount&&(e._connectionRetryCount=1),e._disconnectAndRetry()}),this._heartbeatInterval)},e.prototype._cancelRetryHistoryTimeout=function(){this._retryHistoryTimeout&&(clearTimeout(this._retryHistoryTimeout),this._retryHistoryTimeout=null)},e.prototype._setRetryHistoryTimeout=function(){var t=this;this._retryHistoryTimeout&&clearTimeout(this._retryHistoryTimeout),this._retryHistoryTimeout=setTimeout((function(){t._retryHistoryTimeout=null,t._connectionRetryCount=0}),this.config.eventsClearRetryHistoryInterval)},e.prototype.reconnect=function(){this._connectionRetryCount=0,this.disconnect({unwatchNetwork:!1,source:"Reconnect"}),this.connect()},e.prototype._disconnectAndRetry=function(){var t=this;this.__allEvents.push({eventsDisconnectAndRetry:{eventQueueLength:this._eventQueue.length,pendingAckConnections:this._pendingAckConnections,queuedAcksLength:this._queuedAcks.length,connectionRetryCount:this._connectionRetryCount,timestamp:new Date}}),this.disconnect({clearQueues:!1,unwatchNetwork:!1,source:"Disconnect and retry"}),this.config.eventsAutoReconnect&&(this._reconnectWhenQueuesAreEmpty=!0),this.config.eventsAutoReconnect&&0===this._eventQueue.length&&0===this._pendingAckConnections&&0===this._queuedAcks.length?this._scheduleConnectRetry():this.config.eventsAutoReconnect&&(this._scheduleConnectRetryTimeout=setTimeout((function(){return t.connect()}),this.config.eventDrainTimeout)),this._eventQueue.length>0&&this._scheduleEventQueue({immediate:!0}),(this._pendingAckConnections>0||this._queuedAcks.length>0)&&this._flushQueuedAcks()},e.prototype.disconnect=function(t){var e=void 0===t?{}:t,n=e.clearQueues,r=void 0===n||n,o=e.isRecoverable,i=void 0===o||o,s=e.unwatchNetwork,a=void 0===s||s,u=e.source;if(this.__allEvents.push({eventsDisconnect:{clearQueues:r,source:u,unwatchNetwork:a}}),this._cancelSessionTimers({source:"Disconnect"}),this._cancelRetryHistoryTimeout(),a&&this._unwatchNetworkConnection(),this.eventSource){var c=this.eventSource;this.eventSource=null,this._requestedClose=!0,this._isClosed||(this._isClosed=!0,c.close()),this.emit("disconnected",{isRecoverable:i})}this.isConnected=!1,this.isOpen=!1,r&&(this._eventQueue=[],this._queuedAcks=[])},e.prototype._queueEvent=function(t){var e=t.data;if(e){if(Oi.some((function(t){return e.includes(t)}))){var n=void 0;try{n=JSON.parse(e)}catch(t){return this.logger.error("error parsing SSE payload: <"+e+">"),void this._disconnectAndRetry()}var r=Object.keys(n.event)[0].replace("tigertext:iq:","");if(Oi.includes(r)){this.disconnect({source:"Immediate event "+r});var o=n.event_id;return void this._processImmediateEvent(o,e)}}this._eventQueue.push(e),this._scheduleEventQueue()}},e.prototype._handleEvent=function(t){var e=t.event_id;if(this._autoAck||!this._processedEventIds[e]||Ii.includes(e)){var n=Object.keys(t.event)[0],r=n.replace("tigertext:iq:",""),o=t.event[n];!this.config.eventsDebugging&&wi.includes(r)||this.__allEvents.push(t),"sse:heartbeat"===r&&(this._lastHeartbeatTime=Date.now()),this.logger.debug("incoming",r,o);var i=new vi(e,r,o);try{this.router.emit(i),this.emit("event",i),this._autoAck?bi.includes(r)||this.__queueAck(e):this._processedEventIds[e]=!0}catch(t){this.logger.error("error in event "+r,t,t.stack,{data:o}),this.disconnect({isRecoverable:!1,source:"Error in event "+r})}}},e.prototype.__queueAck=function(t){var e;t=Object(to.d)(t),(e=this._queuedAcks).push.apply(e,t),this._throttled_flushQueuedAcks()},e.prototype.ack=function(t){return mi(this,void 0,void 0,(function(){var e,n;return _i(this,(function(r){switch(r.label){case 0:this.host.requireUser(),e=!1,t=Object(to.d)(t),this.logger.log("ack",t),this._pendingAckConnections++,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.host.api.events.ack(t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),e=this.httpClient.isUnauthorizedError(n),this.logger.warn("some events not acked",t),[3,4];case 4:return this._pendingAckConnections--,e&&(this.logger.warn("no longer authorized, terminating session"),this.disconnect({isRecoverable:!1,source:"Unauthorized during ack"})),[2]}}))}))},Object.defineProperty(e.prototype,"url",{get:function(){var t=Ti[this.endpointType].url;return"/"+("events"===this.endpointType&&this.config.condensedReplays?"v5":"v2")+t},enumerable:!1,configurable:!0}),e}(no),Ai=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ci=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ri=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Pi=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ji=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ai(e,t),e.prototype.mounted=function(){this._fetched=!1},e.prototype.dispose=function(){this._fetched=!1},e.prototype.create=function(t){var e=t.avatarFile,n=t.description,r=t.memberIds,o=void 0===r?[]:r,i=t.metadata,s=t.name,a=t.organizationId,u=t.replayHistory,c=void 0===u||u,l=t.senderId,d=void 0===l?this.host.currentUserId:l;return Ri(this,void 0,void 0,(function(){var t,r,u,l,f=this;return Pi(this,(function(h){switch(h.label){case 0:if(this.host.requireUser(),!a)throw new zn.ValidationError("organizationId","required");return[4,Promise.all(ji([d],o).map(this.host.roles.__resolveRoleId).filter(Boolean).map((function(t){return f._resolveModelIdWithTypes(t,"user")})).map((function(t){return f.host.users.findOrCreate(t,{organizationId:a})})))];case 1:return t=h.sent(),r=go.a.call(t),o=r.map((function(t){return f._resolveModelIdWithTypes(t,"user")})),[4,this.host.api.groups.create({avatarFile:e,description:n,excludeCreator:!1,isPublic:!0,memberIds:o,metadata:i,name:s,organizationId:a,replayHistory:c})];case 2:return u=h.sent(),l=this.config.condensedReplays&&u.entity?this.host.conversations.__injectCounterParty({conversationId:u.conversation_id,entityAttrs:u.entity,entityType:"group",hasCurrentUser:!0,organizationId:u.organization_id}):this.host.models.Group.inject(u),i&&this.host.metadata.__injectMetadata(l.id,a,i),[2,l]}}))}))},e.prototype.find=function(t,e){return void 0===e&&(e={}),Ri(this,void 0,void 0,(function(){var n,r;return Pi(this,(function(o){switch(o.label){case 0:return e=h.a.defaults(e,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),n=null,e.bypassCache?[3,2]:!(n=this.host.models.Group.get(t))||n.$placeholder?[3,2]:[4,this.host.groups.__ensureEntitiesLoaded(n.id,e)];case 1:return o.sent(),[2,n];case 2:return[4,this.host.groups.__find(t)];case 3:if(r=o.sent(),n=this.host.models.Group.get(t),!r){if(!e.ignoreNotFound)throw new zn.NotFoundError(this.host.models.Group.name,t);return[2,n]}return n?[4,this.host.groups.__ensureEntitiesLoaded(n.id,e)]:[3,5];case 4:o.sent(),o.label=5;case 5:return[2,n]}}))}))},e.prototype.findAll=function(t){var e=(void 0===t?{}:t).bypassCache,n=void 0!==e&&e;return Ri(this,void 0,void 0,(function(){var t,e,r;return Pi(this,(function(o){switch(o.label){case 0:return!n&&this._fetched?[2,this.getAll()]:0!==(t=this.host.models.Organization.getAll()).length?[3,2]:[4,this.host.organizations.findAll()];case 1:t=o.sent(),o.label=2;case 2:return[4,this.host.search.query({types:["forum"],organizationIds:t.map((function(t){return t.id})),query:{displayName:""},followContinuations:!0})];case 3:return e=o.sent().results,r=e.map((function(t){return t.entity})),this._fetched=!0,[2,r]}}))}))},e.prototype.getAll=function(){return this.host.models.Group.getAll().filter((function(t){return t.isPublic}))},e.prototype.getById=function(t){return this.host.models.Group.get(t)},e.prototype.join=function(t){return Ri(this,void 0,void 0,(function(){return Pi(this,(function(e){return[2,this.host.groups.addMembers(t,[this.host.currentUserId])]}))}))},Ci([Object(Or.decorator)()],e.prototype,"find",null),Ci([Object(Or.decorator)()],e.prototype,"findAll",null),e}(no),Mi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ki=function(){return(ki=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ni=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},zi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Di=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ui=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},Li=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._setP2PEntities=function(t){var n=t.createdByRole,r=t.createdByUser,o=t.groupType,i=t.targetUser,s=t.targetRole,a=e.host.currentUser;if(a&&o===tr.ROLE_P2P){var u=a.roles,c=[],l=[];n?l.push(n):r&&r!==a&&c.push(r),s?l.push(s):i&&i!==a&&c.push(i);var d=null,f=null;1===l.length?r===a||i===a?u.includes(l[0])?(d=a,f=l[0]):(d=l[0],f=a):(d=c[0],f=l[0]):2===l.length&&(u.includes(l[0])?(d=l[1],f=l[0]):u.includes(l[1])&&(d=l[0],f=l[1])),t.p2pRecipient=d,t.p2pSender=f}},e._onChangeConversation=function(t,n){var r=n.counterPartyId;if("group"===n.counterPartyType){var o=e.host.models.Group.get(r);o&&(o.conversation||e.host.models.Group.inject(o))}},e._onRemoveConversation=function(t,n){var r=n.counterPartyId;if("group"===n.counterPartyType){var o=e.host.models.Group.get(r);o&&o.conversation&&e.host.models.Group.inject(o)}},e._onChangeGroup=function(t,n){var r=n.id,o=n.memberIds,i=e._groupMemberIds[r];if(i)for(var s=0,a=i;s<a.length;s++){var u=a[s],c=(f=e._userGroups[u])?f.indexOf(n):-1;c>-1&&o&&!o.includes(u)&&f.splice(c,1)}if(o){e._groupMemberIds[r]=o;for(var l=0,d=o;l<d.length;l++){var f;u=d[l];(f=e._userGroups[u]||[]).includes(n)||f.push(n),e._userGroups[u]=f}}},e._onRemoveGroup=function(t,n){var r=n.id,o=n.memberIds;if(delete e._groupMemberIds[r],o)for(var i=0,s=o;i<s.length;i++){var a=s[i],u=e._userGroups[a],c=u?u.indexOf(n):-1;c>-1&&u.splice(c,1)}},e._onChangeMetadata=function(t,n){var r=n.entityId,o=e.host.models.Group.get(r);o&&e.host.models.Group.inject(o)},e._onChangeUser=function(t,n){var r=n.botRole,o=n.id,i=n.isRoleBot,s=e._userGroups[o],a=e._userState[o],u=a&&(a.botRole!==r||a.isRoleBot!==i);if(a&&!u||(e._userState[o]={botRole:r,isRoleBot:i}),s)for(var c=0,l=s;c<l.length;c++){var d=l[c],f=d.conversation,h=d.groupType,p=d.members;h!==tr.ROLE_P2P&&!u&&p&&p.includes(n)||(e.host.models.Group.inject(d),f&&e.host.models.Conversation.inject(f))}},e._onRemoveUser=function(t,n){var r=n.id,o=e._userGroups[r];if(o&&o.length>0)for(var i=0,s=o;i<s.length;i++){var a=s[i],u=a.members;u&&u.includes(n)&&e.host.models.Group.inject(a)}delete e._userGroups[r],delete e._userState[r]},e}return Mi(e,t),e.prototype.mounted=function(){this._fetched=!1,this._groupMemberIds={},this._userGroups={},this._userState={},this.host.models.Conversation.on("afterInject",this._onChangeConversation),this.host.models.Conversation.on("afterEject",this._onRemoveConversation),this.host.models.Group.on("afterInject",this._onChangeGroup),this.host.models.Group.on("afterEject",this._onRemoveGroup),this.host.models.Metadata.on("afterInject",this._onChangeMetadata),this.host.models.Metadata.on("afterEject",this._onChangeMetadata),this.host.models.User.on("afterInject",this._onChangeUser),this.host.models.User.on("afterEject",this._onRemoveUser)},e.prototype.dispose=function(){this._fetched=!1,this._groupMemberIds={},this._userGroups={},this._userState={},this.host.models.Conversation.removeListener("afterInject",this._onChangeConversation),this.host.models.Conversation.removeListener("afterEject",this._onRemoveConversation),this.host.models.Group.removeListener("afterInject",this._onChangeGroup),this.host.models.Group.removeListener("afterEject",this._onRemoveGroup),this.host.models.Metadata.removeListener("afterInject",this._onChangeMetadata),this.host.models.Metadata.removeListener("afterEject",this._onChangeMetadata),this.host.models.User.removeListener("afterInject",this._onChangeUser),this.host.models.User.removeListener("afterEject",this._onRemoveUser)},e.prototype.create=function(t){var e=t.avatarFile,n=t.description,r=t.isPatientGroup,o=void 0!==r&&r,i=t.isTeamActivation,s=void 0!==i&&i,a=t.memberIds,u=void 0===a?[]:a,c=t.metadata,l=t.name,d=t.organizationId,h=t.replayHistory,p=void 0!==h&&h,v=t.senderId,y=void 0===v?this.host.currentUserId:v;return zi(this,void 0,void 0,(function(){var t,r,i,a,h,v=this;return Di(this,(function(g){switch(g.label){case 0:if(this.host.requireUser(),!d)throw new zn.ValidationError("organizationId","required");return[4,Promise.all(Ui([y],u).map(this.host.roles.__resolveRoleId).filter(Boolean).map((function(t){return v._resolveModelIdWithTypes(t,["user","team"])})).map((function(t){var e=v._resolveEntity(t);return"team"===Object(f.get)(e,"$entityType")?e:v.host.users.findOrCreate(t,{organizationId:d})})))];case 1:return t=g.sent(),r=go.a.call(t),u=r.map((function(t){return v._resolveModelIdWithTypes(t,["user","team"])})),i=this._shouldExcludeSender(d,u,y),l||o||s||(l=this._getGroupName(r)),[4,this.host.api.groups.create({avatarFile:e,description:n,excludeCreator:i,memberIds:u,metadata:c,name:l,organizationId:d,replayHistory:p})];case 2:return a=g.sent(),this.config.condensedReplays&&a.entity?(h=this.host.conversations.__injectCounterParty({conversationId:a.conversation_id,entityAttrs:a.entity,entityType:"group",organizationId:a.organization_id}),this.host.conversations.__injectConversation(ki(ki({},a),{entity:h}))):h=this.host.models.Group.inject(a),c?(this.host.metadata.__injectMetadata(h.id,d,c),[3,5]):[3,3];case 3:return this.config.condensedReplays?[3,5]:[4,this.host.metadata.find(h.id,d)];case 4:g.sent(),g.label=5;case 5:return[2,h]}}))}))},e.prototype.createPatientGroup=function(t){var e=t.metadata,n=t.name,r=t.organizationId,o=t.recipientId,i=t.senderId;return this.create({isPatientGroup:!0,metadata:e,name:n,organizationId:r,memberIds:Ui([i],o)})},e.prototype._shouldExcludeSender=function(t,e,n){var r,o=this.host.models.User.get(n);return!!(function(t){return t&&"user"===t.$entityType}(r=o)&&r.isRoleBot&&o.botRole&&o.botRole.members.length>0)&&!e.includes(o.botRole.memberIds[0])},e.prototype._getGroupName=function(t,e){return void 0===e&&(e=!1),t.map((function(t){var e=t.displayName,n=t.firstName;return t.isRoleBot||"role"===t.$entityType||"team"===t.$entityType?e:n||(Object(vt.isEmail)(e)||Object(Eo.isPhone)(e)?e:"")})).filter(Boolean).join(", ")+(e?" ####":"")||"Group"},e.prototype.update=function(t,e){var n=e.name,r=e.avatarFile,o=e.replayHistory,i=e.memberIds,s=e.metadata;return zi(this,void 0,void 0,(function(){var e,a,u;return Di(this,(function(c){switch(c.label){case 0:return this.host.requireUser(),t=this._resolveModelId(t),e={},void 0!==n&&(e.name=n),void 0!==o&&(e.replayHistory=o),void 0!==i&&(e.memberIds=i.map(this.host.roles.__resolveRoleId)),[4,this.host.api.groups.update(t,{name:n,avatarFile:r,replayHistory:o,memberIds:i})];case 1:return void 0!==(a=c.sent()).avatarUrl&&(e.avatarUrl=a.avatarUrl),u=this.host.models.Group.inject(ki({id:t},e)),s?[4,this.host.metadata.update(t,s,u.organizationId)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2,u]}}))}))},e.prototype.find=function(t,e){return void 0===e&&(e={}),zi(this,void 0,void 0,(function(){var n,r;return Di(this,(function(o){switch(o.label){case 0:return e=Object(f.defaults)(e,{bypassCache:!1,ignoreNotFound:!1,includeMembers:!1}),this.host.requireUser(),n=null,e.bypassCache?[3,2]:!(n=this.host.models.Group.get(t))||n.$placeholder?[3,2]:[4,this.__ensureEntitiesLoaded(n.id,e)];case 1:return o.sent(),[2,n];case 2:return[4,this.__find(t)];case 3:if(r=o.sent(),n=this.host.models.Group.get(t),!r){if(!e.ignoreNotFound)throw new zn.NotFoundError(this.host.models.Group.name,t);return[2,n]}return n?[4,this.__ensureEntitiesLoaded(n.id,e)]:[3,5];case 4:o.sent(),o.label=5;case 5:return[2,n]}}))}))},e.prototype.__find=function(t){return zi(this,void 0,void 0,(function(){var e,n,r,o,i;return Di(this,(function(s){switch(s.label){case 0:return e=this.host.models.Group.get(t),[4,this.host.api.groups.find(t)];case 1:return n=s.sent(),this.config.condensedReplays&&n&&n.entity?(r=n.entity,e=this.host.conversations.__injectCounterParty({conversationId:n.conversation_id,entityAttrs:r,entityType:"group",organizationId:n.organization_id}),this.host.models.Group.removePlaceholder({entity:e,attrs:r}),[2,r]):(n&&(this.__removeForumMembers(n),o=n.metadata,e=this.host.models.Group.inject(n),i=e.organizationId,o&&i&&this.host.metadata.__injectMetadata(t,i,o)),this.host.models.Group.removePlaceholder({entity:e,attrs:n}),[2,n])}}))}))},e.prototype.__removeForumMembers=function(t){var e=t.members,n=this.__extractGroupTypeFromAttrs(t);n===tr.FORUM?e&&0===e.length&&delete t.members:n===tr.ROLE_ASSIGNMENT||e||(t.members=[])},e.prototype.__extractGroupTypeFromAttrs=function(t){var e=t.id||t.token,n=t.organizationId||t.organization_key,r=n?this.host.metadata.get(e,n):null,o=t.metadata||(r?r.data:null),i=tr.GROUP;if(o&&"role_assignment"===o.meta_type)i=tr.ROLE_ASSIGNMENT;else if(o&&"role"===o.feature_service)i=tr.ROLE_P2P;else if(o&&"escalation"===o.feature_service)i=tr.ESCALATION;else if(o&&"patient_care"===o.feature_service)i=tr.PATIENT_CARE;else if(o&&"patient_messaging"===o.feature_service)i=tr.PATIENT_MESSAGING;else if(o&&"teams"===o.feature_service){var s=o.meta_type;"activated_team"===s?i=tr.ACTIVATED_TEAM:"intra_team"===s&&(i=tr.INTRA_TEAM)}else(t.isPublic||t.is_public)&&(i=tr.FORUM);return i},e.prototype.__ensureEntitiesLoaded=function(t,e){return zi(this,void 0,void 0,(function(){var n,r;return Di(this,(function(o){switch(o.label){case 0:return n=this.host.models.Group.get(t),r=[this.ensureMetadata(n)],e.includeMembers&&r.push(this.ensureMembers(n)),[4,Promise.all(r)];case 1:return o.sent(),[2]}}))}))},e.prototype.findAll=function(t){var e=(void 0===t?{}:t).includeMembers,n=void 0!==e&&e;return zi(this,void 0,void 0,(function(){var t,e,r,o,i,s,a,u,c,l,d,f,h,p,v,y;return Di(this,(function(g){switch(g.label){case 0:return this._fetched?[2,this.getAll()]:0!==(t=this.host.models.Organization.getAll()).length?[3,2]:[4,this.host.organizations.findAll()];case 1:t=g.sent(),g.label=2;case 2:return[4,this.host.search.query({types:["group"],organizationIds:t.map((function(t){return t.id})),query:{displayName:""},followContinuations:!0})];case 3:if(e=g.sent().results,r=e.map((function(t){return t.entity})),!n)return[3,5];for(o={},i=0,s=r;i<s.length;i++)for(a=s[i],v=a.organizationId,y=a.memberIds,u=0,c=y;u<c.length;u++)l=c[u],o[v]||(o[v]=[]),o[v].includes(l)||o[v].push(l);for(d=[],f=0,h=Object.entries(o);f<h.length;f++)p=h[f],v=p[0],y=p[1],d.push(this.host.users.ensureUsers(y,v));return[4,Promise.all(d)];case 4:g.sent(),g.label=5;case 5:return this._fetched=!0,[2,r]}}))}))},e.prototype.findAllWithSpecificMembers=function(t,e,n){return zi(this,void 0,void 0,(function(){var r;return Di(this,(function(o){switch(o.label){case 0:return e=this._resolveModelId(e),t=Object(to.d)(t).map(this._resolveModelId).map(this.host.roles.__resolveRoleId),r=this.__findAllLocalWithSpecificMembers(t,e,n),!!n&&!!n.localOnly||0!==r.length?[3,2]:[4,this.findAll()];case 1:o.sent(),r=this.__findAllLocalWithSpecificMembers(t,e,n),o.label=2;case 2:return[2,r]}}))}))},e.prototype.ensureMembers=function(t,e){return void 0===e&&(e={}),zi(this,void 0,void 0,(function(){var n,r,o,i;return Di(this,(function(s){switch(s.label){case 0:return n=t.groupType===tr.ROLE_ASSIGNMENT,t.memberIds?[3,5]:t.groupType!==tr.FORUM?[3,2]:[4,this.findAllMemberIds(t.id)];case 1:return(r=s.sent())&&this.host.models.Group.inject({id:t.id,members:r}),[3,5];case 2:return n?[3,5]:[3,3];case 3:return[4,this.__find(t.id)];case 4:s.sent(),s.label=5;case 5:return o=e.attrs?ki({},e.attrs):{},i=n&&!t.memberIds?[]:t.memberIds,o.organizationId=t.organizationId,[4,this.ensureMembersWithIds(t.id,i,ki(ki({},e),{attrs:o}))];case 6:return s.sent(),[2]}}))}))},e.prototype.ensureMembersWithIds=function(t,e,n){return void 0===n&&(n={}),zi(this,void 0,void 0,(function(){var r=this;return Di(this,(function(o){switch(o.label){case 0:return this.host.requireUser(),0===(e=Object(f.without)(e,this.host.currentUserId)).length?[2]:(n=Object(f.defaults)(n,{onlyPlaceholder:!1}),[4,Promise.all(e.map((function(t){return r.__ensureMember(t,n)})).filter(Boolean))]);case 1:return o.sent().length>0&&this.host.models.Group.touch(t),[2]}}))}))},e.prototype.__ensureMember=function(t,e){if(void 0===e&&(e={}),!this.host.models.User.shouldEnsure(t,e.onlyPlaceholder))return null;var n=this.host.models.User.get(t);return n&&e.attrs&&this.host.models.User.injectPlaceholder(ki({id:n.id},e.attrs)),this.host.models.User.waitForEnsuredEntity(t,e)},e.prototype.ensureMetadata=function(t){return zi(this,void 0,void 0,(function(){var e,n,r;return Di(this,(function(o){switch(o.label){case 0:return e=t.groupType,n=t.id,r=t.organizationId,(r?this.host.metadata.get(n,r):null)?[3,3]:e!==tr.FORUM&&e!==tr.ROLE_ASSIGNMENT?[3,1]:[3,3];case 1:return[4,this.__find(n)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))},e.prototype.getAll=function(){return this.host.models.Group.getAll()},e.prototype.getById=function(t){return this.host.models.Group.get(t)},e.prototype.getMultiById=function(t){return this.host.models.Group.getMulti(t)},e.prototype.__findAllLocalWithSpecificMembers=function(t,e,n){var r=void 0===n?{}:n,o=r.exact,i=void 0===o||o,s=r.includeCurrentUser,a=void 0===s||s,u=r.includeForums,c=void 0===u||u,l=r.includeRoles,d=void 0===l||l,f=r.senderId,h=void 0===f?null:f,p=this.host,v=p.currentUser,y=p.currentUserId,g=v.roles.map((function(t){return t.botUserId}));h&&g.includes(h)?(t=t.slice()).push(h,y):a&&!t.includes(y)&&(t=t.slice()).push(y);for(var m=t.includes(y),_=t.length,b=[],w=0,I=this.host.models.Group.getAll();w<I.length;w++){var O=I[w];if(c||O.groupType!==tr.FORUM){var E=O.memberIds;if(O.organizationId===e&&E){for(var T=!0,S=0,A=t;S<A.length;S++){var C=A[S];if(!E.includes(C)){T=!1;break}}if(T){if(i){if(!h&&!m)continue;var R=_;if(d)for(var P=0,j=g;P<j.length;P++){var x=j[P];O.memberIds.includes(x)&&R++}if(R!==O.memberIds.length)continue}b.push(O)}}}}return b},e.prototype.destroy=function(t){return zi(this,void 0,void 0,(function(){return Di(this,(function(e){switch(e.label){case 0:return this.host.requireUser(),t=this._resolveModelId(t),[4,this.host.api.groups.destroy(t)];case 1:if(!e.sent())throw new zn.NotFoundError(this.host.models.Group.name,t);return[2]}}))}))},e.prototype.findAllMemberIds=function(t){return zi(this,void 0,void 0,(function(){return Di(this,(function(e){return this.host.requireUser(),t=this._resolveModelId(t),[2,this.host.api.groups.findAllMemberIds(t)]}))}))},e.prototype.addMembers=function(t,e){return zi(this,void 0,void 0,(function(){var n,r,o,i,s;return Di(this,(function(a){switch(a.label){case 0:if(this.host.requireUser(),t=this._resolveModelId(t),e=Object(to.d)(e).map(this._resolveModelId).map(this.host.roles.__resolveRoleId),(n=this.getById(t))&&n.groupType===tr.ROLE_P2P)throw new zn.PermissionDeniedError("role p2p group",n.id,"add users");return n?"FORUM"!==n.groupType||n.memberIds?[3,2]:(r=n,[4,this.findAllMemberIds(t)]):[3,3];case 1:r.memberIds=a.sent(),a.label=2;case 2:e=Object(f.difference)(e,n.memberIds),a.label=3;case 3:return 0===e.length?[2]:[4,this.host.api.groups.addMembers(t,e)];case 4:return o=a.sent(),this.config.condensedReplays?(i=this.host.conversations.getById(o.conversation_id))?[3,6]:[4,this.host.api.conversations.find(o.conversation_id)]:[3,7];case 5:if(!(s=a.sent()))throw new zn.NotFoundError(this.host.models.Conversation.name,t);i=this.host.conversations.__injectConversation(s),a.label=6;case 6:o.unread_message_count&&(i.unreadCount=o.unread_message_count),o.unread_priority_message_count&&(i.unreadPriorityCount=o.unread_priority_message_count),this.host.models.Conversation.inject(i),a.label=7;case 7:return[2]}}))}))},e.prototype.removeMembers=function(t,e){return zi(this,void 0,void 0,(function(){var n,r,o,i,s,a;return Di(this,(function(u){switch(u.label){case 0:if(this.host.requireUser(),t=this._resolveModelId(t),e=Object(to.d)(e).map(this._resolveModelId).map(this.host.roles.__resolveRoleId),!(n=this.getById(t)))return[3,3];if(r=n.groupType,o=n.id,i=n.p2pSender,s=i&&"role"===i.$entityType&&i.botUserId,r===tr.ROLE_P2P&&s&&e.includes(s))throw new zn.PermissionDeniedError("role p2p group",o,"remove an on-duty user");return"FORUM"!==r||n.memberIds?[3,2]:(a=n,[4,this.findAllMemberIds(t)]);case 1:a.memberIds=u.sent(),u.label=2;case 2:e=Object(f.intersection)(e,n.memberIds),u.label=3;case 3:return 0===e.length?[2]:[4,this.host.api.groups.removeMembers(t,e)];case 4:return u.sent(),[2]}}))}))},e.prototype.addMember=function(t,e){return zi(this,void 0,void 0,(function(){return Di(this,(function(n){return[2,this.addMembers(t,[e])]}))}))},e.prototype.removeMember=function(t,e){return zi(this,void 0,void 0,(function(){return Di(this,(function(n){return[2,this.removeMembers(t,[e])]}))}))},e.prototype.leave=function(t){return zi(this,void 0,void 0,(function(){var e,n,r,o,i,s,a,u,c,l,d,f;return Di(this,(function(h){switch(h.label){case 0:return t=this._resolveModelId(t),(e=this.getById(t))?(n=this.host,r=n.currentUser,o=n.currentUserId,i=e.groupType,s=e.p2pSender,a=e.memberIds,u=r.roles.map((function(t){return t.botUserId})),c=[o],i!==tr.FORUM?[3,2]:[4,this.findAllMemberIds(t)]):[2];case 1:a=h.sent(),h.label=2;case 2:if(i===tr.ROLE_P2P&&s)c=["user"===s.$entityType?s.id:s.botUserId];else if(a)for(l=0,d=a;l<d.length;l++)f=d[l],u.includes(f)&&c.push(f);return[4,this.removeMembers(t,c)];case 3:return h.sent(),[2]}}))}))},e.prototype.reactToBangEvent=function(t){var e=t.data,n=(e=Object(to.l)(e)).bang_id||""+e.sort_number;return this.__handleBang({data:e,eventId:n,alwaysAddToTimeline:!1})},e.prototype.__handleBang=function(t){var e=t.data,n=t.eventId,r=t.alwaysAddToTimeline,o=void 0!==r&&r,i=e.event;"added"===i?this.__addedToGroup({data:e,eventId:n,alwaysAddToTimeline:o}):"removed"===i?this.__removedFromGroup({data:e,eventId:n,alwaysAddToTimeline:o}):"teams_request_accepted"===i?this.__acceptedToTeam({data:e,eventId:n,alwaysAddToTimeline:o}):"teams_request_declined"===i||"teams_request_declined_full"===i?this.__deniedToTeam({data:e,eventId:n,alwaysAddToTimeline:o}):Zn.fromServer(i)?this.__handleEscalationBang({data:e,eventId:n,alwaysAddToTimeline:o}):"ended_voip_call"===i&&this.__handleEndedCall({data:e,eventId:n,alwaysAddToTimeline:o})},e.prototype.__handleEndedCall=function(t){var e=t.data,n=t.eventId,r=t.alwaysAddToTimeline;return zi(this,void 0,void 0,(function(){var t,o,i,s,a,u,c,l,d,h,p,v,y,g,m,_,b,w;return Di(this,(function(I){switch(I.label){case 0:t=e.participants_duration,o=e.caller_entity,i=e.conversation_id,s=e.created_on,a=e.organization_id,u=e.sort_number,c=e.subject_entity,l=e.target_entity;try{d=JSON.parse(t)}catch(t){return[2]}return!d||Object(f.isEmpty)(d)||Object(f.isEmpty)(d[this.host.currentUserId])?[2]:(h=d[this.host.currentUserId],p=h.duration,v=h.start_time,p&&Object(f.get)(o,"token")&&Object(f.get)(l,"token")?(y=[o,l].map((function(t){var e=t.display_name,n=t.token,r=t.type;return{displayName:e,id:n,organizationId:a,type:r}})),g=y[0],(m=y[1]).type.includes("group")?(_=this.host.models.Group.get(m.id),[3,3]):[3,1]):[2]);case 1:return m.type.includes("account")?[4,this.findAllWithSpecificMembers([m.id,g.id],a)]:[3,3];case 2:b=I.sent(),w=1===b.length&&2===b[0].memberCount,_=w&&b[0],I.label=3;case 3:return _?(this.host.conversations.addCallChangeLog({action:"CALL_ENDED",alwaysAddToTimeline:r,callee:m,callEntity:c,caller:g,conversationId:i,createdAt:s,duration:p,group:_,id:n,organizationId:a,sortNumber:+u,userStartTime:v}),[2]):[2]}}))}))},e.prototype.__addedToGroup=function(t){var e=t.data,n=t.eventId,r=t.alwaysAddToTimeline,o=e.caller_entity,i=e.subject_entity,s=e.target_entity,a=e.organization_id;if(o&&o.token&&s&&s.token&&i&&i.token){i&&!i.display_name&&(r=!1);var u=this.host.models.Group.get(s.token);if(u){var c,l={displayName:o.display_name,id:o.token,organizationId:a,type:"user"},d={displayName:i.display_name,id:i.token,organizationId:a,type:"user"},f=this.host.models.User.get(l.id),h={action:c=f&&f.isRoleBot||o.metadata&&"role"===o.metadata.feature_service?"OPT_IN":d.id===l.id?"JOIN":"ADD",actionTime:e.action_time||e.created_on,actor:l,alwaysAddToTimeline:r,createdAt:e.created_on,group:u,id:n,members:[d],memberIds:[d.id],sortNumber:+e.sort_number};this.host.conversations.addMembershipChangeLog(h),"OPT_IN"!==c&&u.memberIds&&u.memberIds.includes(d.id)||(this.host.models.Group.touch(u),this.emit("membership:change",h))}}},e.prototype.__removedFromGroup=function(t){var e=t.data,n=t.eventId,r=t.alwaysAddToTimeline,o=e.caller_entity,i=e.subject_entity,s=e.target_entity,a=e.organization_id,u=!1;if(o&&o.token&&s&&s.token&&i&&i.token){var c=this.host.models.Group.get(s.token);if(c){if(e.reason&&("leave_org"===e.reason||"delete_account"===e.reason)&&(e.reason_subject_token||e.subject_entity.token)){r=!1,u=!0;var l=e.reason_subject_token||e.subject_entity.token;this.host.models.User.inject({id:l,removedFromOrg:!0})}var d,f={displayName:o.display_name,id:o.token,organizationId:a,type:"user"},h={displayName:i.display_name,id:i.token,organizationId:a,type:"user"},p=this.host.models.User.get(f.id),v={action:d=p&&p.isRoleBot||o.metadata&&"role"===o.metadata.feature_service?"OPT_OUT":h.id===f.id?"LEAVE":"REMOVE",actionTime:e.action_time||e.created_on,actor:f,alwaysAddToTimeline:r,createdAt:e.created_on,group:c,id:n,members:[h],memberIds:[h.id],removedFromGroup:u,sortNumber:+e.sort_number};this.host.conversations.addMembershipChangeLog(v),"OPT_OUT"!==d&&c.memberIds&&!c.memberIds.includes(h.id)||this.emit("membership:change",v)}}},e.prototype.__acceptedToTeam=function(t){var e=t.data,n=t.eventId,r=t.alwaysAddToTimeline,o=e.caller_entity,i=e.subject_entity,s=e.target_entity,a=e.organization_id;if(o&&o.token&&s&&s.token&&i&&i.token){var u=this.host.models.Group.get(s.token);if(u){var c={displayName:e.action_user_name,id:e.action_user_id,organizationId:a,type:"user"},l={displayName:o.display_name,id:o.token,organizationId:a,type:"user"},d={action:"ADD",actionTime:e.action_time||e.created_on,actor:c,alwaysAddToTimeline:r,createdAt:e.created_on,group:u,id:n,members:[l],memberIds:[l.id],sortNumber:+e.sort_number};this.host.conversations.addMembershipChangeLog(d)}}},e.prototype.__deniedToTeam=function(t){var e=t.data,n=t.eventId,r=t.alwaysAddToTimeline,o=e.caller_entity,i=e.subject_entity,s=e.target_entity,a=e.organization_id;if(o&&o.token&&s&&s.token&&i&&i.token){var u=this.host.models.Group.get(s.token);if(u){var c={displayName:e.action_user_name,id:e.action_user_id,organizationId:a,type:"user"},l={displayName:o.display_name,id:o.token,organizationId:a,type:"user"},d={action:"DENY",actionTime:e.action_time||e.created_on,actor:c,alwaysAddToTimeline:r,createdAt:e.created_on,group:u,id:n,members:[l],memberIds:[l.id],sortNumber:+e.sort_number};this.host.conversations.addMembershipChangeLog(d)}}},e.prototype.__handleEscalationBang=function(t){var e=t.data,n=t.eventId,r=t.alwaysAddToTimeline,o=e.caller_entity,i=e.subject_entity,s=e.target_entity,a=e.organization_id;if(i.token&&s.token){var u=this.host.models.Group.get(s.token);u||(u=this.host.models.Group.injectPlaceholder({id:s.token,organizationId:a}));var c=Zn.resolve(e.event),l=this.host.models.EscalationExecution.get(i.token);l||(l=u.escalationExecution),l||(l=c===Zn.MEMBER_ADDED?null:this.host.models.EscalationExecution.inject({id:i.token,organizationId:a}));var d=e.action_user_name,f=e.action_time||e.created_on,h=null,p=null;c===Zn.INITIATED?h={displayName:o.display_name,id:o.token,organizationId:a,type:"user"}:c===Zn.MEMBER_ADDED?p=[{displayName:e.member_name,id:e.member_id,organizationId:a,type:"user"}]:c!==Zn.NO_RESPONSE&&(h={displayName:d,id:null,organizationId:a,type:"user"});var v={action:c,actionTime:f,actor:h,alwaysAddToTimeline:r,createdAt:e.created_on,escalationExecution:l,group:u,members:p,id:n,sortNumber:+e.sort_number};this.host.conversations.addEscalationExecutionChangeLog(v)}},e.prototype._setMembership=function(t){var e=this.host.currentUser.roles.reduce((function(t,e){var n=e.botUserId;return n&&(t[n]=!0),t}),{});if(t.hasCurrentUserOrRole=!1,t.memberIds)for(var n=0,r=t.memberIds;n<r.length;n++){var o=r[n];if(o===this.host.currentUserId||e[o])return void(t.hasCurrentUserOrRole=!0)}},Ni([Object(Or.decorator)()],e.prototype,"find",null),Ni([Object(Or.decorator)()],e.prototype,"__find",null),Ni([Object(Or.decorator)()],e.prototype,"__ensureEntitiesLoaded",null),Ni([Object(Or.decorator)()],e.prototype,"findAll",null),Ni([Object(Or.decorator)()],e.prototype,"findAllWithSpecificMembers",null),Ni([Object(Or.decorator)()],e.prototype,"findAllMemberIds",null),e}(no),Fi=n(28),Bi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qi=function(){return(qi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Vi=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Gi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Hi=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Wi=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},Yi=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},Ki=["escalationExecutionId","id","serverId"],$i=["distributionList","group","user"],Xi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.DELETE_ON_READ_MS=6e4,e.__retrieveSentMessage=function(t,n){var r=n.instance;return Gi(e,void 0,void 0,(function(){var e,n,o,i,s,a,u,c,l,d,f;return Hi(this,(function(h){switch(h.label){case 0:if(!(e=t.message_id))throw new Error("Missing message_id from /message response");return t.sort_number?[3,5]:[4,this.find(e,{instance:r,replace:!0})];case 1:return(n=h.sent())?[3,4]:[4,new Promise((function(t){return setTimeout(t,1e3)}))];case 2:return h.sent(),[4,this.find(e,{instance:r,replace:!0})];case 3:n=h.sent(),h.label=4;case 4:return n&&(r=n),[3,8];case 5:return void 0===t.is_forwarded&&(t.is_forwarded=!1),o=t.status||"New",this.__setDefaultAttributes(t,{instance:r}),(r=this.host.models.Message.replaceExisting(t,{instance:r})).$synced=void 0,i=r.counterPartyType,s=r.createdAt,a=r.group,u=r.recipientId,l=(c=a||{}).groupType,d=c.p2pRecipient,f=void 0,l===tr.ROLE_P2P&&d?f="role"===d.$entityType?d.botUserId:d.id:"user"===i&&(f=u),f?(this.__injectMessageStatus(r,{accountId:f,createdAt:s,status:o}),[3,8]):[3,6];case 6:return l!==tr.GROUP?[3,8]:[4,this.findRecipientStatus(r,{queue:!1})];case 7:h.sent(),h.label=8;case 8:return[2,r]}}))}))},e.__generateAttachmentDescriptor=function(t){var e="local:"+g.a.v4();t instanceof File||t instanceof Blob||to.c.raise("attachment","invalid","attachment (File or Blob) is invalid"),t.name||(t.name="attachment");var n={id:e,localFile:t,name:t.name,size:t.size,contentType:t.type,isLoading:!0,isLocal:!0};if(t.preview)n.localPath=t.preview,n.localPathPromise=function(){return Promise.resolve(n.localPath)},n.isLoading=!1;else{var r=Object(Fi.loadLocalFilePathWithFileReader)(t);n.localPathPromise=r,r.then((function(t){n.localPath=t,n.isLoading=!1}))}return n},e.__retryApiSend=function(t){return Gi(e,void 0,void 0,(function(){var e,n,r,o,i,s,a,u,c,l,d,f,p,v;return Hi(this,(function(y){switch(y.label){case 0:e=t._originalBody,n=t.attachments,r=t.conversationId,o=t.counterPartyId,i=t.deleteOnRead,s=t.id,a=t.metadata,u=t.priority,c=t.recipientOrganizationId,l=t.senderOrganizationId,d=t.shouldEscalate,f=t.ttl,y.label=1;case 1:return y.trys.push([1,4,,5]),[4,this.host.api.messages.send({attachment:h.a.get(n,"0.localFile"),body:e,conversationId:r,counterPartyId:o,deleteOnRead:i,escalate:d,localId:s,metadata:a,priority:er.toServer(u),recipientOrganizationId:c,senderOrganizationId:l,ttl:f})];case 2:return p=y.sent(),this.host.config.condensedReplays&&p.last_message&&(p=p.last_message),[4,this.__retrieveSentMessage(p,{instance:t})];case 3:return t=y.sent(),this.host.emit("message:sent",t),[3,5];case 4:return v=y.sent(),this.logger.warn("error while sending message",v),t.senderStatus=ir.FAILED,this.host.models.Message.inject(t),[3,5];case 5:return[2,t]}}))}))},e.__retryApiForward=function(t){return Gi(e,void 0,void 0,(function(){var e,n,r,o,i,s,a,u,c,l,d;return Hi(this,(function(f){switch(f.label){case 0:e=t.conversationId,n=t.counterPartyId,r=t.id,o=t.metadata,i=t.originalMessageId,s=t.priority,a=t.recipientOrganizationId,u=t.senderOrganizationId,f.label=1;case 1:return f.trys.push([1,4,,5]),[4,this.host.api.messages.forward(i,n,{conversationId:e,localId:r,metadata:o,priority:er.toServer(s),recipientOrganizationId:a,senderOrganizationId:u})];case 2:return c=f.sent(),l=c.message_id,[4,this.find(l,{instance:t,replace:!0})];case 3:return t=f.sent(),this.host.emit("message:sent",t),[3,5];case 4:return d=f.sent(),this.logger.error("error while forwarding message",d),t.senderStatus=ir.FAILED,this.host.models.Message.inject(t),[3,5];case 5:return[2,t]}}))}))},e._resolveMessage=function(t){return e.host.models.Message.is(t)?t:"string"==typeof t?e.host.models.Message.get(t):null},e._looksLikeDistributionListMessage=function(t){var e=t.body;if(!e)return!1;var n=e.match(/^\[(.+?)\]: /);return!!n&&n[1]},e.__setDefaultAttributes=function(t,e){var n=e.instance,r={is_forwarded:n.isForwarded,attachments:n.attachments,conversationId:n.conversationId,counterParty:n.counterParty,senderStatus:ir.SENT,shouldEscalate:!1};return n.isForwarded&&(r.originalForwardedMessageCreatedAt=n.originalForwardedMessageCreatedAt,r.originalMessageId=n.originalMessageId,n.originalSender&&(r.originalSender=n.originalSender)),h.a.defaults(t,r),t},e.__flushSetMessageStatusesQueue=function(){if(e._queuedSetMessageStatuses.deliveredIds.length+e._queuedSetMessageStatuses.readIds.length>0){var t=e._queuedSetMessageStatuses;e._queuedSetMessageStatuses={deliveredIds:[],readIds:[]},e.__setMessagesStatus(t)}},e._onTick=function(){e._deleteExpiredMessages(),e._deleteExpiredMutes(),e.config.condensedReplays&&e._clearOptimisticMarkAsReadState()},e._deleteExpiredMessages=function(t){void 0===t&&(t=Date.now()),t.getTime&&(t=t.getTime());for(var n=0,r=e.host.organizations.getAll();n<r.length;n++)for(var o=r[n].__expirableMessages,i=!1;!i&&o.length>0;){var s=o[0];s.expiresAt<t?e.host.models.Message.eject(s):i=!0}},e._deleteExpiredMutes=function(t){void 0===t&&(t=Date.now()),t.getTime&&(t=t.getTime());for(var n=0,r=e.host.organizations.getAll();n<r.length;n++)for(var o=r[n].__expirableMutes,i=!1;!i&&o.length>0;){var s=o[0];if(s.expiresAt<t){e.host.models.Mute.eject(s);var a=e.host.models.Conversation.get(s.conversationId);if(!a)continue;a.muted=null,e.host.models.Conversation.inject(a)}else i=!0}},e._onChangeMessageStatus=function(t,n){var r=n.messageId,o=e.host.models.Message.get(r);o&&e.host.models.Message.inject(o)},e._fetchAttachmentTokens=function(t){return void 0===t&&(t=20),e._fetchingAttachmentTokens||(e._fetchingAttachmentTokens=new Promise((function(n){return Gi(e,void 0,void 0,(function(){var e,r,o;return Hi(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.host.api.messages.createAttachmentTokens(t)];case 1:return e=i.sent().attachment_tokens,(o=this._attachmentTokens).push.apply(o,e),[3,3];case 2:return r=i.sent(),this.logger.error("error while requesting attachment tokens",r),[3,3];case 3:return this._fetchingAttachmentTokens=null,n(),[2]}}))}))}))),e._fetchingAttachmentTokens},e._useAttachmentToken=function(t,n){return void 0===t&&(t=20),void 0===n&&(n=0),Gi(e,void 0,void 0,(function(){var e;return Hi(this,(function(r){switch(r.label){case 0:if(n>3)throw new Error("Attachment tokens can not be fetched at this time.");return this._attachmentTokens.length<t?[4,this._fetchAttachmentTokens(t)]:[3,2];case 1:r.sent(),r.label=2;case 2:return(e=this._attachmentTokens.shift())?[3,4]:[4,this._useAttachmentToken(t,++n)];case 3:return[2,r.sent()];case 4:return[2,e]}}))}))},e.getAttachmentUrlWithToken=function(t,n,r){return void 0===r&&(r=!1),Gi(e,void 0,void 0,(function(){var e,o,i;return Hi(this,(function(s){switch(s.label){case 0:return e=this._resolveMessage(t),[4,this.findAttachment(e.serverId,n)];case 1:return o=s.sent(),[4,this._useAttachmentToken()];case 2:return i=s.sent(),[2,""+(r?this.host.config.baseUrl:"")+this.__getAttachmentPath(e.serverId,o.id)+"?token="+i]}}))}))},e.openAttachmentWithToken=function(t,n){return Gi(e,void 0,void 0,(function(){var e,r,o;return Hi(this,(function(i){switch(i.label){case 0:return e=n.toString(),r=this._resolveMessage(t),[4,this.findAttachment(t,e)];case 1:if(!i.sent())throw new zn.NotFoundError("MessageAttachment",r.serverId+":"+e);return[4,this.getAttachmentUrlWithToken(r.serverId,e)];case 2:return o=i.sent(),window.open(this.host.config.baseUrl+o,"_blank"),[2]}}))}))},e}return Bi(e,t),e.prototype.mounted=function(){this._throttled_flushFindRecipientStatusesQueue=this.config.flushFindRecipientStatusInterval?pi()(this.__flushFindRecipientStatusesQueue,this.config.flushFindRecipientStatusInterval,{leading:!1}):this.__flushFindRecipientStatusesQueue,this._throttled_flushSetMessageStatusesQueue=this.config.flushSetMessageStatusInterval?pi()(this.__flushSetMessageStatusesQueue,this.config.flushSetMessageStatusInterval,{leading:!1}):this.__flushSetMessageStatusesQueue,this._attachmentTokens=[],this._pendingFindRecipientStatuses={},this._queuedFindRecipientStatuses=[],this._queuedSetMessageStatuses={deliveredIds:[],readIds:[]},this.host.on("tick",this._onTick),this.host.models.MessageStatusPerRecipient.on("afterInject",this._onChangeMessageStatus),this.host.models.MessageStatusPerRecipient.on("afterEject",this._onChangeMessageStatus)},e.prototype.dispose=function(){this._attachmentTokens=null,this._pendingFindRecipientStatuses=null,this._queuedFindRecipientStatuses=null,this._queuedSetMessageStatuses=null,this._downloadAttachmentBlobAndUrl&&Or.decorator.clear(this._downloadAttachmentBlobAndUrl),this.downloadAttachmentUrl&&Or.decorator.clear(this.downloadAttachmentUrl),this.downloadAttachment&&Or.decorator.clear(this.downloadAttachment),this._throttled_flushFindRecipientStatusesQueue.cancel&&this._throttled_flushFindRecipientStatusesQueue.cancel(),this._throttled_flushSetMessageStatusesQueue.cancel&&this._throttled_flushSetMessageStatusesQueue.cancel(),this.host.removeListener("tick",this._onTick),this.host.models.MessageStatusPerRecipient.removeListener("afterInject",this._onChangeMessageStatus),this.host.models.MessageStatusPerRecipient.removeListener("afterEject",this._onChangeMessageStatus)},e.prototype.send=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l;return Hi(this,(function(d){switch(d.label){case 0:if(this.config.condensedReplays)throw new Error("the send() method has been deprecated in favor of sendToUser(), sendToGroup(), etc.");return Array.isArray(t)?[4,this.__resolveSender(n)]:[3,2];case 1:return d.sent(),[2,this.sendToGroupOfUsers(t,e,n)];case 2:return[4,this.__resolveCounterPartyEntityAndOrganizationId(t,n.senderOrganizationId||n.organizationId)];case 3:return r=d.sent(),o=r.counterParty,i=r.organizationId,to.c.notEmpty("counterPartyId",o,"counterPartyId not found"),i?n=qi(qi({},h.a.omit(n,"organizationId","senderOrganizationId","recipientOrganizationId")),{organizationId:i}):i=n.organizationId,[4,this.__resolveSender(n)];case 4:return s=d.sent(),a=function(t){return t&&"user"===t.$entityType},(u=function(t){return a(t)&&t.isRoleBot})(o)||a(o)&&u(s)?[2,this.sendToRole(t,e,n)]:(c=o.groupType,l=o.memberIds,c!==tr.FORUM||l&&l.includes(this.host.currentUserId)?[3,6]:[4,this.host.forums.join(o)]);case 5:d.sent(),d.label=6;case 6:return[2,this.__sendToCounterParty(o,e,n)]}}))}))},e.prototype.__resolveSender=function(t){return Gi(this,void 0,void 0,(function(){var e,n,r;return Hi(this,(function(o){switch(o.label){case 0:return e=this.__resolveSenderId(t),n=t.senderOrganizationId||t.organizationId,e===this.host.currentUserId?[2,this.host.currentUser]:(n||to.c.raise("senderOrganizationId","missing","When senderId is provided, senderOrganizationId or organizationId must also be provided"),[4,this.host.users.find(e,{organizationId:n})]);case 1:return(r=o.sent())||to.c.raise("senderId","invalid","The provided senderId was not found"),r.isRoleBot||to.c.raise("senderId","invalid","senderId must be either the current user or a role"),[4,this.host.roles.find(e,n)];case 2:return o.sent(),[2,r]}}))}))},e.prototype.__resolveSenderId=function(t){void 0===t&&(t={});var e=t.senderId;return e?(e=this._resolveModelId(e),e=this.host.roles.__resolveRoleId(e)):e=this.host.currentUserId,t.senderId=e,e},e.prototype.__resolveCounterPartyEntityAndOrganizationId=function(t,e){return void 0===e&&(e=null),Gi(this,void 0,void 0,(function(){var n,r,o;return Hi(this,(function(i){switch(i.label){case 0:return"string"==typeof t&&(t=this.host.roles.__resolveRoleId(t)),n=this._resolveEntity(t,Yi($i,["conversation"])),r=e,n?[3,2]:this.host.conversations.looksLikeConversationHandle(t)?[4,this.host.conversations.find(t)]:[3,2];case 1:(o=i.sent())&&(n=o.counterParty,r=o.organizationId),i.label=2;case 2:return n?[3,4]:[4,this.__resolveRemoteCounterPartyEntity(t,r)];case 3:n=i.sent(),i.label=4;case 4:return n&&(n.organizationId&&"user"!==n.$entityType&&(r=n.organizationId),"conversation"===n.$entityType&&(n=n.counterParty)),[2,{counterParty:n,organizationId:r}]}}))}))},e.prototype.__resolveRemoteCounterPartyEntity=function(t,e){return Gi(this,void 0,void 0,(function(){var n,r,o,i,s,a,u=this;return Hi(this,(function(c){switch(c.label){case 0:n=null,t=this.host.roles.__resolveRoleId(t),r=h.a.compact([function(){return Gi(u,void 0,void 0,(function(){return Hi(this,(function(n){return[2,this.host.users.findOrCreate(t,{organizationId:e})]}))}))},function(){return Gi(u,void 0,void 0,(function(){return Hi(this,(function(e){return[2,this.host.groups.find(t)]}))}))},function(){return Gi(u,void 0,void 0,(function(){return Hi(this,(function(e){return[2,this.host.distributionLists.find(t)]}))}))}]),o=0,i=r,c.label=1;case 1:if(!(o<i.length))return[3,6];s=i[o],c.label=2;case 2:return c.trys.push([2,4,,5]),[4,s()];case 3:return(n=c.sent())?[3,6]:[3,5];case 4:if((a=c.sent()).code!==zn.NotFoundError.CODE)throw a;return[3,5];case 5:return o++,[3,1];case 6:return[2,n]}}))}))},e.prototype.__sendToCounterParty=function(t,e,n){var r=n.organizationId,o=n.senderOrganizationId,i=void 0===o?r:o,s=n.recipientOrganizationId,a=void 0===s?i:s,u=Wi(n,["organizationId","senderOrganizationId","recipientOrganizationId"]);return Gi(this,void 0,void 0,(function(){var n,o,s,c,l,d,f,p,v,y,m;return Hi(this,(function(_){switch(_.label){case 0:n=t.$entityType,o=t.serverId,this.host.requireUser(),to.c.oneOf("counterPartyType",n,["user","group","distributionList"]),to.c.notEmpty("counterPartyId",o),i=this.__ensureOrganization(i),a=a||i,u=this.__normalizeSendOptions(u,{counterParty:t,senderOrganizationId:i}),s=this.__createNewMessage(t,e,qi({organizationId:r,senderOrganizationId:i,recipientOrganizationId:a},u)),this.host.events.deferEventQueue(),this.host.models.Message.inject(s),this.host.emit("message:sending",s),c=u.attachmentFiles,l=u.deleteOnRead,d=u.escalate,f=u.metadata,p=u.priority,v=u.ttl,_.label=1;case 1:return _.trys.push([1,4,,5]),[4,this.host.api.messages.send({attachment:h.a.head(c),body:e,counterPartyId:o,deleteOnRead:l,escalate:d,localId:s?s.id:g.a.v4(),metadata:f,priority:er.toServer(p),recipientOrganizationId:a,senderOrganizationId:i,ttl:v})];case 2:return y=_.sent(),[4,this.__retrieveSentMessage(y,{instance:s})];case 3:return s=_.sent(),this.host.emit("message:sent",s),[3,5];case 4:return m=_.sent(),this.logger.error("error while sending message",m),s.senderStatus=ir.FAILED,this.host.models.Message.inject(s),[3,5];case 5:return this.host.events.resumeEventQueue(),[2,s]}}))}))},e.prototype.__createNewMessage=function(t,e,n){var r,o=n.conversationId,i=n.isForwarded,s=void 0!==i&&i,a=n.organizationId,u=n.senderOrganizationId,c=void 0===u?a:u,l=n.recipientOrganizationId,d=void 0===l?c:l,f=Wi(n,["conversationId","isForwarded","organizationId","senderOrganizationId","recipientOrganizationId"]),h=f.attachmentFiles,p=f.deleteOnRead,v=f.escalate,y=f.metadata,m=f.originalMetadata,_=f.priority,b=f.senderId,w=f.ttl,I=t.$entityType,O=t.serverId;this.host.requireUser(),to.c.oneOf("counterPartyType",I,["user","group","distributionList"]),to.c.notEmpty("counterPartyId",O),o&&(r=this.host.conversations.getById(o)),r||(r=this.host.conversations.ensureConversation(I,O,c));var E=r.isLive,T=this.__getNextSortNumber(c,{conversation:r}),S=b&&b!==this.host.currentUserId?b:void 0,A=e;"distributionList"===I&&(e="["+t.displayName+"]: "+e);var C=this.host.models.Message.createInstance({$synced:!1,body:e,conversationId:r.id,counterPartyId:O,counterPartyType:I,createdAt:new Date,currentSenderRoleId:S,deleteOnRead:p,id:g.a.v4(),inTimeline:E,isForwarded:s,isOutgoing:!0,messageType:ar.USER_SENT,metadata:y,originalMetadata:m,priority:_,recipientOrganizationId:d,senderId:this.host.currentUserId,senderOrganizationId:c,senderStatus:ir.SENDING,shouldEscalate:v,sortNumber:T,ttl:w});return C._originalBody=A,h&&(C.attachments=h.map(this.__generateAttachmentDescriptor)),"group"===I?C.groupId=O:"user"===I?C.recipientId=O:"distributionList"===I&&(C.distributionListId=O),this.config.condensedReplays||(C.markedRecipientStatus=or.READ),C},e.prototype.__normalizeSendOptions=function(t,e){var n=t.attachmentFile,r=t.attachmentFiles,o=t.deleteOnRead,i=t.escalate,s=t.metadata,a=t.originalMetadata,u=t.priority,c=t.senderId,l=t.ttl,d=e.counterParty,f=e.senderOrganizationId;s=this.__normalizeMetadata({metadata:s,organizationId:f,senderId:c}),r=Object(to.d)(r||n),!h.a.isEmpty(r)&&r.length>1&&to.c.raise("attachmentFiles","invalid","currently only a single attachment is supported");var p=this.host.models.Organization.get(f);void 0===l&&(l=p?p.messageTimeToLive:-1),!o&&p&&(o=p.deleteOnRead);var v=d.groupType,y=d.p2pRecipient;v===tr.ROLE_P2P&&y&&y.escalationPolicy&&(y.escalationPolicy.alwaysEscalate&&(i=!0,u=er.NORMAL));return{attachmentFiles:r,deleteOnRead:o,escalate:i,metadata:s,originalMetadata:a,priority:u,senderId:c,ttl:l}},e.prototype.__ensureOrganization=function(t){return t||(this.host.config.defaultOrganizationId?this.host.config.defaultOrganizationId:void to.c.raise("organizationId","required","Message is sent in the context of an organization. Provide `organizationId` or set a default one with client.setDefaultOrganization(...)"))},e.prototype.__normalizeMetadata=function(t){var e=t.metadata,n=(t.organizationId,t.senderId);if(e||(e=[]),e=Object(to.d)(e),n!==this.host.currentUserId){var r=this.host.roles.getById(n),o=r.roleTag;e.push({namespace:"tigertext:message:role:sender",payload:{token:n,display_name:r.displayName,tag_id:o?o.tagId:"",tag_color:o?o.color.replace("#","0x"):"",tag_name:o?o.name:""}})}return e.length>0?e.map((function(t){return qi({mimetype:"application/json"},t)})):void 0},e.prototype.__getNextSortNumber=function(t,e){var n=(void 0===e?{}:e).conversation,r=this.host.models.Organization.get(t);r&&!n&&(n=r.conversations[0]);var o=r&&r.highestSortNumber||0,i=n&&n.lastBangMessageSortNumber||0;return Math.max(o,i)+1},e.prototype.previewMessage=function(t,e){void 0===e&&(e={});for(var n=this._resolveMessage(t),r={},o=0,i=Object.entries(n);o<i.length;o++){var s=i[o],a=s[0],u=s[1];Object(to.k)(n,a)&&!Ki.includes(a)&&(r[a]=u)}r=qi(qi(qi({},r),{id:g.a.v4(),conversationId:null}),e),this.__setForwardedMessageProperties({origMessage:n,organizationId:n.__organizationId,message:r});for(var c=this.host.models.Message.inject(r),l=0,d=n.statusesPerRecipient;l<d.length;l++){var f=d[l],h=f.userId||f.distributionListId,p=c.id+":"+h;this.host.models.MessageStatusPerRecipient.inject(qi(qi({},f),{id:p,messageId:c.id}))}return c},e.prototype.endPreviewMessage=function(t){var e=this._resolveMessage(t);if(e){for(var n=0,r=e.statusesPerRecipient;n<r.length;n++){var o=r[n];this.host.models.MessageStatusPerRecipient.eject(o)}this.host.models.Message.eject(e)}},e.prototype.sendToUser=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,h,p;return Hi(this,(function(v){switch(v.label){case 0:if(!this.host.config.condensedReplays)return[2,this.send(t,e,n)];if(r=n.organizationId,o=n.senderId,i=void 0===o?this.host.currentUserId:o,s=n.groupName,a=n.groupMetadata,!r)throw new Error("organizationId is required");return t=this._resolveModelIdWithTypes(t,"user"),(u=this._resolveEntity(t,"user"))&&u.profileByOrganizationId&&u.profileByOrganizationId[r]?[3,2]:[4,this.host.users.findOrCreate(t,{organizationId:r})];case 1:u=v.sent(),v.label=2;case 2:return[4,this.__resolveRoleBotId(i,r)];case 3:return c=v.sent(),l=c.isRole,d=c.roleBotId,l?[4,this.__prepareRoleP2PGroup(r,t,d,s,{groupMetadata:a})]:[3,5];case 4:return f=v.sent(),[2,this.sendToGroup(f,e,qi(qi({},n),{organizationId:r,senderId:i}))];case 5:if(h=u&&u.profileByOrganizationId[r],!(p=h&&h.conversationId))throw new Error("conversationId not found for p2p message");return this.host.conversations.getById(p)||this.host.models.Conversation.inject({counterPartyId:u.id,counterPartyType:u.$entityType,id:p,organizationId:r}),[2,this.sendToConversation(p,e,n)]}}))}))},e.prototype.sendToGroup=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r;return Hi(this,(function(o){switch(o.label){case 0:return this.config.condensedReplays?(t=this._resolveModelId(t),(r=this._resolveEntity(t,"group"))?[3,2]:[4,this.host.groups.find(t)]):[2,this.send(t,e,n)];case 1:r=o.sent(),o.label=2;case 2:if(!r||!r.conversationId)throw new Error("group conversationId not found");return this.host.conversations.getById(r.conversationId)||this.host.models.Conversation.inject({counterPartyId:r.id,counterPartyType:r.$entityType,id:r.conversationId,organizationId:r.organizationId}),[2,this.sendToConversation(r.conversationId,e,n)]}}))}))},e.prototype.sendToRole=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d;return Hi(this,(function(f){switch(f.label){case 0:if(r=n.organizationId,o=n.senderId,i=void 0===o?this.host.currentUserId:o,s=n.groupMetadata,a=n.groupName,!this.host.config.condensedReplays)return[3,2];if(!r)throw new Error("organizationId is required");return[4,this.__resolveRoleBotId(t,r)];case 1:if(u=f.sent(),c=u.isRole,l=u.roleBotId,!c)throw new Error("recipient must be a role");t=l,f.label=2;case 2:return[4,this.__prepareRoleP2PGroup(r,t,i,a,{groupMetadata:s})];case 3:return d=f.sent(),[2,this.sendToGroup(d,e,qi(qi({},n),{organizationId:r,senderId:i}))]}}))}))},e.prototype.sendToPatient=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l;return Hi(this,(function(d){switch(d.label){case 0:if(n.groupMetadata,r=n.organizationId,o=n.senderId,i=void 0===o?this.host.currentUserId:o,s=Wi(n,["groupMetadata","organizationId","senderId"]),n=qi(qi({},s),{organizationId:r,senderId:i}),this.host.config.condensedReplays&&!r)throw new Error("organizationId is required");if(a=t&&1===t.length?t[0]:t,!(c=this._resolveEntity(a,"user")))throw new Error("user could not be resolved");return u=c.isPatientContact?this.host.patients._createPatientContactGroupMetadata(c):this.host.patients._createPatientGroupMetadata(c),[4,this.host.groups.createPatientGroup({organizationId:r,recipientId:t,senderId:i,metadata:u})];case 1:return l=d.sent(),this.host.metadata.__injectMetadata(l.id,r,u),[2,this.sendToGroup(l,e,qi(qi({},n),{organizationId:r,senderId:i}))]}}))}))},e.prototype.__resolveRoleBotId=function(t,e){return Gi(this,void 0,void 0,(function(){var n,r,o;return Hi(this,(function(i){switch(i.label){case 0:t=this.host.roles.__resolveRoleId(t);try{r=this._resolveModelIdWithTypes(t,"role"),n=!!this._resolveEntity(r,"role")}catch(t){n=!1}return n?[3,3]:(o=this._resolveEntity(t,"user"))&&o.profileByOrganizationId&&o.profileByOrganizationId[e]?[3,2]:[4,this.host.users.find(t,{organizationId:e})];case 1:o=i.sent(),i.label=2;case 2:o&&o.isRoleBot&&(n=!0),i.label=3;case 3:return[2,{isRole:n,roleBotId:t}]}}))}))},e.prototype.sendToConversation=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,p,v,y,m,_,b,w,I,O,E;return Hi(this,(function(T){switch(T.label){case 0:if(!this.host.config.condensedReplays)return[2,this.send(t,e,n)];if(t=this._resolveModelIdWithTypes(t,"conversation"),!(r=this.host.conversations.getById(t)))throw new zn.NotFoundError(this.host.models.Conversation.name,t);return[4,this.__resolveSender(n)];case 1:return o=T.sent(),i=r.counterPartyId,s=r.counterPartyType,a=r.organizationId,u=this._resolveEntity(i,s),this.host.requireUser(),c=u.groupType,l=u.memberIds,c!==tr.FORUM||l&&l.includes(this.host.currentUserId)?[3,3]:[4,this.host.forums.join(u)];case 2:T.sent(),T.label=3;case 3:f=d=a,n=this.__normalizeSendOptions(n,{counterParty:u,senderOrganizationId:d,senderId:o.id}),p=this.__createNewMessage(u,e,qi({conversationId:t,organizationId:a,senderOrganizationId:d,recipientOrganizationId:f},n)),this.host.events.deferEventQueue(),this.host.models.Message.inject(p),this.host.emit("message:sending",p),v=n.attachmentFiles,y=n.deleteOnRead,m=n.escalate,_=n.metadata,b=n.priority,w=n.ttl,T.label=4;case 4:return T.trys.push([4,7,,8]),[4,this.host.api.messages.send({attachment:h.a.head(v),body:e,conversationId:r.id,deleteOnRead:y,escalate:m,localId:p?p.id:g.a.v4(),metadata:_,priority:er.toServer(b),senderOrganizationId:d,ttl:w})];case 5:return I=T.sent(),O=void 0,O=I.last_message?I.last_message:I,[4,this.__retrieveSentMessage(O,{instance:p})];case 6:return(p=T.sent()).unreadMessageCount&&(r.unreadCount=p.unreadMessageCount),p.unreadPriorityMessageCount&&(r.unreadPriorityCount=p.unreadPriorityMessageCount),r.lastMessage=p,r.highestSortNumber=p.sortNumber?p.sortNumber:this.__getNextSortNumber(d,{conversation:r}),r.isLive=!0,r.timeline.push(p),this.host.models.Conversation.inject(r),p.inTimeline=!0,this.host.models.Message.inject(p),this.host.emit("message:sent",p),[3,8];case 7:return E=T.sent(),this.logger.error("error while sending message",E),p.senderStatus=ir.FAILED,this.host.models.Message.inject(p),[3,8];case 8:return this.host.events.resumeEventQueue(),[2,p]}}))}))},e.prototype.sendToDistributionList=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o;return Hi(this,(function(i){switch(i.label){case 0:return this.config.condensedReplays?(t=this._resolveModelIdWithTypes(t,"distributionList"),(r=this._resolveEntity(t,"distributionList"))?[3,2]:[4,this.host.distributionLists.find(t)]):[2,this.send(t,e,n)];case 1:r=i.sent(),i.label=2;case 2:if(!r||!r.conversationId)throw new Error("distributionList conversationId not found");return(o=this.host.conversations.getById(r.conversationId))||(o=this.host.models.Conversation.inject({counterPartyId:r.id,counterPartyType:r.$entityType,id:r.conversationId,organizationId:r.organizationId})),[2,this.sendToConversation(o.id,e,n)]}}))}))},e.prototype.sendToGroupOfUsers=function(t,e,n){void 0===n&&(n={});var r=n.groupMetadata,o=n.groupName,i=n.isTeamActivation,s=n.organizationId,a=n.senderId,u=Wi(n,["groupMetadata","groupName","isTeamActivation","organizationId","senderId"]);return Gi(this,void 0,void 0,(function(){var n,c;return Hi(this,(function(l){switch(l.label){case 0:return[4,this.__prepareGroupForUsers(s,t,a,o,i,{groupMetadata:r})];case 1:return n=l.sent(),this.config.condensedReplays?(c=n.conversationId,[4,this.host.conversations.find(c)]):[3,3];case 2:return l.sent(),[2,this.sendToConversation(c,e,qi(qi({},u),{organizationId:s,senderId:a}))];case 3:return[2,this.sendToGroup(n,e,qi(qi({},u),{organizationId:s,senderId:a}))]}}))}))},e.prototype.__prepareGroupForUsers=function(t,e,n,r,o,i){var s=(void 0===i?{}:i).groupMetadata;return 0===e.length&&to.c.raise("memberIds","required"),this.host.groups.create({isTeamActivation:o,memberIds:e,metadata:s,name:r,organizationId:t,senderId:n})},e.prototype.__prepareRoleP2PGroup=function(t,e,n,r,o){var i=(void 0===o?{}:o).groupMetadata;return Gi(this,void 0,void 0,(function(){var o;return Hi(this,(function(s){switch(s.label){case 0:return(o=this.host.conversations.findLocalRoleP2PConversation(e,n))?[2,o.counterParty]:[4,this.host.roles.createP2PGroup({metadata:i,name:r,organizationId:t,recipientId:e,senderId:n})];case 1:return[2,s.sent()]}}))}))},e.prototype.recall=function(t){return Gi(this,void 0,void 0,(function(){var e,n;return Hi(this,(function(r){switch(r.label){case 0:return this.host.requireUser(),e=Object(to.d)(t).filter(Boolean),n=e.map(this.__recallSingle.bind(this)),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},e.prototype.__recallSingle=function(t){return Gi(this,void 0,void 0,(function(){var e;return Hi(this,(function(n){switch(n.label){case 0:if(!(e=this._resolveMessage(t)))return[3,4];if(e.senderId!==this.host.currentUserId)throw new zn.PermissionDeniedError(e,e.serverId,"recall");return!1!==e.$synced&&e.serverId?[3,1]:(this.host.models.Message.eject(e),[3,3]);case 1:return[4,this.host.api.messages.destroy(e.serverId)];case 2:n.sent(),this.host.models.Message.eject(e),n.label=3;case 3:return[3,6];case 4:return[4,this.host.api.messages.destroy(t)];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))},e.prototype.retrySend=function(t){return Gi(this,void 0,void 0,(function(){var e,n,r;return Hi(this,(function(o){switch(o.label){case 0:if(this.host.requireUser(),!(e=this._resolveMessage(t)))throw new zn.NotFoundError(this.host.models.Message.name,t);return n=e.isForwarded,e.senderStatus!==ir.FAILED&&to.c.raise("message","invalid","Message to retry must be in a FAILED senderStatus and sent from current user"),this.host.events.deferEventQueue(),e.senderStatus=ir.RETRYING,this.host.models.Message.inject(e),this.host.emit("message:sending",e),n?[4,this.__retryApiForward(e)]:[3,2];case 1:return e=o.sent(),[3,4];case 2:return[4,this.__retryApiSend(e)];case 3:e=o.sent(),o.label=4;case 4:return this.config.condensedReplays&&(r=this.host.conversations.getById(e.conversationId),e.unreadMessageCount&&(r.unreadCount=e.unreadMessageCount),e.unreadPriorityMessageCount&&(r.unreadPriorityCount=e.unreadPriorityMessageCount),r.lastMessage=e,r.highestSortNumber=e.sortNumber,this.host.models.Conversation.inject(r)),this.host.events.resumeEventQueue(),[2,e]}}))}))},e.prototype.resend=function(t,e){var n=void 0===e?{}:e,r=n.priority,o=n.retrieveMessage,i=void 0!==o&&o,s=n.senderId;return Gi(this,void 0,void 0,(function(){var e,n,o,a,u,c,l,d,f,h,p,v,y,g,m,_,b;return Hi(this,(function(w){switch(w.label){case 0:return e=this._resolveMessage(t),void 0===r&&(r=e.priority),void 0===s&&(s=e.senderId),n=e.attachments,o=e.body,a=e.conversationId,u=e.counterParty,c=e.counterPartyId,l=e.deleteOnRead,d=e.isForwarded,f=e.metadata,h=e.originalMessageId,p=e.recipientOrganizationId,v=e.ttl,d?this.config.condensedReplays?[2,this.forwardToConversation(h,a,{organizationId:p,priority:r})]:[2,this.forward(h,c,{organizationId:p,priority:r,retrieveMessage:i,senderId:s})]:[3,1];case 1:if(y=[],f=f.filter((function(t){return"tigertext:message:role:sender"!==t.namespace})),!n)return[3,5];g=0,m=n,w.label=2;case 2:return g<m.length?(_=m[g],[4,this._downloadAttachmentBlobAndUrl(t,_.id)]):[3,5];case 3:(b=w.sent().blob).name=_.name,y.push(b),w.label=4;case 4:return g++,[3,2];case 5:return this.config.condensedReplays?[2,this.sendToConversation(a,o,{attachmentFiles:y,deleteOnRead:l,organizationId:p,priority:r,metadata:f,senderId:s,ttl:v})]:[2,this.__sendToCounterParty(u,o,{attachmentFiles:y,deleteOnRead:l,organizationId:p,priority:r,senderId:s,metadata:f,ttl:v})]}}))}))},e.prototype.forwardToConversation=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,p,v,y,g,m,_,b,w,I,O,E;return Hi(this,(function(T){switch(T.label){case 0:if(!this.config.condensedReplays)return[2,this.forward(t,e,n)];if(r=n.metadata,o=void 0===r?[]:r,i=n.priority,s=n.senderId,a=void 0===s?this.host.currentUserId:s,!(u=this.host.conversations.getById(e)))throw new Error("conversation not found");if(this.host.requireUser(),!(c=this._resolveMessage(t)))throw new zn.NotFoundError(this.host.models.Message.name,t);if(l=c.attachments,d=c.body,!(f=c.serverId))throw new Error("original message was not sent");a=this.__resolveSenderId({senderId:a}),void 0===i&&(i=c.priority),p=u.counterPartyId,v=u.counterPartyType,y=u.organizationId,g=this._resolveEntity(p,v),m=y,_=h.a.get(c,"originalMetadata"),b={metadata:o,priority:i,senderId:a,originalMetadata:_},b=this.__normalizeSendOptions(b,{counterParty:g,senderOrganizationId:m}),o=b.metadata,(w=this.__createNewMessage(g,d,qi({conversationId:e,organizationId:y,isForwarded:!0},b))).attachments=l,this.__setForwardedMessageProperties({origMessage:c,organizationId:y,message:w}),this.host.events.deferEventQueue(),this.host.models.Message.inject(w),this.host.emit("message:sending",w),T.label=1;case 1:return T.trys.push([1,4,,5]),[4,this.host.api.messages.forward(f,null,{conversationId:e,localId:w.id,metadata:o,priority:er.toServer(i)})];case 2:return I=T.sent(),[4,this.__retrieveSentMessage(I.message,{instance:w})];case 3:return(O=T.sent()).unreadMessageCount&&(u.unreadCount=O.unreadMessageCount),O.unreadPriorityMessageCount&&(u.unreadPriorityCount=O.unreadPriorityMessageCount),this.host.models.Conversation.inject(u),this.host.emit("message:sent",O),[3,5];case 4:return E=T.sent(),this.logger.error("error while forwarding message",E),w.senderStatus=ir.FAILED,this.host.models.Message.inject(w),[3,5];case 5:return this.host.events.resumeEventQueue(),[2,w]}}))}))},e.prototype.forwardToUser=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,h,p,v,y;return Hi(this,(function(g){switch(g.label){case 0:if(!this.config.condensedReplays)return[2,this.forward.apply(this,Yi([t,e],n))];if(r=n[0],i=(o=void 0===r?{}:r).organizationId,s=o.senderId,a=void 0===s?this.host.currentUserId:s,u=o.groupName,c=o.groupMetadata,!i)throw new Error("organizationId is required");return e=this._resolveModelIdWithTypes(e,"user"),(l=this._resolveEntity(e,"user"))&&l.profileByOrganizationId&&l.profileByOrganizationId[i]?[3,2]:[4,this.host.users.find(e,{organizationId:i})];case 1:l=g.sent(),g.label=2;case 2:return[4,this.__resolveRoleBotId(a,i)];case 3:return d=g.sent(),f=d.isRole,h=d.roleBotId,f?[4,this.__prepareRoleP2PGroup(i,e,h,u,{groupMetadata:c})]:[3,5];case 4:return p=g.sent(),[2,this.forwardToGroup(t,p,qi(qi({},o),{organizationId:i,senderId:a}))];case 5:if(v=l&&l.profileByOrganizationId[i],!(y=v&&v.conversationId))throw new Error("conversationId not found for p2p message");return this.host.conversations.getById(y)||this.host.models.Conversation.inject({counterPartyId:l.id,counterPartyType:l.$entityType,id:y,organizationId:i}),[2,this.forwardToConversation.apply(this,Yi([t,y],n))]}}))}))},e.prototype.forwardToGroup=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return Gi(this,void 0,void 0,(function(){var r;return Hi(this,(function(o){switch(o.label){case 0:return this.config.condensedReplays?(e=this._resolveModelId(e),(r=this._resolveEntity(e,"group"))?[3,2]:[4,this.host.groups.find(e)]):[2,this.forward.apply(this,Yi([t,e],n))];case 1:r=o.sent(),o.label=2;case 2:if(!r||!r.conversationId)throw new Error("group "+e+" not found");return this.host.conversations.getById(r.conversationId)||this.host.models.Conversation.inject({counterPartyId:r.id,counterPartyType:r.$entityType,id:r.conversationId,organizationId:r.organizationId}),[2,this.forwardToConversation.apply(this,Yi([t,r.conversationId],n))]}}))}))},e.prototype.forwardToDistributionList=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r;return Hi(this,(function(o){switch(o.label){case 0:return this.config.condensedReplays?(e=this._resolveModelId(e),(r=this._resolveEntity(e,"distributionList"))?[3,2]:[4,this.host.distributionLists.find(e)]):[2,this.forward(t,e,n)];case 1:r=o.sent(),o.label=2;case 2:if(!r||!r.conversationId)throw new Error("distributionList "+e+" not found");return this.host.conversations.getById(r.conversationId)||this.host.models.Conversation.inject({counterPartyId:r.id,counterPartyType:r.$entityType,id:r.conversationId,organizationId:r.organizationId}),[2,this.forwardToConversation(t,r.conversationId,n)]}}))}))},e.prototype.forwardToGroupOfUsers=function(t,e,n){void 0===n&&(n={});var r=n.groupMetadata,o=n.groupName,i=n.organizationId,s=n.senderId,a=Wi(n,["groupMetadata","groupName","organizationId","senderId"]);return Gi(this,void 0,void 0,(function(){var n,u;return Hi(this,(function(c){switch(c.label){case 0:return[4,this.__prepareGroupForUsers(i,e,s,o,!1,{groupMetadata:r})];case 1:return n=c.sent(),this.config.condensedReplays?(u=n.conversationId,[4,this.host.conversations.find(u)]):[3,3];case 2:return c.sent(),[2,this.forwardToConversation(t,u,qi(qi({},a),{organizationId:i,senderId:s}))];case 3:return[2,this.forwardToGroup(t,n,qi(qi({},a),{organizationId:i,senderId:s}))]}}))}))},e.prototype.forwardToRole=function(t,e,n){return void 0===n&&(n={}),Gi(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d;return Hi(this,(function(f){switch(f.label){case 0:if(r=n.organizationId,o=n.senderId,i=void 0===o?this.host.currentUserId:o,s=n.groupMetadata,a=n.groupName,!this.host.config.condensedReplays)return[3,2];if(!r)throw new Error("organizationId is required");return[4,this.__resolveRoleBotId(e,r)];case 1:if(u=f.sent(),c=u.isRole,l=u.roleBotId,!c)throw new Error("recipient must be a role");e=l,f.label=2;case 2:return[4,this.__prepareRoleP2PGroup(r,e,i,a,{groupMetadata:s})];case 3:return d=f.sent(),[2,this.forwardToGroup(t,d.id,qi(qi({},n),{organizationId:r,senderId:i}))]}}))}))},e.prototype.forward=function(t,e,n){var r=void 0===n?{}:n,o=r.organizationId,i=r.senderOrganizationId,s=void 0===i?o:i,a=r.recipientOrganizationId,u=void 0===a?s:a,c=r.groupMetadata,l=r.groupName,d=r.metadata,f=void 0===d?[]:d,p=(r.preferExistingGroup,r.priority),v=r.retrieveMessage,y=void 0!==v&&v,g=r.senderId,m=void 0===g?this.host.currentUserId:g;return Gi(this,void 0,void 0,(function(){var n,r,i,a,d,v,g,_,b,w,I,O,E,T,S,A,C,R,P=this;return Hi(this,(function(j){switch(j.label){case 0:if(this.config.condensedReplays)throw new Error("the forward() method has been deprecated in favor of forwardToUser(), forwardToGroup(), etc.");if(this.host.requireUser(),!(n=this._resolveMessage(t)))throw new zn.NotFoundError(this.host.models.Message.name,t);if(r=n.attachments,i=n.body,!(a=n.serverId))throw new Error("original message was not sent");return m=this.__resolveSenderId({senderId:m}),Array.isArray(e)?(d=e.map((function(t){return P._resolveModelIdWithTypes(t,["user","role"])})),[4,this.__prepareGroupForUsers(o,d,m,l,!1,{groupMetadata:c})]):[3,2];case 1:E=j.sent(),e=E.id,j.label=2;case 2:return void 0===p&&(p=n.priority),[4,this.__resolveCounterPartyEntityAndOrganizationId(e,s)];case 3:return v=j.sent(),g=v.counterParty,(_=v.organizationId)&&(s=u=_),u=u||s,g&&(e=g.serverId),[4,this.__resolveSender({organizationId:o,senderId:m,senderOrganizationId:s})];case 4:return b=j.sent(),w=function(t){return t&&"user"===t.$entityType},I=function(t){return w(t)&&t.isRoleBot},O=h.a.get(n,"originalMetadata"),I(g)||w(g)&&I(b)?[4,this.__prepareRoleP2PGroup(o,g.id,m,l,{groupMetadata:c})]:[3,6];case 5:E=j.sent(),g=E,e=E.id,j.label=6;case 6:to.c.notEmpty("entityId",e,"entityId not found"),T={metadata:f,priority:p,senderId:m,originalMetadata:O},T=this.__normalizeSendOptions(T,{counterParty:g,senderOrganizationId:s}),f=T.metadata,(S=this.__createNewMessage(g,i,qi({organizationId:o,senderOrganizationId:s,recipientOrganizationId:u,isForwarded:!0},T))).attachments=r,this.__setForwardedMessageProperties({origMessage:n,organizationId:o,message:S}),this.host.events.deferEventQueue(),this.host.models.Message.inject(S),this.host.emit("message:sending",S),j.label=7;case 7:return j.trys.push([7,12,,13]),[4,this.host.api.messages.forward(a,e,{localId:S.id,metadata:f,priority:er.toServer(p),recipientOrganizationId:u,senderOrganizationId:s})];case 8:return A=j.sent(),C=A.message_id,y?[4,this.find(C,{instance:S,replace:!0})]:[3,10];case 9:return S=j.sent(),[3,11];case 10:S.senderStatus=ir.SENT,S.serverId=C,S.$synced=void 0,this.host.models.Message.inject(S),j.label=11;case 11:return this.host.emit("message:sent",S),[3,13];case 12:return R=j.sent(),this.logger.error("error while forwarding message",R),S.senderStatus=ir.FAILED,this.host.models.Message.inject(S),[3,13];case 13:return this.host.events.resumeEventQueue(),[2,S]}}))}))},e.prototype.__setForwardedMessageProperties=function(t){var e=t.origMessage,n=t.organizationId,r=t.message,o=e.createdAt,i=e.currentSenderRole,s=e.originalForwardedMessageCreatedAt,a=e.originalMessageId,u=e.originalSender,c=e.originalSenderRole,l=e.sender,d=e.senderRole,f=e.serverId,h=e.subType;return r.originalForwardedMessageCreatedAt||(r.originalForwardedMessageCreatedAt=s||o),r.originalMessageId||(r.originalMessageId=a||f),r.originalSender?r.originalSender=u:l&&(r.originalSender={displayName:l.displayName,id:l.id,organizationId:n}),r.originalSenderRole||(h===sr.ROLE_AWAY_NOTIFICATION&&i?r.originalSenderRole={$entityType:"role",botUserId:i.botUserId,displayName:i.displayName,id:i.id,organizationId:n}:c?r.originalSenderRole=qi({},c):d&&(r.originalSenderRole=qi({},d))),r.subType||(r.subType=h),r},e.prototype.reactToMessageStatusEvent=function(t){var e=t.data;if(this.config.condensedReplays)this.reactToMessageStatusEventCR({data:e});else{var n=(e=Object(to.l)(e)).client_id,r=e.is_recalled,o=this.host.models.Message.get(n);o&&(r?this.host.models.Message.eject(o):(this.__injectMessageStatus(o,e),rr[o.markedRecipientStatus]<rr[or.DELIVERED]&&this.markAsReceived(o)))}},e.prototype.reactToMessageStatusEventCR=function(t){var e=t.data,n=(e=Object(to.l)(e)).client_id,r=e.is_recalled,o=e.is_unread,i=this.host.models.Message.get(n);if(i){e.conversation_id||(e.conversation_id=i.conversationId);var s=this.host.conversations.getById(e.conversation_id);s&&(r?this.host.models.Message.eject(i):(i.shouldEnsureRecipientStatus=!0,void 0!==o&&(i.isUnread=o),this.host.models.Message.inject(i),s._markingAsReadSortNumber&&i.sortNumber>=s._markingAsReadSortNumber&&this.host.conversations.__clearOptimisticStatus([s])),this.host.conversations.__injectConversation(e))}},e.prototype.__injectMessageStatus=function(t,e){if(t){var n=e.account_id||e.accountId,r={createdAt:e.timestamp||e.createdAt,id:t.id+":"+n,messageId:t.id,status:or.resolve(e.status)};return"distributionList"===t.counterPartyType?r.distributionListId=n:(r.userId=n,this.host.models.User.ensureEntity(n,{onlyPlaceholder:!0})),this.host.models.MessageStatusPerRecipient.inject(r)}},e.prototype._findCR=function(t,e){var n=void 0===e?{}:e,r=n.includeCounterParty,o=void 0===r||r,i=n.includeStatuses,s=void 0===i||i,a=n.instance,u=n.replace,c=void 0!==u&&u;return Gi(this,void 0,void 0,(function(){var e,n,r,i,u,l;return Hi(this,(function(d){switch(d.label){case 0:return this.host.requireUser(),[4,this.host.api.messages.find(t)];case 1:return(e=d.sent())&&(n=e.message)?(n.conversationId=e.conversation_id,a&&c&&this.__setDefaultAttributes(n,{instance:a}),o?(r=n.recipient_token,i=n.sender_organization,[4,this.__lookupCounterParty(r,{organizationId:i})]):[3,3]):[2,null];case 2:if(!(u=d.sent()))return[2,null];n.counterParty=u,n.conversationHandle||(n.conversationHandle=this.host.conversations.getConversationKey(u.$entityType,u.serverId,i)),d.label=3;case 3:return(l=c?this.host.models.Message.replaceExisting(n,{instance:a}):this.host.models.Message.inject(n)).$synced=void 0,s?[4,this.findRecipientStatus(l,{queue:!1})]:[3,5];case 4:d.sent(),d.label=5;case 5:return[2,l]}}))}))},e.prototype.find=function(t,e){var n=void 0===e?{}:e,r=n.includeCounterParty,o=void 0===r||r,i=n.includeStatuses,s=void 0===i||i,a=n.instance,u=n.replace,c=void 0!==u&&u;return Gi(this,void 0,void 0,(function(){var e,n,r,i,u;return Hi(this,(function(l){switch(l.label){case 0:return this.config.condensedReplays?[4,this._findCR(t,{includeCounterParty:o,includeStatuses:s,instance:a,replace:c})]:[3,2];case 1:return[2,l.sent()];case 2:return this.host.requireUser(),[4,this.host.api.messages.find(t)];case 3:return(e=l.sent())?(a&&c&&this.__setDefaultAttributes(e,{instance:a}),o?(n=e.recipient_token,r=e.sender_organization,[4,this.__lookupCounterParty(n,{organizationId:r})]):[3,5]):[2,null];case 4:if(!(i=l.sent()))return[2,null];e.counterParty=i,this.config.condensedReplays||e.conversationId||(e.conversationId=this.host.conversations.getConversationKey(i.$entityType,i.serverId,r)),l.label=5;case 5:return(u=c?this.host.models.Message.replaceExisting(e,{instance:a}):this.host.models.Message.inject(e)).$synced=void 0,s?[4,this.findRecipientStatus(u,{queue:!1})]:[3,7];case 6:l.sent(),l.label=7;case 7:return[2,u]}}))}))},e.prototype.findAttachment=function(t,e){return Gi(this,void 0,void 0,(function(){var n,r,o;return Hi(this,(function(i){switch(i.label){case 0:return n=this._resolveMessage(t),r=!1,n?[3,2]:(r=!0,[4,this.find(t,{includeStatuses:!1,includeCounterParty:!1})]);case 1:n=i.sent(),i.label=2;case 2:return n?!(o=this.__getMessageAttachment(n,e))||o.isLocal||r||"name"in o?[3,4]:[4,this.find(t,{includeStatuses:!1,includeCounterParty:!1})]:[2,null];case 3:n=i.sent(),(o=this.__getMessageAttachment(n,e)).name||(o.name=null),i.label=4;case 4:return[2,o]}}))}))},e.prototype.getById=function(t){return this.host.models.Message.get(t)},e.prototype.getMultiById=function(t){return this.host.models.Message.getMulti(t)},e.prototype.__lookupCounterParty=function(t,e){var n=(void 0===e?{}:e).organizationId;return Gi(this,void 0,void 0,(function(){var e,r,o,i,s,a,u,c,l,d=this;return Hi(this,(function(f){switch(f.label){case 0:for(e=[{model:this.host.models.User,finder:function(){return d.host.users.find(t,{organizationId:n})}},{model:this.host.models.Group,finder:function(){return d.host.groups.find(t)}},{model:this.host.models.DistributionList,finder:function(){return d.host.distributionLists.find(t)}}],r=0,o=e;r<o.length;r++)if(i=o[r].model,c=i.get(t))return[2,c];s=0,a=e,f.label=1;case 1:if(!(s<a.length))return[3,6];u=a[s].finder,f.label=2;case 2:return f.trys.push([2,4,,5]),[4,u()];case 3:return(c=f.sent())?[2,c]:[3,5];case 4:if((l=f.sent()).code!==zn.NotFoundError.CODE)throw l;return[3,5];case 5:return s++,[3,1];case 6:return[2,null]}}))}))},e.prototype._isMessageOutgoing=function(t){var e=t.counterParty,n=t.counterPartyType,r=t.currentSenderRole,o=t.senderId;if(!o)return!1;for(var i=this.host,s=i.currentUser,a=i.currentUserId,u=e||{},c=u.groupType,l=u.members,d=u.p2pRecipient,f=u.p2pSender,h="group"===n&&c===tr.ROLE_P2P,p=s.roles,v=[a],y=[],g=0,m=0,_=p;m<_.length;m++){var b=_[m].botUserId;v.push(b)}if(l){for(var w=0,I=l;w<I.length;w++){var O=I[w],E=O.botRole;O.isRoleBot&&E&&!y.includes(E)&&y.push(E)}if(h){if(f){E=f.botRole;f.isRoleBot&&E&&!y.includes(E)&&y.push(E)}if(d){E=d.botRole;d.isRoleBot&&E&&!y.includes(E)&&y.push(E)}}for(var T=0,S=y;T<S.length;T++){var A=S[T];p.includes(A)&&g++}}return h?!(d===s&&o===a&&!r)&&(!(!f||o!==f.id&&o!==f.botUserId)||p.includes(r)&&(1===g||r===f)):"distributionList"===n||(p.includes(r)||v.includes(o))},e.prototype._setRecipientStatus=function(t){for(var e,n,r=t.__organizationId,o=t._markingAsStatus,i=t.conversation,s=t.counterParty,a=t.counterPartyType,u=t.createdAt,c=t.deleteOnRead,l=t.expiresAt,d=t.isOutgoing,f=t.messageType,h=t.senderId,p=t.statusesPerRecipient,v=t.ttl,y=this.host,g=y.currentUser,m=y.currentUserId,_=s||{},b=_.groupType,w=_.p2pRecipient,I=[],O=[],E=[m],T=0,S=g.roles;T<S.length;T++){var A=S[T];A.organizationId===r&&E.push(A.botUserId)}for(var C=h&&E.includes(h),R=[],P=or.READ,j=or.NEW,x=b===tr.ROLE_P2P&&w===g,M=0,k=p;M<k.length;M++){var N=(L=k[M]).userId;(q=E.includes(N))&&R.push(N)}for(var z=R.length>1,D=0,U=p;D<U.length;D++){var L,F=(L=U[D]).distributionListId,B=(N=L.userId,L.status),q=E.includes(N);x||!(!d&&q)&&!(d&&(F||!q))||z&&N===m||O.push(B),(x||C&&E.includes(h))&&(rr[j]<rr[B]&&(j=B),rr[j]<rr[or.READ]&&(j=or.READ)),!q||x||C&&h===N||I.push(B)}if(O.length>0){n=O[0];for(var V=1;V<O.length;V++){var G=O[V];0===R.length?rr[n]<rr[G]&&(n=G):rr[n]>rr[G]&&(n=G)}}else n=j;if(e=P,I.length>0)for(var H=0,W=I;H<W.length;H++){G=W[H];rr[e]>rr[G]&&(e=G)}if(this.config.condensedReplays&&i&&i._markingAsRead&&i._markingAsReadSortNumber>=t.sortNumber&&(n=or.READ),o){var Y=!1;rr[n]<rr[o]&&(n=o,Y=!0),!this.config.condensedReplays&&d&&rr[e]<rr[o]&&(e=o,Y=!0),Y||this.config.condensedReplays||(t._markingAsStatus=void 0)}if(c&&"user"===a&&n===or.READ){var K=Date.now()+6e4;(!l||K<l)&&(l=K)}else l||void 0===v||(l=u.getTime()+60*v*1e3);t.expiresAt=l,this.config.condensedReplays?t.isUnread=!t.isEphemeral&&t.isUnread:(t.isUnread=!t.isEphemeral&&f===ar.USER_SENT&&!d&&-1===this.compareRecipientStatus(n,or.READ),t.markedRecipientStatus=e),t.ttl=v},e.prototype.compareRecipientStatus=function(t,e){return or.isValid(t)&&(t=rr[t]),or.isValid(e)&&(e=rr[e]),t>e?1:t===e?0:t<e?-1:void 0},e.prototype.__getMessageAttachment=function(t,e){var n=this._resolveMessage(t);return n?(e=e.toString(),n.attachments?h.a.find(n.attachments,{id:e}):null):null},e.prototype.__getAttachmentPath=function(t,e){return"/"+this.host.api.messages.getVersion().version+"/message/"+t+"/attachment/"+e},e.prototype.downloadAttachmentUrl=function(t,e){return this._downloadAttachmentBlobAndUrl(t,e).then((function(t){return t.url}))},e.prototype.downloadAttachmentBlobAndUrl=function(t,e){return this._downloadAttachmentBlobAndUrl(t,e)},e.prototype.downloadAttachmentUrlWithToken=function(t,e){return this._downloadAttachmentBlobAndUrlWithToken(t,e).then((function(t){return t.url}))},e.prototype.downloadAttachment=function(t,e,n){var r=(void 0===n?{}:n).fileName;return Gi(this,void 0,void 0,(function(){var n,o,i,s;return Hi(this,(function(a){switch(a.label){case 0:return n=this._resolveMessage(t),o=void 0,(i=this.__getMessageAttachment(t,e))&&i.isLocal?(o=i.localFile,[3,3]):[3,1];case 1:return[4,this._downloadAttachmentBlobAndUrl(n.serverId,e)];case 2:o=a.sent().blob,a.label=3;case 3:return(r=r||i.name)||(r="Attachment",n.sender.$placeholder||(r+=" from "+n.sender.displayName),r+=" at "+wo()(n.createdAt).format("YYYY-MM-DD h-mma"),(s=xr({mime:i.contentType}))&&(r+=s.ext)),[4,Object(Fi.downloadFile)({attachmentContentType:i.contentType,blob:o,fileName:r})];case 4:return a.sent(),[3,6];case 5:zn.TargetNotSupportedError.raise(),a.label=6;case 6:return[2]}}))}))},e.prototype._downloadAttachmentBlobAndUrl=function(t,e){return Gi(this,void 0,void 0,(function(){var n,r,o;return Hi(this,(function(i){switch(i.label){case 0:return e=e.toString(),n=this._resolveMessage(t),[4,this.findAttachment(t,e)];case 1:if(!(r=i.sent()))throw new zn.NotFoundError("MessageAttachment",n.serverId+":"+e);return r.isLocal&&r.localFile instanceof Blob?[4,r.localPathPromise]:[3,3];case 2:return i.sent(),[2,{blob:r.localFile,url:URL.createObjectURL(r.localFile)}];case 3:return o=this.__getAttachmentPath(n.serverId,e),[2,this.httpClient.downloadFileBlobAndUrl(o)];case 4:return[3,6];case 5:zn.TargetNotSupportedError.raise(),i.label=6;case 6:return[2]}}))}))},e.prototype._downloadAttachmentBlobAndUrlWithToken=function(t,e){return Gi(this,void 0,void 0,(function(){var n,r,o,i;return Hi(this,(function(s){switch(s.label){case 0:return e=e.toString(),n=this._resolveMessage(t),[4,this.findAttachment(t,e)];case 1:if(!(r=s.sent()))throw new zn.NotFoundError("MessageAttachment",n.serverId+":"+e);return r.isLocal&&r.localFile instanceof Blob?[4,r.localPathPromise]:[3,3];case 2:return o=s.sent(),[2,{blob:r.localFile,url:o}];case 3:return[4,this.getAttachmentUrlWithToken(n.serverId,e)];case 4:return i=s.sent(),[2,this.httpClient.downloadFileBlobAndUrl(i)];case 5:return[3,7];case 6:zn.TargetNotSupportedError.raise(),s.label=7;case 7:return[2]}}))}))},e.prototype.downloadAttachmentToFile=function(t,e,n){return Gi(this,void 0,void 0,(function(){var t,r,o;return Hi(this,(function(i){switch(i.label){case 0:return[3,2];case 1:if(!(r=i.sent()))throw new zn.NotFoundError("MessageAttachment",t.serverId+":"+e);if(/(\/|\\)$/.test(n)){if(!r.name)throw new Error("missing file name in downloadAttachmentToFile(..., dest)");n+=r.name}return o=this.__getAttachmentPath(t.serverId,e),[2,this.httpClient.downloadToFile(o,n)];case 2:zn.TargetNotSupportedError.raise(),i.label=3;case 3:return[2]}}))}))},e.prototype.getMessageCount=function(){return this.host.models.Message.getAll().length},e.prototype.getTotalUnreadCount=function(){var t=this.host.models.Product.getAll()[0];return t?t.unreadCount:0},e.prototype.getTotalUnreadPriorityCount=function(){var t=this.host.models.Product.getAll()[0];return t?t.unreadPriorityCount:0},e.prototype.markAsRead=function(t,e){var n=void 0===e?{}:e,r=n.localOnly,o=void 0!==r&&r,i=n.queue,s=void 0===i?this.host.currentlyServingOfflineMessages:i;return Gi(this,void 0,void 0,(function(){var e,n,r,i,a;return Hi(this,(function(u){if(t=to.e.call(t).map(this._resolveModelId),0===(e=go.a.call(t)).length)return[2];if(this.config.condensedReplays||!o)return s?[2,this.__queueSetMessageStatuses({readIds:e})]:[2,this.__setMessagesStatus({readIds:e})];for(n=this.host.models.Message.getMulti(e),r=0,i=n;r<i.length;r++)(a=i[r])&&(a._markingAsStatus=or.READ,this.host.models.Message.inject(a));return[2]}))}))},e.prototype.markAsDelivered=function(t,e){return void 0===e&&(e={}),Gi(this,void 0,void 0,(function(){var n;return Hi(this,(function(r){return e=h.a.defaults(e,{queue:this.host.currentlyServingOfflineMessages}),t=to.e.call(t).map(this._resolveModelId),0===(n=go.a.call(t)).length?[2]:e.queue?[2,this.__queueSetMessageStatuses({deliveredIds:n})]:[2,this.__setMessagesStatus({deliveredIds:n})]}))}))},e.prototype.markAsReceived=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Gi(this,void 0,void 0,(function(){return Hi(this,(function(e){return[2,this.markAsDelivered.apply(this,t)]}))}))},e.prototype.__queueSetMessageStatuses=function(t){var e=t.deliveredIds,n=t.readIds;return Gi(this,void 0,void 0,(function(){var t;return Hi(this,(function(r){return t=this._queuedSetMessageStatuses,e&&(t.deliveredIds=h.a.union(t.deliveredIds,e)),n&&(t.readIds=h.a.union(t.readIds,n)),t.deliveredIds.length+t.readIds.length>=this.config.flushSetMessageStatusMaxCount?(this.logger.log("reached "+this.config.flushSetMessageStatusMaxCount+" -- flushing"),[2,this.__flushSetMessageStatusesQueue()]):(this._throttled_flushSetMessageStatusesQueue(),[2])}))}))},e.prototype.__setMessagesStatus=function(t){var e=t.deliveredIds,n=void 0===e?[]:e,r=t.readIds,o=void 0===r?[]:r;return Gi(this,void 0,void 0,(function(){var t,e,r,i,s,a,u,c,l,d,f,p,v,y,g,m,_,b,w,I,O,E,T;return Hi(this,(function(S){switch(S.label){case 0:if(this.host.requireUser(),n=n.map(this._resolveModelId),o=o.map(this._resolveModelId),t=go.a.call(n),e=go.a.call(o),this.config.condensedReplays?t=h.a.difference(t,e):(r=this.host.models.Message.getMulti(t).filter((function(t){return t&&rr[t.markedRecipientStatus]>=rr[or.DELIVERED]})),i=r.map((function(t){return t.id})),s=this.host.models.Message.getMulti(e).filter((function(t){return t&&rr[t.markedRecipientStatus]>=rr[or.READ]})),a=s.map((function(t){return t.id})),e=h.a.difference(e,a),t=h.a.difference(t,e,i)),u={},t.length>0&&(u.delivered=t),e.length>0)for(u.read=e,I=this.host.models.Message.getMulti(e),c=0,l=I;c<l.length;c++)(T=l[c])&&(T._markingAsStatus=or.READ,this.host.models.Message.inject(T));if(0===Object.keys(u).length)return[2,!1];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,this.host.api.messages.updateRecipientStatusMulti(u)];case 2:if(d=S.sent(),this.config.condensedReplays)for(f=0,p=Object.entries(d);f<p.length;f++)v=p[f],y=v[0],g=v[1],m=g.unread_message_count,_=g.unread_priority_message_count,(b=this.host.models.Conversation.get(y))&&(b.unreadMessageCount=m,b.unreadPriorityMessageCount=_,this.host.models.Conversation.inject(b));return[3,4];case 3:for(w=S.sent(),I=this.host.models.Message.getMulti(e),O=0,E=I;O<E.length;O++)(T=E[O])&&T._markingAsStatus&&(T._markingAsStatus=void 0,this.host.models.Message.inject(T));return[2,Promise.reject(w)];case 4:return[2,!0]}}))}))},e.prototype.setMessageTTLInMinutes=function(t,e){var n=this._resolveMessage(t);if(n){var r=wo()().add(e,"minute").toDate().getTime();this.host.models.Message.inject({id:n.id,ttl:e,expiresAt:r})}},e.prototype._clearOptimisticMarkAsReadState=function(t){void 0===t&&(t=Date.now()),t.getTime&&(t=t.getTime());for(var e=0,n=this.host.organizations.getAll();e<n.length;e++)for(var r=n[e].__markingAsReadConversations,o=!1;!o&&r.length>0;){var i=r[0],s=this.host.conversations.getById(i.id);if(!s)return;s._markingAsReadExpiration<t?(s._markingAsRead=!1,s._markingAsReadSortNumber=null,s._markingAsReadExpiration=null,this.host.models.Conversation.inject(s),this.host.conversations.find(s.id,{ensureEntities:!1})):o=!0}},e.prototype.ensureRecipientStatus=function(t,e){var n=void 0===e?{}:e,r=n.includeUsers,o=void 0===r||r,i=n.queue,s=void 0===i||i;return Gi(this,void 0,void 0,(function(){var e,n,r,i,a,u,c,l,d,f;return Hi(this,(function(h){switch(h.label){case 0:if(this.host.requireUser(),t=this._resolveModelId(t),!(e=this._resolveMessage(t)))return[2,null];if(n=e.counterPartyType,r=e.senderStatus,i=e.shouldEnsureRecipientStatus,a=e.statusesPerRecipient,r===ir.SENDING)return[2,null];if("distributionList"===n)return[2,null];if(!i&&a.length>0){if(u=!1,o)for(c=0,l=a;c<l.length;c++)l[c].user||(u=!0);if(!u)return[2,a]}return s?[4,this.__queueFindRecipientStatuses([{id:t,includeUsers:o}])]:[3,2];case 1:return f=h.sent(),d=f[0],[3,4];case 2:return[4,this.__findRecipientStatus(t,{includeUsers:o})];case 3:d=h.sent(),h.label=4;case 4:return[2,d]}}))}))},e.prototype.findRecipientStatus=function(t,e){var n=void 0===e?{}:e,r=n.includeUsers,o=void 0!==r&&r,i=n.queue,s=void 0===i||i;return Gi(this,void 0,void 0,(function(){var e,n,r;return Hi(this,(function(i){switch(i.label){case 0:return this.host.requireUser(),(e=this._resolveMessage(t))?e.senderStatus===ir.SENDING||"distributionList"===e.counterPartyType?[2,null]:(t=this._resolveModelId(t),s?[4,this.__queueFindRecipientStatuses([{id:t,includeUsers:o}])]:[3,2]):[2,null];case 1:return r=i.sent(),n=r[0],[3,4];case 2:return[4,this.__findRecipientStatus(t,{includeUsers:o})];case 3:n=i.sent(),i.label=4;case 4:return[2,n]}}))}))},e.prototype.ensureRecipientStatusMulti=function(t,e){var n=void 0===e?{}:e,r=n.includeUsers,o=void 0===r||r,i=n.queue,s=void 0===i||i;return Gi(this,void 0,void 0,(function(){var e,n,r,i,a,u,c,l,d,f,h,p,v,y,g,m,_,b,w;return Hi(this,(function(I){switch(I.label){case 0:for(t=to.e.call(t).map(this._resolveModelId),e=go.a.call(t),n=[],r={},i=0,a=e;i<a.length;i++){if(w=a[i],y={id:w,includeUsers:o},u=this._resolveMessage(w),c=!0,u&&(l=u.shouldEnsureRecipientStatus,d=u.statusesPerRecipient,!l&&d.length>0&&(c=!1,o)))for(f=0,h=d;f<h.length;f++)h[f].user||(c=!0);c?n.push(y):r[y.id]=u.statusesPerRecipient}return 0===n.length?[2]:s?[4,this.__queueFindRecipientStatuses(n)]:[3,2];case 1:return p=I.sent(),[3,4];case 2:return[4,this.__findRecipientStatusMulti(n)];case 3:p=I.sent(),I.label=4;case 4:if(p)for(v=0;v<n.length;v++)p.length>v&&(y=n[v],g=p[v],r[y.id]=g);for(m=[],_=0,b=e;_<b.length;_++)w=b[_],m.push(r[w]);return[2,m]}}))}))},e.prototype.findRecipientStatusMulti=function(t,e){var n=void 0===e?{}:e,r=n.includeUsers,o=void 0!==r&&r,i=n.queue,s=void 0!==i&&i;return Gi(this,void 0,void 0,(function(){var e,n,r,i,a,u;return Hi(this,(function(c){for(t=to.e.call(t).map(this._resolveModelId),e=go.a.call(t),n=[],r=0,i=e;r<i.length;r++)a=i[r],u={id:a,includeUsers:o},n.push(u);return 0===n.length?[2]:s?[2,this.__queueFindRecipientStatuses(n)]:[2,this.__findRecipientStatusMulti(n)]}))}))},e.prototype.__queueFindRecipientStatuses=function(t){return Gi(this,void 0,void 0,(function(){var e,n,r,o,i,s,a,u;return Hi(this,(function(c){switch(c.label){case 0:for(e=[],n=function(t,n){var o,i,s=!0;e.push(new Promise((function(t,e){o=t,i=e})));for(var a=0,u=r._queuedFindRecipientStatuses;a<u.length;a++){var c=u[a];if(t===c.id){c.includeUsers=c.includeUsers||n,c.onCompletes.push(o),c.onErrors.push(i),s=!1;break}}s&&r._queuedFindRecipientStatuses.push({id:t,includeUsers:n,onCompletes:[o],onErrors:[i]})},r=this,o=0,i=t;o<i.length;o++)s=i[o],a=s.id,u=s.includeUsers,n(a,u);return this._queuedFindRecipientStatuses.length>=this.config.flushFindRecipientStatusMaxCount?(this.logger.log("reached "+this.config.flushFindRecipientStatusMaxCount+" -- flushing"),this.__flushFindRecipientStatusesQueue()):this._queuedFindRecipientStatuses.length>0&&this._throttled_flushFindRecipientStatusesQueue(),[4,Promise.all(e)];case 1:return[2,c.sent()]}}))}))},e.prototype.__flushFindRecipientStatusesQueue=function(){return Gi(this,void 0,void 0,(function(){var t,e,n,r,o,i;return Hi(this,(function(s){switch(s.label){case 0:if(0===this._queuedFindRecipientStatuses.length)return[2];t=this._queuedFindRecipientStatuses,this._queuedFindRecipientStatuses=[],s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this.__findRecipientStatusMulti(t)];case 2:return n=s.sent(),[3,5];case 3:return r=s.sent(),e=r,[3,5];case 4:for(o=function(r){var o;n&&n.length>r&&(o=n[r]);var i=t[r],s=i.onCompletes,a=i.onErrors;if(e)for(var u=function(t){setTimeout((function(){return t(e)}),0)},c=0,l=a;c<l.length;c++){u(l[c])}else for(var d=function(t){setTimeout((function(){return t(o)}),0)},f=0,h=s;f<h.length;f++){d(h[f])}},i=0;i<t.length;i++)o(i);return[7];case 5:return[2]}}))}))},e.prototype.__findRecipientStatus=function(t,e){var n=e.includeUsers;return Gi(this,void 0,void 0,(function(){var e,r,o,i,s,a,u,c,l,d,f,h,p,v=this;return Hi(this,(function(y){switch(y.label){case 0:if(this.host.requireUser(),e=this._resolveMessage(t),r=!1,this._pendingFindRecipientStatuses[e.id])return[2,null];y.label=1;case 1:return y.trys.push([1,,3,4]),i=new Promise((function(t,n){v._pendingFindRecipientStatuses[e.id]=function(){return t(null)}})),[4,Promise.race([i,this.host.api.messages.findRecipientStatus(e.serverId)])];case 2:return o=y.sent(),[3,4];case 3:return delete this._pendingFindRecipientStatuses[e.id],[7];case 4:if(!o)return[2,null];if(o.is_recalled)return this.host.models.Message.eject(e),[2,null];for(s=0,a=o.statuses;s<a.length;s++)u=a[s],this.__injectMessageStatus(e,u);if(!n)return[3,6];for(c=e.recipientOrganizationId,l=e.statusesPerRecipient,d=[],f=0,h=l;f<h.length;f++)(p=h[f].userId)&&d.push(p);return[4,this.host.users.ensureUsers(d,c)];case 5:y.sent(),r=!0,y.label=6;case 6:return e.shouldEnsureRecipientStatus&&(e.shouldEnsureRecipientStatus=!1,r=!0),r&&this.host.models.Message.inject(e),!this.config.condensedReplays&&rr[e.markedRecipientStatus]<rr[or.DELIVERED]&&this.markAsReceived(e),[2,e.statusesPerRecipient]}}))}))},e.prototype.__findRecipientStatusMulti=function(t){return Gi(this,void 0,void 0,(function(){var e,n,r,o,i,s,a,u,c,l,d,f,p,v,y,g,m,_,b,w,I,O,E,T,S,A,C,R,P,j,x,M,k,N,z,D,U,L;return Hi(this,(function(F){switch(F.label){case 0:for(this.host.requireUser(),e={},n=t,t=[],r=0,o=n;r<o.length;r++)i=o[r],U=i.id,O=i.includeUsers,k=this._resolveMessage(U),a=(s=k||{}).counterParty,u=s.serverId,c={id:U,includeUsers:O,message:k},t.push(c),u&&(this._pendingFindRecipientStatuses[u]||a&&"distributionList"===a.$entityType||(c.id=u,e[u]=!0));l=h.a.chunk(Object.keys(e),20),d={},f={},p=function(t){var e,n,r,o,i,s,a,u,c,l,h,p,y,g,m,_,b,w,I,O;return Hi(this,(function(E){switch(E.label){case 0:e=void 0,E.label=1;case 1:for(E.trys.push([1,,3,4]),n={},r=function(t){v._pendingFindRecipientStatuses[t]=function(){n[t]=!0}},o=0,i=t;o<i.length;o++)h=i[o],r(h);return[4,v.host.api.messages.findRecipientStatusMulti(t)];case 2:for(s=E.sent(),e=[],a=0,u=s;a<u.length;a++)g=u[a],h=g.client_id,n[h]||e.push(g);return[3,4];case 3:for(c=0,l=t;c<l.length;c++)h=l[c],delete v._pendingFindRecipientStatuses[h];return[7];case 4:if(!e)return[2,{value:[]}];for(p=0,y=e;p<y.length;p++)if(g=y[p],m=g.client_id,_=g.statuses,b=v.host.models.Message.get(m),g.is_recalled)v.host.models.Message.eject(b),f[m]=!0;else if(_&&_.length>0){for(w=0,I=_;w<I.length;w++)O=I[w],v.__injectMessageStatus(b,O);d[m]=b}return[2]}}))},v=this,y=0,g=l,F.label=1;case 1:return y<g.length?(m=g[y],[5,p(m)]):[3,4];case 2:if("object"==typeof(_=F.sent()))return[2,_.value];F.label=3;case 3:return y++,[3,1];case 4:b=0,w=t,F.label=5;case 5:if(!(b<w.length))return[3,9];if(I=w[b],O=I.includeUsers,k=I.message,E=!1,!k||f[k.serverId])return[3,8];if(T=k.recipientOrganizationId,S=k.shouldEnsureRecipientStatus,A=k.statusesPerRecipient,!O)return[3,7];for(C=[],R=0,P=A;R<P.length;R++)(j=P[R].userId)&&C.push(j);return[4,this.host.users.ensureUsers(C,T)];case 6:F.sent(),E=!0,F.label=7;case 7:S&&(k.shouldEnsureRecipientStatus=!1,E=!0),E&&this.host.models.Message.inject(k),F.label=8;case 8:return b++,[3,5];case 9:if(!this.config.condensedReplays)for(x=0,M=Object.values(d);x<M.length;x++)k=M[x],rr[k.markedRecipientStatus]<rr[or.DELIVERED]&&this.markAsReceived(k);for(N=[],z=0,D=t;z<D.length;z++)U=D[z].id,L=d[U],N.push(L?L.statusesPerRecipient:null);return[2,N]}}))}))},Vi([Object(Or.decorator)()],e.prototype,"__prepareGroupForUsers",null),Vi([Object(Or.decorator)()],e.prototype,"__prepareRoleP2PGroup",null),Vi([Object(Or.decorator)({serializeArguments:function(t){return t[0]}})],e.prototype,"find",null),Vi([Object(Or.decorator)({memoize:!0})],e.prototype,"downloadAttachmentUrl",null),Vi([Object(Or.decorator)({memoize:!0})],e.prototype,"downloadAttachmentBlobAndUrl",null),Vi([Object(Or.decorator)()],e.prototype,"downloadAttachment",null),Vi([Object(Or.decorator)({memoize:!0})],e.prototype,"_downloadAttachmentBlobAndUrl",null),Vi([Object(Or.decorator)({serializeArguments:function(t){return"object"==typeof t[0]?t[0].id:t[0]}})],e.prototype,"findRecipientStatus",null),Vi([Object(Or.decorator)({serializeArguments:function(t){return t[0].map((function(t){return"object"==typeof t?t.id:t})).join(":")}})],e.prototype,"findRecipientStatusMulti",null),e}(no),Qi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zi=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ji=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ts=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},es=["template_label"].join(","),ns=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qi(e,t),e.prototype.batchDelete=function(t){var e=t.ids,n=t.organizationId;return Ji(this,void 0,void 0,(function(){var t=this;return ts(this,(function(r){switch(r.label){case 0:if(!Array.isArray(e))throw new zn.ValidationError("ids","required","ids must be an array");if(!n)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.messageTemplates.batch({ids:e,operation:"destroy",organizationId:n})];case 1:return r.sent(),[2,e.map((function(e){return t.host.models.MessageTemplate.inject({$deleted:!0,id:e})}))]}}))}))},e.prototype.create=function(t){var e=t.attachment,n=t.body,r=t.network,o=void 0===r?"patient":r,i=t.organizationId,s=t.repository,a=void 0===s?"personal":s,u=t.title;return Ji(this,void 0,void 0,(function(){var t,r,s;return ts(this,(function(c){switch(c.label){case 0:if(t=u?u.trim():"",r=n?n.trim():"",this._validate({body:r,organizationId:i,repository:a,shouldCheckId:!1,title:t}),!1===["patient"].includes(o))throw new zn.ValidationError("network","invalid",'network must be "patient"');return[4,this.host.api.messageTemplates.create({attachment:e,body:r,network:o,organizationId:i,repository:a,title:t})];case 1:return s=c.sent(),[2,this.host.models.MessageTemplate.inject(s)]}}))}))},e.prototype.delete=function(t,e){return Ji(this,void 0,void 0,(function(){return ts(this,(function(n){switch(n.label){case 0:return this._validate({id:t,organizationId:e,shouldCheckInvalid:!1}),[4,this.host.api.messageTemplates.delete(t,e)];case 1:return n.sent(),[2,this.host.models.MessageTemplate.inject({$deleted:!0,id:t})]}}))}))},e.prototype.downloadTemplateFile=function(t){var e=t.templateId,n=t.fileName,r=t.organizationId;return Ji(this,void 0,void 0,(function(){var t;return ts(this,(function(o){switch(o.label){case 0:return[4,this.host.api.messageTemplates.downloadTemplateFile({templateId:e,fileName:n,organizationId:r})];case 1:return t=o.sent(),[4,Object(Fi.downloadFile)({attachmentContentType:t.type,blob:t,fileName:n})];case 2:return o.sent(),[2]}}))}))},e.prototype.find=function(t,e){return Ji(this,void 0,void 0,(function(){var n;return ts(this,(function(r){switch(r.label){case 0:return this._validate({id:t,organizationId:e,shouldCheckInvalid:!1}),[4,this.host.api.messageTemplates.find(t,e)];case 1:return n=r.sent(),[2,this.host.models.MessageTemplate.inject(n)]}}))}))},e.prototype.getAll=function(){return this.host.models.MessageTemplate.getAll()},e.prototype.getById=function(t){return this.host.models.MessageTemplate.get(t)},e.prototype.search=function(t){var e=t.continuation,n=t.network,r=void 0===n?"patient":n,o=t.organizationId,i=t.query,s=void 0===i?"":i,a=t.repository,u=void 0===a?"personal":a,c=t.sortBy,l=void 0===c?"title":c,d=t.sortOrder,f=void 0===d?"asc":d;return Ji(this,void 0,void 0,(function(){var t,n,i,a;return ts(this,(function(c){switch(c.label){case 0:return[4,this.host.search.query({continuation:e,network:r,organizationId:o,query:(i={},i[es]=s,i.repository=u,i),returnFields:[],sort:(a={},a[l]=f,a),types:["messageTemplate"]})];case 1:return t=c.sent(),n=this._processSearchResults(t.results),[2,{metadata:t.metadata,results:n}]}}))}))},e.prototype.update=function(t){var e=t.attachment,n=t.body,r=t.id,o=t.organizationId,i=t.repository,s=t.title;return Ji(this,void 0,void 0,(function(){var t,a,u;return ts(this,(function(c){switch(c.label){case 0:return t=s?s.trim():"",a=n?n.trim():"",this._validate({body:a,id:r,organizationId:o,repository:i,title:t}),[4,this.host.api.messageTemplates.update({attachment:e,body:a,id:r,organizationId:o,repository:i,title:t})];case 1:return u=c.sent(),[2,this.host.models.MessageTemplate.inject(u)]}}))}))},e.prototype._processSearchResults=function(t){return t.map((function(t){return t.entity})).filter((function(t){return!t.$deleted}))},e.prototype._validate=function(t){var e=t.body,n=t.id,r=(t.network,t.organizationId),o=t.repository,i=t.shouldCheckId,s=void 0===i||i,a=t.shouldCheckInvalid,u=void 0===a||a,c=t.title;if(s&&!n)throw new zn.ValidationError("id","required");if(!r)throw new zn.ValidationError("organizationId","required");if(u){if(!e||0===e.trim().length)throw new zn.ValidationError("body","invalid","body must be at least 1 character");if(!o||!["general","personal"].includes(o))throw new zn.ValidationError("repository","invalid",'repository must be either "general" or "personal"');if(!c||0===c.trim().length||c.trim().length>60)throw new zn.ValidationError("title","invalid","title must be between 1 and 60 characters")}},Zi([Object(Or.decorator)()],e.prototype,"downloadTemplateFile",null),Zi([Object(Or.decorator)()],e.prototype,"find",null),Zi([Object(Or.decorator)()],e.prototype,"search",null),e}(no),rs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),os=function(){return(os=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},is=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ss=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},as=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},us=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},cs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__parseMessageMetadata=function(t){var e=t.mimetype,n=t.payload,r=e.indexOf(";");if(r>-1&&(e=e.slice(0,r)),"application/json"===e&&"string"==typeof n){var o=void 0;try{o=JSON.parse(n)}catch(e){return console.warn("Invalid metadata payload",t),null}return os(os({},t),{payload:o})}return t},e}return rs(e,t),e.prototype.fullUpdate=function(t,e,n){return ss(this,void 0,void 0,(function(){var r,o,i,s,a;return as(this,(function(u){switch(u.label){case 0:if(!n)throw new zn.ValidationError("organizationId","required");if(this.host.config.maxMetadataKeyCount>0&&Object.keys(e).length>this.host.config.maxMetadataKeyCount)throw new zn.ValidationError("entireData","invalid","Total number of metadata keys is "+Object.keys(e)+" and should not exceed "+this.host.config.maxMetadataKeyCount);for(r=0,o=Object.entries(e);r<o.length;r++)if(i=o[r],s=i[0],"string"!=typeof i[1])throw new zn.ValidationError("value","invalid","Value for metadata key "+s+" must be a string");this.host.requireUser(),t=this._resolveModelId(t),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.host.api.metadata.update(t,e,n)];case 2:return u.sent(),this.__injectMetadata(t,n,e),[2,e];case 3:if((a=u.sent()).response&&404===a.response.status)throw new zn.NotFoundError("metadata",t);return[2,Promise.reject(a)];case 4:return[2]}}))}))},e.prototype.update=function(t,e,n){return ss(this,void 0,void 0,(function(){var r,o;return as(this,(function(i){switch(i.label){case 0:if(!n)throw new zn.ValidationError("organizationId","required");return[4,this.find(t,n,{bypassCache:!0})];case 1:return r=i.sent(),o=Object.assign({},r,e),[2,this.fullUpdate(t,o,n)]}}))}))},e.prototype.find=function(t,e,n){return void 0===n&&(n={}),ss(this,void 0,void 0,(function(){var r,o;return as(this,(function(i){switch(i.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");if(n=h.a.defaults(n,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),t=this._resolveModelId(t),!n.bypassCache&&(r=this.get(t,e)))return[2,r];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.host.api.metadata.find(t,e)];case 2:return r=i.sent(),this.__injectMetadata(t,e,r),[2,r];case 3:if(!(o=i.sent()).response||404!==o.response.status)return[2,Promise.reject(o)];if(!n.ignoreNotFound)throw new zn.NotFoundError("metadata",t);return[3,4];case 4:return[2]}}))}))},e.prototype.findMulti=function(t,e,n){return void 0===n&&(n={}),ss(this,void 0,void 0,(function(){var r,o,i,s=this;return as(this,(function(a){switch(a.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");return this.host.requireUser(),t=h.a.uniq(Object(to.d)(t).map(this._resolveModelId)),r=h.a.chunk(t,20),o=r.map((function(t){return s.__findMultiPaged(t,e,n)})),[4,Promise.all(o)];case 1:return i=a.sent(),[2,h.a.assign.apply(h.a,us([{}],i))]}}))}))},e.prototype.__findMultiPaged=function(t,e,n){return void 0===n&&(n={}),ss(this,void 0,void 0,(function(){var n,r,o,i,s,a,u,c,l,d,f;return as(this,(function(h){switch(h.label){case 0:return[4,this.host.api.entities.findMulti({users:[],metadata:t,organizationId:e})];case 1:for(n=h.sent().metadata,r={},o=0,i=n;o<i.length;o++)for(s=i[o],a=0,u=Object.entries(s);a<u.length;a++)c=u[a],l=c[0],(d=c[1])&&(f=this.__injectMetadata(l,e,d),r[l]=f);return[2,r]}}))}))},e.prototype.get=function(t,e){var n="metadata:"+t+":"+e;return this.host.models.Metadata.get(n)||null},e.prototype.__injectMetadata=function(t,e,n){var r="metadata:"+t+":"+e;return this.host.models.Metadata.inject({id:r,data:n,entityId:t,organizationId:e})},is([Object(Or.decorator)()],e.prototype,"find",null),is([Object(Or.decorator)()],e.prototype,"findMulti",null),e}(no),ls=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ds=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},fs=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},hs=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ps={account:"user",group:"group"},vs=new Set(Object.keys(ps)),ys=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._parseMuteEntry=function(t){var n,r=+t.mute_duration,o=t.mute_start,i=t.caller_organization||t.organization_id;if(o&&(o=1e3*+o),e.config.condensedReplays)n=t.conversation_id;else{var s=ps[t.sender_type],a=t.sender_token;n=e.host.conversations.getConversationKey(s,a,i)}return{conversationId:n,entry:{durationInMinutes:r,organizationId:i,startedAt:o}}},e._addEntry=function(t,n){var r=n.durationInMinutes,o=n.organizationId,i=n.startedAt,s=void 0===i?Date.now():i,a=+s+60*r*1e3;if(!(a<Date.now())){var u=e.host.models.Mute.inject({id:"mute:"+t,conversationId:t,durationInMinutes:r,expiresAt:a,organizationId:o,startedAt:s});if(e.config.condensedReplays){var c=e.host.conversations.getById(t);if(!c)return u;c.muted=u,e.host.models.Conversation.inject(c)}else e._muteEntriesByConversationHandle[t]=u,e.host.models.Conversation.touch(t);return u}},e._removeEntry=function(t){e.config.condensedReplays||delete e._muteEntriesByConversationHandle[t];var n=e.host.conversations.getById(t);n&&n.muted&&(e.host.models.Mute.eject(n.muted),n.muted=null,e.host.models.Conversation.inject(n))},e}return ls(e,t),e.prototype.mounted=function(){this._fetched=!1,this._muteEntriesByConversationHandle={}},e.prototype.dispose=function(){this._fetched=!1,this._muteEntriesByConversationHandle=null},e.prototype.findAll=function(){return fs(this,void 0,void 0,(function(){var t,e,n,r,o,i,s;return hs(this,(function(a){switch(a.label){case 0:return this._fetched?[3,2]:[4,this.host.api.mute.findAll()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)r=n[e],vs.has(r.sender_type)&&(o=this._parseMuteEntry(r),i=o.conversationId,s=o.entry,this._addEntry(i,s));this._fetched=!0,a.label=2;case 2:return[2,Object.values(this._muteEntriesByConversationHandle)]}}))}))},e.prototype._removeAllEntries=function(){if(this.config.condensedReplays)for(var t=0,e=this.host.conversations.getAll();t<e.length;t++){var n=e[t];n.muted&&this._removeEntry(n.id)}else for(var r=0,o=Object.keys(this._muteEntriesByConversationHandle);r<o.length;r++){var i=o[r];this._removeEntry(i)}},e.prototype._getByConversationHandle=function(t){var e=this._muteEntriesByConversationHandle[t];return e?e.expiresAt<Date.now()?(delete this._muteEntriesByConversationHandle[t],null):e:null},e.prototype.unmuteAll=function(){return fs(this,void 0,void 0,(function(){return hs(this,(function(t){switch(t.label){case 0:return[4,this.host.api.mute.unmuteAll()];case 1:return t.sent(),this._removeAllEntries(),[2]}}))}))},e.prototype.muteConversation=function(t,e){return fs(this,void 0,void 0,(function(){var n,r,o,i;return hs(this,(function(s){switch(s.label){case 0:if(this.__validateDurationInMinutes(e),t=this._resolveModelId(t),!(n=this._resolveEntity(t,"conversation")))throw new Error("conversation "+t+" not found");return t=n.id,r=n.counterPartyId,o=n.counterPartyType,i=n.organizationId,"user"!==o?[3,2]:[4,this.host.api.mute.muteUser(r,e,i,{recipientOrganizationId:i})];case 1:return s.sent(),this._addEntry(t,{durationInMinutes:e,organizationId:i}),[3,4];case 2:return"group"!==o?[3,4]:[4,this.host.api.mute.muteGroup(r,e,i)];case 3:s.sent(),this._addEntry(t,{durationInMinutes:e,organizationId:i}),s.label=4;case 4:return[2]}}))}))},e.prototype.unmuteConversation=function(t){return fs(this,void 0,void 0,(function(){var e,n,r,o;return hs(this,(function(i){switch(i.label){case 0:if(!(e=this._resolveEntity(t,"conversation")))throw new Error("conversation "+t+" not found");return t=e.id,n=e.counterPartyId,r=e.counterPartyType,o=e.organizationId,"user"!==r?[3,2]:[4,this.host.api.mute.unmuteUser(n,o,{recipientOrganizationId:o})];case 1:return i.sent(),this._removeEntry(t),[3,4];case 2:return"group"!==r?[3,4]:[4,this.host.api.mute.unmuteGroup(n,o)];case 3:i.sent(),this._removeEntry(t),i.label=4;case 4:return[2]}}))}))},e.prototype.reactToMuteEvent=function(t){var e=t.data;if((e=Object(to.l)(e)).token===this.host.currentUser.id){var n=e.action;if("clear"!==n){var r=this._parseMuteEntry(e),o=r.conversationId,i=r.entry;"add"===n?this._addEntry(o,i):this._removeEntry(o)}else this._removeAllEntries()}},e.prototype.getById=function(t){return t.startsWith("mute:")||(t="mute:"+t),this.host.models.Mute.get(t)},e.prototype.__validateDurationInMinutes=function(t){(t<0||t>525600||t%1!=0)&&to.c.raise("durationInMinutes","invalid","should be a positive integer from 1 to 525600 (1 year)")},ds([Object(Or.decorator)()],e.prototype,"findAll",null),e}(no),gs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ms=function(t){function e(e,n){var r=t.call(this,e,n)||this;r.EVENTS={"message|group_message":function(t){this.host.notifications.reactToMessageEvent(t)},"message:status|group:message:status":function(t){this.host.notifications.reactToMessageStatusEvent(t)},remote_wipe:function(t){this.host.notifications.disconnect({source:"Notifications remote_wipe"}),this.host.notifications.signOut({fromServer:!0})},"sse:heartbeat":function(){return null}};for(var o=0,i=Object.entries(r.EVENTS);o<i.length;o++){var s=i[o],a=s[0],u=s[1];if(a.includes("|")){for(var c=0,l=a.split("|");c<l.length;c++){var d=l[c];r.EVENTS[d]=u}delete r.EVENTS[a]}}return r}return gs(e,t),e.prototype.emit=function(t){this.EVENTS[t.type]?this.EVENTS[t.type].call(this,t):this.logger.info("unhandled event: "+t.type,t.data)},e}(no),_s=n(88),bs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ws=function(){return(ws=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Is=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Os=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Es=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ts=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r._emitConnected=function(){r.emit("connected")},r._emitDisconnected=function(t){r.emit("disconnected",t)},r._emitEvent=function(t){r.emit("event",t)},r.events=new Si(e,ws(ws({},n),{endpointType:"simpleNotifications"})),r}return bs(e,t),e.prototype.mounted=function(){this.events.mounted(),this.events.on("connected",this._emitConnected),this.events.on("disconnected",this._emitDisconnected),this.events.on("event",this._emitEvent)},e.prototype.dispose=function(){this.events.removeListener("connected",this._emitConnected),this.events.removeListener("disconnected",this._emitDisconnected),this.events.removeListener("event",this._emitEvent),this.events.dispose()},e.prototype.signIn=function(){return Os(this,void 0,void 0,(function(){var t,e,n;return Es(this,(function(r){switch(r.label){case 0:if(!(t=this.host.getAuth())||!t.key||!t.secret)throw new zn.RequiresBasicAuthError;return this.emit("signingIn"),this.events.isSignedIn?[3,2]:[4,this.host.api.notifications.signIn(t.key,t.secret)];case 1:e=r.sent(),this.events.setAuth(e),r.label=2;case 2:return n=this.events.getAuth(),this.emit("signedIn",n),[2,n]}}))}))},e.prototype.signOut=function(t){var e=(void 0===t?{}:t).fromServer,n=void 0!==e&&e;return Os(this,void 0,void 0,(function(){var t,e,r;return Es(this,(function(o){switch(o.label){case 0:if(!(t=this.events.getAuth()))return[2,!1];this.emit("signingOut",{fromServer:n}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.host.api.notifications.signOut(t.key,t.secret)];case 2:return o.sent(),e=!0,[3,4];case 3:return r=o.sent(),this.httpClient.isUnauthorizedError(r)?(e=!0,[3,4]):[2,Promise.reject(r)];case 4:return e&&this.events.removeAuth(),this.emit("signedOut",{fromServer:n,signedOut:e}),[2,e]}}))}))},Object.defineProperty(e.prototype,"isSignedIn",{get:function(){return this.events.isSignedIn},enumerable:!1,configurable:!0}),e.prototype.authenticate=function(t,e){return Os(this,void 0,void 0,(function(){return Es(this,(function(n){return this.events.setAuth({key:t,secret:e}),[2]}))}))},e.prototype.connect=function(){return this.events.connect()},e.prototype.disconnect=function(t){var e=(void 0===t?{}:t).source;return this.events.disconnect({source:e})},e.prototype.reconnect=function(){return this.events.reconnect()},Object.defineProperty(e.prototype,"hasConnection",{get:function(){return this.events.hasConnection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.events.isConnected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.events.isOpen},enumerable:!1,configurable:!0}),e.prototype.reactToMessageEvent=function(t){var e=t.data;e=Object(_s.a)(e);var n=this.host.models.Message.createInstance(ws(ws({},e),{id:g.a.v4()}));this.emit("unread:change",n.unreadMessageCount),this.emit("message",n)},e.prototype.reactToMessageStatusEvent=function(t){this.emit("unread:change",t.unread_message_count)},Is([Object(Or.decorator)({serializeArguments:function(t){return""}})],e.prototype,"signOut",null),e}(no),Ss=n(63),As=n.n(Ss),Cs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rs=function(){return(Rs=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ps=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},js=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},xs=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ms=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},ks=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._onChangeConversation=function(t,n){var r=n.organization;r&&(e.host.currentlyServingOfflineMessages||e._deferConversationChanges||e.__reloadConversations(r))},e._onChangeUser=function(t,n){for(var r=n.id,o=e.host.models.Organization.getAll(),i=0,s=o;i<s.length;i++){(l=s[i]).autoForwardReceiverId===r&&l.autoForwardReceiver!==n&&e.host.models.Organization.inject(l)}if(n===e.host.currentUser&&!e.host.currentlyServingOfflineMessages&&!e._deferConversationChanges){var a=e.host.currentUser.roles;if(!As()(a,e._lastMyRoles)){e._lastMyRoles=Ms(a);for(var u=0,c=o;u<c.length;u++){var l=c[u];As()(l.allowedSenders,e._getAllowedSenders(l))||e.host.models.Organization.inject(l)}}}},e.getPreferences=function(t){return js(e,void 0,void 0,(function(){return xs(this,(function(e){switch(e.label){case 0:if(!t)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.organizations.getPreferences(t)];case 1:return[2,e.sent()]}}))}))},e.editPreferences=function(t){var n=t.quickReplies,r=void 0===n?[]:n,o=t.organizationId;return js(e,void 0,void 0,(function(){return xs(this,(function(t){switch(t.label){case 0:if(!r)throw new zn.ValidationError("quickReplies","required");if(!o)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.organizations.editPreferences({organizationId:o,quickReplies:r})];case 1:return[2,t.sent()]}}))}))},e}return Cs(e,t),e.prototype.mounted=function(){this._deferConversationChanges=!1,this._lastMyRoles=[],this.host.models.Conversation.on("afterInject",this._onChangeConversation),this.host.models.Conversation.on("afterEject",this._onChangeConversation),this.host.models.User.on("afterInject",this._onChangeUser)},e.prototype.dispose=function(){this._deferConversationChanges=!1,this._lastMyRoles=[],this.host.models.Conversation.removeListener("afterInject",this._onChangeConversation),this.host.models.Conversation.removeListener("afterEject",this._onChangeConversation),this.host.models.User.removeListener("afterInject",this._onChangeUser),Or.decorator.clear(this._findAll)},e.prototype.create=function(t){return void 0===t&&(t={allowPublicGroups:void 0,autologoutTime:void 0,deleteOnRead:void 0,groupLifespan:void 0,lifecycleCallback:void 0,name:void 0,pinLock:void 0,settingsRestricted:void 0,ttl:void 0,welcomeEmailSettings:void 0}),js(this,void 0,void 0,(function(){var e=this;return xs(this,(function(n){return this.host.requireUser(),[2,this.httpClient.post("/v2/organization",{data:t}).then((function(n){var r=n.getHeader("TT-X-Organization-Key");return e.host.models.Organization.inject({id:r,name:t.name})}))]}))}))},e.prototype.update=function(t){return void 0===t&&(t={allowPublicGroups:void 0,autologoutTime:void 0,autoSendWelcomeEmail:void 0,deleteOnRead:void 0,groupLifespan:void 0,id:void 0,lifecycleCallback:void 0,name:void 0,pinLock:void 0,settingsRestricted:void 0,ttl:void 0,welcomeEmailLogo:void 0,welcomeEmailSettings:void 0}),js(this,void 0,void 0,(function(){var e,n=this;return xs(this,(function(r){return this.host.requireUser(),e=_.a.underscoreObject({allowPublicGroups:t.allowPublicGroups,autologoutTime:t.autologoutTime,autoSendWelcomeEmail:t.autoSendWelcomeEmail,dor:t.deleteOnRead,groupLifespan:t.groupLifespan,lifecycleCallback:t.lifecycleCallback,name:t.name,pinLock:t.pinLock,settingsRestricted:t.settingsRestricted,ttl:t.ttl,welcomeEmailLogo:t.welcomeEmailLogo,welcomeEmailSettings:t.welcomeEmailSettings}),[2,this.httpClient.post("/v2/organization/:id",{urlParams:{id:t.id},data:e}).then((function(r){return n.host.models.Organization.inject(Rs({id:t.id},e))}))]}))}))},e.prototype.findAll=function(t){var e=void 0===t?{}:t,n=e.filter,r=void 0===n?{onlyApproved:!1}:n,o=e.findRoles,i=void 0===o||o;return js(this,void 0,void 0,(function(){var t,e=this;return xs(this,(function(n){switch(n.label){case 0:return this.host.requireUser(),[4,this._findAll()];case 1:return t=n.sent(),i?[4,this.host.userRoles.findAll()]:[3,3];case 2:n.sent(),n.label=3;case 3:return r.onlyApproved&&(t=h.a.filter(t,{pending:!1})),(t=h.a.sortBy(t,(function(t){return t.name.toLowerCase()}))).forEach((function(t){return e.__reloadConversations(t)})),[2,t]}}))}))},e.prototype.refreshAll=function(){return js(this,void 0,void 0,(function(){var t;return xs(this,(function(e){switch(e.label){case 0:return Or.decorator.clear(this._findAll),[4,this._findAll()];case 1:return t=e.sent(),[4,this.host.userRoles.refreshAll()];case 2:return e.sent(),[2,t]}}))}))},e.prototype._findAll=function(){return js(this,void 0,void 0,(function(){var t,e,n,r,o,i;return xs(this,(function(s){switch(s.label){case 0:return[4,this.host.api.organizations.findAllOfUser(this.host.currentUserId)];case 1:for(t=s.sent(),e=[],n=0,r=t;n<r.length;n++)o=r[n],i=this.host.models.Organization.inject(o),this.host.models.Organization.removePlaceholder({entity:i,attrs:o}),e.push(i);return[2,e]}}))}))},e.prototype.find=function(t,e){return void 0===e&&(e={}),js(this,void 0,void 0,(function(){var n,r;return xs(this,(function(o){switch(o.label){case 0:return e=h.a.defaults(e,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),e.bypassCache||!(n=this.host.models.Organization.get(t))||n.$placeholder?[4,this.host.api.organizations.find(this.host.currentUserId,t)]:[2,n];case 1:return r=o.sent(),[4,this.host.userRoles.findAll({organizationId:t})];case 2:if(o.sent(),r)n=this.host.models.Organization.inject(r),this.__reloadConversations(n);else if(!e.ignoreNotFound)throw new zn.NotFoundError(this.host.models.Organization.name,t);return[2,n]}}))}))},e.prototype._getAllowedSenders=function(t){var e=t.id,n=[],r=this.host.currentUser;if(r){for(var o=0,i=r.roles;o<i.length;o++){var s=i[o];s.organizationId===e&&n.push(s)}n.push(r)}return n},e.prototype.getPendingEulas=function(){return js(this,void 0,void 0,(function(){var t,e;return xs(this,(function(n){switch(n.label){case 0:return[4,this._findAll()];case 1:return t=n.sent(),e=t.filter((function(t){return t.eulaEnabled&&!t.isEulaAccepted})).reduce((function(t,e){var n=e.id,r=e.eulaUrl;return t[r]?t[r].push(n):t[r]=[n],t}),{}),[2,Object.entries(e).map((function(t){return{url:t[0],organizationIds:t[1]}}))]}}))}))},e.prototype.findEulaContent=function(t){return js(this,void 0,void 0,(function(){return xs(this,(function(e){switch(e.label){case 0:return t=t.replace("http://","https://"),[4,this.httpClient.get(t,{withCredentials:!1,withHeaders:!1,resFormat:"text"})];case 1:return[2,e.sent()]}}))}))},e.prototype.getSettingValue=function(t,e){t=this._resolveModelId(t);var n=this.getById(t);return n?n.getSettingValue(e):null},e.prototype.getAll=function(){return this.host.models.Organization.getAll()},e.prototype.getById=function(t){return this.host.models.Organization.get(t)},e.prototype.getMultiById=function(t){return this.host.models.Organization.getMulti(t)},e.prototype.__reloadConversations=function(t){if(t){for(var e=0,n=0,r=0,o=0,i=0,s=0,a=0,u=0,c=t.conversations;u<c.length;u++){var l=c[u],d=l.highestSortNumber,f=l.unreadCount,h=l.unreadPriorityCount,p=l.lastIncomingMessageSortNumber,v=l.shouldDisplay,y=l.metadata;v&&(e=Math.max(e,d),y&&"patient_messaging"===y.feature_service?(n+=f,i+=h,o+=f,a+=h):(r+=f,s+=h),!this.config.condensedReplays&&p&&(!t.lastIncomingMessageSortNumber||t.lastIncomingMessageSortNumber<p)&&(t.lastIncomingMessageSortNumber=p))}t.highestSortNumber=e,t.unreadCount=r+n,t.unreadPriorityCount=s+i,t.networks.provider.unreadCount=r,t.networks.provider.unreadPriorityCount=s,t.networks.patient.unreadCount=n,t.networks.patient.unreadPriorityCount=i,t.networks.virtualWaitingRoom.unreadCount=o,t.networks.virtualWaitingRoom.unreadPriorityCount=a,this.host.models.Organization.inject(t),t.emit("change")}},e.prototype.reactToOrganizationPreferencesEvent=function(t){this.emit("preferences:change",_.a.camelizeObject(t))},Ps([Object(Or.decorator)()],e.prototype,"findAll",null),Ps([Object(Or.decorator)()],e.prototype,"refreshAll",null),Ps([Object(Or.decorator)({memoize:!0})],e.prototype,"_findAll",null),Ps([Object(Or.decorator)()],e.prototype,"find",null),e}(no),Ns=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zs=function(){return(zs=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ds=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Us=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ls=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},Fs=["patient","user"],Bs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__resolvePatientId=function(t){if("string"!=typeof t){if(!Fs.includes(t.$entityType))return t;t=e._resolveModelId(t)}return t.replace("patient:","")},e}return Ns(e,t),e.prototype.create=function(t){var e=t.contacts,n=t.dob,r=t.firstName,o=t.lastName,i=t.mrn,s=t.organizationId,a=t.phoneNumber,u=t.gender;return Ds(this,void 0,void 0,(function(){var t;return Us(this,(function(c){switch(c.label){case 0:if(!i)throw new zn.ValidationError("mrn","required");if(!r)throw new zn.ValidationError("firstName","required");if(!o)throw new zn.ValidationError("lastName","required");if(!a)throw new zn.ValidationError("phoneNumber","required");if(!Object(Eo.isPhone)(a))throw new zn.ValidationError("phoneNumber","not a valid format");if(!n)throw new zn.ValidationError("dob","required");if(!/^(19|20)\d\d[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])$/.test(n))throw new zn.ValidationError("dob","not a valid format of YYYY-MM-DD");if(!u)throw new zn.ValidationError("gender","required");if(!s)throw new zn.ValidationError("organizationId","required");return e&&e.length&&function(t){if(t.length>2)throw new zn.ValidationError("contacts count","larger than 2");for(var e=0;e<t.length;e++){var n=t[e],r=n.firstName,o=n.lastName,i=n.phoneNumber,s=n.relation;if(!r)throw new zn.ValidationError("contact firstName","required");if(!o)throw new zn.ValidationError("contact lastName","required");if(!i)throw new zn.ValidationError("contact phoneNumber","required");if(!s)throw new zn.ValidationError("contact relation","required")}if(2===t.length&&Object(f.isEqual)(t[0],t[1]))throw new zn.ValidationError("contacts being unique","required")}(e),[4,this.host.api.patients.create({contacts:Vs(e),dob:n,firstName:r,gender:u,lastName:o,mrn:i,organizationId:s,phoneNumber:Object(Eo.normalizePhone)(a)})];case 1:return t=c.sent(),[2,this.host.models.User.inject(t.entity)]}}))}))},e.prototype.update=function(t){var e=t.currentEditVersion,n=t.dob,r=t.firstName,o=t.patientId,i=t.lastName,s=t.organizationId,a=t.phoneNumber,u=t.gender;return Ds(this,void 0,void 0,(function(){var t;return Us(this,(function(c){switch(c.label){case 0:if(!e)throw new zn.ValidationError("currentEditVersion","required");if(!s)throw new zn.ValidationError("organizationId","required");if(!o)throw new zn.ValidationError("patientId","required");return[4,this.host.api.patients.update({dob:n,editVersion:qs(e),firstName:r,gender:u,patientId:o,lastName:i,organizationId:s,phoneNumber:Object(Eo.normalizePhone)(a)})];case 1:return t=c.sent(),[2,this.host.models.User.inject(t.entity)]}}))}))},e.prototype.delete=function(t,e){return Ds(this,void 0,void 0,(function(){var n;return Us(this,(function(r){switch(r.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");return(n=this.host.models.Patient.get(t))&&this.host.models.Patient.eject(n),[4,this.host.api.patients.delete(t,e)];case 1:return r.sent(),[2]}}))}))},e.prototype.createContact=function(t){var e=t.firstName,n=t.lastName,r=t.organizationId,o=t.patientId,i=t.phoneNumber,s=t.relation;return Ds(this,void 0,void 0,(function(){var t;return Us(this,(function(a){switch(a.label){case 0:if(!o)throw new zn.ValidationError("patientId","required");if(!e)throw new zn.ValidationError("firstName","required");if(!n)throw new zn.ValidationError("lastName","required");if(!i)throw new zn.ValidationError("phoneNumber","required");if(!Object(Eo.isPhone)(i))throw new zn.ValidationError("phoneNumber","not a valid format");if(!s)throw new zn.ValidationError("relation","required");if(!r)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.patients.createContact({firstName:e,lastName:n,organizationId:r,patientId:o,phoneNumber:Object(Eo.normalizePhone)(i),relation:s})];case 1:return t=a.sent(),[2,this.host.models.User.inject(t.entity)]}}))}))},e.prototype.updateContact=function(t){var e=t.contactId,n=t.currentEditVersion,r=t.firstName,o=t.lastName,i=t.organizationId,s=t.patientId,a=t.phoneNumber,u=t.relation;return Ds(this,void 0,void 0,(function(){var t;return Us(this,(function(c){switch(c.label){case 0:if(!n)throw new zn.ValidationError("currentEditVersion","required");if(!i)throw new zn.ValidationError("organizationId","required");if(!s)throw new zn.ValidationError("patientId","required");if(!e)throw new zn.ValidationError("contactId","required");if(!r)throw new zn.ValidationError("firstName","required");if(!o)throw new zn.ValidationError("lastName","required");if(!a)throw new zn.ValidationError("phoneNumber","required");if(!Object(Eo.isPhone)(a))throw new zn.ValidationError("phoneNumber","not a valid format");if(!u)throw new zn.ValidationError("relation","required");return[4,this.host.api.patients.updateContact({contactId:e,editVersion:qs(n),firstName:r,lastName:o,organizationId:i,patientId:s,phoneNumber:Object(Eo.normalizePhone)(a),relation:u})];case 1:return t=c.sent(),[2,this.host.models.User.inject(t.entity)]}}))}))},e.prototype.deleteContact=function(t){var e=t.contactId,n=t.organizationId,r=t.patientId;return Ds(this,void 0,void 0,(function(){var t;return Us(this,(function(o){switch(o.label){case 0:if(!e)throw new zn.ValidationError("contactId","required");if(!n)throw new zn.ValidationError("organizationId","required");if(!r)throw new zn.ValidationError("patientId","required");return[4,this.host.api.patients.deleteContact({contactId:e,patientId:r,organizationId:n})];case 1:return o.sent(),(t=this.host.models.PatientContact.get("patientContact:"+e))&&this.host.models.PatientContact.eject(t),[2]}}))}))},e.prototype.login=function(t){var e=t.accessToken,n=t.dateOfBirth,r=t.linkToken,o=t.sessions;return Ds(this,void 0,void 0,(function(){var t,i,s,a,u,c;return Us(this,(function(l){switch(l.label){case 0:return this.host.emit("signingIn"),[4,this.host.api.patients.login(r,e,n,o)];case 1:return t=l.sent(),i=t.api_key,s=t.api_secret,a=t.group_id,u=t.organization_id,this.host.configure({events:zs(zs({},this.host.config.events),{singleConversation:a})}),this.host._setAuth({key:i,secret:s}),this.host.setDefaultOrganization(u),[4,this.host.users.findMe({ignoreNotFound:!0})];case 2:return c=l.sent(),this.host._setCurrentUser(c),this.host.emit("signedIn",c,this.host.getAuth()),this.host.messages._fetchAttachmentTokens(),[2,t]}}))}))},e.prototype.loginCheck=function(t){var e=t.linkToken,n=t.sessions;return Ds(this,void 0,void 0,(function(){return Us(this,(function(t){return[2,this.host.api.patients.loginCheck(e,n)]}))}))},e.prototype.requestAccessToken=function(t){return Ds(this,void 0,void 0,(function(){return Us(this,(function(e){return[2,this.host.api.patients.requestAccessToken(t)]}))}))},e.prototype.csvUpload=function(t,e){return Ds(this,void 0,void 0,(function(){return Us(this,(function(n){return[2,this.host.api.patients.csvUpload(t,e)]}))}))},e.prototype.getWhiteLabel=function(t){return Ds(this,void 0,void 0,(function(){return Us(this,(function(e){return[2,this.host.api.patients.getWhiteLabel(t)]}))}))},e.prototype.setWhiteLabel=function(t,e){return Ds(this,void 0,void 0,(function(){return Us(this,(function(n){return[2,this.host.api.patients.setWhiteLabel(t,e)]}))}))},e.prototype._createPatientGroupMetadata=function(t){var e=t.displayName,n=t.patient,r=t.id;return{feature_service:"patient_messaging",is_patient_contact:"false",patient_dob:n.dob,patient_gender:n.gender,patient_id:r,patient_mrn:n.mrn,patient_name:e,phone_number:n.phoneNumber,sms_opted_out:n.smsOptedOut}},e.prototype._createPatientContactGroupMetadata=function(t){var e=t.patient,n=t.patientContact,r=t.id,o=e.dob,i=e.gender,s=e.mrn,a=e.user,u=n.phoneNumber,c=n.relation,l=n.smsOptedOut;return{feature_service:"patient_messaging",is_patient_contact:"true",patient_contact_id:r,patient_dob:o,patient_gender:i,patient_id:a.id,patient_mrn:s,patient_name:a.displayName,phone_number:u,relation_name:c,sms_opted_out:l}},e.prototype.getAll=function(){return this.host.models.Patient.getAll()},e.prototype.getById=function(t){return t=this.__resolvePatientId(t),this.host.models.Patient.get("patient:"+t)},e}(no);function qs(t){if(null==t)throw new zn.ValidationError("version","of type string or number");return"string"==typeof t?parseInt(t)+1:t+1}function Vs(t){return void 0===t&&(t=[]),t.map((function(t){var e=t.phoneNumber,n=Ls(t,["phoneNumber"]);return zs(zs({},n),{phoneNumber:Object(Eo.normalizePhone)(e)})}))}var Gs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gs(e,t),e.prototype.mounted=function(){this._data={}},e.prototype.dispose=function(){this._data=null},e.prototype.reactToPresenceEvent=function(t){var e=t.data;this.set(e.from,fr.resolve(e.type))},e.prototype.set=function(t,e){if(this._data[t]!==e){this._data[t]=e;var n=this.host.models.User.inject({id:t,presence:e});this.emit("change",{presence:e,user:n,userId:t})}},e.prototype.get=function(t){return t===this.host.currentUserId?fr.AVAILABLE:this._data[t]||fr.UNKNOWN},e}(no),Ws=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ys=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},Ks=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},$s=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Xs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._addProcessingEvent=function(t){var n=e.host.models.Product.getAll()[0];if(n){var r=t.actionType,o=t.entity;r===hr.ROLE_OPT_IN&&n.rolesOptingIn.push(o.id),n.activeProcessingEvents.push(t),e.host.models.Product.inject(n),e.emit("processing:start",t)}},e._removeProcessingEvent=function(t){var n=e.host.models.Product.getAll()[0];if(n){for(var r=n.activeProcessingEvents,o=n.rolesOptingIn,i=t.actionType,s=t.entity,a=r.length-1;a>=0;a--){var u=r[a];if(i===u.actionType&&s.id===u.entity.id&&(r.splice(a,1),i===hr.ROLE_OPT_IN&&o.includes(s.id)&&o.splice(o.indexOf(s.id),1),i!==hr.MESSAGE_REPLAY))break}e.host.models.Product.inject(n),e.emit("processing:stop",t)}},e._onChangeOrganization=function(t,n){var r=e.host.models.Product.getAll()[0];if(r){var o=e.host.models.Organization.getAll();if(0!==o.length){for(var i={organizations:o},s=0,a=0,u=0,c=0,l=0,d=0,f=o;d<f.length;d++){var h=f[d];h.$placeholder||(s+=h.conversations.length,a+=h.unreadCount,u+=h.unreadPriorityCount,h.networks.virtualWaitingRoom&&(c+=h.networks.patient.unreadCount,l+=h.networks.patient.unreadPriorityCount))}i.conversationCount=s,i.unreadCount=a,i.unreadPriorityCount=u,i.unreadVWRCount=c,i.unreadVWRPriorityCount=l;for(var p=!1,v=0,y=Object.entries(i);v<y.length;v++){var g=y[v],m=g[0],_=g[1];As()(r[m],_)||(r[m]=_,p=!0)}p&&e.host.models.Product.inject(r)}}},e}return Ws(e,t),e.prototype.mounted=function(){this.host.models.Organization.on("afterInject",this._onChangeOrganization),this.host.models.Organization.on("afterEject",this._onChangeOrganization)},e.prototype.dispose=function(){this.host.models.Organization.removeListener("afterInject",this._onChangeOrganization),this.host.models.Organization.removeListener("afterEject",this._onChangeOrganization)},e.prototype.findAll=function(){return Ks(this,void 0,void 0,(function(){return $s(this,(function(t){switch(t.label){case 0:return[4,this.host.organizations.findAll()];case 1:return t.sent(),[2,this.getAll()]}}))}))},e.prototype.refreshAll=function(){return Ks(this,void 0,void 0,(function(){return $s(this,(function(t){switch(t.label){case 0:return[4,this.host.organizations.refreshAll()];case 1:return t.sent(),[2,this.getAll()]}}))}))},e.prototype.getAll=function(){return this.host.models.Product.getAll()},e.prototype.getById=function(t){return this.host.models.Product.get(t)},Ys([Object(Or.decorator)()],e.prototype,"findAll",null),Ys([Object(Or.decorator)()],e.prototype,"refreshAll",null),e}(no),Qs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zs=function(){return(Zs=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Js=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ta=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ea=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},na=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},ra=["role","user"],oa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__injectSearchResult=function(t){var n=t.entity,r=t.metadata,o=void 0===r?{}:r,i=t.organizationId;return o=Zs(Zs({},o),{display_name:n.displayName,token:e.__resolveRoleId(n.id)}),e.__injectRoleFromMetadata({metadata:o,organizationId:i})},e.__injectRoleAssignmentEntity=function(t,n,r){return e.__injectRoleFromMetadata({metadata:{display_name:t,meta_type:n.meta_type,owners:n.owner_id,tag_color:n.tag_color,tag_id:n.tag_id,tag_name:n.tag_name,token:n.id},organizationId:r,replaceExisting:!1})},e.__resolveRoleId=function(t){if("string"!=typeof t){if(!ra.includes(t.$entityType))return t;t=e._resolveModelId(t)}return t.replace("role:","")},e._onChangeConversation=function(t,n){var r=n.counterParty,o=n.counterPartyType,i=r&&r.members&&r.members.length>0;if("group"===o&&i)for(var s=0,a=r.members;s<a.length;s++){var u=a[s];if(u.isRoleBot){var c=e._roleConversations[u.id]||[];if(c.includes(n)||c.push(n),e._roleConversations[u.id]=c,"ROLE_P2P"===r.groupType){var l=e._roleP2PConversations[u.id]||[];l.includes(n)||l.push(n),e._roleP2PConversations[u.id]=l}}}},e._onRemoveConversation=function(t,n){var r=n.counterParty,o=n.counterPartyType,i=r&&r.members&&r.members.length>0;if("group"===o&&i)for(var s=0,a=r.memberIds;s<a.length;s++){var u=a[s],c=e._roleConversations[u],l=c?c.indexOf(n):-1;if(l>-1&&c.splice(l,1),c&&0===c.length&&delete e._roleConversations[u],"ROLE_P2P"===r.groupType){var d=e._roleP2PConversations[u],f=d?d.indexOf(n):-1;f>-1&&d.splice(f,1),d&&0===d.length&&delete e._roleP2PConversations[u]}}},e}return Qs(e,t),e.prototype.mounted=function(){this._previouslyInRoles={},this._roleConversations={},this._roleP2PConversations={},this.host.models.Conversation.on("afterInject",this._onChangeConversation),this.host.models.Conversation.on("afterEject",this._onRemoveConversation)},e.prototype.dispose=function(){this._previouslyInRoles={},this._roleConversations={},this._roleP2PConversations={},this.host.models.Conversation.removeListener("afterInject",this._onChangeConversation),this.host.models.Conversation.removeListener("afterEject",this._onRemoveConversation)},e.prototype.createP2PGroup=function(t){var e=t.metadata,n=t.name,r=t.organizationId,o=t.recipientId,i=t.replayHistory,s=void 0===i||i,a=t.senderId,u=void 0===a?this.host.currentUserId:a;return ta(this,void 0,void 0,(function(){var t,i,a,c,l,d,f,h,p,v,y,g,m,_,b,w,I,O,E,T,S=this;return ea(this,(function(A){switch(A.label){case 0:if(this.host.requireUser(),!o)throw new zn.ValidationError("recipientId","required");if(!r)throw new zn.ValidationError("organizationId","required");for(t=this.host.currentUserId,i=[],a=0,c=[u,o];a<c.length;a++)l=c[a],l=this.host.roles.__resolveRoleId(l),l=this._resolveModelIdWithTypes(l,"user"),i.includes(l)||i.push(l);if(2!==i.length)throw new zn.ValidationError("recipientId","same user as senderId");return[4,Promise.all(i.map((function(t){return S.host.users.find(t,{organizationId:r})})))];case 1:return d=A.sent(),n||(n=d.map((function(t){return t.isRoleBot?t.displayName:t.firstName})).filter(Boolean).join(", ")||"Group"),[4,this.host.api.roles.createP2PGroup({createdByUserId:u,memberIds:i,name:n,organizationId:r,replayHistory:s})];case 2:for(f=A.sent(),this.config.condensedReplays?(p=f.entity||f,h=f.conversation_id):p=f,v=0,y=d;v<y.length;v++)if(g=y[v],m=g.botRole,g.isRoleBot&&m&&(_=m.memberIds))for(b=0,w=_;b<w.length;b++)I=w[b],i.includes(I)||i.push(I);return O=p.id||p.token,(E=this.host.models.Group.get(O))&&E.memberIds?T=E.memberIds:(p.members=i,T=i),E=this.host.conversations.__injectCounterParty({conversationId:h,entityAttrs:p,entityType:"group",groupType:tr.ROLE_P2P,hasCurrentUser:T.includes(t),isPlaceholder:!0,organizationId:r}),e?[4,this.host.metadata.update(E.id,e,r)]:[3,4];case 3:A.sent(),A.label=4;case 4:return[2,E]}}))}))},e.prototype.findAll=function(){return ta(this,void 0,void 0,(function(){var t,e,n,r=this;return ea(this,(function(o){switch(o.label){case 0:return 0!==(t=this.host.models.Organization.getAll()).length?[3,2]:[4,this.host.organizations.findAll()];case 1:t=o.sent(),o.label=2;case 2:return 0===(t=t.filter((function(t){return t.rolesEnabled}))).length?[2,[]]:[4,this.host.search.query({types:["user"],organizationIds:t.map((function(t){return t.id})),query:{displayName:"",featureService:"role"},followContinuations:!0})];case 3:return e=o.sent().results,n=e.map((function(t){return t.entity})),t.map((function(t){var e=t.id;return r.host.models.Organization.touch(e)})),[2,n]}}))}))},e.prototype.findByOrganizationId=function(t){return ta(this,void 0,void 0,(function(){var e,n,r;return ea(this,(function(o){switch(o.label){case 0:return t=this._resolveModelId(t),[4,this.host.organizations.find(t)];case 1:return(e=o.sent()).rolesEnabled?[4,this.host.search.query({types:["user"],organizationIds:e.id,query:{displayName:"",featureService:"role"},followContinuations:!0})]:[2,[]];case 2:return n=o.sent().results,r=n.map((function(t){return t.entity})),this.host.models.Organization.touch(t),[2,r]}}))}))},e.prototype.find=function(t,e,n){return void 0===n&&(n={}),ta(this,void 0,void 0,(function(){var r,o,i;return ea(this,(function(s){switch(s.label){case 0:return this.host.requireUser(),n=h.a.defaults(n,{bypassCache:!1,ignoreNotFound:!1}),t=this.__resolveRoleId(t),e=this._resolveModelId(e),!n.bypassCache&&(r=this.getById(t))?[2,r]:[4,this.host.api.roles.find(t,e)];case 1:if(!(o=s.sent())){if(n.ignoreNotFound)return[2];throw new zn.NotFoundError(this.host.models.Role.name,t)}return i=this.__injectSearchResult({entity:{id:t,displayName:o.display_name},metadata:o,organizationId:e}),this.host.models.Organization.touch(e),[2,i]}}))}))},e.prototype.saveRole=function(t,e){return ta(this,void 0,void 0,(function(){return ea(this,(function(n){switch(n.label){case 0:return this.host.requireUser(),e=this._resolveModelId(e),t=this.__resolveRoleId(t),[4,this.host.api.roles.saveRole(t,this.host.currentUserId,e)];case 1:return n.sent(),[2]}}))}))},e.prototype.removeSavedRole=function(t,e){return ta(this,void 0,void 0,(function(){return ea(this,(function(n){switch(n.label){case 0:return this.host.requireUser(),e=this._resolveModelId(e),t=this.__resolveRoleId(t),[4,this.host.api.roles.removeSavedRole(t,this.host.currentUserId,e)];case 1:return n.sent(),[2]}}))}))},e.prototype.findSavedRoles=function(t,e){return void 0===e&&(e={}),ta(this,void 0,void 0,(function(){var n,r,o=this;return ea(this,(function(i){switch(i.label){case 0:return e=h.a.defaults(e,{ignoreNotFound:!1}),this.host.requireUser(),t=this._resolveModelId(t),[4,this.host.api.roles.findSavedRoles(this.host.currentUserId,t)];case 1:if(!(n=i.sent())){if(e.ignoreNotFound)return[2];throw new zn.NotFoundError("saved roles",t)}return r=n.map((function(e){return o.__injectSearchResult({entity:{id:e.token,displayName:e.display_name},metadata:e,organizationId:t})})).filter(Boolean),this.host.models.Organization.touch(t),[2,r]}}))}))},e.prototype.reactToUpdateEventCR=function(t){var e,n=t.entity,r=n.display_name,o=n.metadata,i=n.organizationId;return e="group"===n.type?o.id:n.id,o=Zs(Zs({},o),{display_name:r,token:this.__resolveRoleId(e)}),this.__injectRoleFromMetadata({metadata:o,organizationId:i})},e.prototype.reactToUpdateEvent=function(t){var e,n=t.data,r=n.display_name,o=n.metadata,i=n.organization_key;return e="tigertext:entity:group"===n.type?o.id:n.token,o=Zs(Zs({},o),{display_name:r,token:this.__resolveRoleId(e)}),this.__injectRoleFromMetadata({metadata:o,organizationId:i})},e.prototype.__injectRoleFromMetadata=function(t){var e=t.metadata,n=void 0===e?{}:e,r=t.organizationId,o=t.replaceExisting,i=void 0===o||o,s=n.escalation_policy,a=n.token;if(!a)return null;var u="role:"+a;if(!i){var c=this.host.models.Role.get(u);if(c)return c}var l=this.host.models.Organization.get(r);this.host.metadata.__injectMetadata(a,r,Zs({feature_service:"role"},n)),this.host.models.User.injectPlaceholder({id:a,organizationId:r,displayName:n.display_name});var d={botUserId:a,displayName:n.display_name,id:u,organizationId:r};if(n.description&&(d.description=n.description),s&&s.escalation_path){var f=JSON.parse(JSON.stringify(s));f.id="escalationPolicy:"+a,f.targetId=a;var p=this.host.models.EscalationPolicy.inject(f);d.escalationPolicyId=p.id}else d.escalationPolicyId=null;if(n.room_assignment_id&&(d.assignmentGroupId=n.room_assignment_id),n.owners)if("string"==typeof n.owners)d.memberIds=n.owners.split(","),this.host.models.User.injectPlaceholder({id:n.owners});else{d.memberIds=n.owners.map((function(t){return t.token}));for(var v=0,y=n.owners;v<y.length;v++){var g=y[v];this.host.models.User.injectPlaceholder(g)}}return n.tag_id?(d.roleTagId=r+":"+n.tag_id,this.host.models.RoleTag.inject(Zs(Zs({},h.a.pick(n,"tag_id","tag_color","tag_name")),{id:d.roleTagId,organizationId:r}))):l&&(d.roleTagId=null),this.host.models.Role.inject(d)},e.prototype.__parseRoleFromMetadata=function(t){var e=t.metadata,n=void 0===e?{}:e,r=t.organizationId,o=n.token;if(!o)return null;var i={$entityType:"role",botUserId:o,displayName:n.display_name,id:"role:"+o,organizationId:r},s=null;n.tag_id&&((s={id:r+":"+n.tag_id,organizationId:r,color:n.tag_color,tagId:n.tag_id,name:n.tag_name,displayName:n.tag_name}).color&&(s.color=s.color.replace("0x","#")));return i.roleTag=s,i},e.prototype.getAll=function(){return this.host.models.Role.getAll()},e.prototype.getById=function(t){return t=this.__resolveRoleId(t),this.host.models.Role.get("role:"+t)},e.prototype.refresh=function(t){return ta(this,void 0,void 0,(function(){var e,n,r,o,i,s,a;return ea(this,(function(u){switch(u.label){case 0:return 0===(e=Object.keys(this._roleConversations)).length?[2]:[4,this.host.entities.findMulti(e,t)];case 1:for(n=u.sent(),r=0,o=n;r<o.length;r++)i=o[r],s=i.entity,a=i.metadata,s&&a&&(a.owners||(a.owners=[]),this.__injectSearchResult({entity:{id:s.token,displayName:s.display_name},metadata:a,organizationId:t}));return[2]}}))}))},e.prototype.reactToFriendsEventCR=function(t){return ta(this,void 0,void 0,(function(){var e,n,r,o,i,s;return ea(this,(function(a){switch(a.label){case 0:return e=t.action,n=t.attrs,r=n.id,o=n.metadata,i=void 0===o?{}:o,s=n.organizationId,n.action=e,n.token=r,[4,this.__reactToRoleChange(i.id,s,i.triggered_id,n)];case 1:return a.sent(),[2]}}))}))},e.prototype.reactToFriendsEvent=function(t){return ta(this,void 0,void 0,(function(){var e,n,r,o,i;return ea(this,(function(s){switch(s.label){case 0:return e=t.data.friend,n=e.metadata,r=void 0===n?{}:n,o=e.organization_id,i=na(e,["metadata","organization_id"]),[4,this.__reactToRoleChange(r.id,o,r.triggered_id,i)];case 1:return s.sent(),[2]}}))}))},e.prototype.__reactToRoleChange=function(t,e,n,r){return ta(this,void 0,void 0,(function(){var o,i,s,a,u,c,l,d,f,h,p,v,y;return ea(this,(function(g){switch(g.label){case 0:if(e=this._resolveModelId(e),t=this.__resolveRoleId(t),n=this._resolveModelId(n),o=this.host.currentUser,i=r.action,s=r.token,a=function(){return o.roles.some((function(e){return e.botUserId===t}))},u=this._previouslyInRoles[t]||a(),c=r.event_status,"del"===i){if(c&&"end"!==c)return this._previouslyInRoles[t]=u,[2];delete this._previouslyInRoles[t]}return l=this.getById(t),[4,Promise.all([this.find(t,e,{bypassCache:!0,ignoreNotFound:!0}),this.host.users.find(n,{organizationId:e,ignoreNotFound:!0})])];case 1:return d=g.sent(),f=d[0],h=d[1],l||f?((p="del"===i&&l&&!f)&&(f=l,v="role:"+t,this.host.models.Role.inject({id:v,memberIds:[]}),this.host.models.Role.eject(f)),(y=a())&&!u?this.emit("change",{type:"OPT_IN",role:f,target:o,triggeredBy:h}):!y&&u&&(this.host.models.Group.eject(s),this.host.models.User.touch(this.host.currentUserId),this.emit("change",{type:"OPT_OUT",isRoleDeleted:p,role:f,target:o,triggeredBy:h})),[2]):[2]}}))}))},Js([Object(Or.decorator)()],e.prototype,"findAll",null),Js([Object(Or.decorator)()],e.prototype,"findByOrganizationId",null),Js([Object(Or.decorator)()],e.prototype,"find",null),Js([Object(Or.decorator)()],e.prototype,"saveRole",null),Js([Object(Or.decorator)()],e.prototype,"removeSavedRole",null),Js([Object(Or.decorator)()],e.prototype,"findSavedRoles",null),Js([Object(Or.decorator)()],e.prototype,"refresh",null),Js([Object(Or.decorator)()],e.prototype,"__reactToRoleChange",null),e}(no),ia=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sa=function(){return(sa=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},aa=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ua=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ca=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},la=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ia(e,t),e.prototype.findAll=function(t){return void 0===t&&(t={}),ua(this,void 0,void 0,(function(){var e,n,r=this;return ca(this,(function(o){switch(o.label){case 0:return t=h.a.defaults(t,{ignoreNotFound:!0,bypassCache:!1}),0!==(e=this.host.models.Organization.getAll()).length?[3,2]:[4,this.host.organizations.findAll()];case 1:e=o.sent(),o.label=2;case 2:return[4,Promise.all(e.map((function(e){return r.findAllForOrganization(e.id,t)})))];case 3:return n=o.sent(),[2,h.a.flatten(n)]}}))}))},e.prototype.findAllForOrganization=function(t,e){return void 0===e&&(e={}),ua(this,void 0,void 0,(function(){var n,r,o,i=this;return ca(this,(function(s){switch(s.label){case 0:return e=h.a.defaults(e,{ignoreNotFound:!0,bypassCache:!1}),t=this._resolveModelId(t),(n=this._resolveEntity(t)).rolesEnabled&&n.canAdminRoles?[4,this.host.api.roleTags.findAll(t)]:[2,[]];case 1:if(!(r=s.sent())){if(e.ignoreNotFound)return[2,[]];throw new zn.NotFoundError("roleTags",t)}return o=r.map((function(e){var n=t+":"+e.tag_id;return i.host.models.RoleTag.inject(sa(sa({},e),{id:n,organizationId:t}))})),this.host.models.Organization.touch(t),[2,o]}}))}))},e.prototype.reactToUpdateEventCR=function(t){var e=t.data,n=(e=Object(to.l)(e)).entity,r=e.organization_id,o=n.color,i=n.display_name,s=n.id||n.token,a=o.color_id,u=o.color_value;return this.host.models.RoleTag.inject({color:a,colorValue:u,id:r+":"+s,name:i,organizationId:r,tagId:s})},e.prototype.reactToUpdateEvent=function(t){var e=t.data;if(!this.config.condensedReplays||!e.entity){var n=(e=Object(to.l)(e)).color,r=e.display_name,o=e.organization_key,i=e.token,s=n.color_id,a=n.color_value;return this.host.models.RoleTag.inject({color:s,colorValue:a,id:o+":"+i,name:r,organizationId:o,tagId:i})}this.reactToUpdateEventCR({data:e})},e.prototype.getAll=function(){return this.host.models.RoleTag.getAll()},e.prototype.getById=function(t){return this.host.models.RoleTag.get(t)},aa([Object(Or.decorator)()],e.prototype,"findAllForOrganization",null),e}(no),da=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fa=function(){return(fa=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ha=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},pa=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},va=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ya=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return da(e,t),e.prototype.batchDelete=function(t){var e=t.ids,n=t.organizationId;return pa(this,void 0,void 0,(function(){var t=this;return va(this,(function(r){switch(r.label){case 0:if(!Array.isArray(e))throw new zn.ValidationError("ids","required","ids must be an array");if(!n)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.scheduledMessages.batch({ids:e,operation:"destroy",organizationId:n})];case 1:return r.sent(),[2,e.map((function(e){return t.host.models.ScheduledMessage.inject({$deleted:!0,id:e})}))]}}))}))},e.prototype.create=function(t){var e=t.attachment,n=t.body,r=t.endDate,o=t.network,i=void 0===o?"patient":o,s=t.noReply,a=void 0!==s&&s,u=t.organizationId,c=t.recipients,l=t.repeating,d=t.sendNow,f=void 0!==d&&d,h=t.startDate,p=t.startTime,v=t.templateId,y=t.timezoneName;return pa(this,void 0,void 0,(function(){var t=this;return va(this,(function(o){switch(o.label){case 0:if(this._validate({body:n,endDate:r,organizationId:u,recipients:c,repeating:l,sendNow:f,shouldCheckId:!1,startDate:h,startTime:p}),!1===["patient"].includes(i))throw new zn.ValidationError("network","invalid",'network must be "patient"');return[4,this.host.api.scheduledMessages.create({attachment:e,body:n,end_date:r,network:i,no_reply:a,organizationId:u,recipients:c,repeating:l,send_now:f,start_date:h,start_time:p,template_id:v,timezone_name:y})];case 1:return[2,o.sent().map((function(e){return e.sender_id=t.host.currentUserId,t.host.conversations.__injectCounterParty({entityAttrs:e,entityType:"scheduledMessage",organizationId:u})}))]}}))}))},e.prototype.delete=function(t,e){return pa(this,void 0,void 0,(function(){return va(this,(function(n){switch(n.label){case 0:return this._validate({id:t,organizationId:e,shouldCheckInvalid:!1}),[4,this.host.api.scheduledMessages.delete(t,e)];case 1:return n.sent(),[2,this.host.models.ScheduledMessage.inject({$deleted:!0,id:t})]}}))}))},e.prototype.downloadScheduledMessageFile=function(t){var e=t.scheduleId,n=t.fileName,r=t.organizationId;return pa(this,void 0,void 0,(function(){var t;return va(this,(function(o){switch(o.label){case 0:return[4,this.host.api.scheduledMessages.downloadScheduledMessageFile({scheduleId:e,fileName:n,organizationId:r})];case 1:return t=o.sent(),[4,Object(Fi.downloadFile)({attachmentContentType:t.type,blob:t,fileName:n})];case 2:return o.sent(),[2]}}))}))},e.prototype.fetchHits=function(t,e){return pa(this,void 0,void 0,(function(){var n,r,o,i,s=this;return va(this,(function(a){switch(a.label){case 0:return n=["history","queue"].map((function(n){return s.search({category:n,feed:t,organizationId:e,pageSize:0})})),[4,Promise.all(n)];case 1:return r=a.sent(),o=r[0],i=r[1],[2,{history:o.metadata.totalHits,queue:i.metadata.totalHits}]}}))}))},e.prototype.find=function(t){var e=t.id,n=t.organizationId,r=t.category;return pa(this,void 0,void 0,(function(){var t;return va(this,(function(o){switch(o.label){case 0:return this._validate({id:e,organizationId:n,shouldCheckInvalid:!1}),[4,this.host.api.scheduledMessages.find({id:e,organizationId:n,isHistoryCategory:"history"===r})];case 1:return t=o.sent(),[2,this.host.models.ScheduledMessage.inject(t)]}}))}))},e.prototype.findCoarseTimezone=function(t,e){return pa(this,void 0,void 0,(function(){var n,r,o;return va(this,(function(i){switch(i.label){case 0:return[4,this.host.api.scheduledMessages.findCoarseTimezone(t,e)];case 1:return n=i.sent(),r=n.abbr,o=n.name,[2,{abbr:r,name:o}]}}))}))},e.prototype.getAll=function(){return this.host.models.ScheduledMessage.getAll()},e.prototype.getById=function(t){return this.host.models.ScheduledMessage.get(t)},e.prototype.search=function(t){var e=t.category,n=t.continuation,r=t.feed,o=t.network,i=void 0===o?"patient":o,s=t.organizationId,a=t.pageSize,u=t.range,c=t.sortBy,l=void 0===c?"scheduled_time":c,d=t.sortOrder,f=void 0===d?"asc":d;return pa(this,void 0,void 0,(function(){var t,o,c;return va(this,(function(d){switch(d.label){case 0:return[4,this.host.search.query({query:fa(fa({},u?{range:u}:null),{schedule_message_category:e}),continuation:n,feedLevel:r,network:i,organizationId:s,pageSize:a,returnFields:[],sort:(c={},c[l]=f,c),types:["scheduledMessage"]})];case 1:return t=d.sent(),o=this._processSearchResults(t.results),[2,{metadata:t.metadata,results:o}]}}))}))},e.prototype.update=function(t){var e=t.attachment,n=t.body,r=t.endDate,o=t.id,i=t.organizationId,s=t.repeating,a=t.startDate,u=t.startTime,c=t.templateId,l=t.timezoneName;return pa(this,void 0,void 0,(function(){var t;return va(this,(function(d){switch(d.label){case 0:return this._validate({body:n,endDate:r,id:o,organizationId:i,repeating:s,startDate:a,startTime:u}),[4,this.host.api.scheduledMessages.update({attachment:e,body:n,end_date:r,id:o,organizationId:i,repeating:s,start_date:a,start_time:u,template_id:c,timezone_name:l})];case 1:return t=d.sent(),[2,this.host.models.ScheduledMessage.inject(t)]}}))}))},e.prototype._processSearchResults=function(t){return t.map((function(t){return t.entity})).filter((function(t){return!t.$deleted}))},e.prototype._validate=function(t){var e=t.body,n=t.endDate,r=t.id,o=t.organizationId,i=t.recipients,s=t.repeating,a=t.sendNow,u=t.shouldCheckId,c=void 0===u||u,l=t.shouldCheckInvalid,d=void 0===l||l,f=t.startDate,h=t.startTime;if(c&&!r)throw new zn.ValidationError("id","required");if(!o)throw new zn.ValidationError("organizationId","required");if(d){if(!e||0===e.trim().length)throw new zn.ValidationError("body","invalid","body must be at least 1 character");if(!(c||Array.isArray(i)&&i.length>0&&i.length<=5))throw new zn.ValidationError("recipients","invalid","recipients must be an array of ids between 1 and 5 elements");if(!a){var p=Date.parse(f+"T"+h);if(isNaN(p))throw new zn.ValidationError("startDate","invalid","start date and time must be the correct format");if(s){if(!1===["daily","weekly","biweekly","monthly"].includes(s))throw new zn.ValidationError("repeating","invalid",'repeating must be either "daily", "weekly", "biweekly", or "monthly"');var v=Date.parse(""+n);if(isNaN(v))throw new zn.ValidationError("endDate","invalid","endDate must be the correct format")}}}},ha([Object(Or.decorator)()],e.prototype,"downloadScheduledMessageFile",null),ha([Object(Or.decorator)()],e.prototype,"fetchHits",null),ha([Object(Or.decorator)()],e.prototype,"find",null),ha([Object(Or.decorator)()],e.prototype,"findCoarseTimezone",null),ha([Object(Or.decorator)()],e.prototype,"search",null),e}(no),ga=function(){function t(t,e,n,r){this.id="searchResult:"+e+":"+t.id,this.entity=t,this.entityId=t.id,this.entityType=t.$entityType,this.metadata=r,this.organizationId=e,this.conversationId=n}return t.is=function(t){return t instanceof this},t}(),ma=function(t,e){if(void 0===t&&(t=""),void 0===e&&(e={}),!t||h.a.isEmpty(e.cloudfront))return t;var n=e.cloudfront,r=h.a.findKey(n,(function(e,n){return-1!==t.indexOf(n)})),o=n[r]?r+"."+e.cloudfrontDomain:"",i=n[r]?e.assetDomain+"/"+n[r]:"",s=o&&i?t.replace(o,i):t;return s=s.replace("http://","https://")},_a=n(87),ba=function(){return(ba=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},wa=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Ia=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Oa={},Ea=function(t){return t.$entityType+":"+t.id};function Ta(t,e,n){return wa(this,void 0,void 0,(function(){var r,o,i,s,a,u,c;return Ia(this,(function(l){switch(l.label){case 0:if(!n.placeholderEntityAllowLoading)return[2];Object.defineProperty(e,"$$loading",{value:!0,configurable:!0}),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.finder(e.id)];case 2:return l.sent(),[3,4];case 3:return((o=l.sent()).code===zn.NotFoundError.CODE||o.code===zn.PermissionDeniedError.CODE)&&(r=!0),[3,4];case 4:if(delete e.$$loading,r){for(i=0,s=Object.entries(n.notFoundAttributes);i<s.length;i++)a=s[i],u=a[0],c=a[1],Object(_a.a)(e,u)&&(e[u]=c);Object.defineProperty(e,"$notFound",{value:!0,configurable:!0}),t.inject(e),n.onNotFound&&n.onNotFound(),n.onLoad&&n.onLoad(null),n.onFinish&&n.onFinish(null)}else delete e.$placeholder,delete e.$notFound,t.inject(e),n.onSuccess&&n.onSuccess(e),n.onLoad&&n.onLoad(e),n.onFinish&&n.onFinish(e);return[2]}}))}))}function Sa(t,e,n){var r=Ea(e);if(!Oa[r])return n.placeholderEntityDelayBeforeRefreshing?(Object.defineProperty(e,"$$loadingScheduled",{value:!0,configurable:!0}),void(Oa[r]=setTimeout((function(){return function(t,e,n){return wa(this,void 0,void 0,(function(){return Ia(this,(function(r){try{return delete e.$$loadingScheduled,delete Oa[Ea(e)],e.$placeholder?[2,Ta(t,e,n)]:[2]}catch(t){console.error(t)}return[2]}))}))}(t,e,n)}),n.placeholderEntityDelayBeforeRefreshing))):Ta(t,e,n).catch(console.error)}function Aa(t,e){var n=e.finder,r=e.defaultPlaceholderAttrs,o=e.defaultNotFoundAttrs,i=e.placeholderEntityDelayBeforeRefreshing,s=e.placeholderEntityAllowLoading,a=e.shouldEnsure;t.ensureEntity=function(e,a){return void 0===a&&(a={}),"function"==typeof i&&(i=i()),"function"==typeof s&&(s=s()),function(t,e,n,r){var o;void 0===r&&(r={});var i=t.get(e);if(i)i.$placeholder?i.$$loading||i.$notFound||r.onlyPlaceholder||Sa(t,i,r):(r.onExists&&r.onExists(i),r.onFinish&&r.onFinish(i));else{if(n=ba(((o={})[t.idAttribute]=e,o),n),r.onMissing&&r.onMissing(),i=t.createInstance(n),Object.defineProperty(i,"$placeholder",{value:!0,configurable:!0}),t.inject(i),r.onlyPlaceholder)return i;Sa(t,i,r)}}(t,e,ba(ba({},r),a.attrs),ba({finder:n,notFoundAttributes:o,placeholderEntityDelayBeforeRefreshing:i,placeholderEntityAllowLoading:s},a))},t.waitForEnsuredEntity=function(e,n){return void 0===n&&(n={}),new Promise((function(r,o){t.ensureEntity(e,ba(ba({},n),{onFinish:r}))}))},t.shouldEnsure=function(e,n,r){return void 0===r&&(r={}),"string"==typeof e&&(e=t.get(e)),!e||(!(!a||!a(e,n,r))||!(!e.$placeholder||e.$$loading||n))}}var Ca=function(){return(Ca=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ra=["autoForwardReceiverIds","conversationId","department","title"],Pa=function(t,e){var n=e.host,r=t.defineModel("user",{replaceKeys:{avatar:"avatarUrl",blockedPersonal:"contactsMessagingBlockedByOrganizationIds",organizationKey:"organizationId",organizationToken:"organizationId",timeToLive:"messagesTTL"},defaultValues:{botRole:null,contactsMessagingBlockedByOrganizationIds:[],isPatient:!1,isPatientContact:!1,organizationIds:[],presence:fr.UNKNOWN,profileByOrganizationId:{},removedFromOrg:!1,roles:[]},skipCamelizationForKeys:["metadata"],parseAttrs:function(t){var e=t.organizationId;if(t.dndAutoForwardReceivers?t.autoForwardReceiverIds=t.dndAutoForwardReceivers.map((function(t){return t.token})):""===t.dndAutoForwardReceiver||"undefined"===t.dndAutoForwardReceiver?t.autoForwardReceiverIds=[]:void 0!==t.dndAutoForwardReceiver&&(t.autoForwardReceiverIds=[t.dndAutoForwardReceiver]),delete t.dndAutoForwardReceiver,delete t.dndAutoForwardReceivers,e){delete t.organizationId,t.organizationIds||(t.organizationIds=[]),t.organizationIds.includes(e)||t.organizationIds.push(e);var r=Ca(Ca({},h.a.pick(t,Ra)),{userId:t.id,organizationId:e});delete t.autoForwardReceiverIds,delete t.conversationId,t.profileByOrganizationId||(t.profileByOrganizationId={}),t.profileByOrganizationId[e]=r}if("patientId"in t&&!t.patientId.startsWith("patient:")){var o="patient:"+t.patientId,i=t.patientId;t.isPatient=!t.isPatientContact,t.patientId=o,t.patientBroadcastListDetails={addedByDisplayName:t.addedByDisplayName,addedOn:t.addedOn};var s={id:o,dob:t.patientDob,gender:t.patientGender,mrn:t.patientMrn};if(t.isPatient)s.userId=t.id;else if(t.isPatientContact){var a="patientContact:"+t.id;t.patientContactId=a,n.models.User.injectPlaceholder({id:i,displayName:t.patientDisplayName,patientId:o}),n.models.PatientContact.injectPlaceholder({id:a,relation:t.relationName,userId:t.id,patientId:o}),s.userId=i}n.models.Patient.injectPlaceholder(s),delete t.addedByDisplayName,delete t.addedOn,delete t.patientDisplayName,delete t.patientDob,delete t.patientGender,delete t.patientMrn,delete t.relationName}if("metadata"in t){if("feature_service"in t.metadata&&"patient_messaging"===t.metadata.feature_service){var u=(s=t.metadata).is_patient_contact;"string"==typeof u&&"true"===u||"boolean"==typeof u&&u?(t.patientContactId="patientContact:"+t.id,t.isPatientContact=!0,n.users._injectPatientContactEntity(t,e)):(t.patientId="patient:"+t.id,t.isPatient=!0,n.users._injectPatientEntity(s,t.id,e))}"feature_service"in t.metadata&&"role"===t.metadata.feature_service&&e&&n.roles.__injectRoleFromMetadata({metadata:Ca(Ca({},t.metadata),{display_name:t.display_name,token:t.id}),organizationId:e}),delete t.metadata}return t.avatarUrl&&(t.avatarUrl=ma(t.avatarUrl,n.config)),!t.displayName&&t.name&&(t.displayName=t.name),t.displayName&&Object(Eo.isPhone)(t.displayName)&&(t.displayName=Object(Eo.formatPhone)(t.displayName)),t},beforeInject:function(t,e){if(e&&(t.organizationIds&&(t.organizationIds=h.a.union(e.organizationIds,t.organizationIds)),t.profileByOrganizationId)){var n={};if(e.profileByOrganizationId)for(var r=0,o=Object.entries(e.profileByOrganizationId);r<o.length;r++){var i=o[r],s=i[0],a=i[1];n[s]={},Object.assign(n[s],a)}for(var u=0,c=Object.entries(t.profileByOrganizationId);u<c.length;u++){var l=c[u];s=l[0],a=l[1];n[s]||(n[s]={}),Object.assign(n[s],a)}t.profileByOrganizationId=n}},afterAssignment:function(t){var e=t.profileByOrganizationId;t.contactsMessagingBlocked=t.contactsMessagingBlockedByOrganizationIds.length>0,t.isRoleBot=t.metadata.some((function(t){return"role"===t.data.feature_service})),t.shouldDisplay=!t.metadata.some((function(t){return"true"===t.data.invisible}));for(var r=0,o=Object.values(e);r<o.length;r++){var i=o[r];t.dnd||(i.autoForwardReceiverIds=[]),n.users._setMembersOnEntity(i,"autoForwardReceiverIds","autoForwardReceivers")}t.removedFromOrg&&(!t.displayName||t.$$loading||t.$$loadingScheduled||t.$notFound)&&(t.displayName="Removed User")},relations:{belongsTo:{patient:{type:"patient",foreignKey:"patientId"},patientContact:{type:"patientContact",foreignKey:"patientContactId"}},hasMany:{metadata:{type:"metadata",foreignKey:"entityId"}}}});return Aa(r,{finder:function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=n.users).find.apply(t,e)},placeholderEntityDelayBeforeRefreshing:function(){return n.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return n.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading..."},defaultNotFoundAttrs:{displayName:"<User Not Found>"}}),r},ja=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xa=function(){return(xa=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ma=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},ka=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Na=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},za=["avatar","conversation_id","department","description","display_name","dnd_auto_forward_receiver","dnd","first_name","group_token","is_public","last_login_time","last_name","members","name","network","num_members","organization_key","pagers","status","title","token","total_members"],Da={distributionList:pr.toServer(pr.DISTRIBUTION_LIST),distributionListMember:pr.toServer(pr.DISTRIBUTION_LIST_MEMBER),forum:pr.toServer(pr.FORUM),group:pr.toServer(pr.GROUP),messageTemplate:pr.toServer(pr.MESSAGE_TEMPLATE),organization:pr.toServer(pr.ORGANIZATION),patient_account:pr.toServer(pr.PATIENT),patientDistributionList:pr.toServer(pr.PATIENT_DISTRIBUTION_LIST),scheduledMessage:pr.toServer(pr.SCHEDULED_MESSAGE),tag:pr.toServer(pr.TAG),team:pr.toServer(pr.TEAM),user:pr.toServer(pr.USER)},Ua=Object.values(Da),La=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._query=function(t){return ka(e,void 0,void 0,(function(){var e,n,r,o,i,s,a,u,c,l,d,f,h,p,v,y,g,m,_,b,w,I,O,E,T,S,A,C,R,P,j,x,M,k,N,z,D,U,L,F,B,q,V;return Na(this,(function(G){switch(G.label){case 0:return e=t.continuation,n=void 0===e?null:e,r=t.excludeIds,o=void 0===r?[]:r,i=t.excludeSelf,s=void 0!==i&&i,a=t.followContinuations,u=void 0!==a&&a,c=t.network,l=void 0===c?"provider":c,d=t.params,n&&(d=xa(xa({},d),{continuation:n})),h=[],"patient"===l||d.type.includes("patient_account")?[4,this.host.api.search.patientQuery(d)]:[3,2];case 1:return(f=G.sent()).metadata.continuation||(f.metadata.continuation=null),[3,4];case 2:return[4,this.host.api.search.query(d)];case 3:f=G.sent(),G.label=4;case 4:for(h=f.results,p=[],v=0,y=h;v<y.length;v++)R=y[v],M=R.type,j=R.entity,x=R.organization_id,g={entityAttrs:j,organizationId:x,type:M},this.config.condensedReplays?j.conversation_id?(g.conversationId=j.conversation_id,delete j.conversation_id):g.conversationId=R.conversation_id:delete j.conversation_id,0!==Object.keys(j).length&&("tigertext:entity:account"===M?Object(to.n)(j,"status","account_status"):"tigertext:entity:tag"===M&&(j.token=x+":"+j.token),(D=j.metadata)&&this.host.metadata.__injectMetadata(j.token,x,D),p.push(g));return m=f.metadata,_=m.continuation,b=m.first_hit,w=m.total_hits,I={firstHit:b,totalHits:w},_&&(u?I.firstHit=1:I.continuation=_),O=[],E=[],T=function(t){for(var e=0,n=t.results;e<n.length;e++){var r=n[e];O.push(r)}},u&&_&&E.push(this._query(xa(xa({},t),{continuation:_})).then(T)),[4,Promise.all(E)];case 5:for(G.sent(),S=[],A=0,C=p;A<C.length;A++)R=C[A],P=R.conversationId,j=R.entityAttrs,x=R.organizationId,M=R.type,k=this.host.modelNameByTypeNS(M),(N="group"===k&&this.host.groups.__extractGroupTypeFromAttrs(j))===tr.FORUM&&delete j.members,z=this.host.metadata.get(j.token,x),D=z?z.data:null,"user"===(U=this.host.conversations.__injectCounterParty({conversationId:P,entityAttrs:j,entityType:k,groupType:N,hasCurrentUser:!1,organizationId:x})).$entityType&&D&&"role"===D.feature_service&&this.host.roles.__injectSearchResult({entity:U,metadata:D,organizationId:x}),o.length&&o.includes(U.id)||(L=this.host.currentUserId,s&&U.id===L||(U?(U.isRoleBot&&U.botRole&&(U=U.botRole),F=new ga(U,x,P,D),S.unshift(F)):this.logger.warn("no entity for ",R)));for(B=0,q=S;B<q.length;B++)V=q[B],O.unshift(V);return[2,{results:O,metadata:I}]}}))}))},e._searchLocalOrganization=function(t){for(var e=t.organization,n=t.query,r=t.types,o=void 0===r?[]:r,i=e.conversations,s=e.id,a=[],u=0,c=i;u<c.length;u++){var l=c[u],d=l.counterParty,f=l.counterPartyType,h=l.metadata,p=Da[f];if(o.includes(p))if(n&&0!==Object.keys(n).length){for(var v=!0,y=0,g=Object.entries(n);y<g.length;y++){var m=g[y],_=m[0],b=m[1];_=_.split(","),b=b.toLowerCase();for(var w=!1,I=0,O=_;I<O.length;I++){var E=O[I],T="user"===f&&Ra.includes(E)?d.profileByOrganizationId[s]:d;if(T){var S=T[E];if(void 0!==S&&S.toLowerCase().includes(b)){w=!0;break}}}if(!w){v=!1;break}}v&&a.push(new ga(d,s,h))}else a.push(new ga(d,s,h))}return a},e}return ja(e,t),e.prototype.query=function(t){return ka(this,void 0,void 0,(function(){var e,n,r,o,i,s,a,u,c,l,d,f,p,v,y,g,m,_,b,w,I,O,E,T,S,A,C,R,P,j,x,M,k,N,z,D,U,L,F,B,q,V,G,H,W,Y,K,$,X,Q,Z,J;return Na(this,(function(tt){switch(tt.label){case 0:if(e=t.continuation,n=void 0===e?null:e,r=t.enabledCapabilities,o=void 0===r?[]:r,i=t.excludeEmptyLists,s=void 0!==i&&i,a=t.excludeIds,u=void 0===a?[]:a,c=t.excludeSelf,l=void 0!==c&&c,d=t.followContinuations,f=void 0!==d&&d,p=t.includeDisabled,v=void 0!==p&&p,y=t.network,g=void 0===y?"provider":y,m=t.organizationId,_=void 0===m?null:m,b=t.organizationIds,w=void 0===b?[]:b,I=t.pageSize,O=t.query,E=void 0===O?{}:O,T=t.resultsFormat,S=void 0===T?"entities":T,A=t.returnFields,C=void 0===A?za:A,R=t.sort,P=void 0===R?[]:R,j=t.types,0===(x=void 0===j?[]:j).length)throw new zn.ValidationError("types","required","no types specified");if(x=h.a.uniq(x.map((function(t){return pr.isValid(t)?pr.toServer(t):Da[t]}))),(M=h.a.difference(x,Ua)).length>0)throw new zn.ValidationError("types","invalid","invalid types: "+M.join(", "));if(_&&(w=[_]),0===w.length)throw new zn.ValidationError("organizationIds","invalid","search must be done in a context of an organization");if(1===w.length&&(k=this.host.models.Organization.get(_))&&k.isContacts)return N=this._queryLocalOrganization({organization:k,query:E,types:x}),X=N.results,z=N.metadata,[2,{results:X,metadata:z}];if("ids"===S&&(S="tokens"),u=Object(to.d)(u),D={directory:w,include_disabled:v,render_metadata:!0,results_format:S,return_fields:C,type:x},o.length&&(D.enabled_capabilities=o),P&&P.length?D.sort=P.map((function(t){return to.a.underscoreKey(t)})):"object"==typeof P&&(D.sort=P),D.type.includes("schedule_message")&&t.feedLevel&&(D.feed_level=t.feedLevel),isNaN(parseInt(I))||(D.page_size=I),U={},E&&Object.keys(E).length>0){for(L=0,F=Object.entries(E);L<F.length;L++)B=F[L],q=B[0],V=B[1],q.includes(",")&&(G=q.split(",").map(to.a.underscoreKey).join(","),U[G]=V,delete E[q]);U=xa(xa({},U),to.a.underscoreObject(E)),D.bool={must:U}}return s&&(x.includes("distribution_list")||x.includes("patient_distribution_list"))&&(D.bool=Object.assign({},D.bool,{must_not:{total_members:"0"}})),H=[{continuation:n,excludeIds:u,excludeSelf:l,followContinuations:f,network:g,params:D}],[4,Promise.all(H.map(this._query))];case 1:for(W=tt.sent(),Y=[],K=0,$=W;K<$.length;K++)for(X=$[K].results,Q=0,Z=X;Q<Z.length;Q++)J=Z[Q],Y.push(J);return[2,{results:Y=h.a.uniqBy(Y,"entity"),metadata:W[0].metadata}]}}))}))},e.prototype._queryLocalOrganization=function(t){var e=t.organization,n=t.query,r=t.types,o=e.id,i=this._searchLocalOrganization({organization:e,query:n,types:r}),s={firstHit:1,totalHits:i.length},a=Object.keys(n);if(0===i.length&&a.length>0){var u=a.find((function(t){return t.includes("displayName")})),c=u?n[u]:n[a[0]];if(Object(vt.isEmail)(c)||Object(Eo.isPhone)(c)){var l=Object(vt.isEmail)(c)?c:Object(Eo.normalizePhoneUS)(c),d=this.host.models.User.createInstance({displayName:Object(Eo.isPhone)(c)?Object(Eo.formatPhone)(c):c,id:l,messageAnyoneRecipient:!0,organizationId:o});return{results:[new ga(d,o,s)],metadata:s}}}return{results:i,metadata:s}},Ma([Object(Or.decorator)()],e.prototype,"query",null),e}(no),Fa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ba=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},qa=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Va=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Ga=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fa(e,t),e.prototype.mounted=function(){this._fetched=!1},e.prototype.dispose=function(){this._fetched=!1},e.prototype.find=function(t,e){var n=void 0===e?{}:e,r=n.organizationId,o=n.bypassCache,i=void 0!==o&&o;return qa(this,void 0,void 0,(function(){var e,n,o;return Va(this,(function(s){switch(s.label){case 0:if(this.host.requireUser(),!t)throw new zn.ValidationError("id","required");if(!r)throw new zn.ValidationError("organizationId","required");return i||!(e=this.host.models.Team.get(t))||e.$placeholder?[4,this.host.api.teams.find(t,{organizationId:r})]:[2,e];case 1:return n=s.sent(),o=n.team,[2,e=this.host.models.Team.inject(o)]}}))}))},e.prototype.refresh=function(t,e){var n=(void 0===e?{}:e).organizationId;return qa(this,void 0,void 0,(function(){return Va(this,(function(e){switch(e.label){case 0:return[4,this.find(t,{organizationId:n,bypassCache:!0})];case 1:return[2,e.sent()]}}))}))},e.prototype.findAll=function(t){var e=(void 0===t?{}:t).bypassCache,n=void 0!==e&&e;return qa(this,void 0,void 0,(function(){var t,e,r;return Va(this,(function(o){switch(o.label){case 0:return!n&&this._fetched?[2,this.getAll()]:0!==(t=this.host.models.Organization.getAll()).length?[3,2]:[4,this.host.organizations.findAll()];case 1:t=o.sent(),o.label=2;case 2:return[4,this.host.search.query({types:["team"],organizationIds:t.map((function(t){return t.id})),query:{displayName:""},followContinuations:!0})];case 3:return e=o.sent().results,r=e.map((function(t){return t.entity})),this._fetched=!0,[2,r]}}))}))},e.prototype.findByOrganizationId=function(t){return qa(this,void 0,void 0,(function(){var e,n;return Va(this,(function(r){switch(r.label){case 0:return t=this._resolveModelId(t),[4,this.host.organizations.find(t)];case 1:return e=r.sent(),[4,this.host.search.query({types:["team"],organizationIds:e.id,query:{displayName:""},followContinuations:!0})];case 2:return n=r.sent().results,[2,n.map((function(t){return t.entity}))]}}))}))},e.prototype.refreshAll=function(){return qa(this,void 0,void 0,(function(){return Va(this,(function(t){switch(t.label){case 0:return[4,this.findAll({bypassCache:!0})];case 1:return[2,t.sent()]}}))}))},e.prototype.getAll=function(){return this.host.models.Team.getAll()},e.prototype.create=function(t){var e=t.avatar,n=t.canMembersLeave,r=void 0===n||n,o=t.canRequestToJoin,i=void 0===o||o,s=t.description,a=t.displayName,u=t.memberIds,c=void 0===u?[]:u,l=t.organizationId;return qa(this,void 0,void 0,(function(){var t,n,o,u=this;return Va(this,(function(d){switch(d.label){case 0:if(this.host.requireUser(),!l)throw new zn.ValidationError("organizationId","required");if(c.length<2)throw new zn.ValidationError("memberIds","required to have 2 or more IDs");return[4,Promise.all(c.map(this.host.roles.__resolveRoleId).filter(Boolean).map((function(t){return u._resolveModelIdWithTypes(t,"user")})).map((function(t){return u.host.users.find(t,{organizationId:l})})))];case 1:return t=d.sent(),n=go.a.call(t),c=n.map((function(t){return u._resolveModelIdWithTypes(t,"user")})),[4,this.host.api.teams.create({avatar:e,canMembersLeave:r,canRequestToJoin:i,description:s,displayName:a,memberIds:c,organizationId:l})];case 2:return o=d.sent(),[2,this.host.models.Team.inject(o.team)]}}))}))},e.prototype.update=function(t){var e=t.avatar,n=t.canMembersLeave,r=void 0===n||n,o=t.canRequestToJoin,i=void 0===o||o,s=t.description,a=t.displayName,u=t.id,c=t.memberIds,l=void 0===c?[]:c,d=t.organizationId;return qa(this,void 0,void 0,(function(){var t;return Va(this,(function(n){switch(n.label){case 0:if(this.host.requireUser(),!u)throw new zn.ValidationError("id","required");if(!d)throw new zn.ValidationError("organizationId","required");if(l.length<2)throw new zn.ValidationError("memberIds","required to have 2 or more IDs");return l=l.map(this.host.roles.__resolveRoleId),[4,this.host.api.teams.update({avatar:e,canMembersLeave:r,canRequestToJoin:i,description:s,displayName:a,id:u,memberIds:l,organizationId:d})];case 1:return t=n.sent(),[2,this.host.models.Team.inject(t.team)]}}))}))},e.prototype.delete=function(t,e){var n=e.organizationId;return qa(this,void 0,void 0,(function(){var e,r;return Va(this,(function(o){switch(o.label){case 0:if(!n)throw new zn.ValidationError("organizationId","required");if(!t)throw new zn.ValidationError("teamId","required");return[4,this.host.api.teams.delete(t,{organizationId:n})];case 1:return 204===(e=o.sent())&&(r=this.host.models.Team.get(t))&&this.host.models.Team.eject(r),[2,e]}}))}))},e.prototype.requestToJoin=function(t,e){var n=e.requestedById,r=e.organizationId;return qa(this,void 0,void 0,(function(){var e;return Va(this,(function(o){switch(o.label){case 0:if(!r)throw new zn.ValidationError("organizationId","required");if(!t)throw new zn.ValidationError("teamId","required");if(!n)throw new zn.ValidationError("requestedById","required");return[4,this.host.api.teams.requestToJoin(t,{requestedById:n,organizationId:r})];case 1:return 204===(e=o.sent())&&this.host.models.Team.inject({id:t,hasCurrentUserPending:!0}),[2,e]}}))}))},e.prototype.acceptJoinRequest=function(t,e){var n=e.teamId,r=e.organizationId,o=e.handledAsId;return qa(this,void 0,void 0,(function(){return Va(this,(function(e){switch(e.label){case 0:if(!r)throw new zn.ValidationError("organizationId","required");if(!n)throw new zn.ValidationError("teamId","required");if(!t)throw new zn.ValidationError("requestId","required");if(!o)throw new zn.ValidationError("handledAsId","required");return[4,this.host.api.teams.updateJoinRequest(t,{teamId:n,organizationId:r,handledAsId:o,status:"accepted"})];case 1:return[2,e.sent()]}}))}))},e.prototype.declineJoinRequest=function(t,e){var n=e.teamId,r=e.organizationId,o=e.handledAsId;return qa(this,void 0,void 0,(function(){return Va(this,(function(e){switch(e.label){case 0:if(!r)throw new zn.ValidationError("organizationId","required");if(!n)throw new zn.ValidationError("teamId","required");if(!t)throw new zn.ValidationError("requestId","required");if(!o)throw new zn.ValidationError("handledAsId","required");return[4,this.host.api.teams.updateJoinRequest(t,{teamId:n,organizationId:r,handledAsId:o,status:"declined"})];case 1:return[2,e.sent()]}}))}))},e.prototype.leave=function(t,e){var n=(void 0===e?{}:e).organizationId;return qa(this,void 0,void 0,(function(){var e;return Va(this,(function(r){switch(r.label){case 0:if(!t)throw new zn.ValidationError("teamId","required");if(!n)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.teams.leave(t,{organizationId:n})];case 1:return 204===(e=r.sent())&&this.refresh(t,{organizationId:n}),[2,e]}}))}))},e.prototype._setHasUserPending=function(t){if(t.pendingRequestUserIds)for(var e=0,n=t.pendingRequestUserIds;e<n.length;e++){if(n[e]===this.host.currentUserId)return void(t.hasCurrentUserPending=!0)}},e.prototype.__injectTeamRequest=function(t){if(!t.id)return null;var e;if(t.created_by&&t.created_by.token&&(e=this.host.models.User.inject(t.created_by)),t.team&&t.team.id){var n=t.status,r=Object.assign({},t.team);e&&e.id===this.host.currentUserId&&("accepted"===n?(r.hasCurrentUserBeenDeclined=!1,r.hasCurrentUserPending=!1):"declined"===n&&(r.hasCurrentUserBeenDeclined=!0,r.hasCurrentUserPending=!1)),this.host.models.Team.inject(r)}return this.host.models.TeamRequest.inject(t)},e.prototype.resetDeclinedUserOnTeam=function(t){this.host.models.Team.inject({id:t,hasCurrentUserBeenDeclined:!1})},Ba([Object(Or.decorator)()],e.prototype,"find",null),Ba([Object(Or.decorator)()],e.prototype,"refresh",null),Ba([Object(Or.decorator)()],e.prototype,"findAll",null),Ba([Object(Or.decorator)()],e.prototype,"findByOrganizationId",null),Ba([Object(Or.decorator)()],e.prototype,"refreshAll",null),e}(no),Ha=n(64),Wa=n.n(Ha),Ya=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ka=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},$a=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},Xa=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Qa=vr.GLOBAL,Za=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._onMessageSending=function(t){e.stopTyping(t.counterPartyId,{senderId:t.senderId})},e}return Ya(e,t),e.prototype.mounted=function(){this._lastStartTypingAPICalls={},this._lastStopTypingAPICalls={},this._typers={},this._currentUserTyping={},this.host.on("message:sending",this._onMessageSending)},e.prototype.dispose=function(){vo.a.call(lo.a.call(vo.a.call(Wa.a.call(this._typers),h.a.values)),"timer").forEach((function(t){return null!==t&&clearTimeout(t)})),vo.a.call(Wa.a.call(this._currentUserTyping),"timer").forEach((function(t){return null!==t&&clearTimeout(t)})),this._lastStartTypingAPICalls=null,this._lastStopTypingAPICalls=null,this._typers=null,this.host.removeListener("message:sending",this._onMessageSending)},e.prototype.reactToIsTypingEvent=function(t){var e,n=this,r=t.data;if(this.host.requireUser(),(e=r.proxy_token?r.proxy_token:r.sender_token)!==this.host.currentUserId){var o=r.group_token,i=r.org_token,s=o||i||null,a=o?vr.GROUP:i?vr.ORGANIZATION:Qa,u="typing"===r.status;this.host.models.User.ensureEntity(e,{onlyPlaceholder:!1}),a===Qa?h.a.get(this.host,"currentUser.organizationIds",[]).forEach((function(t){n._setTypingStatusOfUser(t,vr.ORGANIZATION,e,u)})):this._setTypingStatusOfUser(s,a,e,u)}},e.prototype.startTyping=function(t,e){var n=void 0===e?{}:e,r=n.autoStopAfterTimeout,o=n.senderId,i=n.organizationId;return $a(this,void 0,void 0,(function(){var e,n,s=this;return Xa(this,(function(a){switch(a.label){case 0:return void 0===t?[2]:(t=this._resolveModelId(t),o=this._resolveModelId(o),this.host.requireUser(),[4,this._sendStartTyping(t,o,i)]);case 1:return a.sent(),(e=this._currentUserTyping[t])?(clearTimeout(this._currentUserTyping[t].timer),e.timer=null):(e={},this._currentUserTyping[t]=e),n="number"==typeof r?r:this.host.config.clearTypingStatusTimeout,e.timer=setTimeout((function(){s.logger.info("auto stop typing for current user",t),s.stopTyping(t,{senderId:o})}),n),[2]}}))}))},e.prototype._sendStartTyping=function(t,e,n){return $a(this,void 0,void 0,(function(){var r,o,i,s,a,u;return Xa(this,(function(c){switch(c.label){case 0:return this._lastStartTypingAPICalls[t]?(r=this._lastStartTypingAPICalls[t],o=r.expiresAt,i=r.retVal,s=r.lastSenderId,e===s?[3,2]:[4,this.stopTyping(t,{senderId:s})]):[3,3];case 1:c.sent(),c.label=2;case 2:if(wo()().isBefore(o))return[2,i];c.label=3;case 3:return[4,this.host.api.typingStatus.startTyping(t,e,n)];case 4:return a=c.sent(),u=wo()().add(this.config.clearTypingStatusThrottleDelay,"ms"),this._lastStartTypingAPICalls[t]={expiresAt:u,retVal:a,lastSenderId:e},[2,a]}}))}))},e.prototype.stopTyping=function(t,e){var n=(void 0===e?{}:e).senderId;return $a(this,void 0,void 0,(function(){var e;return Xa(this,(function(r){switch(r.label){case 0:return void 0===t?[2]:(t=this._resolveModelId(t),n=this._resolveModelId(n),this.host.requireUser(),(e=this._currentUserTyping[t])&&null!==e.timer&&(clearTimeout(e.timer),e.timer=null),[4,this._sendStopTyping(t,n)]);case 1:return r.sent(),[2]}}))}))},e.prototype._sendStopTyping=function(t,e){return $a(this,void 0,void 0,(function(){var n,r,o,i,s;return Xa(this,(function(a){switch(a.label){case 0:return(n=this._lastStopTypingAPICalls[t])&&(r=n.expiresAt,o=n.retVal,wo()().isBefore(r))?[2,o]:[4,this.host.api.typingStatus.stopTyping(t,e)];case 1:return i=a.sent(),s=wo()().add(this.config.clearTypingStatusThrottleDelay,"ms"),this._lastStopTypingAPICalls[t]={expiresAt:s,retVal:i,senderId:e},[2,i]}}))}))},e.prototype._setTypingStatusOfUser=function(t,e,n,r,o){var i=this;void 0===o&&(o=!1),t=t||vr.GLOBAL;var s=this._typers[t];if(r){s||(s={},this._typers[t]=s);var a=(u=s[n])&&null!==u.timer;if(u?clearTimeout(u.timer):(u={},s[n]=u),u.timer=setTimeout((function(){i.logger.info("auto stop typing for other typer",t,n),i._setTypingStatusOfUser(t,e,n,!1,!0)}),this.host.config.clearTypingStatusTimeout),a)return}else{var u;if(!(a=(u=s&&s[n])&&null!==u.timer))return;clearTimeout(u.timer),u.timer=null}this.emit("change",{userId:n,contextId:t,contextType:e,isTyping:r,timedOut:o})},e.prototype.isUserTyping=function(t,e){var n=this,r=(void 0===e?{}:e).organizationId;return t=this._resolveModelId(t),r?this._isUserTypingInContext(r,t):h.a.get(this.host,"currentUser.organizationIds",[]).some((function(e){return n._isUserTypingInContext(e,t)}))},e.prototype.isCurrentUserTyping=function(t){t=this._resolveModelId(t);var e=this._currentUserTyping[t];return!!e&&null!==e.timer},e.prototype.isUserTypingInGroup=function(t,e){return e=this._resolveModelId(e),t=this._resolveModelId(t),this._isUserTypingInContext(t,e)},e.prototype._isUserTypingInContext=function(t,e){var n=this._typers[t],r=n&&n[e];return!!r&&null!==r.timer},Ka([Object(Or.decorator)()],e.prototype,"_sendStartTyping",null),Ka([Object(Or.decorator)()],e.prototype,"_sendStopTyping",null),e}(no),Ja=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tu=function(){return(tu=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},eu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},nu=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ru=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},ou=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ja(e,t),e.prototype.dispose=function(){Or.decorator.clear(this._findAll)},e.prototype.findAll=function(t){var e=void 0===t?{}:t,n=e.userId,r=void 0===n?this.host.currentUserId:n,o=e.organizationId;return nu(this,void 0,void 0,(function(){return ru(this,(function(t){return this.host.requireUser(),[2,this._findAll(r,o)]}))}))},e.prototype.refreshAll=function(t){var e=void 0===t?{}:t,n=e.userId,r=void 0===n?this.host.currentUserId:n,o=e.organizationId;return nu(this,void 0,void 0,(function(){return ru(this,(function(t){return this.host.requireUser(),Or.decorator.clear(this._findAll),[2,this._findAll(r,o)]}))}))},e.prototype._findAll=function(t,e){return void 0===e&&(e=this._pickOrganizationId()),nu(this,void 0,void 0,(function(){var n,r,o=this;return ru(this,(function(i){switch(i.label){case 0:return[4,this.host.api.userRoles.findAll(t,e)];case 1:return n=i.sent(),r={userRoles:[],productRoles:[]},n.forEach((function(e){var n=e.organization,i=e.product;if(n){var s=n.organization_id,a=o.host.organizations.getById(s),u=o.host.models.UserRoles.inject(tu({id:o._getOrganizationKey({organizationId:s,userId:t}),userId:t},n));a&&o.host.models.Organization.touch(a),r.userRoles.push(u)}else if(i){var c=i.product_id,l=o.host.models.ProductRoles.inject(tu({id:o._getProductKey({productId:c,userId:t}),userId:t},i));o.host.models.Product.inject({id:c}),r.productRoles.push(l)}})),[2,r]}}))}))},e.prototype._pickOrganizationId=function(){var t=this.host.organizations.getAll();return 0===t.length?"placeholder":t[0].id},e.prototype.getAllUserRoles=function(){return this.host.models.UserRoles.getAll()},e.prototype.getByOrganizationId=function(t,e){var n=(void 0===e?{}:e).userId,r=void 0===n?this.host.currentUserId:n,o=this._getOrganizationKey({organizationId:t,userId:r});return this.host.models.UserRoles.get(o)},e.prototype._getOrganizationKey=function(t){var e=t.organizationId,n=t.userId;return"userRoles:"+(void 0===n?this.host.currentUserId:n)+":"+e},e.prototype.getAllProductRoles=function(){return this.host.models.ProductRoles.getAll()},e.prototype.getByProductId=function(t,e){var n=(void 0===e?{}:e).userId,r=void 0===n?this.host.currentUserId:n,o=this._getProductKey({productId:t,userId:r});return this.host.models.ProductRoles.get(o)},e.prototype._getProductKey=function(t){var e=t.productId,n=t.userId;return"productRoles:"+(void 0===n?this.host.currentUserId:n)+":"+e},eu([Object(Or.decorator)()],e.prototype,"findAll",null),eu([Object(Or.decorator)()],e.prototype,"refreshAll",null),eu([Object(Or.decorator)({memoize:!0,serializeArguments:function(t){return t[0]}})],e.prototype,"_findAll",null),e}(no),iu=n(89),su=n.n(iu),au=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),uu=function(){return(uu=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},cu=function(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},lu=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},du=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},fu=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},hu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.PROFILE_ATTRIBUTES_PER_ORG=Ra,e._setMembersOnEntity=function(t,n,r){void 0===n&&(n="memberIds"),void 0===r&&(r="members");var o=t,i=o[n],s=o[r];if(i){s?s.length=0:s=[];for(var a=0,u=i;a<u.length;a++){var c=u[a],l=e.host.models.User.get(c);l&&s.push(l)}}else s=null;t[r]=s},e._injectPatientEntity=function(t,n,r){var o="patient:"+n;if(t.id=o,t.organizationId=r,t.userId=n,e.host.models.Patient.inject(t),t.patient_contacts)for(var i=0,s=t.patient_contacts;i<s.length;i++){var a=s[i],u=a.entity?a.entity:a,c=u.token||u.id;u.id=c,u.patientId=o,e.host.models.User.inject(u)}},e._injectPatientContactEntity=function(t,n){t.entity&&(t=t.entity);var r=t.metadata,o={editVersion:r.edit_version,id:"patientContact:"+t.id,organizationId:n,patientDob:r.patient_dob,patientGender:r.patient_gender,patientId:"patient:"+r.patient_id,patientMrn:r.patient_mrn,phoneNumber:r.phone_number,relationName:r.relation_name,smsOptedOut:r.sms_opted_out,userId:t.id};e.host.models.PatientContact.inject(o)},e._onChangeMetadata=function(t,n){var r=n.entityId,o=e.host.models.User.get(r);o&&e.host.models.User.inject(o)},e._onChangeRole=function(t,n){var r=e.host.currentUserId,o=n.botUserId,i=n.memberIds;i||(i=[]),o&&e.host.models.User.injectPlaceholder({id:o,botRole:n});var s={},a=e._roleMemberIds[n.id];if(a)for(var u=0,c=a;u<c.length;u++){var l=c[u];if((p=e.host.models.User.get(l))&&!i.includes(l)){var d=(_=p.roles).indexOf(n);d>-1&&(_.splice(d,1),s[l]=_)}}e._roleMemberIds[n.id]=i;for(var f=0,h=i;f<h.length;f++){var p;l=h[f];(_=(p=e.host.models.User.get(l))?p.roles:[]).includes(n)||(_.push(n),s[l]=_)}for(var v=0,y=Object.entries(s);v<y.length;v++){var g=y[v],m=g[0],_=g[1];e.host.models.User.injectPlaceholder({id:m,roles:_}),m===r&&e._onChangeCurrentUserRole(n)}},e._onRemoveRole=function(t,n){var r=n.botUserId;r&&e.host.models.User.injectPlaceholder({id:r,botRole:null});var o=e._roleMemberIds[n.id];if(o){for(var i=0,s=o;i<s.length;i++){var a=s[i],u=e.host.models.User.get(a);if(u){var c=u.roles,l=c.indexOf(n);l>-1&&(c.splice(l,1),e.host.models.User.inject(u))}}delete e._roleMemberIds[n.id]}},e.getPreferences=function(t){return void 0===t&&(t=e.host.currentUserId),lu(e,void 0,void 0,(function(){return du(this,(function(e){switch(e.label){case 0:if(!t)throw new zn.ValidationError("userId","required");return[4,this.host.api.users.getPreferences(t)];case 1:return[2,e.sent()]}}))}))},e.editPreferences=function(t){var n=t.quickReplies,r=void 0===n?[]:n,o=t.organizationId,i=t.userId,s=void 0===i?e.host.currentUserId:i;return lu(e,void 0,void 0,(function(){return du(this,(function(t){switch(t.label){case 0:if(!r)throw new zn.ValidationError("quickReplies","required");if(!o)throw new zn.ValidationError("organizationId","required");if(!s)throw new zn.ValidationError("userId","required");return[4,this.host.api.users.editPreferences({organizationId:o,quickReplies:r,userId:s})];case 1:return[2,t.sent()]}}))}))},e}return au(e,t),e.prototype.mounted=function(){this._defaultOrganizationId=null,this._roleMemberIds={},this.host.models.Metadata.on("afterInject",this._onChangeMetadata),this.host.models.Metadata.on("afterEject",this._onChangeMetadata),this.host.models.Role.on("afterInject",this._onChangeRole),this.host.models.Role.on("afterEject",this._onRemoveRole)},e.prototype.dispose=function(){this._defaultOrganizationId=null,this._roleMemberIds={},this.host.models.Metadata.removeListener("afterInject",this._onChangeMetadata),this.host.models.Metadata.removeListener("afterEject",this._onChangeMetadata),this.host.models.Role.removeListener("afterInject",this._onChangeRole),this.host.models.Role.removeListener("afterEject",this._onRemoveRole)},e.prototype.signInWithMagicToken=function(t,e){void 0===e&&(e={});var n={Authorization:"magic-token "+t};return this._signInWithHeaders(n,e)},e.prototype.signInWithApiKeyAndSecret=function(t,e,n){void 0===n&&(n={});var r=this.httpClient.getAuthHeaders({key:t,secret:e});return this._signInWithHeaders(r,n)},e.prototype.signIn=function(t,e,n){void 0===n&&(n={}),Object(Eo.isPhone)(t)&&(t=Object(Eo.normalizePhoneUS)(t));var r={Authorization:this.getSignInAuthHeader(t,e)};return this._signInWithHeaders(r,n)},e.prototype._checkPartnerName=function(){if(!this.config.partnerName)throw new Error("`partnerName` must be supplied as a config option for `new TigerConnect.Client()`")},e.prototype._signInWithHeaders=function(t,e){return void 0===e&&(e={}),lu(this,void 0,void 0,(function(){var n,r;return du(this,(function(o){switch(o.label){case 0:return this._checkPartnerName(),[4,this.host.api.users.signIn(t,e)];case 1:return n=o.sent(),r=this.host.models.User.inject(n.data.user),[2,{auth:n.data.auth,user:r}]}}))}))},e.prototype.checkLogin=function(t,e){return void 0===e&&(e={udid:void 0}),lu(this,void 0,void 0,(function(){return du(this,(function(n){switch(n.label){case 0:return this._checkPartnerName(),[4,this.host.api.users.checkLogin(t,e)];case 1:return[2,n.sent().data]}}))}))},e.prototype.signUp=function(t){return void 0===t&&(t={udid:void 0,email:void 0,password:void 0,countryCode:void 0,version:void 0}),lu(this,void 0,void 0,(function(){var e,n,r,o;return du(this,(function(i){switch(i.label){case 0:return[4,this.host.api.users.signUp(t)];case 1:return e=i.sent(),n=this.host.models.User.inject(e.data.user),r=e.data.auth,o={user:n,auth:r},this.host.emit("signUp",o),[2,o]}}))}))},e.prototype.signOut=function(t){var e=void 0===t?{}:t,n=e.fromServer,r=void 0!==n&&n,o=e.resetClient,i=void 0===o||o;return lu(this,void 0,void 0,(function(){var t,e,n,o;return du(this,(function(s){switch(s.label){case 0:if(!this.host.isSignedIn)return[2,!1];t=!1,e=!1,this.host.emit("signingOut",{fromServer:r,resetClient:i}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.host.api.users.signOut()];case 2:return n=s.sent(),t=!0,[3,4];case 3:return o=s.sent(),e=!0,this.httpClient.isUnauthorizedError(o)?(t=!0,[3,4]):[2,Promise.reject(o)];case 4:return t&&(this.host._setCurrentUser(null),this.host._removeAuth()),this.host.emit("signedOut",{externalLogoutUrl:e?null:n.data.external_logout_url,fromServer:r,resetClient:i&&t,signedOut:t}),[2,t]}}))}))},e.prototype.createQRCode=function(){return lu(this,void 0,void 0,(function(){return du(this,(function(t){switch(t.label){case 0:return[4,this.host.api.qrCode.create()];case 1:return[2,t.sent()]}}))}))},e.prototype.findOrCreate=function(t,e){return void 0===e&&(e={}),lu(this,void 0,void 0,(function(){var n,r,o,i,s,a,u;return du(this,(function(c){switch(c.label){case 0:return n=e.organizationId,r=!1,n?[4,this.host.organizations._findAll()]:[3,2];case 1:c.sent(),o=this.host.models.Organization.get(n),r=!!o&&o.isContacts,c.label=2;case 2:return(i=r&&(Object(vt.isEmail)(t)||Object(Eo.isPhone)(t)))&&t!==this.host.currentUserId&&!this.getById(t)?[3,4]:[4,this.find(t,{organizationId:n,ignoreNotFound:!0})];case 3:s=c.sent(),c.label=4;case 4:return s||!i?[3,8]:[4,this.host.api.users.lookup(t)];case 5:return(a=c.sent())?this.config.condensedReplays?[3,7]:[4,this.find(a.token,{organizationId:n})]:[2,null];case 6:return s=c.sent(),[3,8];case 7:(u=a.entity).conversationId=a.conversation_id,u.organizationId=a.organization_id,s=this.host.models.User.inject(u),c.label=8;case 8:return[2,s]}}))}))},e.prototype.signOutAllDevices=function(){return lu(this,void 0,void 0,(function(){return du(this,(function(t){switch(t.label){case 0:return[4,this.host.api.users.wipe(this.host.currentUserId)];case 1:return[2,t.sent()]}}))}))},e.prototype.findMe=function(t){return void 0===t&&(t={}),lu(this,void 0,void 0,(function(){var e,n,r,o;return du(this,(function(i){switch(i.label){case 0:return t=h.a.defaults(t,{ignoreNotFound:!1}),this.host.requireUser(),[4,this.host.api.users.findMe()];case 1:if(e=i.sent())return e.entity&&(e.entity.organization_token=e.organization_id,e=e.entity),n=e.metadata,r=e.organization_token,this._defaultOrganizationId=r,o=this.host.models.User.inject(e),n&&this.host.metadata.__injectMetadata(o.id,r,n),[2,o];if(!t.ignoreNotFound)throw new zn.NotFoundError(this.host.models.User.name,"me");return[2]}}))}))},e.prototype.findDefaultOrganizationId=function(){return lu(this,void 0,void 0,(function(){return du(this,(function(t){switch(t.label){case 0:return this._defaultOrganizationId?[3,2]:[4,this.findMe()];case 1:t.sent(),t.label=2;case 2:return[2,this._defaultOrganizationId]}}))}))},e.prototype.findMyProfilesForAllOrganizations=function(t){return void 0===t&&(t={}),lu(this,void 0,void 0,(function(){var t;return du(this,(function(e){switch(e.label){case 0:return[4,this.host.organizations.findAll()];case 1:return t=e.sent().map((function(t){return t.id})),[2,this.findProfileForOrganizations(this.host.currentUserId,t)]}}))}))},e.prototype.find=function(t,e){return void 0===e&&(e={}),lu(this,void 0,void 0,(function(){var n,r,o,i,s,a,u,c,l,d,f,p,v,y=this;return du(this,(function(g){switch(g.label){case 0:return e=h.a.defaults(e,{bypassCache:!1,ignoreNotFound:!1}),this.host.requireUser(),n=this.host.models.User.get(t),o=!0,e.organizationIds?(r=e.organizationIds,[3,4]):[3,1];case 1:return e.organizationId?(r=[e.organizationId],[3,4]):[3,2];case 2:return o=!1,r=n?fu(n.organizationIds):[],[4,this.findDefaultOrganizationId()];case 3:i=g.sent(),r.includes(i)||r.push(i),g.label=4;case 4:for(s=uu(uu({},e),{ignoreNotFound:!0}),a=[],u=0,c=r;u<c.length;u++)l=c[u],a.push(this.__find(t,l,s));return[4,Promise.all(a)];case 5:return d=g.sent(),f=d.map((function(t){return t.data})).find(Boolean),p=!!d.find((function(t){return!t.cached})),f&&f.id&&(n=this.host.models.User.get(f.id)),!f||t===f.id||o?[3,7]:(v=h.a.difference(n.organizationIds,r)).length>0?[4,Promise.all(v.map((function(e){return y.__find(t,e,s)})))]:[3,7];case 6:g.sent(),g.label=7;case 7:if(this.host.models.User.removePlaceholder({entity:n,attrs:f}),p&&!e.ignoreNotFound&&!f)throw new zn.NotFoundError(this.host.models.User.name,t);return[2,n]}}))}))},e.prototype.__find=function(t,e,n){return void 0===n&&(n={}),lu(this,void 0,void 0,(function(){var r,o,i,s,a,u=this;return du(this,(function(c){switch(c.label){case 0:return n=h.a.defaults(n,{bypassCache:!1,ignoreNotFound:!1}),r=this.host.models.User.get(t),n.bypassCache?[3,2]:r&&!r.$placeholder&&r.profileByOrganizationId&&r.profileByOrganizationId[e]?[4,this.host.metadata.find(t,e,n)]:[3,2];case 1:return c.sent(),this.host.models.User.touch(t),[2,{cached:!0,user:r}];case 2:return[4,this.host.api.users.find(t,{organizationId:e})];case 3:if((o=c.sent())&&(o.entity&&(o.entity.organization_token=o.organization_id,o.entity.conversation_id=o.conversation_id,o=o.entity),o.token&&(o.id=o.token,delete o.token),i=o.dnd_auto_forward_receivers,s=void 0===i?[]:i,a=o.metadata,s.forEach((function(t){return u.host.models.User.injectPlaceholder(t)})),o.dnd_auto_forward_receivers=s,r=this.host.models.User.inject(o),a&&("role"===a.feature_service?this.host.roles.__injectSearchResult({entity:r,metadata:a,organizationId:e}):this.host.metadata.__injectMetadata(r.id,e,a))),!n.ignoreNotFound&&!o)throw new zn.NotFoundError(this.host.models.User.name,t);return[2,{cached:!1,data:o,user:r}]}}))}))},e.prototype.findProfileForOrganizations=function(t,e,n){return void 0===n&&(n={}),lu(this,void 0,void 0,(function(){var r;return du(this,(function(o){switch(o.label){case 0:return n=h.a.defaults(n,{bypassCache:!1,ignoreNotFound:!1}),[4,this.find(t,uu(uu({},n),{organizationIds:e}))];case 1:return[2,(r=o.sent())?r.profileByOrganizationId:r]}}))}))},e.prototype.findProfileForOrganization=function(t,e,n){return void 0===n&&(n={}),lu(this,void 0,void 0,(function(){var r;return du(this,(function(o){switch(o.label){case 0:return n=h.a.defaults(n,{bypassCache:!1,ignoreNotFound:!0}),"string"!=typeof e&&(e=e.id),[4,this.find(t,uu(uu({},n),{organizationId:e}))];case 1:return r=o.sent(),[2,r&&r.profileByOrganizationId&&r.profileByOrganizationId[e]||null]}}))}))},e.prototype.ensureUsers=function(t,e){return lu(this,void 0,void 0,(function(){var n,r,o,i;return du(this,(function(s){switch(s.label){case 0:for(this.host.requireUser(),"string"!=typeof e&&(e=e.id),n=[],r=0,o=t;r<o.length;r++)i=o[r],n.push(this.find(i,{organizationId:e,ignoreNotFound:!0}));return[4,Promise.all(n)];case 1:return[2,s.sent()]}}))}))},e.prototype.refresh=function(t){return lu(this,void 0,void 0,(function(){return du(this,(function(e){switch(e.label){case 0:return[4,this.find(t,{ignoreNotFound:!0,bypassCache:!0})];case 1:return[2,e.sent()]}}))}))},e.prototype.update=function(t){var e=t.firstName,n=t.lastName,r=t.displayName,o=t.status,i=t.dnd,s=t.dndText,a=t.avatarFile,u=t.removeAvatar;return lu(this,void 0,void 0,(function(){var t,c,l;return du(this,(function(d){switch(d.label){case 0:return this.host.requireUser(),t=su.a.call({firstName:e,lastName:n,displayName:r,status:o,dnd:i,dndText:s,avatarFile:a,removeAvatar:u},(function(t,e){return void 0===t})),[4,this.host.api.users.update(this.host.currentUserId,t)];case 1:return c=d.sent(),l=h.a.omit(t,"removeAvatar","avatarFile"),u?l.avatarUrl=null:void 0!==c.avatarUrl&&(l.avatarUrl=c.avatarUrl),[2,this.host.models.User.inject(uu({id:this.host.currentUserId},l))]}}))}))},e.prototype.updatePassword=function(t,e){return lu(this,void 0,void 0,(function(){return du(this,(function(n){return this.host.requireUser(),[2,this.host.api.users.updatePassword(this.host.currentUserId,t,e,this.config.productKey)]}))}))},e.prototype.setAutoForward=function(t,e){return lu(this,void 0,void 0,(function(){var n;return du(this,(function(r){switch(r.label){case 0:return this.host.requireUser(),n=this.host.currentUser.dnd,[4,this.host.api.users.setAutoForward(this.host.currentUserId,t,{dnd:n,receiverId:e})];case 1:return r.sent(),[2,!0]}}))}))},e.prototype.removeAutoForward=function(t){return lu(this,void 0,void 0,(function(){return du(this,(function(e){switch(e.label){case 0:return this.host.requireUser(),[4,this.host.api.users.removeAutoForward(this.host.currentUserId,t)];case 1:return e.sent(),[2,!0]}}))}))},e.prototype.setEulaAccepted=function(t,e){return lu(this,void 0,void 0,(function(){return du(this,(function(n){switch(n.label){case 0:return this.host.requireUser(),[4,this.host.api.users.setEulaAccepted(this.host.currentUserId,t,e)];case 1:return[2,n.sent()]}}))}))},e.prototype.setAwayMessage=function(t,e){return void 0===e&&(e={}),lu(this,void 0,void 0,(function(){var n,r,o;return du(this,(function(i){switch(i.label){case 0:return n=e.dnd,r=e.dndText,o=void 0===r?"":r,this.host.requireUser(),[4,this.host.api.users.setAwayMessage(this.host.currentUserId,t,{dnd:n,dndText:o})];case 1:return i.sent(),[2]}}))}))},e.prototype.getSignInAuthHeader=function(t,e){return this.host.api.users.getSignInAuthHeader(this.config.productKey,t,e)},e.prototype.getAll=function(){return this.host.models.User.getAll()},e.prototype.getById=function(t){return this.host.models.User.get(t)},e.prototype.getMultiById=function(t){return this.host.models.User.getMulti(t)},e.prototype._onChangeCurrentUserRole=function(t){var e=t.botUser;if(e){var n=this.host.roles._roleConversations[e.id];if(n)for(var r=0,o=n;r<o.length;r++){for(var i=o[r],s=!1,a=0,u=i.content;a<u.length;a++){var c=u[a];c.shouldEnsureRecipientStatus=!0,this.host.models.Message.inject(c),s=!0}s||this.host.models.Conversation.inject(i)}}},e.prototype.reactToUserPreferencesEvent=function(t){this.emit("preferences:change",_.a.camelizeObject(t))},e.PROFILE_ATTRIBUTES_PER_ORG=Ra,cu([Object(Or.decorator)({serializeArguments:function(t){return""}})],e.prototype,"signOut",null),cu([Object(Or.decorator)()],e.prototype,"findOrCreate",null),cu([Object(Or.decorator)()],e.prototype,"signOutAllDevices",null),cu([Object(Or.decorator)()],e.prototype,"findMe",null),cu([Object(Or.decorator)()],e.prototype,"findMyProfilesForAllOrganizations",null),cu([Object(Or.decorator)()],e.prototype,"find",null),cu([Object(Or.decorator)()],e.prototype,"__find",null),cu([Object(Or.decorator)()],e.prototype,"refresh",null),e}(no),pu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vu=function(){return(vu=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},yu=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},gu=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},mu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pu(e,t),e.prototype.findAll=function(t){return yu(this,void 0,void 0,(function(){var e=this;return gu(this,(function(n){switch(n.label){case 0:if(!t)throw new zn.ValidationError("organizationId","required");return[4,this.host.api.virtualWaitingRoom.findAll(t)];case 1:return[2,n.sent().content.map((function(t){return e.host.models.VirtualWaitingRoom.inject(t)}))]}}))}))},e.prototype.find=function(t,e){return yu(this,void 0,void 0,(function(){var n;return gu(this,(function(r){switch(r.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");if(!t)throw new zn.ValidationError("room_id","required");return[4,this.host.api.virtualWaitingRoom.find(t,e)];case 1:return n=r.sent(),[2,this.host.models.VirtualWaitingRoom.inject(n)]}}))}))},e.prototype.create=function(t,e){var n=e.staff,r=e.name;return yu(this,void 0,void 0,(function(){var e;return gu(this,(function(o){switch(o.label){case 0:if(!t)throw new zn.ValidationError("organizationId","required");if(!n)throw new zn.ValidationError("staff","required");if(!r)throw new zn.ValidationError("name","required");return[4,this.host.api.virtualWaitingRoom.create(t,{staff:n,name:r})];case 1:return e=o.sent(),[2,this.host.models.VirtualWaitingRoom.inject(e)]}}))}))},e.prototype.update=function(t,e,n){var r=n.staff,o=n.name,i=n.status,s=n.version;return yu(this,void 0,void 0,(function(){var n;return gu(this,(function(a){switch(a.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");if(!t)throw new zn.ValidationError("room_id","required");return[4,this.host.api.virtualWaitingRoom.update(t,e,{staff:r,name:o,status:i,version:s})];case 1:return n=a.sent(),[2,this.host.models.VirtualWaitingRoom.inject({id:t,staff:r,name:o,status:i,version:n.version})]}}))}))},e.prototype.delete=function(t,e){return yu(this,void 0,void 0,(function(){var n;return gu(this,(function(r){switch(r.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");if(!t)throw new zn.ValidationError("room_id","required");return(n=this.host.models.VirtualWaitingRoom.get(t))&&this.host.models.VirtualWaitingRoom.eject(n),[4,this.host.api.virtualWaitingRoom.delete(t,e)];case 1:return r.sent(),[2]}}))}))},e.prototype.getVisitInfo=function(t){return yu(this,void 0,void 0,(function(){return gu(this,(function(e){switch(e.label){case 0:if(!t)throw new zn.ValidationError("joinId","required");return[4,this.host.api.virtualWaitingRoom.getVisitInfo(t)];case 1:return[2,e.sent()]}}))}))},e.prototype.createVisit=function(t){var e=t.firstName,n=t.lastName,r=t.mobilePhone,o=t.visitReason,i=t.joinId;return yu(this,void 0,void 0,(function(){return gu(this,(function(t){switch(t.label){case 0:return[4,this.host.api.virtualWaitingRoom.createVisit({firstName:e,lastName:n,mobilePhone:r,visitReason:o,joinId:i})];case 1:return[2,t.sent()]}}))}))},e.prototype.editVisit=function(t){var e=t.visitId,n=t.firstName,r=t.lastName,o=t.mobilePhone,i=t.visitReason,s=t.createResources;return yu(this,void 0,void 0,(function(){return gu(this,(function(t){switch(t.label){case 0:return[4,this.host.api.virtualWaitingRoom.editVisit({visitId:e,firstName:n,lastName:r,mobilePhone:o,visitReason:i,createResources:s})];case 1:return[2,t.sent()]}}))}))},e.prototype.clearAllCompletedVisits=function(t){var e=t.roomId,n=t.organizationId;return yu(this,void 0,void 0,(function(){return gu(this,(function(t){switch(t.label){case 0:return[4,this.host.api.virtualWaitingRoom.cleanupVisits({type:"delete_completed_visits",roomId:e,organizationId:n})];case 1:return t.sent(),[2]}}))}))},e.prototype.reactToJoinableCallSSE=function(t){var e=t.data,n=t.type,r=Object(to.l)(e);r.vwrCallStatus=n.split(":")[1],this.host.models.VirtualWaitingRoom.inject(r)},e.prototype.findAllVisits=function(t,e){return yu(this,void 0,void 0,(function(){var n=this;return gu(this,(function(r){switch(r.label){case 0:if(!e)throw new zn.ValidationError("organizationId","required");if(!t)throw new zn.ValidationError("roomId","required");return[4,this.host.api.virtualWaitingRoom.findAllVisits(t,e)];case 1:return[2,r.sent().content.map((function(r){return n.host.models.VirtualWaitingRoomVisit.inject(vu({roomId:t,organizationId:e},r))}))]}}))}))},e.prototype.informProvider=function(t,e){return yu(this,void 0,void 0,(function(){return gu(this,(function(n){if(!t)throw new zn.ValidationError("organizationId","required");if(!e.roomId)throw new zn.ValidationError("roomId","required");if(!e.visitId)throw new zn.ValidationError("visitId","required");if(!e.accountToken)throw new zn.ValidationError("accountToken","required");return[2,this.host.api.virtualWaitingRoom.informProvider(t,e)]}))}))},e}(no),_u=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},bu=function(t,e){e.host;return t.defineModel("call",{replaceKeys:{},defaultValues:{},skipCamelizationForKeys:["payload"],parseAttrs:function(t){if(t.id||(t.id=t.roomName),t.payload){var e={};t.payload.disabled_participants&&(e=t.payload.disabled_participants,delete t.payload.disabled_participants),t.payload=_.a.camelizeObject(t.payload),t.payload.disabledParticipants=e}return t.payload&&(t.payload.orgId&&(t.organizationId=t.payload.orgId),t.payload.callId&&(t.callId=t.payload.callId),t.payload.groupId&&(t.groupId=t.payload.groupId),t.payload.participantsTokens&&t.payload.callerId&&(t.memberIds=_u(t.payload.participantsTokens,[t.payload.callerId]))),delete t.serverId,t}})},wu=function(t,e){var n=e.host;return t.defineModel("callLogEntry",{parseAttrs:function(t){return t.isContact=Jr()(t,"target.entity.metadata.isPatientContact"),t.isGroup="tigertext:entity:group"===Jr()(t,"target.type"),t.memberCount=Jr()(t,"target.entity.numMembers"),t.isMissed="missed_voip_call"===t.type,t.isOptedOut=Jr()(t,"target.entity.metadata.smsOptedOut",!1),t.isOutgoing=n.currentUserId===Jr()(t,"caller.entity.token"),t.isQuickCall=Boolean(Object(Eo.isPhone)(Jr()(t,"target.entity.displayName")))&&"00000"===Jr()(t,"target.entity.metadata.patientMrn"),t}})},Iu=function(t,e){var n=e.host;return t.defineModel("conversation",{instanceEvents:!0,transientAttrs:["_counterPartyAddedOnServer","_origIndex","highestSortNumber","unreadCount","unreadPriorityCount"],defaultValues:{_markingAsRead:!1,_markingAsReadSortNumber:null,_markingAsReadExpiration:null,firstExpiringUnreadMessage:null,firstUnreadMessage:null,higherContinuation:null,highestSortNumber:0,inProgressEscalationCount:0,isLive:!1,lastBangMessageSortNumber:0,lastIncomingMessageSortNumber:0,lastMessage:null,lowerContinuation:null,markableAsReadMessages:null,messages:null,muted:null,network:ur.PROVIDER,timeline:null,unreadCount:0,unreadPriorityCount:0},skipCamelizationForKeys:["metadata","muted"],parseAttrs:function(t){if("muted"in t&&t.muted){var e=t.muted;if(Object.keys(e).length>0){var r=e.mute_duration,o=e.mute_start;o&&(o=1e3*+o);var i=n.mute._addEntry(t.id,{durationInMinutes:r,organizationId:t.organizationId,startedAt:o});t.muted=i}else t.muted=null}return t},afterAssignment:function(e){var r=e.counterParty,o=e.counterPartyId,i=e.counterPartyType,s=e.id,a=e.isDeletable,u=e.isMuteable,c=e.metadata,l=e.muted;if(t.host.config.condensedReplays?l||(l=n.mute.getById(s)):l=n.mute._getByConversationHandle(s),e.muted=l,e.isMuted=!!e.muted,r?(o=r.id,i=r.$entityType):r=i&&o?t.store.get(i,o):null,e.counterParty=r,e.counterPartyId=o,e.counterPartyType=i,e.shouldDisplay=!("user"===i&&r&&!r.shouldDisplay),n.conversations._setAllowedSenders(e),a=!0,u="distributionList"!==i,r&&"group"===i){var d=r.groupType,f=r.p2pSender;if(d===tr.ROLE_P2P){var h=f&&"role"===f.$entityType;a=e.allowedSenders.length>0&&!h,u=u&&e.allowedSenders.length>0}else d===tr.ESCALATION?(a=!1,u=!0):d===tr.PATIENT_MESSAGING&&(a=e.counterParty.memberCount>2)}else r&&"team"===i&&(a=!1,u=!1);e.isDeletable=a,e.isMuteable=u,e.markableAsReadMessages||(e.markableAsReadMessages=[]),e.messages||(e.messages=[]),e.timeline||(e.timeline=[]),e.higherContinuation||(e.higherContinuation={continuation:t.host.config.condensedReplays?{higher_continuation:null}:"HIGHER",itemsEstimate:null}),e.lowerContinuation||(e.lowerContinuation={continuation:t.host.config.condensedReplays?{lower_continuation:null}:"LOWER",itemsEstimate:null}),c&&"patient_messaging"===c.feature_service&&(e.network=ur.PATIENT,"group"===i&&(e.patientId="patient:"+c.patient_id,c.patient_contact_id&&(e.patientContactId="patientContact:"+c.patient_contact_id)))},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}},hasMany:{content:{type:"message",foreignKey:"conversationId",sortBy:[["sortNumber","asc"],["id","asc"]]}}}})},Ou=function(t,e){var n=t.defineModel("distributionList",{replaceKeys:{avatar:"avatarUrl",createdBy:"createdById",displayName:"name",organizationKey:"organizationId",totalMembers:"memberCount",updatedBy:"updatedById"},skipCamelizationForKeys:["metadata"],transientAttrs:["$deleted"],defaultValues:{memberCount:0},afterAssignment:function(t){t.displayName=t.name},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},organization:{type:"organization",foreignKey:"organizationId"},updatedBy:{type:"user",foreignKey:"updatedById"}}}});return Aa(n,{finder:function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e.host.distributionLists).find.apply(t,n)},placeholderEntityDelayBeforeRefreshing:function(){return t.host.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return t.host.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Distribution List..."},defaultNotFoundAttrs:{name:"<Distribution List Not Found>"}}),n},Eu=function(t,e){var n=e.host;return t.defineModel("escalationExecution",{replaceKeys:{destructionDuration:"minutesToExpire",destructionTime:"expiresAt",displayName:"displayId",escalationExecutionId:"id",escalationGroupToken:"groupId",escalationPath:"path",escalationStatus:"status",level:"currentStep",organizationToken:"organizationId",targetDuration:"targetMinutesToAcknowledge",targetToken:"targetId",triggeredMessageToken:"carbonCopyMessageId",triggeringConversationId:"originalGroupConversationId",triggeringMessageToken:"originalMessageId"},defaultValues:{currentStep:0,status:Jn.IN_PROGRESS},parseAttrs:function(t){if("actionTime"in t&&"string"==typeof t.actionTime&&(t.actionTime=new Date(t.actionTime)),"carbonCopyMessageId"in t&&"string"==typeof t.carbonCopyMessageId&&"undefined"===t.carbonCopyMessageId&&(t.carbonCopyMessageId=null),"displayId"in t&&(t.displayId.startsWith("#")&&(t.displayId=t.displayId.slice(1)),t.displayId=t.displayId.toUpperCase()),"expiresAt"in t&&"string"==typeof t.expiresAt&&(t.expiresAt=new Date(t.expiresAt).getTime()),"groupId"in t&&"string"==typeof t.groupId&&"undefined"===t.groupId&&(t.groupId=null),"path"in t){for(var e=[],r=!1,o=0,i=t.path;o<i.length;o++){for(var s=i[o],a=s.targets,u=s.duration,c=[],l=0,d=a;l<d.length;l++){var f=d[l];if("string"==typeof f)c.push(n.injectPlaceholderModel({id:f},"user"));else if(f&&f.token){var h=f.displayName,p=f.token;c.push(n.injectPlaceholderModel({id:p,displayName:h},"user"))}else r=!0}e.push({minutesToAcknowledge:u,targets:c})}r?delete t.path:t.path=e}return"status"in t&&("init"===t.status&&(t.status="in_progress"),"destruct"===t.status&&(t.status="cancelled"),t.status=Jn.resolve(t.status)),t},afterAssignment:function(t){},relations:{belongsTo:{carbonCopyMessage:{type:"message",foreignKey:"carbonCopyMessageId"},group:{type:"group",foreignKey:"groupId"},organization:{type:"organization",foreignKey:"organizationId"},originalConversation:{type:"conversation",foreignKey:"originalGroupConversationId"},originalMessage:{type:"message",foreignKey:"originalMessageId"},target:{type:"user",foreignKey:"targetId"},escalationGroupConversation:{type:"conversation",foreignKey:"escalationGroupConversationId"}}}})},Tu=function(t,e){e.host;return t.defineModel("escalationExecutionChange",{parseAttrs:function(t){return"actionTime"in t&&"string"==typeof t.actionTime&&(t.actionTime=new Date(t.actionTime)),t}})},Su=function(t,e){var n=e.host;return t.defineModel("escalationPolicy",{replaceKeys:{destructionDuration:"minutesToExpire",escalationPath:"path",target:"targetId",targetDuration:"targetMinutesToAcknowledge"},defaultValues:{alwaysEscalate:!1},parseAttrs:function(t){if("path"in t){for(var e=[],r=!1,o=0,i=t.path;o<i.length;o++){for(var s=i[o],a=s.targets,u=s.duration,c=[],l=0,d=a;l<d.length;l++){var f=d[l];if("string"==typeof f)c.push(n.injectPlaceholderModel({id:f},"user"));else if(f&&f.token){var h=f.displayName,p=f.token;c.push(n.injectPlaceholderModel({id:p,displayName:h},"user"))}else r=!0}e.push({minutesToAcknowledge:u,targets:c})}r?delete t.path:t.path=e}return t},afterAssignment:function(t){},relations:{belongsTo:{target:{type:"user",foreignKey:"targetId"}}}})},Au=function(t,e){var n=e.host,r=t.defineModel("group",{replaceKeys:{avatar:"avatarUrl",createdTime:"createdAt",displayName:"name",members:"memberIds",numMembers:"__memberCount",organizationKey:"organizationId",proxied_members:"proxiedMembers"},transientAttrs:["__memberCount"],defaultValues:{hasCurrentUser:!1,isPublic:!1,memberIds:null},skipCamelizationForKeys:["escalation","metadata","proxied_members"],parseAttrs:function(t){if("createdAt"in t&&(t.createdAt=new Date(t.createdAt)),"createdBy"in t&&delete t.createdBy,t.avatarUrl&&(t.avatarUrl=ma(t.avatarUrl,n.config)),"escalation"in t){var e=n.escalations._updateEscalation(t.escalation,{inGroupInject:!0});delete t.escalation,t.escalationExecutionId=e.id}if(t.memberIds){for(var r=[],o=0,i=t.memberIds;o<i.length;o++){var s=i[o];"string"==typeof s?r.push(s):s.id&&r.push(s.id)}t.memberIds=r}if(t.metadata&&"patient_care"===t.metadata.feature_service&&(t.patientDetails=t.metadata.patient),t.metadata&&"patient_messaging"===t.metadata.feature_service&&(t.patientDetails={dob:t.metadata.patient_dob,gender:t.metadata.patient_gender,id:t.metadata.patient_id,isPatientContact:t.metadata.is_patient_contact,mrn:t.metadata.patient_mrn,name:t.metadata.patient_name,phoneNumber:t.metadata.phone_number,smsOptedOut:t.metadata.sms_opted_out},t.patientDetails.isPatientContact&&t.metadata.relation_name&&(t.patientDetails.relationName=t.metadata.relation_name)),t.metadata)if(t.metadata.team&&(t.metadata.team.token||t.metadata.team.id)){var a=n.models.Team.inject(t.metadata.team);a&&(t.teamId=a.id)}else t.metadata.team_token&&(t.teamId=t.metadata.team_token);return"metadata"in t&&delete t.metadata,t},afterAssignment:function(t){var e,r=t.id,o=t.memberIds,i=t.organizationId;n.config.condensedReplays?t.conversationId&&(e=n.conversations.getById(t.conversationId)):e=i?n.conversations.get("group",r,i):null;var s=i?n.metadata.get(r,i):null;s&&(s=s.data);var a=n.groups.__extractGroupTypeFromAttrs(t),u=s&&a===tr.ROLE_P2P?s.target_display_name:t.name;t.conversation=e,t.displayName=u,t.groupType=a,t.memberCount=o&&o.length||t.__memberCount||0,t.metadata=s,"FORUM"!==a&&delete t.hasCurrentUser,n.users._setMembersOnEntity(t),n.groups._setMembership(t),n.groups._setP2PEntities(t)},beforeCreateInstance:function(t){!function(t,e,r){if(!e||0===e.length)return;n.groups.ensureMembersWithIds(t,e,{onlyPlaceholder:!0,attrs:{organizationId:r}})}(t.id,t.memberIds,t.organizationId)},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"},escalationExecution:{type:"escalationExecution",foreignKey:"escalationExecutionId"},team:{type:"team",foreignKey:"teamId"}}}});return Aa(r,{finder:function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=n.groups).find.apply(t,e)},placeholderEntityDelayBeforeRefreshing:function(){return n.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return n.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading group..."},defaultNotFoundAttrs:{displayName:"<Group Not Found>"},shouldEnsure:function(t,e,r){var o=r.groupMembersOnlyPlaceholder;return!t.members||!t.metadata||t.groupType===tr.ROLE_P2P||t.members.some((function(t){return n.models.User.shouldEnsure(t,o)}))}}),r},Cu=function(t,e){e.host;return t.defineModel("groupMembersChange",{parseAttrs:function(t){return"actionTime"in t&&"string"==typeof t.actionTime&&(t.actionTime=new Date(t.actionTime)),t}})},Ru=function(t,e){var n=e.host;return t.defineModel("message",{replaceKeys:{clientId:"id",createdTime:"createdAt",data:"metadata",dndAutoForwardedFrom:"autoForwardedFromId",dor:"deleteOnRead",escalationExecId:"escalationExecutionId",groupAvatar:"groupAvatarUrl",groupToken:"groupId",messageId:"id",originalData:"originalMetadata",originalMsgId:"originalMessageId",originalSenderName:"originalSenderDisplayName",originalTimestamp:"originalForwardedMessageCreatedAt",recipient:"recipientId",recipientOrganization:"recipientOrganizationId",recipientOrgToken:"recipientOrganizationId",recipientToken:"recipientId",sender:"senderId",senderAvatar:"senderAvatarUrl",senderOrganization:"senderOrganizationId",senderOrgToken:"senderOrganizationId",senderToken:"senderId"},transientAttrs:["__organizationId","$synced","escalationExecutionChange","groupMembersChange","inTimeline"],defaultValues:{inTimeline:!1,isUnread:!1,messageType:ar.USER_SENT,senderStatus:or.NEW,shouldEnsureRecipientStatus:!1,sortNumber:0},skipCamelizationForKeys:["escalation","metadata","originalMetadata"],parseAttrs:function(t){if(t.teamRequest&&(t.senderId||(t.senderId=t.teamRequest.createdById),t.teamRequestId=t.teamRequest.id,delete t.teamRequest),"attachmentName"in t){var e=t.attachmentName;delete t.attachmentName,"undefined"!==e&&Array.isArray(t.attachments)&&t.attachments.length>0&&e&&(t.attachments[0].name=e)}if(Array.isArray(t.attachments)&&t.attachments.forEach((function(t,e){return t.id=""+(e+1)})),"priority"in t&&(t.priority=er.resolve(t.priority)),"createdAt"in t&&"string"==typeof t.createdAt&&(t.createdAt=new Date(t.createdAt)),"expireIn"in t&&(t.expiresAt=Date.now()+1e3*t.expireIn,delete t.expireIn),"recipientStatus"in t&&delete t.recipientStatus,"status"in t&&delete t.status,"xmlns"in t&&delete t.xmlns,"escalation"in t){var r=n.escalations._updateEscalation(t.escalation);delete t.escalation,t.escalationExecutionId=r.id}if("subType"in t&&(t.subType=sr.resolve(t.subType)),t.metadata){t.metadata=h.a.castArray(t.metadata).map(n.metadata.__parseMessageMetadata).filter(Boolean);var o=t.metadata.find((function(t){return"tigertext:message:role:sender"===t.namespace})),i=t.metadata.find((function(t){return"tigertext:message:role:owner"===t.namespace})),s=t.metadata.find((function(t){return"tigertext:message:patient_care"===t.namespace}));if(o&&o.payload){var a=t.senderOrganizationId,u=o.payload;t.senderRole=n.roles.__parseRoleFromMetadata({metadata:u,organizationId:a}),t.currentSenderRoleId=t.senderRole.id}if(i&&i.payload){a=t.senderOrganizationId;var c=t.senderId;u=i.payload;t.senderId=u.token,c!==u.token&&(t.senderRole={$entityType:"role",botUserId:c,id:"role:"+c,organizationId:a},t.currentSenderRoleId="role:"+c)}if(s&&s.payload){for(var l=[],d=0,f=s.payload.components;d<f.length;d++){var p=f[d];"type"in p&&(p.type=dr.resolve(p.type)),"sub_type"in p&&(p.sub_type=lr.resolve(p.sub_type)),"action_type"in p&&(p.action_type=cr.resolve(p.action_type)),l.push(p)}t.patientCareCard=l}}else"metadata"in t&&delete t.metadata;if(t.originalMetadata){t.originalMetadata=h.a.castArray(t.originalMetadata).map(n.metadata.__parseMessageMetadata).filter(Boolean);o=t.originalMetadata.find((function(t){return"tigertext:message:role:sender"===t.namespace})),i=t.originalMetadata.find((function(t){return"tigertext:message:role:owner"===t.namespace}));var v=t.originalMetadata.find((function(t){return"tigertext:message:patient_messaging"===t.namespace}));if(o&&o.payload){a=t.senderOrganizationId,u=o.payload;t.originalSenderRole=n.roles.__parseRoleFromMetadata({metadata:u,organizationId:a})}if(i&&i.payload){var y=t.originalSender,g=t.originalSenderDisplayName,m=t.originalSenderRole;a=t.senderOrganizationId,u=i.payload;m||"string"!=typeof y||(t.originalSenderRole={$entityType:"role",botUserId:y,displayName:g,id:"role:"+y,organizationId:a}),(!y||y&&"string"==typeof y)&&(t.originalSender={$entityType:"user",displayName:u.display_name,id:u.token,organizationId:a})}"isForwarded"in t&&t.isForwarded&&v&&(t.isForwardedFromPatientNetwork=!0,v.payload&&(t.patientDetails={isPatientContact:v.payload.is_patient_contact,mrn:v.payload.patient_mrn,patientId:v.payload.patient_id,patientName:v.payload.patient_name},v.payload.is_patient_contact&&(t.patientDetails.contactId=v.payload.patient_contact_id,t.patientDetails.contactName=v.payload.patient_contact_name,t.patientDetails.relation=v.payload.relation_name),t.originalGroupId=v.payload.group_id,t.originalGroupName=v.payload.group_name))}if("originalSender"in t&&"string"==typeof t.originalSender){a=t.senderOrganizationId,y=t.originalSender,g=t.originalSenderDisplayName;t.originalSender={$entityType:"user",displayName:g,id:y,organizationId:a},"patientDetails"in t&&(t.patientDetails.patientId===t.originalSender.id&&(t.originalSender.isPatient=!0),t.patientDetails.contactId===t.originalSender.id&&(t.originalSender.isPatientContact=!0,t.originalSender.relation=t.patientDetails.relation)),delete t.originalSenderDisplayName}return t},afterAssignment:function(e){var r=e.__organizationId,o=e.counterParty,i=e.counterPartyId,s=e.counterPartyType,a=e.createdAt,u=e.isOutgoing,c=e.recipientOrganizationId,l=e.senderId,d=e.senderOrganizationId,f=n.currentUserId;if(o)switch(i=o.id,s=o.$entityType){case"group":e.groupId=i,delete e.recipientId;break;case"distributionList":e.distributionListId=i,delete e.recipientId}else o=s&&i?t.store.get(s,i):null;e.counterParty=o,e.counterPartyId=i,e.counterPartyType=s,a||(a=new Date),l&&(u=n.messages._isMessageOutgoing(e)),u&&d?r=d:!u&&c&&(r=c),e.__organizationId=r,e.canRecall="distributionList"!==s&&l===f,e.createdAt=a,e.isOutgoing=u,e.isAutoForwarded=!!e.autoForwardedFromId,e.subType||(e.subType=sr.NA),n.messages._setRecipientStatus(e)},relations:{belongsTo:{autoForwardedFrom:{type:"user",foreignKey:"autoForwardedFromId"},conversation:{type:"conversation",foreignKey:"conversationId"},currentSenderRole:{type:"role",foreignKey:"currentSenderRoleId"},distributionList:{type:"distributionList",foreignKey:"distributionListId"},escalationExecution:{type:"escalationExecution",foreignKey:"escalationExecutionId"},group:{type:"group",foreignKey:"groupId"},originalGroup:{type:"group",foreignKey:"originalGroupId"},recipient:{type:"user",foreignKey:"recipientId"},recipientOrganization:{type:"organization",foreignKey:"recipientOrganizationId"},sender:{type:"user",foreignKey:"senderId"},senderOrganization:{type:"organization",foreignKey:"senderOrganizationId"},teamRequest:{type:"teamRequest",foreignKey:"teamRequestId"}},hasMany:{statusesPerRecipient:{type:"messageStatusPerRecipient",foreignKey:"messageId"}}}})},Pu=function(t){return t.defineModel("messageStatusPerRecipient",{replaceKeys:{accountId:"userId",timestamp:"createdAt"},defaultValues:{status:or.NA},parseAttrs:function(t){return t.status&&(t.status=or.resolve(t.status)),t.createdAt&&"string"==typeof t.createdAt&&(t.createdAt=new Date(t.createdAt)),t},beforeInject:function(t,e){if(e){var n=e.status,r=t.status;rr[r]<rr[n]&&(delete t.createdAt,delete t.status)}},relations:{belongsTo:{distributionList:{type:"distributionList",foreignKey:"distributionListId"},message:{type:"message",foreignKey:"messageId"},user:{type:"user",foreignKey:"userId"}}}})},ju=function(t,e){e.host;return t.defineModel("messageTemplate",{replaceKeys:{createdBy:"createdById",templateLabel:"title",updatedBy:"updatedById"},transientAttrs:["$deleted"],parseAttrs:function(t){return t.hasAttachment=!1,t.attachmentName&&t.attachmentSize&&t.attachmentType&&(t.hasAttachment=!0),t},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},organization:{type:"organization",foreignKey:"organizationId"},updatedBy:{type:"user",foreignKey:"updatedById"}}}})},xu=function(t,e){return t.defineModel("metadata",{parseAttrs:function(t,e){return t.data=e.data,t},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}})},Mu=function(t,e){e.host;return t.defineModel("mute",{parseAttrs:function(t){return t},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}})},ku=n(205),Nu=n.n(ku),zu=n(206),Du=n.n(zu);function Uu(t,e){return e in t?t[e].value:null}var Lu=function(t,e){var n=e.host,r=t.defineModel("organization",{instanceEvents:!0,replaceKeys:{allowMsgForward:"__isForwardAllowed",allowPublicGroups:"forumsEnabled",allowRoleScheduleUpload:"__isRolesScheduleUploadEnabled",desktopPriorityMessaging:"__desktopPriorityMessagingSounds",eula:"eulaEnabled",eulaContent:"eulaUrl",featurePatientCare:"__canShowPatientCare",featurePatientNetwork:"__canShowPatientNetwork",featureRoleScheduleUpload:"__canUploadRolesSchedule",featureRoleService:"rolesEnabled",featureRolesEscalation:"__canEscalateMessages",featureTeams:"__canShowTeams",featureTransactions:"canShowTransactions",latestIncomingMessageSortNumber:"lastIncomingMessageSortNumber",members:"memberCount",organizationKey:"organizationId",patientCare:"__showPatientCare",patientNetwork:"__showPatientNetwork",pfNoAttachment:"__isPFAttachmentAllowed",pfNoPhoto:"__isPFPhotoAllowed",roleService:"canAdminRoles",rolesEscalation:"__isRolesEscalationEnabled",ssoWebSessionDuration:"desktopExtendedSession",teams:"__showTeams"},defaultValues:{__canEscalateMessages:!1,__canShowPatientCare:!1,__canShowTeams:!1,__canUploadRolesSchedule:!1,__isForwardAllowed:!1,__isPFAttachmentAllowed:!1,__isPFPhotoAllowed:!1,__isRolesEscalationEnabled:!1,__isRolesScheduleUploadEnabled:!1,__showPatientCare:!1,__showTeams:!1,canAdminRoles:!1,canShowTransactions:!1,desktopExtendedSession:-1,forumsEnabled:!1,highestSortNumber:0,isPatientNetworkEnabled:!1,lastIncomingMessageSortNumber:0,networks:null,paid:!1,rolesEnabled:!1,settings:{},unreadCount:0,unreadPriorityCount:0},transientAttrs:["unreadCount","unreadPriorityCount"],parseAttrs:function(t){return t.settings&&(t.settings=Du.a.call(Nu.a.call(t.settings,(function(t){return _.a.camelizeKey(t.name)})),(function(t){isFinite(t.value)&&(t.value=+t.value),"true"===t.value&&(t.value=!0),"false"===t.value&&(t.value=!1)}))),t},afterAssignment:function(t){var e=t.__canEscalateMessages,r=t.__canShowPatientCare,o=t.__canShowPatientNetwork,i=t.__canShowTeams,s=t.__canUploadRolesSchedule,a=t.__desktopPriorityMessagingSounds,u=t.__isForwardAllowed,c=t.__isPFAttachmentAllowed,l=t.__isPFPhotoAllowed,d=t.__isRolesEscalationEnabled,f=t.__isRolesScheduleUploadEnabled,h=t.__showPatientCare,p=t.__showPatientNetwork,v=t.__showTeams,y=t.autoForwardReceiverId,g=t.id,m=t.name,_=t.paid,b=t.settings;v=v&&!!Uu(b,"teams"),p="individual"===p?!!Uu(b,"patientNetwork"):!!p,y=Uu(b,"dndAutoForwardReceiver"),t.allowPriorityMessage=!!Uu(b,"priorityMessaging"),t.autoLogoutMinutes=Uu(b,"autologoutTime")||1440,t.canUploadRolesSchedule=s&&f,t.deleteOnRead=!!Uu(b,"dor"),t.desktopAutoUpdate=!!Uu(b,"autoUpdate"),t.isEulaAccepted=!Uu(b,"eula"),t.isForwardAllowed=u&&1===Uu(b,"forward"),t.messageTimeToLive=Uu(b,"ttl")||-1,t.isPatientBroadcastEnabled=!!Uu(b,"pfBroadcast"),t.isPatientScheduledMessagesEnabled=!!Uu(b,"pfScheduleMessages"),t.isPatientVirtualWaitingRoomEnabled=!!Uu(b,"pfVirtualWaitingRoom"),t.isPFVideoCallEnabled=!!Uu(b,"pfVideoCall"),t.isPFVoiceCallEnabled=!!Uu(b,"pfVoiceCall"),t.isPFGroupVideoCallEnabled=!!Uu(b,"pfGroupVideoCall"),t.isPFGroupVoiceCallEnabled=!!Uu(b,"pfGroupVoiceCall"),t.isPFAttachmentAllowed=!c,t.isPFPhotoAllowed=!l;var w="UpM28mnfW65vJkbqEATtKvxm"===t.id;if(t.allowedSenders=n.organizations._getAllowedSenders(t),t.autoForwardReceiverId=y,t.autoForwardReceiver=y?n.models.User.get(y):null,t.canEscalateMessages=e&&d,t.desktopPriorityMessagingSounds=_&&a,t.displayName=w?"Contacts":m,t.isContacts=w,t.showPatientCare=r&&h,t.isPatientNetworkEnabled=o&&p,n.currentUser&&(n.currentUser.isPatient||n.currentUser.isPatientContact)&&o&&(t.isPatientNetworkEnabled="off"!==p),t.showTeams=i&&v,t.userRoles=n.userRoles.getByOrganizationId(g),t.networks||(t.networks={}),t.networks.provider||(t.networks.provider={unreadCount:0,unreadPriorityCount:0}),t.networks.patient||(t.networks.patient={dnd:!1,dndText:"",unreadCount:0,unreadPriorityCount:0}),t.networks.virtualWaitingRoom||(t.networks.virtualWaitingRoom={unreadCount:0,unreadPriorityCount:0}),t.network){var I=t.network.patient,O=I.dnd,E=I.dndText;t.networks.patient.dnd=O,t.networks.patient.dndText=null!==E?E:"",delete t.network}},methods:{getSettingValue:function(t){return Uu(this.settings,t)},getSettingEntry:function(t){return this.settings&&t in this.settings?this.settings[t]:null}},relations:{hasMany:{__expirableMessages:{type:"message",foreignKey:"__organizationId",filter:function(t){return!!t.expiresAt},sortBy:[["expiresAt","asc"],["id","asc"]]},__expirableMutes:{type:"mute",foreignKey:"organizationId",filter:function(t){return!!t.expiresAt},sortBy:[["expiresAt","asc"],["id","asc"]]},__markingAsReadConversations:{type:"conversation",foreignKey:"organizationId",filter:function(t){return!!t._markingAsRead},sortBy:[["_markingAsReadExpiration","asc"],["id","asc"]]},conversations:{type:"conversation",foreignKey:"organizationId",filter:function(t){var e=t.counterParty;return!!e&&e.groupType!==tr.ROLE_ASSIGNMENT},sortBy:[["highestSortNumber","desc"],["_origIndex","asc"],["id","asc"]]},messageTemplates:{type:"messageTemplate",foreignKey:"organizationId",sortBy:[["title","asc"]]},roles:{type:"role",foreignKey:"organizationId"},roleTags:{type:"roleTag",foreignKey:"organizationId"}}}});return Aa(r,{finder:function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=n.organizations).find.apply(t,e)},placeholderEntityDelayBeforeRefreshing:function(){return n.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return n.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{name:"Loading Organization..."},defaultNotFoundAttrs:{displayName:"<Organization Not Found>"}}),r},Fu=function(t,e){e.host;return t.defineModel("patient",{replaceKeys:{patientMrn:"mrn",patientGender:"gender",patientDob:"dob"},parseAttrs:function(t){return"featureService"in t&&delete t.featureService,"patientContacts"in t&&delete t.patientContacts,"isPatientContact"in t&&delete t.isPatientContact,"dob"in t&&(t.dob=Object(To.formatDob)(t.dob)),"phoneNumber"in t&&(t.phoneNumber=Object(Eo.formatPhoneWithDash)(t.phoneNumber)),t},relations:{belongsTo:{user:{type:"user",foreignKey:"userId"}},hasMany:{contacts:{type:"patientContact",foreignKey:"patientId"},sharedConversations:{type:"conversation",foreignKey:"patientId",filter:function(t,e){var n=t.counterParty;if(!n)return!1;var r=n.groupType,o=n.hasCurrentUserOrRole,i=n.memberIds;return!(r!==tr.PATIENT_MESSAGING||!o||!i.includes(e.userId))},sortBy:[["highestSortNumber","desc"],["_origIndex","asc"],["id","asc"]]}}}})},Bu=function(t,e){e.host;return t.defineModel("patientContact",{replaceKeys:{patientDob:"dob",patientGender:"gender",patientMrn:"mrn",relationName:"relation"},parseAttrs:function(t){return"entity"in t&&delete t.entity,"dob"in t&&(t.dob=Object(To.formatDob)(t.dob)),"phoneNumber"in t&&(t.phoneNumber=Object(Eo.formatPhoneWithDash)(t.phoneNumber)),t},relations:{belongsTo:{patient:{type:"patient",foreignKey:"patientId"},user:{type:"user",foreignKey:"userId"}},hasMany:{sharedConversations:{type:"conversation",foreignKey:"patientContactId",filter:function(t,e){var n=t.counterParty;if(!n)return!1;var r=n.groupType,o=n.hasCurrentUserOrRole,i=n.memberIds;return!(r!==tr.PATIENT_MESSAGING||!o||!i.includes(e.userId))},sortBy:[["highestSortNumber","desc"],["_origIndex","asc"],["id","asc"]]}}}})},qu=function(t,e){var n=e.host;return t.defineModel("product",{defaultValues:{activeProcessingEvents:null,conversationCount:0,organizations:null,rolesOptingIn:null,unreadCount:0,unreadPriorityCount:0,unreadVWRCount:0,unreadVWRPriorityCount:0},transientAttrs:["conversationCount","organizations","unreadCount","unreadPriorityCount"],afterAssignment:function(t){var e=t.id;t.productRoles=n.userRoles.getByProductId(e),null===t.activeProcessingEvents&&(t.activeProcessingEvents=[]),null===t.organizations&&(t.organizations=[]),null===t.rolesOptingIn&&(t.rolesOptingIn=[])}})};function Vu(t,e){return!!t&&t.includes(e)}var Gu=function(t,e){return t.defineModel("productRoles",{defaultValues:{roles:[]},afterAssignment:function(t){var e=t.roles;t.isAdmin=Vu(e,"tt_admin"),t.isAnalyticsAdmin=Vu(e,"tt_reporting"),t.isLdapAdmin=Vu(e,"tt_ldap"),t.isSuperAdmin=Vu(e,"tt_super_admin")},methods:{hasRole:function(t){return!!this.roles&&this.roles.includes(t)}},relations:{belongsTo:{product:{type:"product",foreignKey:"productId"},user:{type:"user",foreignKey:"userId"}}}})},Hu=function(t,e){var n=e.host;return t.defineModel("role",{defaultValues:{description:"",memberIds:null,roleTagId:null},afterAssignment:function(t){n.users._setMembersOnEntity(t)},relations:{belongsTo:{assignmentGroup:{type:"group",foreignKey:"assignmentGroupId"},botUser:{type:"user",foreignKey:"botUserId"},escalationPolicy:{type:"escalationPolicy",foreignKey:"escalationPolicyId"},organization:{type:"organization",foreignKey:"organizationId"},roleTag:{type:"roleTag",foreignKey:"roleTagId"}}}})},Wu=function(t,e){return t.defineModel("roleTag",{replaceKeys:{tagColor:"color",tagName:"name"},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}},hasMany:{roles:{type:"role",foreignKey:"roleTagId"}}},parseAttrs:function(t){if("colorValue"in t){var e=t.color,n=t.colorValue;t.color=n,t.colorId=e,delete t.colorValue}return"color"in t&&(t.color=t.color.replace("0x","#")),t},afterAssignment:function(t){var e=t.name;t.displayName=e,t.isDefault=e&&e.startsWith("Default")}})},Yu=function(t,e){var n=e.host;return t.defineModel("scheduledMessage",{replaceKeys:{createdBy:"createdById",recipient:"recipientId",recipientType:"_recipientType",senderToken:"senderId",scheduleStatus:"status",updatedBy:"updatedById"},transientAttrs:["$deleted"],parseAttrs:function(t){return t.hasAttachment=!1,t.attachmentName&&t.attachmentSize&&t.attachmentType&&(t.hasAttachment=!0),t._recipientType&&(t.recipientType=n.modelsByEntityType[to.a.camelizeKey(t._recipientType)].name),t},afterAssignment:function(e){var n=e.recipient,r=e.recipientId,o=e.recipientType;n?(r=n.id,o=n.$entityType):n=o&&r?t.store.get(o,r):null,e.recipient=n,e.recipientId=r,e.recipientType=o},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},organization:{type:"organization",foreignKey:"organizationId"},sender:{type:"user",foreignKey:"senderId"},template:{type:"messageTemplate",foreignKey:"templateId"},updatedBy:{type:"user",foreignKey:"updatedById"}}}})},Ku=function(t,e){var n=e.host,r=t.defineModel("team",{replaceKeys:{avatar:"avatarUrl",group_token:"groupToken",members:"__members",numMembers:"__memberCount",name:"displayName"},transientAttrs:["__memberCount","__members"],defaultValues:{canMembersLeave:!1,canRequestToJoin:!1,hasCurrentUserOrRole:!1,hasCurrentUserPending:!1,hasCurrentUserBeenDeclined:!1,memberIds:[]},skipCamelizationForKeys:["members"],parseAttrs:function(t){var e=t.__members;if(e){for(var r=[],o=0,i=e;o<i.length;o++){var s=i[o];if("object"==typeof s)if(s.token){r.push(s.token);var a=n.models.User.inject(s);n.models.User.removePlaceholder({entity:a,attrs:s})}else s.id&&r.push(s.id);else"string"==typeof s&&r.push(s)}t.memberIds=r,delete t.__members}return t},afterAssignment:function(t){var e=t.memberIds;n.groups._setMembership(t),n.users._setMembersOnEntity(t),n.teams._setHasUserPending(t),t.memberCount=e&&e.length||t.__memberCount||0},relations:{belongsTo:{group:{type:"group",foreignKey:"groupId"}}}});return Aa(r,{finder:function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=n.teams).find.apply(t,e)},placeholderEntityDelayBeforeRefreshing:function(){return n.config.placeholderEntityDelayBeforeRefreshing},placeholderEntityAllowLoading:function(){return n.config.placeholderEntityAllowLoading},defaultPlaceholderAttrs:{displayName:"Loading..."},defaultNotFoundAttrs:{displayName:"<Team Not Found>"}}),r},$u=function(t,e){e.host;return t.defineModel("teamRequest",{replaceKeys:{},transientAttrs:[],defaultValues:{},parseAttrs:function(t){return t.createdBy&&(t.createdById=t.createdBy.token,delete t.createdBy),t.team&&(t.teamId=t.team.id,delete t.team),t},afterAssignment:function(t){},relations:{belongsTo:{createdBy:{type:"user",foreignKey:"createdById"},team:{type:"team",foreignKey:"teamId"}}}})},Xu=function(t,e){return t.defineModel("userRoles",{defaultValues:{roles:[]},afterAssignment:function(t){var e="UpM28mnfW65vJkbqEATtKvxm"===t.organizationId,n=t.roles;t.isAdmin=n.includes("admin"),t.isHelpDesk=n.includes("help_desk"),t.isPatientAdmin=n.includes("patient_messaging_admin"),t.isRoleAdmin=n.includes("feature_role_admin"),t.isTeamAdmin=n.includes("team_admin"),t.isVirtualWaitingRoomAdmin=n.includes("virtual_waiting_room_admin"),t.reportingEnabled=n.includes("reporting")&&!e,t.reportingEnabledOnAllOrgs=n.includes("reporting_view_orgs")&&!e,t.tigerTouchPlusReportingEnabled=n.includes("tigertouchplus_reporting")},methods:{hasRole:function(t){return this.roles.includes(t)}},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"},user:{type:"user",foreignKey:"userId"}}}})},Qu=function(t,e){e.host;return t.defineModel("virtualWaitingRoom",{parseAttrs:function(t){return t},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"}}}})},Zu=function(t,e){e.host;return t.defineModel("VirtualWaitingRoomVisit",{parseAttrs:function(t){return t},relations:{belongsTo:{organization:{type:"organization",foreignKey:"organizationId"},VirtualWaitingRoom:{type:"VirtualWaitingRoom",foreignKey:"roomId"}}}})},Ju=n(207),tc=function(){return(tc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ec=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},nc=function(){function t(t,e){void 0===e&&(e={});var n=e.logger,r=ec(e,["logger"]);this.host=t,this.options=r,this.logger=n,this.store=new Ju.a(tc(tc({},r),{host:t,logger:n})),this.store.host=t}return t.prototype.defineModels=function(){var t=this,e={},n=tc(tc({},this.options),{host:this.host,logger:this.logger});h.a.each(s,(function(r,o){e[o]=r(t,n)})),this.models=e},t.prototype.defineModel=function(t,e){return void 0===e&&(e={}),h.a.defaults(e,{replaceKeys:{},skipCamelizationForKeys:null}),h.a.defaults(e.replaceKeys,{token:"id"}),this.store.defineModel(t,tc(tc({},e),{afterInject:function(t){var n=Date.now();t.$lastModified===n&&(n+=1e-5),t.$lastModified=n,e.afterInject&&e.afterInject(t)},parseAttrs:function(t){var n;if(h.a.isEmpty(e.skipCamelizationForKeys))n=to.a.camelizeObject(t);else{var r=h.a.omit(t,e.skipCamelizationForKeys),o=h.a.pick(t,e.skipCamelizationForKeys);n=tc(tc({},to.a.camelizeObject(r)),o)}return Object(to.o)(n,e.replaceKeys),e.parseAttrs&&(n=e.parseAttrs(n,t)),n}}))},t.prototype.clear=function(){this.store.clear()},t}(),rc=n(211).version,oc=rc=rc.replace("-dev",""),ic=function(){return(ic=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},sc=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},ac=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},uc=function(){function t(t){var e=this;void 0===t&&(t={}),this.errors=zn,this.VERSION=oc,this.version=oc,this._onBrowserUnload=function(){var t=[];e.emit("browserUnload",(function(e,n,r){return t.push({fn:e,priority:n,name:r})})),h.a.orderBy(t,["priority"],["desc"]).forEach((function(t){var e=t.fn,n=t.priority,r=t.name;console.log("[unload]",n,r),e()}))},this._onDisconnected=function(t){var n=t.isRecoverable;n||e._removeAuth(),e.emit("events:disconnected",{isRecoverable:n})},this._onTick=function(){e.__tickerFrame=v()((function(){try{e.emit("tick")}finally{e.__ticker=setTimeout(e._onTick,5e3)}}))},this._resetLastBang=function(){e._bangOccurredDuringReplay=!0},this._startBangTimer=function(){e._bangOccurredDuringReplay=!1,e._checkBangTimer=setTimeout(e._didBangOccur,e.config.detectBangReplayTimeout)},this._didBangOccur=function(){e._bangOccurredDuringReplay?e._startBangTimer():(e._checkBangTimer=null,e._bangReplayDone())},this._bangReplayDone=function(){e.currentlyServingOfflineMessages&&(e.currentlyServingOfflineMessages=!1,e.emit("conversations:loading:start"),e.conversations.hasPendingReloads()&&e.conversations.__flushConversationsToReload(),e.emit("groups:offline:stop"),e.emit("messages:offline:stop"),e.emit("conversations:loading:stop"),e.emit("messages:new:start"))},this.config=Object.assign({},t),h.a.defaultsDeep(this.config,Un.CONFIG_DEFAULT);var n=this.config,s=n.apiEnv,a=n.logLevel;this.config.cloudfront=Un.CLOUDFRONT[s],/(env\d+|lt\d*)/.test(s)&&(this.config.cloudfront=Un.CLOUDFRONT.development,Un.BASE_URLS[this.config.apiEnv]="https://"+s+"-devapi.tigertext.xyz",Un.FORGOT_PASSWORD_URLS[this.config.apiEnv]="https://"+s+"-forget.tigertext.com",Un.CN_URLS[this.config.apiEnv]="https://"+s+"-console.tigertext.xyz",Un.ADMIN_URLS[this.config.apiEnv]=Un.CN_URLS[s]+"/app/admin",Un.ROLES_URLS[this.config.apiEnv]="/"+s+"/app/roles/index.html"),this.config.baseUrl||(this.config.baseUrl=Un.BASE_URLS[s]),Object.assign(this,{attachments:to.f,date:to.g,email:to.h,file:to.i,phone:to.m}),this.httpClient=new Qr({config:this.config,logger:new Bn({name:"HttpClient",level:a})}),this.eventSourceClient=new br({config:this.config,httpClient:this.httpClient,logger:new Bn({name:"EventSourceClient",level:a})}),this.enums=ic(ic({},o),{NetworkStatus:mr}),this.store=new nc(this,{logger:new Bn({name:"Store",level:a})}),this.store.defineModels(),this.models=this.store.models,this.modelsByEntityType=h.a.mapKeys(this.store.models,(function(t,e){return to.a.camelizeKey(e)})),this.modelsByEntityType.account=this.modelsByEntityType.user,this.modelsByEntityType.list=this.modelsByEntityType.distributionList,this.allModelEntityTypes=Object.keys(this.modelsByEntityType),this.logger=new Bn({name:"TigerConnectClient",level:a}),this.api={};for(var u=0,c=Object.entries(r);u<c.length;u++){var l=c[u],d=l[0],f=l[1],p=to.a.camelizeKey(d);this.api[p]=new f(this,{logger:new Bn({name:d+"API",level:a})})}this._services=[];for(var y=0,g=Object.entries(i);y<g.length;y++){var m=g[y],_=m[0],b=(f=m[1],p=to.a.camelizeKey(_),new f(this,{logger:new Bn({name:_+"Service",level:this.config.serviceLogLevels[p]||a})}));this[p]=b,this._services.push(b)}for(var w=0,I=this._services;w<I.length;w++){(b=I[w]).mounted&&b.mounted()}this._listenToEvents(),this._startTicker(),this.on("browserUnload",(function(t){return t((function(){e.config.autoSignOutOnBrowserUnload&&(e.notifications.disconnect({source:"On browser unload"}),e.signOut({async:!1,resetClient:!1}))}),100,"signOut")})),this._checkBangTimer=null,this.conversationsLoaded=!1,this.currentlyServingOfflineMessages=!1}return t.prototype._listenToEvents=function(){var t=this;this.on("signedIn",(function(e,n){t.logger.info("signedIn",e.id)})),this.on("signedOut",(function(e){e.resetClient&&t.reset()})),this.on("signUp",(function(e){var n=e.user,r=e.auth;t.logger.info("signUp",n.id),t._setCurrentUser(n),t._setAuth(r)})),this.events.on("event",(function(e){t.emit("event",e),"bang"===e.type&&t._resetLastBang()})),this.events.on("batch:available",(function(e){return t.emit("events:batch:available",e)})),this.events.on("connected",(function(){return t.emit("events:connected")})),this.events.on("disconnected",this._onDisconnected),this.events.on("processing:start",(function(e){return t.emit("processing:start",e)})),this.events.on("processing:stop",(function(e){return t.emit("processing:stop",e)})),this.events.on("visibilityChange",(function(e,n){return t.emit("visibilityChange",e,n)})),this.calls.on("answered",(function(e){return t.emit("call:answered",e)})),this.calls.on("ended",(function(e){return t.emit("call:ended",e)})),this.calls.on("incoming",(function(e){return t.emit("call:incoming",e)})),this.calls.on("state",(function(e){return t.emit("call:state",e)})),this.conversations.on("clearTimeline",(function(e){return t.emit("conversation:clearTimeline",e)})),this.conversations.on("clearMessageStatuses",(function(e){return t.emit("conversation:clearMessageStatuses",e)})),this.conversations.on("message",(function(e){return t.emit("message",e)})),this.conversations.on("friends",(function(e){return t.emit("friends",e)})),this.eventSourceClient.on("auth:invalid",(function(){return t.emit("auth:invalid")})),this.groups.on("membership:change",(function(e){return t.emit("group:membership:change",e)})),this.httpClient.on("networkStatus:change",(function(e){return t.emit("networkStatus:change",e)})),this.notifications.on("connected",(function(){return t.emit("notifications:connected")})),this.notifications.on("disconnected",(function(e){return t.emit("notifications:disconnected")})),this.notifications.on("signingIn",(function(){return t.emit("notifications:signingIn")})),this.notifications.on("signedIn",(function(e){return t.emit("notifications:signedIn",e)})),this.notifications.on("signingOut",(function(e){return t.emit("notifications:signingOut",e)})),this.notifications.on("signedOut",(function(e){return t.emit("notifications:signedOut",e)})),this.notifications.on("event",(function(e){return t.emit("notifications:event",e)})),this.notifications.on("message",(function(e){return t.emit("notification:message",e)})),this.notifications.on("unread:change",(function(e){return t.emit("notification:unread:change",e)})),this.organizations.on("preferences:change",(function(e){return t.emit("organization:preferences:change",e)})),this.presence.on("change",(function(e){return t.emit("presence:change",e)})),this.roles.on("change",(function(e){return t.emit("role:change",e)})),this.typingStatus.on("change",(function(e){return t.emit("typing:change",e)})),this.users.on("preferences:change",(function(e){return t.emit("user:preferences:change",e)})),"undefined"!=typeof window&&window.addEventListener("unload",this._onBrowserUnload)},t.prototype._startTicker=function(){this.__ticker=setTimeout(this._onTick,5e3),this.__tickerFrame=null},t.prototype._stopTicker=function(){null!==this.__ticker&&(clearTimeout(this.__ticker),this.__ticker=null),null!==this.__tickerFrame&&(v.a.cancel(this.__tickerFrame),this.__tickerFrame=null)},t.prototype.signIn=function(t,e,n){return void 0===n&&(n={}),sc(this,void 0,void 0,(function(){var r,o,i,s,a,u,c;return ac(this,(function(l){switch(l.label){case 0:return r=n.udid,o=void 0===r?g()():r,i=n.refreshUser,s=void 0===i||i,this.emit("signingIn"),[4,this.users.signIn(t,e,{udid:o})];case 1:return a=l.sent(),u=a.auth,c=a.user,this._setCurrentUser(c),this._setAuth(u),s?[4,this.users.findMe({bypassCache:!0})]:[3,3];case 2:l.sent(),l.label=3;case 3:return this.emit("signedIn",c,u),[2,{auth:u,user:c}]}}))}))},t.prototype.signInWithApiKeyAndSecret=function(t,e,n){return void 0===n&&(n={}),sc(this,void 0,void 0,(function(){var r,o,i,s,a,u,c;return ac(this,(function(l){switch(l.label){case 0:return r=n.udid,o=void 0===r?g()():r,i=n.refreshUser,s=void 0===i||i,this.emit("signingIn"),[4,this.users.signInWithApiKeyAndSecret(t,e,{udid:o})];case 1:return a=l.sent(),u=a.auth,c=a.user,this._setCurrentUser(c),this._setAuth(u),s?[4,this.users.findMe({bypassCache:!0})]:[3,3];case 2:l.sent(),l.label=3;case 3:return this.emit("signedIn",c,u),[2,{auth:u,user:c}]}}))}))},t.prototype.signInWithMagicToken=function(t,e){return void 0===e&&(e={}),sc(this,void 0,void 0,(function(){var n,r,o,i,s,a,u;return ac(this,(function(c){switch(c.label){case 0:return n=e.udid,r=void 0===n?g()():n,o=e.refreshUser,i=void 0===o||o,this.emit("signingIn"),[4,this.users.signInWithMagicToken(t,{udid:r})];case 1:return s=c.sent(),a=s.auth,u=s.user,this._setCurrentUser(u),this._setAuth(a),i?[4,this.users.findMe({bypassCache:!0})]:[3,3];case 2:c.sent(),c.label=3;case 3:return this.emit("signedIn",u,a),[2,{auth:a,user:u}]}}))}))},t.prototype.signOut=function(t){var e=void 0===t?{}:t,n=e.async,r=void 0===n||n,o=e.fromServer,i=void 0!==o&&o,s=e.resetClient,a=void 0===s||s;if(!this.isSignedIn)return Promise.resolve(!1);if(!r&&"undefined"==typeof XMLHttpRequest)throw new Error("`async: false` option cannot be set unless using signOut() in a browser");if(this.events.disconnect({source:"On sign out"}),r)return this.users.signOut({fromServer:i,resetClient:a});this.emit("signingOut",{fromServer:i,resetClient:a});var u=new XMLHttpRequest;u.open("POST",this.config.baseUrl+"/v2/logout",!1);for(var c=0,l=Object.entries(this.httpClient.getAuthHeaders());c<l.length;c++){var d=l[c],f=d[0],h=d[1];u.setRequestHeader(f,h)}return u.send(null),this.emit("signedOut",{fromServer:i,resetClient:a,signedOut:!0}),Promise.resolve(!0)},t.prototype.signOutAllDevices=function(t){var e=(void 0===t?{}:t).async,n=void 0===e||e;if(!this.isSignedIn)return Promise.resolve();if(!n&&"undefined"==typeof XMLHttpRequest)throw new Error("`async: false` option cannot be set unless using signOutAllDevices() in a browser");if(n)return this.users.signOutAllDevices();var r=new XMLHttpRequest;r.open("POST",this.config.baseUrl+"/v2/wipe?token="+this.currentUserId,!1);for(var o=0,i=Object.entries(this.httpClient.getAuthHeaders());o<i.length;o++){var s=i[o],a=s[0],u=s[1];r.setRequestHeader(a,u)}return r.send(null),Promise.resolve()},t.prototype.authenticate=function(t,e){return sc(this,void 0,void 0,(function(){return ac(this,(function(n){switch(n.label){case 0:return[4,this._authenticateWithParams({key:t,secret:e})];case 1:return[2,n.sent()]}}))}))},t.prototype.authenticateUsingOauth=function(t,e){return void 0===e&&(e={udid:void 0}),sc(this,void 0,void 0,(function(){var n,r;return ac(this,(function(o){switch(o.label){case 0:return n=e.udid,r=void 0===n?g()():n,[4,this._authenticateWithParams({bearerToken:t,udid:r})];case 1:return[2,o.sent()]}}))}))},t.prototype._authenticateWithParams=function(t){return sc(this,void 0,void 0,(function(){var e,n;return ac(this,(function(r){switch(r.label){case 0:this._setAuth(t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.users.findMe()];case 2:return e=r.sent(),this._setCurrentUser(e),this.emit("signedIn",e,t),[2,e];case 3:throw n=r.sent(),this._removeAuth(),this._currentUser=null,n;case 4:return[2]}}))}))},t.prototype._setCurrentUser=function(t){this._currentUser=t},t.prototype._setAuth=function(t){this._auth=t,this.httpClient.setAuth(t),this.events.setAuth(t)},t.prototype._removeAuth=function(){this._auth=null,this.httpClient.removeAuth(),this.events.removeAuth()},t.prototype.getCurrentUser=function(){return this._currentUser||null},Object.defineProperty(t.prototype,"currentUser",{get:function(){return this.getCurrentUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentUserId",{get:function(){var t=this.getCurrentUser();return t?t.id:null},enumerable:!1,configurable:!0}),t.prototype.getAuth=function(){return this._auth},Object.defineProperty(t.prototype,"isSignedIn",{get:function(){return!!this.getAuth()},enumerable:!1,configurable:!0}),t.prototype.requireUser=function(){if(!this.isSignedIn)throw new zn.NotSignedInError},t.prototype.reactToAdvisoryEvent=function(t,e){switch(this.emit("advisory",{type:t,data:e}),t){case"replayStart":this.currentlyServingOfflineMessages=!0,this.emit("messages:offline:start",e),this.products._addProcessingEvent({actionType:hr.MESSAGE_REPLAY,entity:this.products.getAll()[0],itemsEstimate:e.replayMessageCount});break;case"replayStop":null===this._checkBangTimer&&(this.emit("groups:offline:start"),this._startBangTimer()),this.products._removeProcessingEvent({actionType:hr.MESSAGE_REPLAY,entity:this.products.getAll()[0]})}},Object.defineProperty(t.prototype,"MODEL_BY_TYPE_NS",{get:function(){return this._MODEL_BY_TYPE_NS||(this._MODEL_BY_TYPE_NS={"tigertext:entity:account":this.models.User,"tigertext:entity:group":this.models.Group,"tigertext:entity:distribution_list":this.models.DistributionList,"tigertext:entity:dist_list_member":this.models.User,"tigertext:entity:list":this.models.DistributionList,"tigertext:entity:message_template":this.models.MessageTemplate,"tigertext:entity:patient_distribution_list":this.models.DistributionList,"tigertext:entity:schedule_message":this.models.ScheduledMessage,"tigertext:entity:tag":this.models.RoleTag,"tigertext:entity:team":this.models.Team,"tigertext:iq:message":this.models.Message,"tigertext:iq:group_message":this.models.Message,"tigertext:iq:group:message":this.models.Message}),this._MODEL_BY_TYPE_NS},enumerable:!1,configurable:!0}),t.prototype.modelByTypeNS=function(t){return this.MODEL_BY_TYPE_NS[t]},t.prototype.modelNameByTypeNS=function(t){var e=this.MODEL_BY_TYPE_NS[t];return e?e.name:(d()(e,"modelNameByTypeNS: Missing class for "+t),null)},t.prototype.modelNameByEntityType=function(t){var e=this.modelsByEntityType[t]||this.MODEL_BY_TYPE_NS[t];if(e)return e.name;d()(e,"modelNameByEntityType: Missing class for "+t)},t.prototype.ejectModel=function(t,e){void 0===e&&(e=t.xmlns||t.type);var n=this.MODEL_BY_TYPE_NS[e]||this.modelsByEntityType[e];if(n)return n.eject(t);d()(n,"ejectModel: Missing class for "+e)},t.prototype.injectModel=function(t,e){void 0===e&&(e=t.xmlns||t.type);var n=this.MODEL_BY_TYPE_NS[e]||this.modelsByEntityType[e];return n?n.inject(t):(d()(n,"injectModel: Missing class for "+e),null)},t.prototype.injectPlaceholderModel=function(t,e){void 0===e&&(e=t.xmlns||t.type);var n=this.modelByTypeNS(e)||this.modelsByEntityType[e];return n?n.injectPlaceholder(t):(d()(n,"injectPlaceholderModel: Missing class for "+e),null)},t.prototype.getEntity=function(t,e){return this.modelsByEntityType[t].get(e)},t.prototype.getEntities=function(t){var e=this;return t.map((function(t){return e.getEntity(t.type,t.id)}))},t.prototype.dispose=function(){this._stopTicker(),this.conversationsLoaded=!1,null!==this._checkBangTimer&&(clearTimeout(this._checkBangTimer),this._checkBangTimer=null);for(var t=0,e=this._services;t<e.length;t++){var n=e[t];n.dispose&&n.dispose()}this.store&&this.store.clear()},t.prototype.reset=function(){this.dispose();for(var t=0,e=this._services;t<e.length;t++){var n=e[t];n.mounted&&n.mounted()}this._startTicker()},t.prototype.configure=function(t){return Object.assign(this.config,t),this.httpClient.mounted(),this},t.prototype.setDefaultOrganization=function(t){return this.configure({defaultOrganizationId:t})},Object.defineProperty(t.prototype,"networkStatus",{get:function(){return this.httpClient.networkStatus},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forgotPasswordUrl",{get:function(){return Un.FORGOT_PASSWORD_URLS[this.config.apiEnv]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adminUrl",{get:function(){return this.config.adminFeatureBranch?"/feature/"+this.config.adminFeatureBranch+"/app/admin":this.config.localAdminUrl?this.config.localAdminUrl:Un.ADMIN_URLS[this.config.apiEnv]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cnUrl",{get:function(){return this.config.localCnUrl?this.config.localCnUrl:Un.CN_URLS[this.config.apiEnv]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rolesUrl",{get:function(){return this.config.rolesFeatureBranch?"/feature/"+this.config.rolesFeatureBranch+"/app/roles/index.html":this.config.localRolesUrl?this.config.localRolesUrl:Un.ROLES_URLS[this.config.apiEnv]},enumerable:!1,configurable:!0}),t.CONSUMER_ORGANIZATION_ID=Un.CONSUMER_ORGANIZATION_ID,t.errors=zn,t.VERSION=oc,t.version=oc,t}();Object.assign(uc.prototype,c.a.prototype)}]);
//# sourceMappingURL=tigerconnect-sdk-web.min.js.map